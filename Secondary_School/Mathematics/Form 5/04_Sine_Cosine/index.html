<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sine & Cosine Rule | S5 Math</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.production.min.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <script
      type="text/javascript"
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    ></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=Noto+Sans+TC:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Outfit", "Noto Sans TC", sans-serif;
      }
    </style>
  </head>
  <body class="bg-rose-50 text-slate-800 min-h-screen">
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect, useMemo } = React;

      const translations = {
        en: {
          unit: "Unit 3: Trigonometry",
          title: "Sine & Cosine Rule Explorer",
          desc: "Solve triangles using AAS, SAS, or SSS cases.",
          sideA: "Side a",
          sideB: "Side b",
          sideC: "Side c",
          angleA: "Angle A",
          angleB: "Angle B",
          angleC: "Angle C",
          calculate: "Solve Triangle",
          mode: "Mode",
          reset: "Reset",
          area: "Area",
          error: "Invalid Triangle",
        },
        zh: {
          unit: "單元三：三角學",
          title: "正弦及餘弦定律探索器",
          desc: "使用 AAS, SAS 或 SSS 條件解三角形。",
          sideA: "邊長 a",
          sideB: "邊長 b",
          sideC: "邊長 c",
          angleA: "角 A",
          angleB: "角 B",
          angleC: "角 C",
          calculate: "解三角形",
          mode: "模式",
          reset: "重置",
          area: "面積",
          error: "無效的三角形",
        },
      };

      const App = () => {
        const [lang, setLang] = useState("en");
        const t = translations[lang];

        // Mode: SSS, SAS, AAS
        const [mode, setMode] = useState("SAS");

        // Inputs
        const [val1, setVal1] = useState(5); // a or Side 1
        const [val2, setVal2] = useState(60); // Angle or Side 2
        const [val3, setVal3] = useState(7); // Side 3 or Side 2

        const [solution, setSolution] = useState(null);

        // Solver Logic
        useEffect(() => {
          let res = { valid: false };
          if (mode === "SAS") {
            // b, A, c given? Let's say inputs are: side b, Angle A, side c
            // Standardize: val1 = b, val2 = A (deg), val3 = c
            const b = val1;
            const A_deg = val2;
            const c = val3;
            const A = (A_deg * Math.PI) / 180;

            if (b > 0 && c > 0 && A_deg > 0 && A_deg < 180) {
              // Cosine Rule: a^2 = b^2 + c^2 - 2bc cosA
              const a = Math.sqrt(b * b + c * c - 2 * b * c * Math.cos(A));
              // Sine Rule for B: sinB/b = sinA/a
              const sinB = (b * Math.sin(A)) / a;
              const B = Math.asin(sinB);
              const C = Math.PI - A - B;

              res = {
                valid: true,
                a,
                b,
                c,
                A: A_deg,
                B: (B * 180) / Math.PI,
                C: (C * 180) / Math.PI,
              };
            }
          } else if (mode === "SSS") {
            const a = val1,
              b = val2,
              c = val3;
            if (a + b > c && a + c > b && b + c > a) {
              // Cosine Rule for Angles
              const A = Math.acos((b * b + c * c - a * a) / (2 * b * c));
              const B = Math.acos((a * a + c * c - b * b) / (2 * a * c));
              const C = Math.PI - A - B;
              res = {
                valid: true,
                a,
                b,
                c,
                A: (A * 180) / Math.PI,
                B: (B * 180) / Math.PI,
                C: (C * 180) / Math.PI,
              };
            }
          } else if (mode === "AAS") {
            // Angle A, Angle B, Side a
            const A_deg = val1;
            const B_deg = val2;
            const a = val3;
            if (A_deg + B_deg < 180 && a > 0) {
              const C_deg = 180 - A_deg - B_deg;
              const A = (A_deg * Math.PI) / 180;
              const B = (B_deg * Math.PI) / 180;
              const C = (C_deg * Math.PI) / 180;
              // Sine Rule
              const b = (a * Math.sin(B)) / Math.sin(A);
              const c = (a * Math.sin(C)) / Math.sin(A);
              res = { valid: true, a, b, c, A: A_deg, B: B_deg, C: C_deg };
            }
          }

          // Calculate Area
          if (res.valid) {
            // 0.5 ab sinC
            const A_rad = (res.A * Math.PI) / 180;
            res.area = 0.5 * res.b * res.c * Math.sin((res.A * Math.PI) / 180); // wait, need to ensure b,c match logic.
            // Area formula is independent of which sides used if consistent.
            // Heron's formula is safer for SSS
            const s = (res.a + res.b + res.c) / 2;
            res.area = Math.sqrt(s * (s - res.a) * (s - res.b) * (s - res.c));
          }

          setSolution(res);
        }, [mode, val1, val2, val3]);

        // SVG Point Calculation
        const getPoints = () => {
          if (!solution || !solution.valid) return [];
          // Scale triangle to fit 300x200 box
          // Fix Point A at (50, 150)?
          // Line AB along X axis?
          // Let c be base AB.
          // A at (0,0), B at (c, 0). C at (b cosA, b sinA).
          // Then translate/scale.

          const { a, b, c, A, B, C } = solution;
          const A_rad = (A * Math.PI) / 180;

          const Ax = 0,
            Ay = 0;
          const Bx = c,
            By = 0;
          const Cx = b * Math.cos(A_rad);
          const Cy = b * Math.sin(A_rad);

          // Bounding box
          const minX = Math.min(Ax, Bx, Cx);
          const maxX = Math.max(Ax, Bx, Cx);
          const minY = Math.min(Ay, By, Cy);
          const maxY = Math.max(Ay, By, Cy);

          const w = maxX - minX;
          const h = maxY - minY;

          const scale = Math.min(250 / w, 180 / h);
          const offX = (300 - w * scale) / 2 - minX * scale;
          const offY = (300 - h * scale) / 2 - minY * scale; // Invert Y later

          const toSvg = (x, y) => ({
            x: x * scale + offX,
            y: 250 - (y * scale + offY), // Flip Y
          });

          return [toSvg(Ax, Ay), toSvg(Bx, By), toSvg(Cx, Cy)];
        };

        const pts = getPoints();

        return (
          <div className="p-8 max-w-5xl mx-auto min-h-screen flex flex-col items-center select-none font-sans">
            <header className="mb-8 text-center w-full relative">
              <button
                onClick={() => setLang(lang === "en" ? "zh" : "en")}
                className="absolute right-0 top-0 px-4 py-2 bg-white rounded-full shadow border border-rose-200 text-sm font-bold text-rose-600 hover:bg-rose-50 transition"
              >
                <i className="fa-solid fa-globe mr-2"></i>
                {lang === "en" ? "中文" : "ENG"}
              </button>
              <div className="text-rose-600 font-bold uppercase text-xs tracking-widest mb-2">
                {t.unit}
              </div>
              <h1 className="text-4xl font-extrabold text-slate-900 mb-2">
                {t.title}
              </h1>
              <p className="text-slate-500">{t.desc}</p>
            </header>

            <div className="flex flex-col lg:flex-row gap-8 w-full">
              {/* Controls */}
              <div className="bg-white p-6 rounded-3xl shadow-lg border border-rose-100 flex-1 h-fit">
                <div className="flex gap-2 mb-6">
                  {["SAS", "SSS", "AAS"].map((m) => (
                    <button
                      key={m}
                      onClick={() => setMode(m)}
                      className={`flex-1 py-2 rounded-xl font-bold transition ${
                        mode === m
                          ? "bg-rose-600 text-white shadow-md"
                          : "bg-slate-100 text-slate-500 hover:bg-slate-200"
                      }`}
                    >
                      {m}
                    </button>
                  ))}
                </div>

                <div className="space-y-6">
                  {mode === "SAS" && (
                    <>
                      <div>
                        <label className="text-xs font-bold text-slate-400 uppercase mb-1">
                          {t.sideB}
                        </label>
                        <input
                          type="range"
                          min="1"
                          max="100"
                          value={val1}
                          onChange={(e) => setVal1(Number(e.target.value))}
                          className="w-full accent-rose-500"
                        />
                        <div className="text-right font-mono text-rose-600 font-bold">
                          {val1}
                        </div>
                      </div>
                      <div>
                        <label className="text-xs font-bold text-slate-400 uppercase mb-1">
                          {t.angleA} (°)
                        </label>
                        <input
                          type="range"
                          min="1"
                          max="179"
                          value={val2}
                          onChange={(e) => setVal2(Number(e.target.value))}
                          className="w-full accent-blue-500"
                        />
                        <div className="text-right font-mono text-blue-600 font-bold">
                          {val2}°
                        </div>
                      </div>
                      <div>
                        <label className="text-xs font-bold text-slate-400 uppercase mb-1">
                          {t.sideC}
                        </label>
                        <input
                          type="range"
                          min="1"
                          max="100"
                          value={val3}
                          onChange={(e) => setVal3(Number(e.target.value))}
                          className="w-full accent-rose-500"
                        />
                        <div className="text-right font-mono text-rose-600 font-bold">
                          {val3}
                        </div>
                      </div>
                    </>
                  )}
                  {mode === "SSS" && (
                    <>
                      <div>
                        <label className="text-xs font-bold text-slate-400 uppercase mb-1">
                          {t.sideA}
                        </label>
                        <input
                          type="range"
                          min="1"
                          max="100"
                          value={val1}
                          onChange={(e) => setVal1(Number(e.target.value))}
                          className="w-full accent-rose-500"
                        />
                        <div className="text-right font-mono text-rose-600 font-bold">
                          {val1}
                        </div>
                      </div>
                      <div>
                        <label className="text-xs font-bold text-slate-400 uppercase mb-1">
                          {t.sideB}
                        </label>
                        <input
                          type="range"
                          min="1"
                          max="100"
                          value={val2}
                          onChange={(e) => setVal2(Number(e.target.value))}
                          className="w-full accent-rose-500"
                        />
                        <div className="text-right font-mono text-rose-600 font-bold">
                          {val2}
                        </div>
                      </div>
                      <div>
                        <label className="text-xs font-bold text-slate-400 uppercase mb-1">
                          {t.sideC}
                        </label>
                        <input
                          type="range"
                          min="1"
                          max="100"
                          value={val3}
                          onChange={(e) => setVal3(Number(e.target.value))}
                          className="w-full accent-rose-500"
                        />
                        <div className="text-right font-mono text-rose-600 font-bold">
                          {val3}
                        </div>
                      </div>
                    </>
                  )}
                  {mode === "AAS" && (
                    <>
                      <div>
                        <label className="text-xs font-bold text-slate-400 uppercase mb-1">
                          {t.angleA} (°)
                        </label>
                        <input
                          type="range"
                          min="1"
                          max="178"
                          value={val1}
                          onChange={(e) => setVal1(Number(e.target.value))}
                          className="w-full accent-blue-500"
                        />
                        <div className="text-right font-mono text-blue-600 font-bold">
                          {val1}°
                        </div>
                      </div>
                      <div>
                        <label className="text-xs font-bold text-slate-400 uppercase mb-1">
                          {t.angleB} (°)
                        </label>
                        <input
                          type="range"
                          min="1"
                          max={179 - val1}
                          value={val2}
                          onChange={(e) => setVal2(Number(e.target.value))}
                          className="w-full accent-blue-500"
                        />
                        <div className="text-right font-mono text-blue-600 font-bold">
                          {val2}°
                        </div>
                      </div>
                      <div>
                        <label className="text-xs font-bold text-slate-400 uppercase mb-1">
                          {t.sideA}
                        </label>
                        <input
                          type="range"
                          min="1"
                          max="100"
                          value={val3}
                          onChange={(e) => setVal3(Number(e.target.value))}
                          className="w-full accent-rose-500"
                        />
                        <div className="text-right font-mono text-rose-600 font-bold">
                          {val3}
                        </div>
                      </div>
                    </>
                  )}
                </div>
              </div>

              {/* Visualization & Results */}
              <div className="bg-white p-8 rounded-3xl shadow-lg border border-slate-200 flex-[2] flex flex-col items-center justify-center min-h-[400px]">
                {solution && solution.valid && pts.length === 3 ? (
                  <>
                    <svg
                      width="300"
                      height="300"
                      className="overflow-visible mb-6"
                    >
                      <polygon
                        points={`${pts[0].x},${pts[0].y} ${pts[1].x},${pts[1].y} ${pts[2].x},${pts[2].y}`}
                        fill="rgba(244, 63, 94, 0.1)"
                        stroke="#f43f5e"
                        strokeWidth="3"
                        strokeLinejoin="round"
                      />

                      {/* Labels - Simplified placement */}
                      <text
                        x={pts[0].x - 10}
                        y={pts[0].y + 20}
                        className="font-bold fill-blue-600"
                      >
                        A
                      </text>
                      <text
                        x={pts[1].x + 10}
                        y={pts[1].y + 20}
                        className="font-bold fill-blue-600"
                      >
                        B
                      </text>
                      <text
                        x={pts[2].x}
                        y={pts[2].y - 10}
                        className="font-bold fill-blue-600 text-center"
                      >
                        C
                      </text>
                    </svg>

                    <div className="grid grid-cols-2 md:grid-cols-3 gap-4 w-full">
                      <div className="bg-slate-50 p-3 rounded-lg text-center border border-slate-100">
                        <div className="text-xs text-slate-400 font-bold">
                          a
                        </div>
                        <div className="text-lg font-mono font-bold text-slate-700">
                          {solution.a.toFixed(2)}
                        </div>
                      </div>
                      <div className="bg-slate-50 p-3 rounded-lg text-center border border-slate-100">
                        <div className="text-xs text-slate-400 font-bold">
                          b
                        </div>
                        <div className="text-lg font-mono font-bold text-slate-700">
                          {solution.b.toFixed(2)}
                        </div>
                      </div>
                      <div className="bg-slate-50 p-3 rounded-lg text-center border border-slate-100">
                        <div className="text-xs text-slate-400 font-bold">
                          c
                        </div>
                        <div className="text-lg font-mono font-bold text-slate-700">
                          {solution.c.toFixed(2)}
                        </div>
                      </div>
                      <div className="bg-blue-50 p-3 rounded-lg text-center border border-blue-100">
                        <div className="text-xs text-blue-400 font-bold">
                          ∠A
                        </div>
                        <div className="text-lg font-mono font-bold text-blue-700">
                          {solution.A.toFixed(1)}°
                        </div>
                      </div>
                      <div className="bg-blue-50 p-3 rounded-lg text-center border border-blue-100">
                        <div className="text-xs text-blue-400 font-bold">
                          ∠B
                        </div>
                        <div className="text-lg font-mono font-bold text-blue-700">
                          {solution.B.toFixed(1)}°
                        </div>
                      </div>
                      <div className="bg-blue-50 p-3 rounded-lg text-center border border-blue-100">
                        <div className="text-xs text-blue-400 font-bold">
                          ∠C
                        </div>
                        <div className="text-lg font-mono font-bold text-blue-700">
                          {solution.C.toFixed(1)}°
                        </div>
                      </div>
                    </div>

                    <div className="mt-4 bg-emerald-50 px-6 py-2 rounded-full border border-emerald-100 text-emerald-700 font-bold text-sm">
                      {t.area}: {solution.area.toFixed(2)}
                    </div>
                  </>
                ) : (
                  <div className="text-slate-400 italic flex flex-col items-center">
                    <i className="fa-solid fa-triangle-exclamation text-4xl mb-2 text-amber-400"></i>
                    {t.error}
                  </div>
                )}
              </div>
            </div>

            
          </div>
        );
      };
      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  
      
      <!-- Footer -->
      <footer class="text-center py-4 text-slate-500 text-sm">
        <p class="italic mb-1">
          But God made the earth by his power; he founded the world by his wisdom and stretched out the heavens by his
          understanding. Jeremiah 10:12
        </p>
        <p class="text-xs mb-1 mt-2">
          「耶和華用能力創造大地，用智慧建立世界，用聰明鋪張穹蒼。」 耶利米書 10:12
        </p>
        <p class="text-xs mt-2 pt-2 border-t border-slate-300">
          @ 2025 Education Engineering Portfolio | Generated by Gemini Pro 3.0 | Prepared by SF Lau
        </p>
      </footer>
</body>
</html>
