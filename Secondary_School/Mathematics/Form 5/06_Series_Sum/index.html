<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Summation of Series | S5 Math 等差等比級數求和</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.production.min.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <script
      type="text/javascript"
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    ></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=Noto+Sans+TC:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Outfit", "Noto Sans TC", sans-serif;
      }
    </style>
  </head>
  <body class="bg-rose-50 text-slate-800 min-h-screen">
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;

      const translations = {
          en: {
              unit: "Unit 1: Sequences & Series",
              title: "Series Summation Calculator",
              desc: "Calculate the sum of arithmetic (AS) or geometric (GS) series.",
              type: "Series Type",
              as: "Arithmetic",
              gs: "Geometric",
              firstTerm: "First Term (a)",
              commonDiff: "Common Difference (d)",
              commonRatio: "Common Ratio (r)",
              numTerms: "Number of Terms (n)",
              formula: "Formula",
              sum: "Sum"
          },
          zh: {
              unit: "單元一：等差等比數列",
              title: "級數求和計算器",
              desc: "計算等差 (AS) 或等比 (GS) 級數的和。",
              type: "級數類型",
              as: "等差",
              gs: "等比",
              firstTerm: "首項 (a)",
              commonDiff: "公差 (d)",
              commonRatio: "公比 (r)",
              numTerms: "項數 (n)",
              formula: "公式",
              sum: "和"
          }
      };

      const App = () => {
          const [lang, setLang] = useState("en");
          const t = translations[lang];

          const [type, setType] = useState("AS");
          const [a, setA] = useState(1);
          const [d, setD] = useState(2);
          const [r, setR] = useState(2);
          const [n, setN] = useState(10);

          // Calculations
          let sum = 0;
          let terms = [];

          if (type === "AS") {
              // S_n = n/2 * (2a + (n-1)d)
              sum = (n / 2) * (2 * a + (n - 1) * d);
              for (let i = 0; i < Math.min(n, 8); i++) {
                  terms.push(a + i * d);
              }
          } else {
              // S_n = a(1-r^n)/(1-r) for r != 1
              if (r === 1) {
                  sum = a * n;
              } else {
                  sum = a * (1 - Math.pow(r, n)) / (1 - r);
              }
              for (let i = 0; i < Math.min(n, 8); i++) {
                  terms.push(a * Math.pow(r, i));
              }
          }

          useEffect(() => {
              if(window.MathJax) window.MathJax.typesetPromise();
          }, [type, a, d, r, n, lang]);

          return (
              <div className="p-8 max-w-4xl mx-auto min-h-screen flex flex-col items-center select-none">
                  <header className="mb-8 text-center w-full relative">
                      <button
                          onClick={() => setLang(lang === 'en' ? 'zh' : 'en')}
                          className="absolute right-0 top-0 px-4 py-2 bg-white rounded-full shadow border border-rose-200 text-sm font-bold text-rose-600 hover:bg-rose-50 transition"
                      >
                          <i className="fa-solid fa-globe mr-2"></i>
                          {lang === 'en' ? '中文' : 'ENG'}
                      </button>
                      <div className="text-rose-600 font-bold uppercase text-xs tracking-widest mb-2">{t.unit}</div>
                      <h1 className="text-4xl font-extrabold text-slate-900 mb-2">{t.title}</h1>
                      <p className="text-slate-500">{t.desc}</p>
                  </header>

                  <div className="bg-white p-6 rounded-3xl shadow-xl border border-rose-100 w-full mb-8">
                      {/* Type Toggle */}
                      <div className="flex justify-center gap-4 mb-8">
                          <button onClick={() => setType("AS")} className={`px-8 py-3 rounded-xl font-bold transition ${type === "AS" ? "bg-rose-600 text-white shadow-lg" : "bg-slate-100 text-slate-500"}`}>
                              {t.as} (AS)
                          </button>
                          <button onClick={() => setType("GS")} className={`px-8 py-3 rounded-xl font-bold transition ${type === "GS" ? "bg-rose-600 text-white shadow-lg" : "bg-slate-100 text-slate-500"}`}>
                              {t.gs} (GS)
                          </button>
                      </div>

                      {/* Inputs */}
                      <div className="grid md:grid-cols-3 gap-6 mb-8">
                          <div>
                              <label className="text-sm font-bold text-slate-500 block mb-2">{t.firstTerm}</label>
                              <input type="number" value={a} onChange={e => setA(Number(e.target.value))} className="w-full p-3 text-xl font-mono text-center border rounded-xl focus:ring-2 focus:ring-rose-400 outline-none" />
                          </div>
                          {type === "AS" ? (
                              <div>
                                  <label className="text-sm font-bold text-slate-500 block mb-2">{t.commonDiff}</label>
                                  <input type="number" value={d} onChange={e => setD(Number(e.target.value))} className="w-full p-3 text-xl font-mono text-center border rounded-xl focus:ring-2 focus:ring-rose-400 outline-none" />
                              </div>
                          ) : (
                              <div>
                                  <label className="text-sm font-bold text-slate-500 block mb-2">{t.commonRatio}</label>
                                  <input type="number" step="0.1" value={r} onChange={e => setR(Number(e.target.value))} className="w-full p-3 text-xl font-mono text-center border rounded-xl focus:ring-2 focus:ring-rose-400 outline-none" />
                              </div>
                          )}
                          <div>
                              <label className="text-sm font-bold text-slate-500 block mb-2">{t.numTerms}</label>
                              <input type="number" min="1" max="100" value={n} onChange={e => setN(Math.max(1, Number(e.target.value)))} className="w-full p-3 text-xl font-mono text-center border rounded-xl focus:ring-2 focus:ring-rose-400 outline-none" />
                          </div>
                      </div>

                      {/* Terms Preview */}
                      <div className="bg-slate-50 p-4 rounded-xl mb-6 overflow-x-auto">
                          <div className="flex gap-2 items-center justify-center flex-wrap">
                              {terms.map((term, i) => (
                                  <span key={i} className="px-3 py-1 bg-rose-100 text-rose-700 rounded-full font-mono text-sm">
                                      {Number.isInteger(term) ? term : term.toFixed(2)}
                                  </span>
                              ))}
                              {n > 8 && <span className="text-slate-400">... ({n - 8} more)</span>}
                          </div>
                      </div>

                      {/* Formula */}
                      <div className="bg-rose-50 p-4 rounded-xl mb-6 text-center border border-rose-100">
                          <div className="text-sm font-bold text-rose-400 uppercase mb-2">{t.formula}</div>
                          {type === "AS" ? (
                              <div className="text-xl font-mono">\[ S_n = \frac{n}{2}(2a + (n-1)d) = \frac{ {n} }{2}(2 \times {a} + ({n}-1) \times {d}) \]</div>
                          ) : (
                              <div className="text-xl font-mono">\[ S_n = \frac{a(1-r^n)}{1-r} = \frac{ {a}(1-{r}^{ {n} })}{1-{r}} \]</div>
                          )}
                      </div>

                      {/* Result */}
                      <div className="text-center bg-emerald-50 p-6 rounded-2xl border border-emerald-200">
                          <div className="text-sm font-bold text-emerald-600 uppercase mb-2">{t.sum} (S<sub>{n}</sub>)</div>
                          <div className="text-5xl font-extrabold text-emerald-700 font-mono">
                              {Number.isInteger(sum) ? sum.toLocaleString() : sum.toFixed(4)}
                          </div>
                      </div>
                  </div>

                  
              </div>
          );
      };
      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  
      
      <!-- Footer -->
      <footer class="text-center py-4 text-slate-500 text-sm">
        <p class="italic mb-1">
          But God made the earth by his power; he founded the world by his wisdom and stretched out the heavens by his
          understanding. Jeremiah 10:12
        </p>
        <p class="text-xs mb-1 mt-2">
          「耶和華用能力創造大地，用智慧建立世界，用聰明鋪張穹蒼。」 耶利米書 10:12
        </p>
        <p class="text-xs mt-2 pt-2 border-t border-slate-300">
          @ 2025 Education Engineering Portfolio | Generated by Gemini Pro 3.0 | Prepared by SF Lau
        </p>
      </footer>
</body>
</html>
