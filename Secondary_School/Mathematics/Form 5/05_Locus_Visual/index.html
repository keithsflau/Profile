<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Locus Visualizer | S5 Math</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.production.min.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <script
      type="text/javascript"
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    ></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=Noto+Sans+TC:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Outfit", "Noto Sans TC", sans-serif;
      }
    </style>
  </head>
  <body class="bg-rose-50 text-slate-800 min-h-screen">
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect, useRef } = React;

      const translations = {
        en: {
          unit: "Unit 4: Locus",
          title: "Locus Visualizer",
          desc: "Explore the path of a point satisfying specific conditions.",
          distPoint: "Distance from Point",
          distLine: "Distance from Line",
          equiTwoPoints: "Equidistant from 2 Points",
          equiTwoLines: "Equidistant from 2 Lines",
          drag: "Drag the Red Point (p)",
          trace: "Trace Locus",
          clear: "Clear Trace",
        },
        zh: {
          unit: "單元四：軌跡",
          title: "軌跡視像儀",
          desc: "探索點在特定條件下移動的路徑。",
          distPoint: "與一點保持固定距離",
          distLine: "與直線保持固定距離",
          equiTwoPoints: "與兩點保持相等距離",
          equiTwoLines: "與兩直線保持相等距離",
          drag: "拖動紅點 (p)",
          trace: "顯示軌跡",
          clear: "清除軌跡",
        },
      };

      const App = () => {
        const [lang, setLang] = useState("en");
        const t = translations[lang];
        const [mode, setMode] = useState("distPoint");
        const [showTrace, setShowTrace] = useState(true);
        const [p, setP] = useState({ x: 200, y: 200 }); // Moving point
        const [isDragging, setIsDragging] = useState(false);

        // Constrains
        const [c1, setC1] = useState({ x: 200, y: 200 }); // Center / Point A
        const [c2, setC2] = useState({ x: 300, y: 200 }); // Point B

        // For traces (if we want history, but simple constraint calc is better for 'dynamic' locus).
        // Actually, let's render the TRUE locus line, and show if P is ON it.

        // Svg Size
        const w = 600;
        const h = 400;

        const handleMouseMove = (e) => {
          if (!isDragging) return;
          const rect = e.target.closest("svg").getBoundingClientRect();
          setP({
            x: e.clientX - rect.left,
            y: e.clientY - rect.top,
          });
        };

        // Locus Render Logic
        const renderLocus = () => {
          if (mode === "distPoint") {
            // Fixed distance form c1
            // Let's say dist is 100
            return (
              <circle
                cx={c1.x}
                cy={c1.y}
                r="100"
                stroke="#f43f5e"
                strokeWidth="2"
                fill="none"
                strokeDasharray="5"
                className="animate-pulse"
              />
            );
          }
          if (mode === "equiTwoPoints") {
            // Perpendicular Bisector
            const mx = (c1.x + c2.x) / 2;
            const my = (c1.y + c2.y) / 2;
            const dx = c2.x - c1.x;
            const dy = c2.y - c1.y;
            // Slope m = dy/dx. Normal slope = -dx/dy.
            // Too lazy for exact SVG bounds calc. Draw a long line.
            // Vector (-dy, dx).
            const len = Math.sqrt(dx * dx + dy * dy);
            const ux = (-dy / len) * 1000;
            const uy = (dx / len) * 1000;
            return (
              <line
                x1={mx - ux}
                y1={my - uy}
                x2={mx + ux}
                y2={my + uy}
                stroke="#f43f5e"
                strokeWidth="2"
                strokeDasharray="5"
              />
            );
          }
          return null;
        };

        // Check if P satisfies condition
        const checkCondition = () => {
          if (mode === "distPoint") {
            const d = Math.sqrt(
              Math.pow(p.x - c1.x, 2) + Math.pow(p.y - c1.y, 2)
            );
            return Math.abs(d - 100) < 5;
          }
          if (mode === "equiTwoPoints") {
            const d1 = Math.sqrt(
              Math.pow(p.x - c1.x, 2) + Math.pow(p.y - c1.y, 2)
            );
            const d2 = Math.sqrt(
              Math.pow(p.x - c2.x, 2) + Math.pow(p.y - c2.y, 2)
            );
            return Math.abs(d1 - d2) < 5;
          }
          return false;
        };

        const isOnLocus = checkCondition();

        return (
          <div className="p-8 max-w-4xl mx-auto min-h-screen flex flex-col items-center select-none font-sans">
            <header className="mb-8 text-center w-full relative">
              <button
                onClick={() => setLang(lang === "en" ? "zh" : "en")}
                className="absolute right-0 top-0 px-4 py-2 bg-white rounded-full shadow border border-rose-200 text-sm font-bold text-rose-600 hover:bg-rose-50 transition"
              >
                <i className="fa-solid fa-globe mr-2"></i>
                {lang === "en" ? "中文" : "ENG"}
              </button>
              <div className="text-rose-600 font-bold uppercase text-xs tracking-widest mb-2">
                {t.unit}
              </div>
              <h1 className="text-4xl font-extrabold text-slate-900 mb-2">
                {t.title}
              </h1>
            </header>

            <div className="bg-white p-6 rounded-3xl shadow-xl border border-rose-100 w-full mb-8">
              <div className="flex justify-center gap-4 mb-6">
                <button
                  onClick={() => setMode("distPoint")}
                  className={`px-4 py-2 rounded-xl transition font-bold ${
                    mode === "distPoint"
                      ? "bg-rose-600 text-white"
                      : "bg-slate-100 text-slate-500"
                  }`}
                >
                  {t.distPoint}
                </button>
                <button
                  onClick={() => setMode("equiTwoPoints")}
                  className={`px-4 py-2 rounded-xl transition font-bold ${
                    mode === "equiTwoPoints"
                      ? "bg-rose-600 text-white"
                      : "bg-slate-100 text-slate-500"
                  }`}
                >
                  {t.equiTwoPoints}
                </button>
                {/* Shortened for demo */}
              </div>

              <div
                className="w-full h-[400px] bg-slate-50 rounded-xl border border-slate-200 relative overflow-hidden cursor-crosshair"
                onMouseMove={handleMouseMove}
                onMouseUp={() => setIsDragging(false)}
                onMouseLeave={() => setIsDragging(false)}
              >
                <svg
                  width="100%"
                  height="100%"
                  className="absolute inset-0 pointer-events-none"
                >
                  {/* Base Objects */}
                  {mode === "distPoint" && (
                    <circle cx={c1.x} cy={c1.y} r="4" fill="#64748b" />
                  )}
                  {mode === "equiTwoPoints" && (
                    <>
                      <circle cx={c1.x} cy={c1.y} r="4" fill="#64748b" />
                      <circle cx={c2.x} cy={c2.y} r="4" fill="#64748b" />
                      <text
                        x={c1.x - 10}
                        y={c1.y - 10}
                        fill="#64748b"
                        fontSize="12"
                      >
                        A
                      </text>
                      <text
                        x={c2.x + 10}
                        y={c2.y - 10}
                        fill="#64748b"
                        fontSize="12"
                      >
                        B
                      </text>
                    </>
                  )}

                  {/* Locus Trace */}
                  {showTrace && renderLocus()}

                  {/* Moving P */}
                  <circle
                    cx={p.x}
                    cy={p.y}
                    r="8"
                    fill={isOnLocus ? "#10b981" : "#f43f5e"}
                    stroke="white"
                    strokeWidth="2"
                    className="pointer-events-auto cursor-pointer shadow-lg transition-colors duration-100"
                    onMouseDown={() => setIsDragging(true)}
                  />
                  <text
                    x={p.x + 12}
                    y={p.y}
                    fill={isOnLocus ? "#10b981" : "#f43f5e"}
                    fontWeight="bold"
                  >
                    P
                  </text>
                </svg>

                <div className="absolute top-4 left-4 bg-white/90 p-3 rounded-lg shadow text-xs font-mono">
                  <div>
                    Condition:{" "}
                    {isOnLocus ? (
                      <span className="text-emerald-600 font-bold">
                        SATISFIED
                      </span>
                    ) : (
                      <span className="text-rose-500">Unsatisfied</span>
                    )}
                  </div>
                </div>
              </div>
            </div>

            
          </div>
        );
      };
      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  
      
      <!-- Footer -->
      <footer class="text-center py-4 text-slate-500 text-sm">
        <p class="italic mb-1">
          But God made the earth by his power; he founded the world by his wisdom and stretched out the heavens by his
          understanding. Jeremiah 10:12
        </p>
        <p class="text-xs mb-1 mt-2">
          「耶和華用能力創造大地，用智慧建立世界，用聰明鋪張穹蒼。」 耶利米書 10:12
        </p>
        <p class="text-xs mt-2 pt-2 border-t border-slate-300">
          @ 2025 Education Engineering Portfolio | Generated by Gemini Pro 3.0 | Prepared by SF Lau
        </p>
      </footer>
</body>
</html>
