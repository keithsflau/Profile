<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Completing the Square | S4 Math 配方法</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.production.min.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <script
      type="text/javascript"
      id="MathJax-script"
      async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
    ></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=Noto+Sans+TC:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Outfit", "Noto Sans TC", sans-serif;
      }
    </style>
  </head>
  <body class="bg-sky-50 text-slate-800 min-h-screen">
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;

      const translations = {
        en: {
          unit: "Unit 2: Polynomials",
          title: "Completing the Square",
          desc: "Transform ax² + bx + c into a(x - h)² + k form.",
          coeffA: "Coefficient a",
          coeffB: "Coefficient b",
          coeffC: "Constant c",
          standardForm: "Standard Form",
          vertexForm: "Vertex Form",
          vertex: "Vertex",
        },
        zh: {
          unit: "單元二：多項式",
          title: "配方法",
          desc: "將 ax² + bx + c 轉換為 a(x - h)² + k 形式。",
          coeffA: "係數 a",
          coeffB: "係數 b",
          coeffC: "常數 c",
          standardForm: "標準式",
          vertexForm: "頂點式",
          vertex: "頂點",
        },
      };

      const App = () => {
        const [lang, setLang] = useState("en");
        const t = translations[lang];

        const [a, setA] = useState(1);
        const [b, setB] = useState(-6);
        const [c, setC] = useState(5);

        // Completing the square:
        // ax² + bx + c = a(x² + (b/a)x) + c
        //              = a(x + b/(2a))² - a(b/(2a))² + c
        //              = a(x + b/(2a))² - b²/(4a) + c
        // h = -b/(2a), k = c - b²/(4a)

        const h = a !== 0 ? -b / (2 * a) : 0;
        const k = a !== 0 ? c - (b * b) / (4 * a) : c;

        useEffect(() => {
          if (window.MathJax) window.MathJax.typesetPromise();
        }, [a, b, c, lang]);

        const formatSign = (val) =>
          val >= 0 ? `+ ${val}` : `- ${Math.abs(val)}`;
        const formatH = (val) => (val >= 0 ? `- ${val}` : `+ ${Math.abs(val)}`);

        return (
          <div className="p-8 max-w-4xl mx-auto min-h-screen flex flex-col items-center select-none">
            <header className="mb-8 text-center w-full relative">
              <button
                onClick={() => setLang(lang === "en" ? "zh" : "en")}
                className="absolute right-0 top-0 px-4 py-2 bg-white rounded-full shadow border border-sky-200 text-sm font-bold text-sky-600 hover:bg-sky-50 transition"
              >
                <i className="fa-solid fa-globe mr-2"></i>
                {lang === "en" ? "中文" : "ENG"}
              </button>
              <div className="text-sky-600 font-bold uppercase text-xs tracking-widest mb-2">
                {t.unit}
              </div>
              <h1 className="text-4xl font-extrabold text-slate-900 mb-2">
                {t.title}
              </h1>
              <p className="text-slate-500">{t.desc}</p>
            </header>

            <div className="bg-white p-6 rounded-3xl shadow-xl border border-sky-100 w-full mb-8">
              {/* Controls */}
              <div className="grid md:grid-cols-3 gap-6 mb-8">
                <div>
                  <label className="text-sm font-bold text-slate-500 block mb-2">
                    {t.coeffA}
                  </label>
                  <input
                    type="range"
                    min="-5"
                    max="5"
                    step="1"
                    value={a}
                    onChange={(e) => setA(Number(e.target.value))}
                    className="w-full accent-sky-500"
                  />
                  <div className="text-right font-mono text-sky-600 font-bold">
                    {a}
                  </div>
                </div>
                <div>
                  <label className="text-sm font-bold text-slate-500 block mb-2">
                    {t.coeffB}
                  </label>
                  <input
                    type="range"
                    min="-10"
                    max="10"
                    step="1"
                    value={b}
                    onChange={(e) => setB(Number(e.target.value))}
                    className="w-full accent-sky-500"
                  />
                  <div className="text-right font-mono text-sky-600 font-bold">
                    {b}
                  </div>
                </div>
                <div>
                  <label className="text-sm font-bold text-slate-500 block mb-2">
                    {t.coeffC}
                  </label>
                  <input
                    type="range"
                    min="-10"
                    max="10"
                    step="1"
                    value={c}
                    onChange={(e) => setC(Number(e.target.value))}
                    className="w-full accent-sky-500"
                  />
                  <div className="text-right font-mono text-sky-600 font-bold">
                    {c}
                  </div>
                </div>
              </div>

              {/* Standard Form */}
              <div className="bg-sky-50 p-6 rounded-xl mb-6 text-center border border-sky-100">
                <div className="text-sm font-bold text-sky-400 uppercase mb-2">
                  {t.standardForm}
                </div>
                <div className="text-3xl font-mono">
                  \[ y = {a === 1 ? "" : a === -1 ? "-" : a}x^2 {formatSign(b)}x{" "}
                  {formatSign(c)} \]
                </div>
              </div>

              {/* Steps */}
              <div className="bg-slate-50 p-6 rounded-xl mb-6 border border-slate-100">
                <div className="text-sm font-bold text-slate-400 uppercase mb-4">
                  Steps
                </div>
                <div className="space-y-3 font-mono text-sm">
                  <div>
                    1. h = -b/(2a) = -{b}/(2×{a}) ={" "}
                    <span className="text-sky-600 font-bold">
                      {h.toFixed(2)}
                    </span>
                  </div>
                  <div>
                    2. k = c - b²/(4a) = {c} - {b}²/(4×{a}) ={" "}
                    <span className="text-sky-600 font-bold">
                      {k.toFixed(2)}
                    </span>
                  </div>
                </div>
              </div>

              {/* Vertex Form */}
              <div className="bg-emerald-50 p-6 rounded-xl mb-6 text-center border border-emerald-100">
                <div className="text-sm font-bold text-emerald-400 uppercase mb-2">
                  {t.vertexForm}
                </div>
                <div className="text-3xl font-mono">
                  \[ y = {a === 1 ? "" : a === -1 ? "-" : a}(x{" "}
                  {formatH(h.toFixed(1))})^2{" "}
                  {formatSign(parseFloat(k.toFixed(2)))} \]
                </div>
              </div>

              {/* Vertex */}
              <div className="bg-rose-50 p-6 rounded-2xl text-center border border-rose-100">
                <div className="text-sm font-bold text-rose-500 uppercase mb-2">
                  {t.vertex} (h, k)
                </div>
                <div className="text-4xl font-extrabold text-rose-700 font-mono">
                  ({h.toFixed(2)}, {k.toFixed(2)})
                </div>
              </div>
            </div>

            <footer className="mt-8">
              <a
                href="../index.html"
                className="text-sky-500 hover:text-sky-700 font-bold"
              >
                <i className="fa-solid fa-arrow-left mr-2"></i> Back to
                Dashboard
              </a>
            </footer>
          </div>
        );
      };
      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
