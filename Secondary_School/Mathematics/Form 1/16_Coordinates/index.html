<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Coordinate Hunter | S1 Math</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.production.min.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Outfit", sans-serif;
      }
      .grid-bg {
        background-size: 40px 40px;
        background-image: linear-gradient(
            to right,
            #e2e8f0 1px,
            transparent 1px
          ),
          linear-gradient(to bottom, #e2e8f0 1px, transparent 1px);
      }
      .axis {
        background: #94a3b8;
      }
    </style>
  </head>
  <body class="bg-slate-900 text-white min-h-screen">
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;

      const App = () => {
        const range = 5; // -5 to 5
        const [target, setTarget] = useState({ x: 3, y: -2 });
        const [score, setScore] = useState(0);
        const [msg, setMsg] = useState(
          "Click on the grid to locate the Alien!"
        );
        const [shots, setShots] = useState([]);
        const [gameOver, setGameOver] = useState(false);

        const generateTarget = () => {
          const x = Math.floor(Math.random() * (range * 2 + 1)) - range;
          const y = Math.floor(Math.random() * (range * 2 + 1)) - range;
          setTarget({ x, y });
          setShots([]);
          setMsg(`New Target Detected! Finds coordinates.`);
          setGameOver(false);
        };

        const handleGridClick = (e) => {
          if (gameOver) return;
          const rect = e.target.getBoundingClientRect();
          const size = 400;
          const cellSize = size / (range * 2 + 1); // 400 / 11 ~ 36px

          // Click position relative to grid center
          // Center is at index 5,5 (if 0-10) -> (range, range)

          const clickX = e.clientX - rect.left;
          const clickY = e.clientY - rect.top;

          const col = Math.floor(clickX / (size / 11));
          const row = Math.floor(clickY / (size / 11));

          // Convert col/row to x/y
          // row 0 is y = 5. row 5 is y = 0. row 10 is y = -5.
          // col 0 is x = -5. col 5 is x = 0.

          const x = col - range;
          const y = range - row;

          const hit = x === target.x && y === target.y;
          setShots([...shots, { x, y, hit }]);

          if (hit) {
            setScore((s) => s + 100);
            setMsg("TARGET ELIMINATED! Well done.");
            setGameOver(true);
          } else {
            setMsg(`Missed at (${x}, ${y})! Try again.`);
          }
        };

        return (
          <div className="p-8 max-w-4xl mx-auto min-h-screen flex flex-col items-center">
            <header className="mb-8 text-center">
              <div className="text-green-400 font-bold uppercase text-xs tracking-widest mb-2">
                Unit 2: Geometry
              </div>
              <h1 className="text-4xl font-extrabold text-white">
                Coordinate Hunter
              </h1>
              <p className="text-slate-400">
                Locate the hidden alien signal on the Cartesian plane.
              </p>
            </header>

            <div className="flex flex-col md:flex-row gap-12 items-start">
              <div
                className="relative bg-white rounded-xl overflow-hidden shadow-2xl cursor-crosshair"
                style={{ width: 400, height: 400 }}
                onClick={handleGridClick}
              >
                {/* Grid Lines */}
                <div className="absolute inset-0 grid-bg opacity-50"></div>

                {/* Axes */}
                <div className="absolute top-0 bottom-0 left-1/2 w-0.5 bg-slate-800"></div>
                <div className="absolute left-0 right-0 top-1/2 h-0.5 bg-slate-800"></div>

                {/* Shots */}
                {shots.map((shot, i) => {
                  const left = (shot.x + range) * (400 / 11);
                  const top = (range - shot.y) * (400 / 11);
                  return (
                    <div
                      key={i}
                      className="absolute w-[36px] h-[36px] flex items-center justify-center animate-ping-once"
                      style={{ left, top }}
                    >
                      {shot.hit ? (
                        <i className="fa-solid fa-burst text-3xl text-red-500"></i>
                      ) : (
                        <i className="fa-solid fa-xmark text-2xl text-slate-400 opacity-50"></i>
                      )}
                    </div>
                  );
                })}

                {/* Labels (Simplified) */}
                <div className="absolute top-2 left-1/2 ml-2 text-slate-500 font-bold text-xs">
                  y
                </div>
                <div className="absolute top-1/2 right-2 mt-2 text-slate-500 font-bold text-xs">
                  x
                </div>
                <div className="absolute top-1/2 left-1/2 ml-1 mt-1 text-slate-800 font-bold text-xs">
                  0
                </div>
              </div>

              <div className="w-full md:w-64 flex flex-col gap-6">
                <div className="bg-slate-800 p-6 rounded-2xl border border-slate-700">
                  <h3 className="text-slate-400 text-xs font-bold uppercase tracking-widest mb-2">
                    Mission Status
                  </h3>
                  <div
                    className={`text-lg font-bold ${
                      gameOver ? "text-green-400" : "text-yellow-400"
                    }`}
                  >
                    {msg}
                  </div>
                </div>

                <div className="bg-slate-800 p-6 rounded-2xl border border-slate-700">
                  <h3 className="text-slate-400 text-xs font-bold uppercase tracking-widest mb-2">
                    Target Intel
                  </h3>
                  {gameOver ? (
                    <div className="text-4xl font-mono text-green-400">
                      ({target.x}, {target.y})
                    </div>
                  ) : (
                    <div className="text-4xl font-mono text-slate-600 animate-pulse">
                      (?, ?)
                    </div>
                  )}
                </div>

                <button
                  onClick={generateTarget}
                  className="w-full py-4 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-xl shadow-lg shadow-blue-900/50 transition"
                >
                  <i className="fa-solid fa-radar mr-2"></i> Scan New Target
                </button>

                <div className="text-xs text-slate-500 text-center">
                  Grid Range: X: -5 to 5, Y: -5 to 5
                </div>
              </div>
            </div>

            <footer className="mt-12">
              <a
                href="../index.html"
                className="text-slate-400 hover:text-white font-bold"
              >
                <i className="fa-solid fa-arrow-left mr-2"></i> Back to
                Dashboard
              </a>
            </footer>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
