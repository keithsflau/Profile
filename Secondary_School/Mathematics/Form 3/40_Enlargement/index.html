<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Enlargement 放大與縮小 | S3 Math</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.production.min.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Outfit", sans-serif;
      }
    </style>
  </head>
  <body class="bg-violet-50 text-slate-800 min-h-screen">
    <div id="root"></div>
    <script type="text/babel">
      const { useState } = React;

      const App = () => {
        const [lang, setLang] = useState("en");
        const [scale, setScale] = useState(2);
        // Center of Enlargement
        const [cx, setCx] = useState(50);
        const [cy, setCy] = useState(150);

        const t = {
          title: { en: "Enlargement & Similarity", zh: "放大與相似" },
          center: { en: "Center of Enlargement", zh: "放大中心" },
          factor: { en: "Scale Factor (k)", zh: "比例因子 (k)" },
          original: { en: "Original Object", zh: "原像" },
          image: { en: "Image", zh: "影像" },
          drag: { en: "Controls", zh: "控制面板" },
          areaRatio: { en: "Area Ratio", zh: "面積比" },
          back: { en: "Back to Dashboard", zh: "返回主頁" },
        };

        // Original Triangle Vertices (Fixed relative positions)
        const ox1 = 120,
          oy1 = 100; // Point A
        const ox2 = 160,
          oy2 = 100; // Point B
        const ox3 = 120,
          oy3 = 140; // Point C

        // Calculate Image Vertices based on Center (cx, cy) and scale
        // x' = cx + k(x - cx)
        const getPrime = (x, y) => ({
          x: cx + scale * (x - cx),
          y: cy + scale * (y - cy),
        });

        const p1 = getPrime(ox1, oy1);
        const p2 = getPrime(ox2, oy2);
        const p3 = getPrime(ox3, oy3);

        return (
          <div className="p-6 max-w-4xl mx-auto min-h-screen flex flex-col">
            <header className="mb-6 flex justify-between items-center">
              <div>
                <div className="text-violet-600 font-bold uppercase text-xs tracking-widest mb-1">
                  S3 Math
                </div>
                <h1 className="text-3xl font-extrabold text-slate-900">
                  {t.title[lang]}
                </h1>
              </div>
              <button
                onClick={() => setLang(lang === "en" ? "zh" : "en")}
                className="px-3 py-1 bg-white border border-violet-200 rounded-lg text-sm font-bold hover:bg-violet-100"
              >
                {lang === "en" ? "中文" : "ENG"}
              </button>
            </header>

            {/* Interactive Canvas */}
            <div
              className="bg-white p-4 rounded-2xl border border-violet-100 mb-6 shadow-sm overflow-hidden relative"
              style={{ height: "400px" }}
            >
              <svg viewBox="0 0 500 300" className="w-full h-full">
                {/* Grid Background */}
                <defs>
                  <pattern
                    id="smallGrid"
                    width="20"
                    height="20"
                    patternUnits="userSpaceOnUse"
                  >
                    <path
                      d="M 20 0 L 0 0 0 20"
                      fill="none"
                      stroke="#f1f5f9"
                      strokeWidth="1"
                    />
                  </pattern>
                </defs>
                <rect width="100%" height="100%" fill="url(#smallGrid)" />

                {/* Center of Enlargement */}
                <circle
                  cx={cx}
                  cy={cy}
                  r="6"
                  fill="#8b5cf6"
                  stroke="white"
                  strokeWidth="2"
                />
                <text
                  x={cx - 10}
                  y={cy + 20}
                  className="text-xs fill-violet-600 font-bold"
                >
                  Center
                </text>

                {/* Projection Lines (Dashed) */}
                {/* Only show if scale is reasonable to avoid mess */}
                <line
                  x1={cx}
                  y1={cy}
                  x2={p1.x}
                  y2={p1.y}
                  stroke="#cbd5e1"
                  strokeWidth="1"
                  strokeDasharray="4,4"
                />
                <line
                  x1={cx}
                  y1={cy}
                  x2={p2.x}
                  y2={p2.y}
                  stroke="#cbd5e1"
                  strokeWidth="1"
                  strokeDasharray="4,4"
                />
                <line
                  x1={cx}
                  y1={cy}
                  x2={p3.x}
                  y2={p3.y}
                  stroke="#cbd5e1"
                  strokeWidth="1"
                  strokeDasharray="4,4"
                />

                {/* Image Triangle (Transformed) */}
                <polygon
                  points={`${p1.x},${p1.y} ${p2.x},${p2.y} ${p3.x},${p3.y}`}
                  fill="rgba(236, 72, 153, 0.3)"
                  stroke="#ec4899"
                  strokeWidth="2"
                />
                <text
                  x={p1.x}
                  y={p1.y - 10}
                  className="text-xs fill-pink-500 font-bold"
                >
                  A'
                </text>

                {/* Original Triangle */}
                <polygon
                  points={`${ox1},${oy1} ${ox2},${oy2} ${ox3},${oy3}`}
                  fill="rgba(139, 92, 246, 0.5)"
                  stroke="#8b5cf6"
                  strokeWidth="2"
                />
                <text
                  x={ox1}
                  y={oy1 - 10}
                  className="text-xs fill-violet-700 font-bold"
                >
                  A
                </text>
              </svg>

              <div className="absolute top-4 right-4 bg-white/90 p-3 rounded-xl border border-violet-100 text-xs shadow-sm">
                <div className="flex items-center gap-2 mb-1">
                  <div className="w-3 h-3 bg-violet-400 rounded-sm"></div>{" "}
                  {t.original[lang]}
                </div>
                <div className="flex items-center gap-2">
                  <div className="w-3 h-3 bg-pink-400 rounded-sm"></div>{" "}
                  {t.image[lang]} (k={scale})
                </div>
              </div>
            </div>

            {/* Controls */}
            <div className="grid md:grid-cols-2 gap-8 items-start mb-6">
              <div className="bg-white p-6 rounded-2xl border border-violet-100 shadow-sm">
                <h3 className="text-sm font-bold text-slate-400 uppercase mb-4">
                  {t.drag[lang]}
                </h3>

                <div className="space-y-4">
                  <div>
                    <label className="flex justify-between text-xs font-bold text-pink-600 mb-1">
                      <span>{t.factor[lang]} (k)</span>
                      <span>{scale}</span>
                    </label>
                    <input
                      type="range"
                      min="0.5"
                      max="3"
                      step="0.1"
                      value={scale}
                      onChange={(e) => setScale(Number(e.target.value))}
                      className="w-full accent-pink-500"
                    />
                  </div>

                  <div className="pt-2 border-t border-slate-100">
                    <label className="block text-xs font-bold text-violet-600 mb-2">
                      {t.center[lang]} (X, Y)
                    </label>
                    <div className="grid grid-cols-2 gap-4">
                      <input
                        type="range"
                        min="20"
                        max="300"
                        value={cx}
                        onChange={(e) => setCx(Number(e.target.value))}
                        className="w-full accent-violet-500"
                      />
                      <input
                        type="range"
                        min="20"
                        max="250"
                        value={cy}
                        onChange={(e) => setCy(Number(e.target.value))}
                        className="w-full accent-violet-500"
                      />
                    </div>
                  </div>
                </div>
              </div>

              <div className="grid grid-cols-2 gap-4">
                <div className="bg-violet-500 text-white p-6 rounded-2xl shadow-lg transform transition hover:scale-105 text-center">
                  <div className="text-xs uppercase opacity-80 mb-2">
                    Length Ratio
                  </div>
                  <div className="text-3xl font-extrabold">1 : {scale}</div>
                  <div className="text-xs opacity-80 mt-1">
                    Image Length = k × Original
                  </div>
                </div>
                <div className="bg-fuchsia-500 text-white p-6 rounded-2xl shadow-lg transform transition hover:scale-105 text-center">
                  <div className="text-xs uppercase opacity-80 mb-2">
                    {t.areaRatio[lang]}
                  </div>
                  <div className="text-3xl font-extrabold">
                    1 : {(scale * scale).toFixed(2)}
                  </div>
                  <div className="text-xs opacity-80 mt-1">
                    Area = k² × Original
                  </div>
                </div>
              </div>
            </div>

            <footer className="mt-auto pt-8">
              <a
                href="../index.html"
                className="text-violet-600 hover:text-violet-700 font-bold"
              >
                <i className="fa-solid fa-arrow-left mr-2"></i>
                {t.back[lang]}
              </a>
            </footer>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
