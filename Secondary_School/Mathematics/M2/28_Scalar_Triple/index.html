<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Scalar Triple Product | M2 Vectors</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Outfit", sans-serif;
        background: #0f172a;
        color: #e2e8f0;
        overflow: hidden;
      }
      .glass {
        background: rgba(15, 23, 42, 0.8);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
    </style>
  </head>
  <body>
      <!-- Language Toggle -->
      <div class="absolute top-4 right-4">
        <button
          onclick="toggleLang()"
          class="px-2 py-1 bg-slate-800 border border-slate-600 rounded-full text-[10px] font-bold text-emerald-400 hover:bg-slate-700 hover:text-white transition flex items-center gap-1"
        >
          <i class="fa-solid fa-language"></i>
          <span id="lang-btn">中文</span>
        </button>
      </div>

      <h1
        id="app-title"
        class="text-2xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-amber-400 mb-2"
      >
        Scalar Triple Product
      </h1>
      <p id="app-subtitle" class="text-xs text-slate-300 mb-4">
        Vol = |a · (b × c)|
      </p>

      <div class="space-y-4">
        <p id="app-desc" class="text-[10px] text-slate-400">
          The absolute value of the scalar triple product represents the volume
          of the parallelepiped formed by vectors a, b, and c.
        </p>
        <div class="flex gap-2 items-center">
          <div class="w-2 h-2 rounded-full bg-sky-500"></div>
          <div id="label-vecA" class="font-mono text-xs">Vector A (Blue)</div>
        </div>
        <div class="flex gap-2 items-center">
          <div class="w-2 h-2 rounded-full bg-rose-500"></div>
          <div id="label-vecB" class="font-mono text-xs">Vector B (Red)</div>
        </div>
        <div class="flex gap-2 items-center">
          <div class="w-2 h-2 rounded-full bg-emerald-500"></div>
          <div id="label-vecC" class="font-mono text-xs">Vector C (Green)</div>
        </div>

        <div class="mt-4 pt-4 border-t border-slate-700">
          <div
            id="label-slider"
            class="text-[10px] uppercase text-slate-500 font-bold mb-1"
          >
            C-Vector Height (z)
          </div>
          <input
            type="range"
            id="slider"
            min="0"
            max="3"
            step="0.1"
            value="2"
            class="w-full accent-amber-500"
          />
        </div>
      </div>
    </div>

    <div id="canvas-container" class="w-screen h-screen"></div>

    <script>
      const scene = new THREE.Scene();
      scene.background = new THREE.Color(0x0f172a);

      const camera = new THREE.PerspectiveCamera(
        75,
        window.innerWidth / window.innerHeight,
        0.1,
        1000
      );
      camera.position.set(6, 6, 6);
      camera.lookAt(0, 0, 0);

      const renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      document
        .getElementById("canvas-container")
        .appendChild(renderer.domElement);

      const controls = new THREE.OrbitControls(camera, renderer.domElement);
      controls.enableDamping = true;

      scene.add(new THREE.GridHelper(10, 10, 0x334155, 0x1e293b));
      scene.add(new THREE.AxesHelper(2));

      scene.add(new THREE.AmbientLight(0xffffff, 0.5));
      const dir = new THREE.DirectionalLight(0xffffff, 1);
      dir.position.set(5, 5, 5);
      scene.add(dir);

      // Dynamic Parallelepiped
      const origin = new THREE.Vector3(0, 0, 0);
      let cz = 2;
      let meshGroup = new THREE.Group();
      scene.add(meshGroup);

      function updateShape() {
        while (meshGroup.children.length > 0)
          meshGroup.remove(meshGroup.children[0]);

        const A = new THREE.Vector3(3, 0, 0);
        const B = new THREE.Vector3(0, 3, 0);
        const C = new THREE.Vector3(1, 1, cz); // Dynamic C

        // Arrows
        meshGroup.add(
          new THREE.ArrowHelper(
            A.clone().normalize(),
            origin,
            A.length(),
            0x38bdf8,
            0.2,
            0.1
          )
        );
        meshGroup.add(
          new THREE.ArrowHelper(
            B.clone().normalize(),
            origin,
            B.length(),
            0xf43f5e,
            0.2,
            0.1
          )
        );
        meshGroup.add(
          new THREE.ArrowHelper(
            C.clone().normalize(),
            origin,
            C.length(),
            0x10b981,
            0.2,
            0.1
          )
        );

        // Parallelepiped Edges (Wireframe)
        const pts = [
          origin,
          A, // Base OA
          origin,
          B, // Base OB
          A,
          A.clone().add(B), // A -> A+B
          B,
          B.clone().add(A), // B -> B+A

          // Tops
          origin,
          C, // OC
          A,
          A.clone().add(C),
          B,
          B.clone().add(C),
          A.clone().add(B),
          A.clone().add(B).add(C),

          // Top Base
          C,
          C.clone().add(A),
          C,
          C.clone().add(B),
          C.clone().add(A),
          C.clone().add(A).add(B),
          C.clone().add(B),
          C.clone().add(B).add(A),
        ];

        const geo = new THREE.BufferGeometry().setFromPoints(pts);
        meshGroup.add(
          new THREE.LineSegments(
            geo,
            new THREE.LineBasicMaterial({
              color: 0xffffff,
              opacity: 0.3,
              transparent: true,
            })
          )
        );

        // Solid Volume (Transparent)
        // Convex Hull or just BoxGeometry transformed?
        // We can build using 12 triangles.
        // Vertices:
        // 0: 000
        // 1: A
        // 2: B
        // 3: C
        // 4: A+B
        // 5: A+C
        // 6: B+C
        // 7: A+B+C
        const v = [
          origin,
          A,
          B,
          C,
          A.clone().add(B),
          A.clone().add(C),
          B.clone().add(C),
          A.clone().add(B).add(C),
        ];

        // Faces are parallelograms.
        // 0,1,4,2 (Base)
        // 0,1,5,3 (Front)
        // 0,2,6,3 (Left)
        // 7,6,3,5 (Back-Top)
        // 7,4,1,5 (Right)
        // 7,4,2,6 (Top)

        // Simple approach: Use polyhedron or explicit triangles.
        // Let's do explicit geometry
        const vertices = [];

        // Helper push quad
        const pushQuad = (i1, i2, i3, i4) => {
          // Tri 1: i1, i2, i3
          vertices.push(v[i1].x, v[i1].y, v[i1].z);
          vertices.push(v[i2].x, v[i2].y, v[i2].z);
          vertices.push(v[i3].x, v[i3].y, v[i3].z);
          // Tri 2: i1, i3, i4
          vertices.push(v[i1].x, v[i1].y, v[i1].z);
          vertices.push(v[i3].x, v[i3].y, v[i3].z);
          vertices.push(v[i4].x, v[i4].y, v[i4].z);
        };

        // Indices map:
        // 0:0, 1:A, 2:B, 3:C, 4:A+B, 5:A+C, 6:B+C, 7:ABC
        pushQuad(0, 1, 4, 2); // Base
        pushQuad(3, 5, 7, 6); // Top
        pushQuad(0, 2, 6, 3); // Left
        pushQuad(1, 4, 7, 5); // Right
        pushQuad(0, 3, 5, 1); // Front
        pushQuad(2, 4, 7, 6); // Back

        const polyGeo = new THREE.BufferGeometry();
        polyGeo.setAttribute(
          "position",
          new THREE.Float32BufferAttribute(vertices, 3)
        );
        polyGeo.computeVertexNormals();

        const mat = new THREE.MeshPhysicalMaterial({
          color: 0xf59e0b,
          transparent: true,
          opacity: 0.3,
          side: THREE.DoubleSide,
        });
        meshGroup.add(new THREE.Mesh(polyGeo, mat));
      }

      updateShape();

      document.getElementById("slider").addEventListener("input", (e) => {
        cz = parseFloat(e.target.value);
        updateShape();
      });

      function animate() {
        requestAnimationFrame(animate);
        controls.update();
        renderer.render(scene, camera);
      }
      animate();

      // Bilingual
      const translations = {
        en: {
          title: "Scalar Triple Product",
          subtitle: "Vol = |a · (b × c)|",
          desc: "The absolute value of the scalar triple product represents the volume of the parallelepiped formed by vectors a, b, and c.",
          vecA: "Vector A (Blue)",
          vecB: "Vector B (Red)",
          vecC: "Vector C (Green)",
          height: "C-Vector Height (z)",
          langBtn: "中文",
        },
        zh: {
          title: "純量三重積",
          subtitle: "體積 = |a · (b × c)|",
          desc: "純量三重積的絕對值代表由向量 a、b 和 c 組成的平行六面體的體積。",
          vecA: "向量 A (藍)",
          vecB: "向量 B (紅)",
          vecC: "向量 C (綠)",
          height: "C-向量高度 (z)",
          langBtn: "English",
        },
      };

      let currentLang = "en";

      window.toggleLang = () => {
        currentLang = currentLang === "en" ? "zh" : "en";
        const t = translations[currentLang];
        document.getElementById("lang-btn").innerText = t.langBtn;
        document.getElementById("app-title").innerText = t.title;
        document.getElementById("app-subtitle").innerText = t.subtitle;
        document.getElementById("app-desc").innerText = t.desc;
        document.getElementById("label-vecA").innerText = t.vecA;
        document.getElementById("label-vecB").innerText = t.vecB;
        document.getElementById("label-vecC").innerText = t.vecC;
        document.getElementById("label-slider").innerText = t.height;
      };

      window.addEventListener("resize", () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      });
    </script>
  
      
      <!-- Footer -->
      <footer class="text-center py-4 text-slate-500 text-sm">
        <p class="italic mb-1">
          But God made the earth by his power; he founded the world by his wisdom and stretched out the heavens by his
          understanding. Jeremiah 10:12
        </p>
        <p class="text-xs mb-1 mt-2">
          「耶和華用能力創造大地，用智慧建立世界，用聰明鋪張穹蒼。」 耶利米書 10:12
        </p>
        <p class="text-xs mt-2 pt-2 border-t border-slate-300">
          @ 2025 Education Engineering Portfolio | Generated by Gemini Pro 3.0 | Prepared by SF Lau
        </p>
      </footer>
</body>
</html>
