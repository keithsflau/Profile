<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Binomial Expansion | M2 Algebra</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.production.min.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <style>
      body {
        font-family: "Outfit", sans-serif;
        background: #0f172a;
        color: #e2e8f0;
      }
      .glass {
        background: rgba(30, 41, 59, 0.7);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }
      .triangle-row {
        display: flex;
        justify-content: center;
        gap: 0.5rem;
        margin-bottom: 0.5rem;
      }
      .triangle-cell {
        width: 3rem;
        height: 3rem;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.05);
        font-family: "JetBrains Mono", monospace;
        font-size: 0.9rem;
        transition: all 0.2s;
      }
      .triangle-cell.active {
        background: #0ea5e9;
        color: white;
        transform: scale(1.1);
        box-shadow: 0 0 15px rgba(14, 165, 233, 0.5);
      }
    </style>
  </head>
  <body class="min-h-screen flex flex-col">
    <div id="root" class="flex-grow flex flex-col"></div>
    <script type="text/babel">
      const { useState } = React;

      const translations = {
        en: {
          header: "Unit 1: Algebra",
          title: "Binomial Expansion",
          subtitle: "(a + b)ⁿ using Pascal's Triangle",
          currRow: "Exposed Row",
          pascal: "Pascal's Triangle",
          langBtn: "中文",
        },
        zh: {
          header: "第一單元：代數",
          title: "二項式展開",
          subtitle: "(a + b)ⁿ 與帕斯卡三角形",
          currRow: "當前行數",
          pascal: "帕斯卡三角形",
          langBtn: "English",
        },
      };

      const App = () => {
        const [n, setN] = useState(4); // Exponent (a+b)^n
        const [lang, setLang] = useState("en");
        const t = translations[lang];

        // Pascal's Triangle Gen
        const getRow = (rowIdx) => {
          let arr = [1];
          for (let i = 1; i <= rowIdx; i++) {
            arr.push((arr[i - 1] * (rowIdx - i + 1)) / i);
          }
          return arr;
        };

        const triangle = [];
        for (let i = 0; i <= 6; i++) triangle.push(getRow(i));

        const coeffs = triangle[n];

        // Expansion String
        const expansion = coeffs.map((c, k) => {
          // c * a^(n-k) * b^k
          const powA = n - k;
          const powB = k;

          let str = "";
          if (c !== 1 || (powA === 0 && powB === 0)) str += c;
          if (str === "" && (powA > 0 || powB > 0)) str = ""; // Implicit 1 if variables exist

          let term = c !== 1 ? c : "";
          if (powA > 0) term += powA === 1 ? "a" : `a^${powA}`;
          if (powB > 0) term += powB === 1 ? "b" : `b^${powB}`;
          if (term === "") term = "1";

          return (
            <span key={k} className="inline-block mx-1">
              <span className="text-sky-400 font-bold">
                {c === 1 && powA + powB > 0 ? "" : c}
              </span>
              <span className="text-white">
                {powA > 0 ? (
                  powA === 1 ? (
                    "a"
                  ) : (
                    <span>
                      a<sup>{powA}</sup>
                    </span>
                  )
                ) : (
                  ""
                )}
              </span>
              <span className="text-white">
                {powB > 0 ? (
                  powB === 1 ? (
                    "b"
                  ) : (
                    <span>
                      b<sup>{powB}</sup>
                    </span>
                  )
                ) : (
                  ""
                )}
              </span>
              {k < n && <span className="text-slate-500 ml-2">+</span>}
            </span>
          );
        });

        return (
          <div className="flex-grow flex flex-col items-center justify-center p-8 select-none">
            <div className="absolute top-4 right-4">
              <button
                onClick={() => setLang((l) => (l === "en" ? "zh" : "en"))}
                className="px-3 py-1 bg-slate-800 border border-slate-600 rounded-full text-xs font-bold text-sky-400 hover:bg-slate-700 hover:text-white transition flex items-center gap-2"
              >
                <i className="fa-solid fa-language"></i>
                {t.langBtn}
              </button>
            </div>

            <header className="mb-8 text-center">
              <div className="text-sky-500 font-bold uppercase tracking-widest text-xs mb-2">
                {t.header}
              </div>
              <h1 className="text-4xl font-extrabold text-white mb-2">
                {t.title}
              </h1>
              <p className="text-slate-400 font-mono text-lg">{t.subtitle}</p>
            </header>

            <div className="w-full max-w-4xl space-y-8">
              <div className="glass p-8 rounded-3xl">
                <div className="text-center mb-6">
                  <div className="text-xs text-slate-500 uppercase font-bold mb-2">
                    {t.currRow}
                  </div>
                  <div className="text-5xl font-mono text-white mb-4">
                    (a + b)<sup className="text-sky-400">{n}</sup>
                  </div>
                  <div className="text-xl font-mono p-4 bg-slate-900/50 rounded-xl overflow-x-auto whitespace-nowrap">
                    {expansion}
                  </div>
                </div>

                <div className="flex justify-center mb-8">
                  <input
                    type="range"
                    min="0"
                    max="6"
                    step="1"
                    value={n}
                    onChange={(e) => setN(Number(e.target.value))}
                    className="w-64 accent-sky-500"
                  />
                </div>
              </div>

              <div className="glass p-8 rounded-3xl">
                <h3 className="text-center text-xs font-bold text-slate-500 uppercase mb-6">
                  {t.pascal}
                </h3>
                <div className="flex flex-col items-center">
                  {triangle.map((row, rIdx) => (
                    <div key={rIdx} className="triangle-row">
                      {row.map((val, cIdx) => (
                        <div
                          key={cIdx}
                          className={`triangle-cell ${
                            rIdx === n ? "active" : "opacity-40"
                          }`}
                        >
                          {val}
                        </div>
                      ))}
                    </div>
                  ))}
                </div>
              </div>
            </div>
          </div>
        );
      };
      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
