<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pie Chart Creator | S2 Math</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.production.min.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Outfit", sans-serif;
      }
    </style>
  </head>
  <body class="bg-violet-50 text-slate-800 min-h-screen">
    <div id="root"></div>
    <script type="text/babel">
      const { useState } = React;

      const App = () => {
        const [data, setData] = useState([
          { label: "Apples", value: 30, color: "#f43f5e" },
          { label: "Bananas", value: 25, color: "#fbbf24" },
          { label: "Oranges", value: 20, color: "#f97316" },
          { label: "Grapes", value: 25, color: "#a855f7" },
        ]);

        const total = data.reduce((sum, d) => sum + d.value, 0);

        // Generate SVG pie slices
        const cx = 150,
          cy = 150,
          r = 120;
        let cumulativeAngle = -90; // Start at top

        const slices = data.map((d, i) => {
          const angle = (d.value / total) * 360;
          const startAngle = cumulativeAngle;
          const endAngle = cumulativeAngle + angle;
          cumulativeAngle = endAngle;

          const startRad = (startAngle * Math.PI) / 180;
          const endRad = (endAngle * Math.PI) / 180;

          const x1 = cx + r * Math.cos(startRad);
          const y1 = cy + r * Math.sin(startRad);
          const x2 = cx + r * Math.cos(endRad);
          const y2 = cy + r * Math.sin(endRad);

          const largeArc = angle > 180 ? 1 : 0;

          const pathD = `M ${cx} ${cy} L ${x1} ${y1} A ${r} ${r} 0 ${largeArc} 1 ${x2} ${y2} Z`;

          // Label position (midpoint of arc)
          const midAngle = ((startAngle + endAngle) / 2) * (Math.PI / 180);
          const labelR = r * 0.65;
          const lx = cx + labelR * Math.cos(midAngle);
          const ly = cy + labelR * Math.sin(midAngle);

          return {
            ...d,
            pathD,
            lx,
            ly,
            angle: angle.toFixed(1),
            percent: ((d.value / total) * 100).toFixed(1),
          };
        });

        const updateValue = (index, newVal) => {
          const updated = [...data];
          updated[index].value = Math.max(1, Number(newVal) || 1);
          setData(updated);
        };

        return (
          <div className="p-8 max-w-5xl mx-auto min-h-screen flex flex-col items-center">
            <header className="mb-8 text-center">
              <div className="text-violet-600 font-bold uppercase text-xs tracking-widest mb-2">
                Unit 6: Data Handling
              </div>
              <h1 className="text-4xl font-extrabold text-slate-900">
                Pie Chart Creator
              </h1>
              <p className="text-slate-500">
                Visualize proportions as sectors of a circle.
              </p>
            </header>

            <div className="flex flex-col lg:flex-row gap-12 w-full items-center">
              {/* Pie Chart */}
              <div className="bg-white p-8 rounded-3xl shadow-xl border border-violet-100 shrink-0">
                <svg width="300" height="300" className="overflow-visible">
                  {slices.map((s, i) => (
                    <g key={i}>
                      <path
                        d={s.pathD}
                        fill={s.color}
                        stroke="white"
                        strokeWidth="2"
                        className="hover:opacity-80 transition cursor-pointer"
                      />
                      <text
                        x={s.lx}
                        y={s.ly}
                        textAnchor="middle"
                        dominantBaseline="middle"
                        className="fill-white text-xs font-bold pointer-events-none"
                      >
                        {s.percent}%
                      </text>
                    </g>
                  ))}
                </svg>
              </div>

              {/* Data Editor */}
              <div className="flex-1 w-full max-w-md flex flex-col gap-4">
                <h3 className="font-bold text-slate-400 uppercase text-xs tracking-widest">
                  Edit Data
                </h3>
                {data.map((d, i) => (
                  <div
                    key={i}
                    className="flex items-center gap-4 bg-white p-4 rounded-xl shadow-sm border border-slate-100"
                  >
                    <div
                      className="w-5 h-5 rounded-full shrink-0"
                      style={{ backgroundColor: d.color }}
                    ></div>
                    <div className="flex-1 font-bold text-slate-700">
                      {d.label}
                    </div>
                    <input
                      type="number"
                      min="1"
                      value={d.value}
                      onChange={(e) => updateValue(i, e.target.value)}
                      className="w-20 text-right font-mono font-bold text-slate-800 bg-slate-50 border border-slate-200 rounded-lg px-2 py-1 focus:outline-none focus:ring-2 focus:ring-violet-400"
                    />
                  </div>
                ))}

                <div className="mt-4 bg-violet-100 p-4 rounded-xl border border-violet-200">
                  <div className="flex justify-between text-sm">
                    <span className="font-bold text-violet-600">Total</span>
                    <span className="font-mono font-bold text-violet-800">
                      {total}
                    </span>
                  </div>
                </div>

                {/* Legend */}
                <div className="mt-4 grid grid-cols-2 gap-2 text-sm">
                  {slices.map((s, i) => (
                    <div
                      key={i}
                      className="flex items-center gap-2 bg-slate-50 p-2 rounded-lg"
                    >
                      <div
                        className="w-3 h-3 rounded-sm"
                        style={{ backgroundColor: s.color }}
                      ></div>
                      <span className="text-slate-600">{s.label}</span>
                      <span className="ml-auto font-mono text-slate-400">
                        {s.angle}°
                      </span>
                    </div>
                  ))}
                </div>
              </div>
            </div>

            
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  
      
      <!-- Footer -->
      <footer class="text-center py-4 text-slate-500 text-sm">
        <p class="italic mb-1">
          But God made the earth by his power; he founded the world by his wisdom and stretched out the heavens by his
          understanding. Jeremiah 10:12
        </p>
        <p class="text-xs mb-1 mt-2">
          「耶和華用能力創造大地，用智慧建立世界，用聰明鋪張穹蒼。」 耶利米書 10:12
        </p>
        <p class="text-xs mt-2 pt-2 border-t border-slate-300">
          @ 2025 Education Engineering Portfolio | Generated by Gemini Pro 3.0 | Prepared by SF Lau
        </p>
      </footer>
</body>
</html>
