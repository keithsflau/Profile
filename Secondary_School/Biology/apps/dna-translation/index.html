<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DNA Translation Game</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700;800&family=JetBrains+Mono:wght@500&display=swap');

        body {
            font-family: 'Outfit', sans-serif;
        }

        .font-code {
            font-family: 'JetBrains Mono', monospace;
        }

        .floating {
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0% {
                transform: translateY(0px) rotate(0deg);
            }

            50% {
                transform: translateY(-20px) rotate(2deg);
            }

            100% {
                transform: translateY(0px) rotate(0deg);
            }
        }

        .glow-text {
            text-shadow: 0 0 20px rgba(16, 185, 129, 0.5);
        }
    </style>
</head>

<body class="bg-[#0b1120] text-white h-screen overflow-hidden flex flex-col">
    <div id="root" class="h-full flex flex-col"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const CODON_TABLE = {
            'AUG': 'Met', 'UUU': 'Phe', 'UUC': 'Phe',
            'UUA': 'Leu', 'UUG': 'Leu', 'GGU': 'Gly', 'GGC': 'Gly',
            'GGA': 'Gly', 'GGG': 'Gly', 'UAA': 'STOP', 'UAG': 'STOP', 'UGA': 'STOP',
            // Simplified table for demo
            'AAA': 'Lys', 'CCC': 'Pro', 'GGG': 'Gly', 'UUU': 'Phe'
        };

        const App = () => {
            const [gameState, setGameState] = useState("start"); // start, play, win
            const [score, setScore] = useState(0);
            const [chain, setChain] = useState([]); // Amino acids built
            const [codonIdx, setCodonIdx] = useState(0);

            // Hardcoded sequence for better demo flow
            const sequence = ["AUG", "UUU", "AAA", "CCC", "GGG", "UGA"];
            const aaSequence = ["Met", "Phe", "Lys", "Pro", "Gly", "STOP"];

            const [options, setOptions] = useState([]);

            // Generate Options
            useEffect(() => {
                if (gameState !== "play") return;
                const correct = sequence[codonIdx];
                if (!correct) { setGameState("win"); return; }

                const correctAA = aaSequence[codonIdx];
                const correctAnti = getAnticodon(correct);

                // Fake options
                const pool = [
                    { anti: "UUU", aa: "Phe" }, { anti: "AAA", aa: "Lys" },
                    { anti: "GGG", aa: "Gly" }, { anti: "CCC", aa: "Pro" }
                ].filter(x => x.anti !== correctAnti);

                // Mix
                const opts = [{ anti: correctAnti, aa: correctAA }, ...pool.slice(0, 3)];
                setOptions(opts.sort(() => Math.random() - 0.5));

            }, [codonIdx, gameState]);

            const getAnticodon = (c) => {
                const map = { A: 'U', U: 'A', G: 'C', C: 'G' };
                return c.split('').map(x => map[x]).join('');
            };

            const handlePick = (opt) => {
                const correct = sequence[codonIdx];
                const correctAnti = getAnticodon(correct);

                if (opt.anti === correctAnti) {
                    // Correct
                    if (opt.aa === "STOP") {
                        setGameState("win");
                    } else {
                        setChain([...chain, opt.aa]);
                        setScore(s => s + 100);
                        setCodonIdx(i => i + 1);
                    }
                } else {
                    // Wrong
                    setScore(s => Math.max(0, s - 50));
                    // Shake effect ideally
                }
            };

            return (
                <div className="flex h-full bg-[#0b1120] font-sans">
                    {/* Game Sidebar */}
                    <div className="w-96 bg-[#111827] border-r border-slate-800 p-8 flex flex-col z-20 shadow-2xl relative">
                        {/* Header */}
                        <div className="mb-8">
                            <div className="flex items-center gap-2 mb-2">
                                <i data-lucide="dna" className="text-emerald-400 w-6 h-6"></i>
                                <span className="text-xs font-bold text-emerald-400 bg-emerald-900/30 px-2 py-1 rounded">GENETICS</span>
                            </div>
                            <h1 className="text-4xl font-black text-white tracking-tight mb-2">Translation</h1>
                            <p className="text-slate-400 text-sm">Build the Polypeptide Chain</p>
                        </div>

                        {/* Score Board */}
                        <div className="bg-slate-800/50 p-6 rounded-2xl border border-slate-700 mb-8">
                            <div className="text-xs font-bold text-slate-500 uppercase tracking-widest mb-1">Current Score</div>
                            <div className="text-5xl font-code font-bold text-white glow-text">{score}</div>
                        </div>

                        {/* Controls / Options */}
                        <div className="flex-1">
                            {gameState === "start" && (
                                <button onClick={() => setGameState("play")} className="w-full h-24 bg-emerald-600 hover:bg-emerald-500 rounded-2xl text-2xl font-bold flex items-center justify-center gap-3 transition-all hover:scale-105 shadow-lg shadow-emerald-900/50">
                                    <i data-lucide="play" className="fill-current"></i> START
                                </button>
                            )}

                            {gameState === "win" && (
                                <div className="text-center">
                                    <h2 className="text-2xl font-bold text-white mb-4">Protein Synthesized!</h2>
                                    <button onClick={() => window.location.reload()} className="px-6 py-3 bg-slate-700 rounded-xl font-bold hover:bg-slate-600">Replay</button>
                                </div>
                            )}

                            {gameState === "play" && (
                                <div className="grid grid-cols-2 gap-3 animate-in slide-in-from-bottom-4 fade-in duration-500">
                                    {options.map((opt, i) => (
                                        <button key={i} onClick={() => handlePick(opt)} className="bg-slate-800 hover:bg-slate-700 border border-slate-700 hover:border-emerald-500/50 rounded-xl p-4 flex flex-col items-center gap-2 transition-all hover:-translate-y-1">
                                            <div className="text-[10px] uppercase font-bold text-slate-500">tRNA Anticodon</div>
                                            <div className="text-xl font-code font-bold text-yellow-400">{opt.anti}</div>
                                            <div className="px-3 py-1 bg-pink-500/20 text-pink-300 rounded-full text-xs font-bold border border-pink-500/30">{opt.aa}</div>
                                        </button>
                                    ))}
                                </div>
                            )}
                        </div>

                        {/* Footer */}
                        <div className="mt-auto text-[10px] text-slate-600 font-bold uppercase tracking-widest text-center">
                            Ribosome Subunit 60S + 40S
                        </div>
                    </div>

                    {/* Visual Stage */}
                    <div className="flex-1 bg-[#0b1120] relative overflow-hidden flex flex-col items-center justify-center">
                        {/* Background Elements */}
                        <div className="absolute top-0 left-0 w-full h-full bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-slate-900 via-[#0b1120] to-black opacity-80"></div>

                        {/* Ribosome Graphic */}
                        <div className="relative z-10 flex flex-col items-center">

                            {/* Chain Growing Up */}
                            <div className="flex flex-col-reverse gap-1 mb-8 transition-all min-h-[200px] justify-end pb-4">
                                {chain.map((aa, i) => (
                                    <div key={i} className="w-16 h-16 rounded-2xl bg-gradient-to-br from-pink-500 to-rose-600 shadow-lg flex items-center justify-center font-bold text-lg border-2 border-white/20 animate-in zoom-in duration-300">
                                        {aa}
                                    </div>
                                ))}
                                {chain.length === 0 && <div className="text-slate-600 text-sm italic opacity-50">Chain waiting...</div>}
                            </div>

                            {/* Ribosome Structure (Abstract) */}
                            <div className="w-[600px] bg-slate-800/50 backdrop-blur-xl rounded-full border border-white/5 p-8 relative shadow-2xl">
                                {/* mRNA Strip */}
                                <div className="flex justify-center gap-4 overflow-hidden mask-linear">
                                    {sequence.map((codon, i) => (
                                        <div key={i} className={`w-24 h-16 rounded-lg flex items-center justify-center transition-all duration-500
                                             ${i === codonIdx
                                                ? 'bg-emerald-500/20 border-2 border-emerald-500 text-emerald-300 scale-110 shadow-[0_0_30px_rgba(16,185,129,0.3)]'
                                                : 'bg-slate-900/50 border border-slate-700 text-slate-600 blur-[1px] scale-90'}
                                         `}>
                                            <span className="font-code text-xl font-bold">{codon}</span>
                                        </div>
                                    ))}
                                </div>

                                {/* Label */}
                                <div className="absolute -bottom-12 left-1/2 -translate-x-1/2 text-slate-500 font-bold text-xs uppercase tracking-[0.2em]">mRNA Strand 5' → 3'</div>
                            </div>

                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
        setTimeout(() => lucide.createIcons(), 100);
    </script>

      
      <!-- Footer -->
      <footer class="text-center py-4 text-slate-500 text-sm">
        <p class="italic mb-1">
          But God made the earth by his power; he founded the world by his wisdom and stretched out the heavens by his
          understanding. Jeremiah 10:12
        </p>
        <p class="text-xs mb-1 mt-2">
          「耶和華用能力創造大地，用智慧建立世界，用聰明鋪張穹蒼。」 耶利米書 10:12
        </p>
        <p class="text-xs mt-2 pt-2 border-t border-slate-300">
          @ 2025 Education Engineering Portfolio | Generated by Gemini Pro 3.0 | Prepared by SF Lau
        </p>
      </footer>
</body>

</html>