<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Human Ear | S2 Science</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.production.min.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Outfit", sans-serif;
        background: #f0f9ff;
      }
      .eardrum {
        transition: transform 0.05s ease-in-out;
      }
    </style>
  </head>
  <body class="bg-sky-50 text-slate-800 min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect, useRef } = React;

      const App = () => {
        const canvasRef = useRef(null);
        const [freq, setFreq] = useState(50); // Hz relative scale
        const [amp, setAmp] = useState(50); // Volume relative scale
        const [vibration, setVibration] = useState(0);

        // Audio Visualization Loop
        useEffect(() => {
          const canvas = canvasRef.current;
          const ctx = canvas.getContext("2d");
          let frameId;
          let phase = 0;

          const render = () => {
            // Clear
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.strokeStyle = "#0ea5e9";
            ctx.lineWidth = 3;
            ctx.shadowBlur = 5;
            ctx.shadowColor = "#bae6fd";
            ctx.beginPath();

            // Draw Sine Wave
            const width = canvas.width;
            const height = canvas.height;
            const centerY = height / 2;

            // Wave Logic
            // Freq: 50 -> 1 cycle per width roughly
            // Amp: 50 -> 50px peak
            const wavelength = width / (freq / 10);
            const amplitude = amp;

            for (let x = 0; x < width; x++) {
              const y =
                centerY +
                Math.sin((x / wavelength) * Math.PI * 2 + phase) * amplitude;
              if (x === 0) ctx.moveTo(x, y);
              else ctx.lineTo(x, y);
            }
            ctx.stroke();

            // Update Phase
            phase -= freq / 200;

            // Eardrum Vibration Value for React State
            const currentVibe = Math.sin(phase) * (amp / 50); // -1 to 1 scaled
            setVibration(currentVibe);

            frameId = requestAnimationFrame(render);
          };
          render();
          return () => cancelAnimationFrame(frameId);
        }, [freq, amp]);

        return (
          <div className="p-8 max-w-6xl mx-auto min-h-screen flex flex-col items-center">
            <header className="text-center mb-10 w-full">
              <span className="text-sky-600 font-bold uppercase text-xs tracking-widest">
                Form 2 Science • Unit 10
              </span>
              <h1 className="text-4xl font-extrabold text-slate-800 mb-2">
                Sound & The Ear
              </h1>
              <p className="text-slate-500">
                Visualize Sound Waves and Eardrum Mechanical Response.
              </p>
            </header>

            <div className="grid grid-cols-1 lg:grid-cols-2 gap-12 w-full">
              {/* Visualization Stack */}
              <div className="flex flex-col gap-8">
                {/* Oscilloscope */}
                <div className="bg-slate-900 rounded-3xl p-6 shadow-xl border-4 border-slate-800 relative">
                  <h3 className="absolute top-4 left-4 text-xs font-bold text-slate-500 uppercase tracking-widest">
                    Oscilloscope
                  </h3>
                  <canvas
                    ref={canvasRef}
                    width={500}
                    height={200}
                    className="w-full h-48"
                  ></canvas>
                </div>

                {/* Ear Animation */}
                <div className="bg-white rounded-3xl p-8 shadow-xl border border-sky-100 flex items-center justify-center relative overflow-hidden h-[300px]">
                  {/* Sound Waves entering ear */}
                  <div className="absolute left-0 top-0 h-full w-full pointer-events-none">
                    {Array.from({ length: 5 }).map((_, i) => (
                      <div
                        key={i}
                        className="absolute top-1/2 left-0 w-4 h-32 border-r-4 border-sky-200 rounded-r-full opacity-0"
                        style={{
                          animation: `enter 1s infinite linear`,
                          animationDelay: `${i * 0.2}s`,
                          animationDuration: `${100 / freq}s`,
                        }}
                      ></div>
                    ))}
                    <style>{`@keyframes enter { 0% { left: -20px; opacity: 0; transform: scaleY(0.5); } 50% { opacity: 1; } 100% { left: 150px; opacity: 0; transform: scaleY(1); } }`}</style>
                  </div>

                  {/* Ear Visual (Simple SVG) */}
                  <svg width="400" height="200" viewBox="0 0 400 200">
                    {/* Canal */}
                    <path
                      d="M 50 70 L 150 75 L 150 125 L 50 130"
                      fill="none"
                      stroke="#fca5a5"
                      strokeWidth="10"
                      strokeLinecap="round"
                    />

                    {/* Eardrum (Vibrating Part) */}
                    <line
                      x1="150"
                      y1="75"
                      x2="150"
                      y2="125"
                      stroke="#fb7185"
                      strokeWidth="4"
                      style={{
                        transform: `scaleX(${1 + vibration * 0.2})`,
                        transformOrigin: "150px 100px",
                      }}
                      className="eardrum"
                    />

                    {/* Ossicles (Bones) - responding */}
                    <path
                      d="M 155 100 L 180 90 L 200 110"
                      stroke="#cbd5e1"
                      strokeWidth="6"
                      fill="none"
                      style={{
                        transform: `rotate(${vibration * 10}deg)`,
                        transformOrigin: "155px 100px",
                      }}
                      className="eardrum"
                    />

                    {/* Cochlea (Snail) */}
                    <path
                      d="M 200 110 Q 250 150 280 110 T 260 80"
                      fill="none"
                      stroke="#fca5a5"
                      strokeWidth="12"
                      strokeLinecap="round"
                    />

                    {/* Label */}
                    <text x="130" y="150" fontSize="10" fill="#94a3b8">
                      Ear Drum
                    </text>
                    <text x="180" y="70" fontSize="10" fill="#94a3b8">
                      Bones
                    </text>
                    <text x="250" y="150" fontSize="10" fill="#94a3b8">
                      Cochlea
                    </text>
                  </svg>
                </div>
              </div>

              {/* Controls */}
              <div className="flex flex-col justify-center space-y-8">
                <div className="bg-white p-8 rounded-3xl shadow-md border border-sky-100">
                  <label className="flex justify-between font-bold text-slate-600 mb-6">
                    <span className="flex items-center gap-3">
                      <i className="fa-solid fa-wave-square text-sky-500"></i>{" "}
                      Frequency (Pitch)
                    </span>
                    <span className="bg-sky-100 text-sky-700 px-3 py-1 rounded-full text-sm">
                      {freq} Hz (Scale)
                    </span>
                  </label>
                  <input
                    type="range"
                    min="10"
                    max="100"
                    value={freq}
                    onChange={(e) => setFreq(Number(e.target.value))}
                    className="w-full h-4 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-sky-500"
                  />
                  <div className="flex justify-between text-xs text-slate-400 mt-2 font-bold uppercase tracking-wider">
                    <span>Low / Bass</span>
                    <span>High / Treble</span>
                  </div>
                </div>

                <div className="bg-white p-8 rounded-3xl shadow-md border border-purple-100">
                  <label className="flex justify-between font-bold text-slate-600 mb-6">
                    <span className="flex items-center gap-3">
                      <i className="fa-solid fa-volume-high text-purple-500"></i>{" "}
                      Amplitude (Loudness)
                    </span>
                    <span className="bg-purple-100 text-purple-700 px-3 py-1 rounded-full text-sm">
                      {amp} Units
                    </span>
                  </label>
                  <input
                    type="range"
                    min="0"
                    max="100"
                    value={amp}
                    onChange={(e) => setAmp(Number(e.target.value))}
                    className="w-full h-4 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-purple-500"
                  />
                  <div className="flex justify-between text-xs text-slate-400 mt-2 font-bold uppercase tracking-wider">
                    <span>Soft / Quiet</span>
                    <span>Loud / Noisy</span>
                  </div>
                </div>

                <div className="bg-sky-50 p-6 rounded-2xl border border-sky-200 text-sky-900 text-sm">
                  <strong>Physics Note:</strong>
                  <ul className="list-disc pl-5 mt-2 space-y-1">
                    <li>
                      Higher Frequency = More waves per second = Higher Pitch.
                    </li>
                    <li>
                      Higher Amplitude = Taller waves = Louder Sound = Stronger
                      Vibration.
                    </li>
                  </ul>
                </div>
              </div>
            </div>

            
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  
      
      <!-- Footer -->
      <footer class="text-center py-4 text-slate-500 text-sm">
        <p class="italic mb-1">
          But God made the earth by his power; he founded the world by his wisdom and stretched out the heavens by his
          understanding. Jeremiah 10:12
        </p>
        <p class="text-xs mb-1 mt-2">
          「耶和華用能力創造大地，用智慧建立世界，用聰明鋪張穹蒼。」 耶利米書 10:12
        </p>
        <p class="text-xs mt-2 pt-2 border-t border-slate-300">
          @ 2025 Education Engineering Portfolio | Generated by Gemini Pro 3.0 | Prepared by SF Lau
        </p>
      </footer>
</body>
</html>
