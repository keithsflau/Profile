<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Air Composition Analyst | S2 Science</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.production.min.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Outfit", sans-serif;
        background: #f0f9ff;
      }
    </style>
  </head>
  <body class="bg-sky-50 text-slate-800 min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect, useRef } = React;

      const dataInhaled = {
        Nitrogen: 78,
        Oxygen: 21,
        "Noble Gases": 0.9,
        "Carbon Dioxide": 0.04,
        "Water Vapour": "Variable",
      };

      const dataExhaled = {
        Nitrogen: 78,
        Oxygen: 16,
        "Noble Gases": 0.9,
        "Carbon Dioxide": 4,
        "Water Vapour": "Saturated",
      };

      const App = () => {
        const chartRef = useRef(null);
        const [mode, setMode] = useState("inhaled"); // inhaled, exhaled
        const [chartInstance, setChartInstance] = useState(null);

        useEffect(() => {
          const data = mode === "inhaled" ? dataInhaled : dataExhaled;
          // Prepare Chart Data (excluding Water Vapour text, treating as small number visually or just excluding for pie)
          // We will just chart N, O, CO2, Others
          const labels = ["Nitrogen", "Oxygen", "Carbon Dioxide", "Others"];
          const values = [
            data["Nitrogen"],
            data["Oxygen"],
            data["Carbon Dioxide"],
            1,
          ]; // Approx others

          if (chartRef.current) {
            const ctx = chartRef.current.getContext("2d");
            const config = {
              type: "doughnut",
              data: {
                labels: labels,
                datasets: [
                  {
                    data: values,
                    backgroundColor: [
                      "#bae6fd",
                      "#3b82f6",
                      "#ef4444",
                      "#cbd5e1",
                    ],
                    hoverOffset: 4,
                  },
                ],
              },
              options: {
                responsive: true,
                plugins: {
                  legend: { position: "bottom" },
                },
                animation: {
                  animateScale: true,
                  animateRotate: true,
                },
              },
            };

            if (chartInstance) {
              chartInstance.data.datasets[0].data = values;
              chartInstance.update();
            } else {
              setChartInstance(new Chart(ctx, config));
            }
          }
        }, [mode]);

        return (
          <div className="p-8 max-w-5xl mx-auto min-h-screen flex flex-col items-center">
            <header className="text-center mb-10 w-full">
              <span className="text-sky-600 font-bold uppercase text-xs tracking-widest">
                Form 2 Science • Unit 7
              </span>
              <h1 className="text-5xl font-extrabold text-slate-800 mb-2">
                Air Composition
              </h1>
              <p className="text-slate-500">
                Compare what we breathe in vs what we breathe out.
              </p>
            </header>

            <nav className="flex bg-white p-2 rounded-2xl shadow-sm border border-slate-200 mb-12">
              <button
                onClick={() => setMode("inhaled")}
                className={`px-8 py-3 rounded-xl font-bold transition-all ${
                  mode === "inhaled"
                    ? "bg-sky-500 text-white shadow-lg"
                    : "text-slate-500 hover:bg-slate-50"
                }`}
              >
                Inhaled Air{" "}
                <i className="fa-solid fa-arrow-right-to-bracket ml-2"></i>
              </button>
              <button
                onClick={() => setMode("exhaled")}
                className={`px-8 py-3 rounded-xl font-bold transition-all ${
                  mode === "exhaled"
                    ? "bg-indigo-500 text-white shadow-lg"
                    : "text-slate-500 hover:bg-slate-50"
                }`}
              >
                <i className="fa-solid fa-arrow-right-from-bracket mr-2"></i>{" "}
                Exhaled Air
              </button>
            </nav>

            <div className="grid grid-cols-1 md:grid-cols-2 gap-12 w-full items-center">
              {/* Chart */}
              <div className="bg-white p-8 rounded-3xl shadow-xl border border-sky-100 relative">
                <canvas ref={chartRef}></canvas>
                {/* Center text for doughnut */}
                <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-[40%] text-center pointer-events-none">
                  <div className="text-sm font-bold text-slate-400 uppercase">
                    Total
                  </div>
                  <div className="text-3xl font-bold text-slate-800">100%</div>
                </div>
              </div>

              {/* Data Cards */}
              <div className="grid grid-cols-1 gap-4">
                {Object.entries(
                  mode === "inhaled" ? dataInhaled : dataExhaled
                ).map(([key, val]) => (
                  <div
                    key={key}
                    className="bg-white p-4 rounded-xl border border-slate-100 shadow-sm flex items-center justify-between group hover:border-sky-300 transition-colors"
                  >
                    <div className="flex items-center gap-3">
                      <div
                        className={`w-10 h-10 rounded-full flex items-center justify-center text-white ${
                          key === "Oxygen"
                            ? "bg-blue-500"
                            : key === "Carbon Dioxide"
                            ? "bg-red-500"
                            : key === "Nitrogen"
                            ? "bg-sky-200 text-sky-700"
                            : "bg-slate-300"
                        }`}
                      >
                        <i
                          className={`fa-solid ${
                            key === "Water Vapour"
                              ? "fa-droplet"
                              : "fa-gas-pump"
                          }`}
                        ></i>
                      </div>
                      <span className="font-bold text-slate-700">{key}</span>
                    </div>
                    <div
                      className={`text-xl font-bold font-mono ${
                        val === 21 || val === 0.04
                          ? "text-slate-400"
                          : mode === "exhaled" &&
                            (key === "Oxygen" || key === "Carbon Dioxide")
                          ? "text-indigo-600 scale-110"
                          : "text-slate-600"
                      }`}
                    >
                      {key === "Water Vapour" ? val : val + "%"}
                      {mode === "exhaled" && key === "Oxygen" && (
                        <i className="fa-solid fa-arrow-down text-xs ml-1 text-red-400"></i>
                      )}
                      {mode === "exhaled" && key === "Carbon Dioxide" && (
                        <i className="fa-solid fa-arrow-up text-xs ml-1 text-green-500"></i>
                      )}
                    </div>
                  </div>
                ))}

                <div className="mt-4 p-4 bg-sky-50 rounded-xl text-sm text-sky-800 border-l-4 border-sky-500">
                  <strong>Why change?</strong> We consume Oxygen for respiration
                  and produce Carbon Dioxide as a waste product. Water vapour
                  increases because our lung lining is moist.
                </div>
              </div>
            </div>

            
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  
      
      <!-- Footer -->
      <footer class="text-center py-4 text-slate-500 text-sm">
        <p class="italic mb-1">
          But God made the earth by his power; he founded the world by his wisdom and stretched out the heavens by his
          understanding. Jeremiah 10:12
        </p>
        <p class="text-xs mb-1 mt-2">
          「耶和華用能力創造大地，用智慧建立世界，用聰明鋪張穹蒼。」 耶利米書 10:12
        </p>
        <p class="text-xs mt-2 pt-2 border-t border-slate-300">
          @ 2025 Education Engineering Portfolio | Generated by Gemini Pro 3.0 | Prepared by SF Lau
        </p>
      </footer>
</body>
</html>
