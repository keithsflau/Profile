<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bonding Simulator | 化學鍵模擬器</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
      }
      .atom-circle {
        transition: all 0.5s ease;
      }
      .electron-dot {
        width: 8px;
        height: 8px;
        background: #facc15;
        border-radius: 50%;
        position: absolute;
        transition: all 1s ease-in-out;
        box-shadow: 0 0 5px #facc15;
      }
    </style>
  </head>

  <body class="bg-indigo-950 text-white min-h-screen flex flex-col">
    <!-- Header -->
    <header
      class="bg-indigo-900/50 backdrop-blur-md border-b border-indigo-800 px-6 py-4 flex justify-between items-center z-10"
    >
      <div class="flex items-center gap-4">
        <a
          href="../index.html"
          class="text-indigo-300 hover:text-white transition-colors"
        >
          <svg
            class="w-6 h-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M10 19l-7-7m0 0l7-7m-7 7h18"
            />
          </svg>
        </a>
        <h1
          class="text-xl font-bold bg-gradient-to-r from-pink-400 to-indigo-400 bg-clip-text text-transparent"
        >
          Bonding Simulator
          <span class="text-indigo-400 font-medium text-sm ml-2">化學鍵</span>
        </h1>
      </div>
    </header>

    <main class="flex-grow flex flex-col md:flex-row">
      <!-- Controls Panel -->
      <div
        class="w-full md:w-80 bg-indigo-900/40 border-r border-indigo-800 p-6 flex flex-col gap-8 z-10"
      >
        <div>
          <h3
            class="text-sm font-semibold text-indigo-300 uppercase tracking-widest mb-4"
          >
            Select Atoms
          </h3>

          <div class="space-y-4">
            <div>
              <label class="text-xs text-indigo-400 block mb-2"
                >Atom 1 (Left)</label
              >
              <select
                id="atom1"
                class="w-full bg-indigo-950 border border-indigo-700 rounded-lg p-2 text-sm focus:outline-none focus:border-pink-500 transition-colors"
              >
                <option value="Na">Sodium (Na) - Metal</option>
                <option value="Mg">Magnesium (Mg) - Metal</option>
                <option value="H">Hydrogen (H) - Non-metal</option>
                <option value="Cl">Chlorine (Cl) - Non-metal</option>
                <option value="O">Oxygen (O) - Non-metal</option>
              </select>
            </div>

            <div>
              <label class="text-xs text-indigo-400 block mb-2"
                >Atom 2 (Right)</label
              >
              <select
                id="atom2"
                class="w-full bg-indigo-950 border border-indigo-700 rounded-lg p-2 text-sm focus:outline-none focus:border-pink-500 transition-colors"
              >
                <option value="Cl">Chlorine (Cl) - Non-metal</option>
                <option value="O">Oxygen (O) - Non-metal</option>
                <option value="H">Hydrogen (H) - Non-metal</option>
                <option value="F">Fluorine (F) - Non-metal</option>
              </select>
            </div>
          </div>
        </div>

        <button
          onclick="startBonding()"
          class="w-full py-3 bg-gradient-to-r from-pink-600 to-purple-600 rounded-xl font-bold text-white shadow-lg hover:shadow-pink-500/25 transition-all transform hover:scale-[1.02] active:scale-95"
        >
          Simulate Bond
        </button>

        <div
          id="result-box"
          class="hidden p-4 rounded-xl bg-indigo-950/80 border border-indigo-700"
        >
          <div class="text-xs text-indigo-400 uppercase mb-1">Result</div>
          <div id="bond-type" class="text-xl font-bold text-white mb-2">
            Ionic Bond
          </div>
          <p id="bond-desc" class="text-sm text-indigo-200 leading-relaxed">
            Electron transfer occurs from Metal to Non-metal.
          </p>
        </div>
      </div>

      <!-- Simulation Stage -->
      <div
        class="flex-grow relative bg-slate-950 overflow-hidden flex items-center justify-center"
        id="stage"
      >
        <!-- Background Grid -->
        <div
          class="absolute inset-0 opacity-10"
          style="
            background-image: radial-gradient(#4f46e5 1px, transparent 1px);
            background-size: 20px 20px;
          "
        ></div>

        <!-- Atoms Container -->
        <div
          id="atoms-container"
          class="relative w-[600px] h-[400px] flex items-center justify-center gap-20"
        >
          <!-- Injected via JS -->
        </div>
      </div>
    </main>

    <script>
      const ATOMS_DB = {
        Na: {
          type: "metal",
          electrons: 1,
          shell: [2, 8, 1],
          color: "#cbd5e1",
          size: 60,
          name: "Sodium",
        },
        Mg: {
          type: "metal",
          electrons: 2,
          shell: [2, 8, 2],
          color: "#94a3b8",
          size: 55,
          name: "Magnesium",
        },
        H: {
          type: "nonmetal",
          electrons: 1,
          shell: [1],
          color: "#fca5a5",
          size: 30,
          name: "Hydrogen",
        },
        Cl: {
          type: "nonmetal",
          electrons: 7,
          shell: [2, 8, 7],
          color: "#86efac",
          size: 50,
          name: "Chlorine",
        },
        O: {
          type: "nonmetal",
          electrons: 6,
          shell: [2, 6],
          color: "#93c5fd",
          size: 45,
          name: "Oxygen",
        },
        F: {
          type: "nonmetal",
          electrons: 7,
          shell: [2, 7],
          color: "#fcd34d",
          size: 40,
          name: "Fluorine",
        },
      };

      function createAtomVisual(symbol, id) {
        const data = ATOMS_DB[symbol];
        const outerE = data.electrons; // valence
        const container = document.createElement("div");
        container.id = id;
        container.className =
          "relative flex items-center justify-center transition-all duration-1000";
        container.style.width = data.size * 3 + "px";
        container.style.height = data.size * 3 + "px";

        // Nucleus
        const nuc = document.createElement("div");
        nuc.className =
          "absolute rounded-full flex items-center justify-center font-bold text-slate-800 shadow-lg z-10";
        nuc.style.width = data.size + "px";
        nuc.style.height = data.size + "px";
        nuc.style.backgroundColor = data.color;
        nuc.innerText = symbol;
        container.appendChild(nuc);

        // Shell
        const shell = document.createElement("div");
        shell.className = "absolute rounded-full border border-white/20";
        shell.style.width = "100%";
        shell.style.height = "100%";
        container.appendChild(shell);

        // Electrons (Valence)
        for (let i = 0; i < outerE; i++) {
          const angle = (i / outerE) * Math.PI * 2 - Math.PI / 2; // start top
          const r = (data.size * 3) / 2;
          const dot = document.createElement("div");
          dot.className = "electron-dot";
          dot.dataset.angle = angle;
          // Position logic
          const x = Math.cos(angle) * r;
          const y = Math.sin(angle) * r;

          // Centered in container
          dot.style.left = `calc(50% + ${x}px - 4px)`;
          dot.style.top = `calc(50% + ${y}px - 4px)`;
          dot.style.transform = `scale(1)`;

          container.appendChild(dot);
        }

        return container;
      }

      function startBonding() {
        const a1Sym = document.getElementById("atom1").value;
        const a2Sym = document.getElementById("atom2").value;

        const d1 = ATOMS_DB[a1Sym];
        const d2 = ATOMS_DB[a2Sym];

        const stage = document.getElementById("atoms-container");
        stage.innerHTML = "";
        document.getElementById("result-box").classList.add("hidden");

        // Render Initial State
        const el1 = createAtomVisual(a1Sym, "atom-left");
        const el2 = createAtomVisual(a2Sym, "atom-right");
        stage.appendChild(el1);
        stage.appendChild(el2);

        // Determine Bond Type
        let bondType = "";
        let bondDesc = "";

        if (d1.type === "metal" && d2.type === "nonmetal") {
          bondType = "Ionic Bond (離子鍵)";
          bondDesc = `${d1.name} loses electron(s) to become a cation. ${d2.name} gains electron(s) to become an anion. electrostatic attraction holds them together.`;
          setTimeout(() => animateIonic(el1, el2, d1, d2), 1000);
        } else if (d1.type === "nonmetal" && d2.type === "nonmetal") {
          bondType = "Covalent Bond (共價鍵)";
          bondDesc = `${d1.name} and ${d2.name} share electrons to achieve a stable outer shell.`;
          setTimeout(() => animateCovalent(el1, el2), 1000);
        } else {
          bondType = "Metallic / No Reaction";
          bondDesc =
            "Metals typically form metallic bonds with other metals (not shown here).";
        }

        // Show text
        document.getElementById("bond-type").innerText = bondType;
        document.getElementById("bond-desc").innerText = bondDesc;
        document.getElementById("result-box").classList.remove("hidden");
      }

      function animateIonic(el1, el2, d1, d2) {
        // Find an electron on el1 (Left) to move to el2 (Right)
        // Simplified: Take the top electron
        const dots = el1.querySelectorAll(".electron-dot");
        if (dots.length === 0) return;

        const mover = dots[0]; // Take one
        const target = el2;

        // Calculate positions
        const r1 = el1.getBoundingClientRect();
        const r2 = el2.getBoundingClientRect();

        // Relative translation vector
        const tx = r2.left + r2.width / 2 - (r1.left + r1.width / 2);

        // Animate
        mover.style.zIndex = 100;
        // Move to right side
        // We need to calculate precise spot on target shell?
        // Just move to center of right atom for visual ease then fade or stick
        mover.style.transform = `translate(${tx}px, 0) scale(1.5)`;
        mover.style.opacity = "0"; // Disappear into the other or stick?

        // Visual feedback: Shrink cation, Grow anion slightly?
        // Just change color

        setTimeout(() => {
          // Change nucleus colors/signs
          const n1 = el1.querySelector("div.font-bold");
          n1.innerText += "+";
          n1.style.boxShadow = "0 0 20px #ef4444"; // Red glow

          const n2 = el2.querySelector("div.font-bold");
          n2.innerText += "-";
          n2.style.boxShadow = "0 0 20px #3b82f6"; // Blue glow

          // Move atoms closer
          el1.style.transform = "translateX(40px)";
          el2.style.transform = "translateX(-40px)";
        }, 1000);
      }

      function animateCovalent(el1, el2) {
        // Move atoms to overlap
        el1.style.transform = "translateX(60px)";
        el2.style.transform = "translateX(-60px)";

        // Highlight shared region?
        setTimeout(() => {
          const flare = document.createElement("div");
          flare.className =
            "absolute w-20 h-20 bg-white/30 rounded-full blur-xl animate-pulse";
          flare.style.zIndex = 0;
          document.getElementById("atoms-container").appendChild(flare);
        }, 600);
      }
    </script>
  </body>
</html>
