<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HKDSE 2025 Paper 1A Q5 - Data Processing Cycle</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
        background-color: #0f172a;
        color: #e2e8f0;
      }
      .draggable-card {
        cursor: grab;
      }
      .draggable-card:active {
        cursor: grabbing;
      }
      .drop-zone {
        transition: all 0.2s;
        min-height: 120px;
      }
      .drop-zone.hover {
        background-color: rgba(56, 189, 248, 0.1);
        border-color: #38bdf8;
      }
    </style>
  </head>
  <body class="min-h-screen p-4 md:p-8 flex flex-col items-center">
    <div id="root" class="w-full max-w-5xl"></div>

    <script type="text/babel">
      const { useState, useEffect } = React;

      // Lucide Icon Shim
      const LucideIcon = ({ name, size = 24, className = "" }) => {
        const formatName = (n) =>
          n
            .split("-")
            .map((p) => p.charAt(0).toUpperCase() + p.slice(1))
            .join("");
        const iconName = formatName(name);
        const [svgHtml, setSvgHtml] = useState("");
        useEffect(() => {
          if (window.lucide?.icons[iconName]?.toSvg) {
            setSvgHtml(
              window.lucide.icons[iconName].toSvg({
                width: size,
                height: size,
                class: className,
              })
            );
          }
        }, [name]);
        return (
          <span
            dangerouslySetInnerHTML={{ __html: svgHtml }}
            style={{ display: "inline-flex" }}
          />
        );
      };

      const DraggableStep = ({ step, onDragStart }) => (
        <div
          draggable
          onDragStart={(e) => onDragStart(e, step.id)}
          className="bg-slate-800 p-4 rounded-lg border border-slate-600 shadow-md hover:border-cyan-400 hover:shadow-cyan-900/20 transition-all draggable-card flex items-start gap-3"
        >
          <div className="bg-slate-700 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold shrink-0 mt-0.5">
            {step.id}
          </div>
          <div>
            <p className="text-sm text-slate-200">{step.text}</p>
          </div>
        </div>
      );

      const DropZone = ({ title, items, onDrop, onDragOver, icon }) => (
        <div
          onDrop={onDrop}
          onDragOver={onDragOver}
          className="flex-1 bg-slate-900/50 rounded-xl border-2 border-dashed border-slate-700 p-4 flex flex-col gap-4 drop-zone relative min-h-[200px]"
        >
          <div className="flex items-center gap-2 text-slate-400 font-bold uppercase text-xs tracking-wider mb-2">
            <LucideIcon name={icon} size={16} /> {title}
          </div>

          {items.length === 0 && (
            <div className="flex-1 flex items-center justify-center text-slate-600 text-sm italic pointer-events-none">
              Drop Item Here
            </div>
          )}

          {items.map((step) => (
            <div
              key={step.id}
              className="bg-cyan-900/20 p-3 rounded border border-cyan-500/30 flex items-center gap-3"
            >
              <div className="bg-cyan-900 w-5 h-5 rounded-full flex items-center justify-center text-[10px] font-bold text-cyan-200">
                {step.id}
              </div>
              <span className="text-sm text-cyan-100">{step.short}</span>
            </div>
          ))}
        </div>
      );

      const App = () => {
        // Steps from the Question
        const steps = [
          {
            id: 1,
            text: "Classmates submit different parts of the report to Fanny.",
            short: "Submit Parts",
            category: "collection",
          },
          {
            id: 2,
            text: "Fanny checks the report to ensure no missing pages.",
            short: "Check Missing Pages",
            category: "validation",
          }, // Validation/Verification
          {
            id: 3,
            text: "Fanny counts the number of words in the report.",
            short: "Count Words",
            category: "analysis",
          },
          {
            id: 4,
            text: "Fanny submits the completed report.",
            short: "Submit Report",
            category: "output",
          }, // Output/Termination
        ];

        // Initially all steps are in the "Source" pool
        const [sourceItems, setSourceItems] = useState(steps);
        const [collectionItems, setCollectionItems] = useState([]);
        const [analysisItems, setAnalysisItems] = useState([]);
        const [feedback, setFeedback] = useState(null);

        const handleDragStart = (e, id) => {
          e.dataTransfer.setData("text/plain", id);
        };

        const handleDrop = (e, targetZone) => {
          e.preventDefault();
          const id = parseInt(e.dataTransfer.getData("text/plain"));
          const item = steps.find((s) => s.id === id);

          // Remove from all zones first
          setSourceItems((prev) => prev.filter((i) => i.id !== id));
          setCollectionItems((prev) => prev.filter((i) => i.id !== id));
          setAnalysisItems((prev) => prev.filter((i) => i.id !== id));

          // Add to target
          if (targetZone === "source")
            setSourceItems((prev) =>
              [...prev, item].sort((a, b) => a.id - b.id)
            );
          if (targetZone === "collection")
            setCollectionItems((prev) => [...prev, item]);
          if (targetZone === "analysis")
            setAnalysisItems((prev) => [...prev, item]);
        };

        const handleDragOver = (e) => {
          e.preventDefault();
        };

        const checkAnswer = () => {
          // Correct: Collection = Step 1, Analysis = Step 3
          const colCorrect =
            collectionItems.length === 1 && collectionItems[0].id === 1;
          const anaCorrect =
            analysisItems.length === 1 && analysisItems[0].id === 3;

          if (colCorrect && anaCorrect) {
            setFeedback({
              type: "success",
              msg: "Correct! Submitting parts is 'Data Collection', and processing/counting them is 'Data Analysis'.",
            });
          } else {
            setFeedback({
              type: "error",
              msg: "Not quite. Think about which step gathers raw data, and which step processes it to get new info (stats).",
            });
          }
        };

        const reset = () => {
          setSourceItems(steps);
          setCollectionItems([]);
          setAnalysisItems([]);
          setFeedback(null);
        };

        return (
          <div className="space-y-8 animate-fade-in w-full max-w-5xl mx-auto">
            <header className="text-center space-y-2">
              <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-cyan-900/30 border border-cyan-500/30 text-cyan-400 text-sm font-bold mb-4">
                <span className="w-2 h-2 rounded-full bg-cyan-400 animate-pulse"></span>
                HKDSE 2025 Paper 1A Q5
              </div>
              <h1 className="text-3xl md:text-4xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-400 to-pink-400">
                Data Processing Cycle
              </h1>
              <p className="text-slate-400 max-w-2xl mx-auto">
                Classify the steps of Fanny's project into the correct stages of
                the Data Processing Cycle.
              </p>
            </header>

            <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
              {/* Source List */}
              <div className="bg-slate-900 p-6 rounded-2xl border border-slate-800 space-y-4">
                <h2 className="text-white font-bold flex items-center gap-2">
                  <LucideIcon name="list" className="text-slate-400" />
                  Project Steps
                </h2>
                <div
                  className="space-y-3 min-h-[300px]"
                  onDrop={(e) => handleDrop(e, "source")}
                  onDragOver={handleDragOver}
                >
                  {sourceItems.map((step) => (
                    <DraggableStep
                      key={step.id}
                      step={step}
                      onDragStart={handleDragStart}
                    />
                  ))}
                  {sourceItems.length === 0 && (
                    <div className="text-center text-slate-600 italic py-10">
                      All items placed
                    </div>
                  )}
                </div>
              </div>

              {/* Drop Zones */}
              <div className="lg:col-span-2 space-y-6">
                <div className="bg-slate-950 p-6 rounded-2xl border border-slate-800 shadow-2xl space-y-6">
                  <div className="flex flex-col md:flex-row gap-6">
                    <DropZone
                      title="Data Collection"
                      icon="folder-input"
                      items={collectionItems}
                      onDrop={(e) => handleDrop(e, "collection")}
                      onDragOver={handleDragOver}
                    />

                    <div className="hidden md:flex items-center text-slate-600">
                      <LucideIcon name="arrow-right" size={24} />
                    </div>

                    <DropZone
                      title="Data Analysis / Processing"
                      icon="bar-chart-3"
                      items={analysisItems}
                      onDrop={(e) => handleDrop(e, "analysis")}
                      onDragOver={handleDragOver}
                    />
                  </div>

                  <div className="flex items-center justify-between pt-4 border-t border-slate-800">
                    <button
                      onClick={reset}
                      className="text-slate-500 hover:text-white text-sm underline decoration-slate-700"
                    >
                      Reset
                    </button>
                    <button
                      onClick={checkAnswer}
                      className="px-8 py-3 bg-purple-600 hover:bg-purple-500 text-white font-bold rounded-lg shadow-lg shadow-purple-900/20 transition-all flex items-center gap-2"
                    >
                      <LucideIcon name="check-square" size={18} /> Check Answer
                    </button>
                  </div>
                </div>

                {feedback && (
                  <div
                    className={`p-6 rounded-xl border flex items-start gap-4 animate-fade-in ${
                      feedback.type === "success"
                        ? "bg-green-900/20 border-green-500/30 text-green-300"
                        : "bg-red-900/20 border-red-500/30 text-red-300"
                    }`}
                  >
                    <LucideIcon
                      name={
                        feedback.type === "success" ? "trophy" : "alert-circle"
                      }
                      size={24}
                      className="shrink-0 mt-1"
                    />
                    <div>
                      <h3 className="font-bold text-lg mb-1">
                        {feedback.type === "success" ? "Correct!" : "Try Again"}
                      </h3>
                      <p>{feedback.msg}</p>
                    </div>
                  </div>
                )}
              </div>
            </div>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
