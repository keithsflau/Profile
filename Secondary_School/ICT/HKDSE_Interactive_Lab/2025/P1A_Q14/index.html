<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HKDSE 2025 Paper 1A Q14 - Distributed Systems</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
        background-color: #0f172a;
        color: #e2e8f0;
      }
      .node-pulse {
        animation: pulse-ring 2s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
      }
      @keyframes pulse-ring {
        0% {
          transform: scale(0.95);
          box-shadow: 0 0 0 0 rgba(14, 165, 233, 0.7);
        }
        70% {
          transform: scale(1);
          box-shadow: 0 0 0 10px rgba(14, 165, 233, 0);
        }
        100% {
          transform: scale(0.95);
          box-shadow: 0 0 0 0 rgba(14, 165, 233, 0);
        }
      }
    </style>
  </head>
  <body class="min-h-screen p-4 md:p-8 flex flex-col items-center">
    <div id="root" class="w-full max-w-5xl"></div>

    <script type="text/babel">
      const { useState, useEffect } = React;

      // Lucide Icon Shim
      const LucideIcon = ({ name, size = 20, className = "" }) => {
        const formatName = (n) =>
          n
            .split("-")
            .map((p) => p.charAt(0).toUpperCase() + p.slice(1))
            .join("");
        const iconName = formatName(name);
        const [svgHtml, setSvgHtml] = useState("");
        useEffect(() => {
          if (window.lucide?.icons[iconName]?.toSvg) {
            setSvgHtml(
              window.lucide.icons[iconName].toSvg({
                width: size,
                height: size,
                class: className,
              })
            );
          }
        }, [name]);
        return (
          <span
            dangerouslySetInnerHTML={{ __html: svgHtml }}
            style={{ display: "inline-flex" }}
          />
        );
      };

      const Node = ({ id, status, hasMemory }) => (
        <div className="flex flex-col items-center gap-2 relative">
          <div
            className={`w-24 h-24 rounded-2xl border-2 flex items-center justify-center relative bg-slate-900 transition-all duration-300 ${
              status === "active"
                ? "border-cyan-400 node-pulse shadow-[0_0_20px_rgba(34,211,238,0.3)]"
                : "border-slate-700"
            }`}
          >
            <LucideIcon
              name="cpu"
              size={32}
              className={
                status === "active" ? "text-cyan-400" : "text-slate-600"
              }
            />
            {hasMemory && (
              <div
                className="absolute -top-3 -right-3 w-8 h-8 rounded bg-purple-600 flex items-center justify-center text-[10px] font-bold text-white border-2 border-slate-900 shadow-lg"
                title="Local Memory"
              >
                RAM
              </div>
            )}
          </div>
          <div className="text-xs font-mono font-bold text-slate-500">
            NODE_0{id}
          </div>
        </div>
      );

      const App = () => {
        const [simulation, setSimulation] = useState("idle"); // idle, exchanging, parallel, sequential
        const [feedback, setFeedback] = useState(null);

        const runExchange = () => {
          setSimulation("exchanging");
          setFeedback({
            correct: true,
            title: "(1) Information Exchange",
            msg: "Correct. In distributed systems, nodes communicate by passing messages/data to each other.",
          });
          setTimeout(() => setSimulation("idle"), 3000);
        };

        const runParallel = () => {
          setSimulation("parallel");
          setFeedback({
            correct: true,
            title: "(3) Sequential Wait? (False)",
            msg: "False! Distributed systems run in PARALLEL. Node 2 does NOT need to wait for Node 1 to finish. They work simultaneously.",
          });
          setTimeout(() => setSimulation("idle"), 3000);
        };

        return (
          <div className="space-y-8 animate-fade-in w-full max-w-5xl mx-auto">
            <header className="text-center space-y-2">
              <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-cyan-900/30 border border-cyan-500/30 text-cyan-400 text-sm font-bold mb-4">
                <span className="w-2 h-2 rounded-full bg-cyan-400 animate-pulse"></span>
                HKDSE 2025 Paper 1A Q14
              </div>
              <h1 className="text-3xl md:text-4xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-indigo-500">
                Distributed Processing Sim
              </h1>
              <p className="text-slate-400 max-w-xl mx-auto">
                Which characteristics define a Distributed Processing System?
              </p>
            </header>

            <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
              {/* Controls */}
              <div className="bg-slate-900 p-8 rounded-2xl border border-slate-800 shadow-xl space-y-4">
                <h2 className="text-white font-bold flex items-center gap-2 border-b border-slate-800 pb-2 mb-4">
                  <LucideIcon name="activity" className="text-blue-400" />
                  Test Characteristics
                </h2>

                <button
                  onClick={runExchange}
                  className="w-full p-4 rounded-xl bg-slate-800 hover:bg-slate-700 border border-slate-700 flex items-center justify-between group transition-all"
                >
                  <div className="text-left">
                    <div className="font-bold text-slate-200 group-hover:text-white">
                      Test (1): Exchange Info
                    </div>
                    <div className="text-xs text-slate-500">
                      Can nodes talk to each other?
                    </div>
                  </div>
                  <LucideIcon
                    name="network"
                    className="text-slate-500 group-hover:text-blue-400"
                  />
                </button>

                <div className="w-full p-4 rounded-xl bg-slate-800 border border-slate-700 flex items-center justify-between">
                  <div className="text-left">
                    <div className="font-bold text-slate-200">
                      Fact (2): Local Memory
                    </div>
                    <div className="text-xs text-slate-500">
                      Does each node have its own RAM?
                    </div>
                  </div>
                  <div className="px-3 py-1 bg-purple-900/50 text-purple-300 text-xs font-bold rounded border border-purple-500/30">
                    YES (Visible)
                  </div>
                </div>

                <button
                  onClick={runParallel}
                  className="w-full p-4 rounded-xl bg-slate-800 hover:bg-slate-700 border border-slate-700 flex items-center justify-between group transition-all"
                >
                  <div className="text-left">
                    <div className="font-bold text-slate-200 group-hover:text-white">
                      Test (3): Sequential Logic
                    </div>
                    <div className="text-xs text-slate-500">
                      Does Node 2 MUST wait for Node 1?
                    </div>
                  </div>
                  <LucideIcon
                    name="clock"
                    className="text-slate-500 group-hover:text-red-400"
                  />
                </button>
              </div>

              {/* Feedback */}
              <div className="space-y-4">
                {feedback ? (
                  <div
                    className={`p-6 rounded-2xl border flex flex-col items-center text-center animate-fade-in ${
                      feedback.correct
                        ? "bg-green-900/10 border-green-500/30 text-green-300"
                        : "bg-red-900/10 border-red-500/30 text-red-300"
                    }`}
                  >
                    <LucideIcon
                      name={feedback.correct ? "check-circle" : "x-circle"}
                      size={32}
                      className="mb-2"
                    />
                    <div className="font-bold text-lg mb-1">
                      {feedback.title}
                    </div>
                    <p className="opacity-80 text-sm leading-relaxed">
                      {feedback.msg}
                    </p>
                  </div>
                ) : (
                  <div className="p-6 rounded-2xl border border-dashed border-slate-700 text-slate-500 flex flex-col items-center text-center justify-center h-full">
                    <LucideIcon
                      name="flask-conical"
                      size={32}
                      className="mb-2 opacity-50"
                    />
                    <p>Run a test to verify the statements.</p>
                  </div>
                )}

                {simulation === "parallel" && (
                  <div className="p-4 bg-blue-900/20 rounded-xl border border-blue-500/30 text-center text-blue-300 text-xs font-mono font-bold animate-pulse">
                    SYSTEM STATUS: PARALLEL PROCESSING ACTIVE (Nodes running
                    simultaneously)
                  </div>
                )}
              </div>
            </div>

            {/* Visualization Stage */}
            <div className="bg-black rounded-2xl border border-slate-800 p-12 relative overflow-hidden h-[300px] flex items-center justify-center">
              {/* Grid Lines */}
              <div
                className="absolute inset-0 opacity-20"
                style={{
                  backgroundImage:
                    "radial-gradient(#334155 1px, transparent 1px)",
                  backgroundSize: "20px 20px",
                }}
              ></div>

              {/* Nodes */}
              <div className="flex gap-12 md:gap-24 relative z-10">
                <Node
                  id={1}
                  status={
                    simulation === "parallel" || simulation === "exchanging"
                      ? "active"
                      : "idle"
                  }
                  hasMemory={true}
                />
                <Node
                  id={2}
                  status={
                    simulation === "parallel" || simulation === "exchanging"
                      ? "active"
                      : "idle"
                  }
                  hasMemory={true}
                />
                <Node
                  id={3}
                  status={simulation === "parallel" ? "active" : "idle"}
                  hasMemory={true}
                />
              </div>

              {/* Packet Animation for Exchange */}
              {simulation === "exchanging" && (
                <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-32 h-1 bg-slate-700">
                  {/* Fake connecting line */}
                  <div className="absolute top-[-10px] left-0 right-0 h-4 flex justify-between px-2">
                    <div className="w-4 h-4 rounded-full bg-yellow-400 animate-bounce absolute left-0"></div>
                    <div className="w-4 h-4 rounded-full bg-green-400 animate-bounce absolute right-0 animation-delay-500"></div>
                  </div>
                </div>
              )}
            </div>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
