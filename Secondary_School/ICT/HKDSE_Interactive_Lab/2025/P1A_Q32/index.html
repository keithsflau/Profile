<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HKDSE 2025 Paper 1A Q32 - Logic Equivalence</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
        background-color: #0f172a;
        color: #e2e8f0;
      }
    </style>
  </head>
  <body class="min-h-screen p-4 md:p-8 flex flex-col items-center">
    <div id="root" class="w-full max-w-6xl"></div>

    <script type="text/babel">
      const { useState, useEffect } = React;

      // Lucide Icon Shim
      const LucideIcon = ({ name, size = 20, className = "" }) => {
        const formatName = (n) =>
          n
            .split("-")
            .map((p) => p.charAt(0).toUpperCase() + p.slice(1))
            .join("");
        const iconName = formatName(name);
        const [svgHtml, setSvgHtml] = useState("");
        useEffect(() => {
          if (window.lucide?.icons[iconName]?.toSvg) {
            setSvgHtml(
              window.lucide.icons[iconName].toSvg({
                width: size,
                height: size,
                class: className,
              })
            );
          }
        }, [name]);
        return (
          <span
            dangerouslySetInnerHTML={{ __html: svgHtml }}
            style={{ display: "inline-flex" }}
          />
        );
      };

      const CodeBox = ({ title, codeLines, highlight }) => (
        <div className="bg-slate-900 rounded-xl border border-slate-700 overflow-hidden shadow-xl flex flex-col h-full">
          <div className="bg-slate-800 px-4 py-2 border-b border-slate-700 font-bold text-slate-300 text-sm flex justify-between items-center">
            <span>{title}</span>
            {highlight && (
              <LucideIcon name="zap" size={16} className="text-yellow-400" />
            )}
          </div>
          <div className="p-6 font-mono text-sm md:text-base space-y-2 flex-1 relative">
            {codeLines.map((line, idx) => (
              <div
                key={idx}
                className={
                  line.active
                    ? "text-yellow-300 bg-yellow-900/30 -mx-2 px-2 rounded"
                    : "text-slate-300"
                }
              >
                {line.indent && <span className="inline-block w-6"></span>}
                {line.text}
              </div>
            ))}
          </div>
        </div>
      );

      const App = () => {
        const [inputP, setInputP] = useState(25);
        const [selectedOpt, setSelectedOpt] = useState(null); // 'A', 'B', 'C', 'D'
        const [resultV1, setResultV1] = useState(null);
        const [resultV2, setResultV2] = useState(null);

        const options = [
          { id: "A", label: "A \u2190 A + P", val: 1 },
          { id: "B", label: "A \u2190 A + P * 2", val: 2 },
          { id: "C", label: "A \u2190 A + P * 3", val: 3 },
          { id: "D", label: "A \u2190 A + P * 5", val: 5 },
        ];

        const runComparison = (opt) => {
          setSelectedOpt(opt);

          // Logic V1
          let a1 = 0;
          let linesV1 = [];
          if (inputP > 20) {
            a1 = inputP * 5;
            linesV1 = "P > 20 is TRUE. A = P * 5";
          } else {
            a1 = inputP * 2;
            linesV1 = "P > 20 is FALSE. A = P * 2";
          }
          setResultV1({ val: a1, log: linesV1 });

          // Logic V2 with selected Option
          let a2 = inputP * 2; // Initial
          let linesV2 = "A = P * 2 (" + a2 + "). ";

          if (inputP > 20) {
            // Apply the missing part
            if (opt.id === "A") a2 += inputP; // + P
            if (opt.id === "B") a2 += inputP * 2; // + 2P
            if (opt.id === "C") a2 += inputP * 3; // + 3P
            if (opt.id === "D") a2 += inputP * 5; // + 5P
            linesV2 += `P > 20 is TRUE. Executing ${opt.label}`;
          } else {
            linesV2 += "P > 20 is FALSE. Skip If.";
          }
          setResultV2({ val: a2, log: linesV2 });
        };

        // Effect to update on P change if option selected
        useEffect(() => {
          if (selectedOpt) runComparison(selectedOpt);
        }, [inputP]);

        const isMatch = resultV1 && resultV2 && resultV1.val === resultV2.val;

        return (
          <div className="space-y-8 animate-fade-in w-full max-w-5xl mx-auto p-4 flex flex-col items-center">
            <header className="text-center space-y-4 max-w-3xl w-full">
              <div className="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-cyan-900/30 border border-cyan-500/30 text-cyan-400 text-sm font-bold">
                <span className="w-2 h-2 rounded-full bg-cyan-400 animate-pulse"></span>
                HKDSE 2025 Paper 1A Q32
              </div>

              <div className="bg-slate-800/50 p-6 rounded-2xl border border-slate-700 text-left">
                <h2 className="text-lg font-bold text-white mb-2">
                  Question (題目)
                </h2>
                <p className="text-slate-300 leading-relaxed text-sm md:text-base">
                  Version 1 and 2 represent algorithms with the same effect.
                  What corresponds to the missing part in Version 2?
                  <br />
                  <span className="text-slate-500">
                    版本 1 和 2 是具有相同效果的算法。在版本 2
                    內未填的部分是什麼？
                  </span>
                </p>
              </div>
            </header>

            {/* Controls */}
            <div className="flex flex-col md:flex-row gap-6 items-center w-full justify-center bg-slate-900/50 p-6 rounded-2xl border border-slate-800">
              <div className="flex items-center gap-4">
                <label className="text-slate-400 font-bold">
                  Test Value P:
                </label>
                <input
                  type="number"
                  value={inputP}
                  onChange={(e) => setInputP(Number(e.target.value))}
                  className="bg-slate-800 border-slate-600 rounded px-3 py-2 text-white w-24 font-mono text-center"
                />
                <span className="text-xs text-slate-500">
                  (Try &gt; 20 and &le; 20)
                </span>
              </div>

              <div className="flex flex-wrap gap-2">
                {options.map((opt) => (
                  <button
                    key={opt.id}
                    onClick={() => runComparison(opt)}
                    className={`px-4 py-2 rounded-lg font-mono text-sm border transition-all ${
                      selectedOpt?.id === opt.id
                        ? "bg-blue-600 border-blue-400 text-white"
                        : "bg-slate-800 border-slate-600 text-slate-400 hover:text-white"
                    }`}
                  >
                    {opt.label}
                  </button>
                ))}
              </div>
            </div>

            {/* Comparison View */}
            <div className="grid grid-cols-1 md:grid-cols-2 gap-8 w-full">
              {/* Version 1 */}
              <div className="space-y-4">
                <CodeBox
                  title="Version 1 (Target Logic)"
                  codeLines={[
                    { text: "IF (P > 20)", active: inputP > 20 },
                    {
                      text: "A \u2190 P * 5",
                      indent: true,
                      active: inputP > 20,
                    },
                    { text: "ELSE", active: inputP <= 20 },
                    {
                      text: "A \u2190 P * 2",
                      indent: true,
                      active: inputP <= 20,
                    },
                  ]}
                />
                <div className="bg-slate-800 p-4 rounded-xl border border-slate-700 flex justify-between items-center">
                  <span className="text-slate-400">Result A:</span>
                  <span className="text-2xl font-bold text-green-400 font-mono">
                    {resultV1?.val ?? "-"}
                  </span>
                </div>
              </div>

              {/* Version 2 */}
              <div className="space-y-4">
                <CodeBox
                  title="Version 2 (With Missing Part)"
                  codeLines={[
                    { text: "A \u2190 P * 2", active: true },
                    { text: "IF (P > 20)", active: inputP > 20 },
                    {
                      text: selectedOpt ? selectedOpt.label : "_____________?",
                      indent: true,
                      active: inputP > 20,
                    },
                  ]}
                  highlight={true}
                />
                <div className="bg-slate-800 p-4 rounded-xl border border-slate-700 flex justify-between items-center">
                  <span className="text-slate-400">Result A:</span>
                  <span
                    className={`text-2xl font-bold font-mono ${
                      isMatch ? "text-green-400" : "text-red-400"
                    }`}
                  >
                    {resultV2?.val ?? "-"}
                  </span>
                </div>
              </div>
            </div>

            {/* Conclusion */}
            {selectedOpt && (
              <div
                className={`w-full p-6 rounded-2xl border flex items-center justify-center gap-4 animate-fade-in ${
                  isMatch
                    ? "bg-green-900/20 border-green-500/50"
                    : "bg-red-900/20 border-red-500/50"
                }`}
              >
                <LucideIcon
                  name={isMatch ? "check-check" : "x"}
                  size={32}
                  className={isMatch ? "text-green-400" : "text-red-400"}
                />
                <div className="text-center">
                  <h3
                    className={`font-bold text-xl ${
                      isMatch ? "text-green-400" : "text-red-400"
                    }`}
                  >
                    {isMatch
                      ? "Algorithms are Equivalent!"
                      : "Results Do Not Match"}
                  </h3>
                  <p className="text-slate-300 text-sm mt-1">
                    {isMatch
                      ? `Since A starts as 2*P, adding 3*P results in 5*P, matching Version 1 when P > 20.`
                      : `Version 1 Result (${resultV1?.val}) !== Version 2 Result (${resultV2?.val}). Try another option.`}
                  </p>
                </div>
              </div>
            )}
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
