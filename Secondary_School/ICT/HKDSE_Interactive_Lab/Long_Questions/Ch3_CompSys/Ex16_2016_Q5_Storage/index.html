<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>HKDSE Ch3: 2016 Q5 RAID & Storage</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
      body {
        background-color: #0f172a;
        color: #e2e8f0;
        font-family: sans-serif;
      }
    </style>
  </head>
  <body class="p-4 flex justify-center min-h-screen">
    <div id="root" class="w-full max-w-4xl"></div>
    <script type="text/babel">
      const { useState } = React;
      const createLucideIcon = (name) => {
        const iconData = window.lucide?.icons[name];
        if (!iconData) return (props) => <span>?</span>;
        return ({ size, className, ...props }) =>
          React.createElement(
            "svg",
            {
              width: size || 24,
              height: size || 24,
              fill: "none",
              stroke: "currentColor",
              strokeWidth: 2,
              strokeLinecap: "round",
              strokeLinejoin: "round",
              className: `lucide lucide-${name.toLowerCase()} ${
                className || ""
              }`,
              viewBox: "0 0 24 24",
              ...props,
            },
            iconData.map(([tag, attrs], i) =>
              React.createElement(tag, { ...attrs, key: i })
            )
          );
      };
      const Icon = ({ name, ...p }) => {
        const C = createLucideIcon(name);
        return <C {...p} />;
      };

      const TEXT = {
        en: {
          title: "HKDSE 2016 Q5: Storage & RAID",
          subtitle: "Capacity Calculation and RAID Levels",
          task1: "Task 1: RAID Calculator",
          task2: "Task 2: Storage Requirements",
          disks: "Number of Disks:",
          size: "Size per Disk (TB):",
          raid0: "RAID 0 (Striping)",
          raid1: "RAID 1 (Mirroring)",
          raid5: "RAID 5 (Striping + Parity)",
          cap: "Total Usable Capacity:",
          fault: "Fault Tolerance:",
          speed: "Speed:",
          none: "None (1 disk failure = data loss)",
          n1: "N-1 Disks (Can start with 1 failure)",
          all: "All Disks except 1 (Very safe)",
          one: "1 Disk Failure",
          fast: "Very Fast (R/W)",
          med: "Fast Read / Slow Write",
          slow: "Slow (Redundant)",
          calcInfo:
            "Calculate image storage needing: 1000 images, 24MP, 24-bit color.",
          res: "Result:",
          formula: "Formula: P x P x BitDepth / 8 / 1024^2",
          raidDesc0: "Data split across disks. Fast but risky.",
          raidDesc1: "Data duplicated. Safe but expensive (50% space lost).",
          raidDesc5:
            "Data striped with parity. Balance of speed/safety. Requires 3+ disks.",
        },
        tc: {
          title: "HKDSE 2016 Q5: 儲存與 RAID",
          subtitle: "容量計算與 RAID 級別",
          task1: "任務 1：RAID 計算器",
          task2: "任務 2：儲存需求計算",
          disks: "硬碟數量：",
          size: "單碟容量 (TB)：",
          raid0: "RAID 0 (分割)",
          raid1: "RAID 1 (鏡像)",
          raid5: "RAID 5 (分割 + 奇偶校驗)",
          cap: "總可用容量：",
          fault: "容錯能力：",
          speed: "速度：",
          none: "無 (1 個硬碟損壞 = 數據丟失)",
          n1: "N-1 硬碟",
          all: "除 1 個外的所有硬碟 (非常安全)",
          one: "1 個硬碟損壞",
          fast: "非常快 (讀/寫)",
          med: "讀取快 / 寫入慢",
          slow: "慢 (冗餘)",
          calcInfo:
            "計算所需儲存空間：1000 張圖片，2400萬像素 (24MP)，24位元色彩。",
          res: "結果：",
          formula: "公式：像素 x 位元深度 / 8 / 1024^2",
          raidDesc0: "數據分散在硬碟上。快但有風險。",
          raidDesc1: "數據完全複製。安全但昂貴 (損失 50% 空間)。",
          raidDesc5: "數據分散並帶有校驗。速度與安全的平衡。需 3+ 硬碟。",
        },
      };

      const App = () => {
        const [lang, setLang] = useState("en");
        const t = TEXT[lang];

        const [numDisks, setNumDisks] = useState(3); // Min 2 for 0/1, Min 3 for 5
        const [diskSize, setDiskSize] = useState(2); // TB
        const [raidType, setRaidType] = useState("5"); // 0, 1, 5

        // Capacity Calc
        let totalCap = 0;
        let faultTol = "";
        let pSpeed = "";
        let desc = "";

        if (raidType === "0") {
          totalCap = numDisks * diskSize;
          faultTol = t.none;
          pSpeed = t.fast;
          desc = t.raidDesc0;
        } else if (raidType === "1") {
          totalCap = (numDisks * diskSize) / 2; // Usually Pairs
          if (numDisks % 2 !== 0)
            totalCap = "N/A (Need even disks)"; // Simple check
          else {
            faultTol = t.all; // Technically can lose 1 per pair
            faultTol = "1 Disk per pair";
          }
          // Simplification for DSE: RAID 1 is usually 2 disks.
          if (numDisks === 2) {
            totalCap = diskSize;
            faultTol = t.one;
          } else if (numDisks > 2) {
            // Assume RAID 10 or just Mirroring
            totalCap = diskSize * (numDisks / 2);
          }
          pSpeed = t.med;
          desc = t.raidDesc1;
        } else if (raidType === "5") {
          if (numDisks < 3) {
            totalCap = 0;
            faultTol = "N/A (Min 3 Disks)";
          } else {
            totalCap = (numDisks - 1) * diskSize;
            faultTol = t.one;
          }
          pSpeed = t.fast;
          desc = t.raidDesc5;
        }

        // Task 2 Image Calc
        // 24MP * 24 bit / 8 = 72 MB per pic (approx)
        // 1000 pics = 72000 MB = 72 GB
        const imgSize = (24000000 * 24) / 8; // Bytes
        const totalImgSizeGB = (imgSize * 1000) / (1024 * 1024 * 1024);

        return (
          <div className="space-y-6">
            <div className="flex justify-between items-center bg-slate-800 p-4 rounded-xl border border-slate-700">
              <div className="flex items-center gap-3">
                <div className="p-2 bg-indigo-600 rounded-lg">
                  <Icon name="HardDrive" className="text-white" />
                </div>
                <div>
                  <h1 className="text-xl font-bold text-white">{t.title}</h1>
                  <p className="text-slate-400 text-xs">{t.subtitle}</p>
                </div>
              </div>
              <button
                onClick={() => setLang((l) => (l === "en" ? "tc" : "en"))}
                className="px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-white font-bold border border-slate-500"
              >
                {lang === "en" ? "中文" : "English"}
              </button>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
              {/* Task 1: RAID */}
              <div className="bg-slate-900 border border-slate-700 rounded-xl p-6">
                <h2 className="text-white font-bold mb-4 flex items-center gap-2">
                  <Icon name="Database" /> {t.task1}
                </h2>

                <div className="space-y-4 mb-6">
                  <div>
                    <label className="text-slate-400 text-xs block mb-1">
                      {t.disks}
                    </label>
                    <div className="flex items-center gap-4">
                      <input
                        type="range"
                        min="2"
                        max="8"
                        value={numDisks}
                        onChange={(e) => setNumDisks(parseInt(e.target.value))}
                        className="flex-1"
                      />
                      <span className="text-white font-mono text-xl">
                        {numDisks}
                      </span>
                    </div>
                  </div>
                  <div>
                    <label className="text-slate-400 text-xs block mb-1">
                      {t.size}
                    </label>
                    <div className="flex gap-2">
                      {[1, 2, 4, 8].map((s) => (
                        <button
                          key={s}
                          onClick={() => setDiskSize(s)}
                          className={`px-3 py-1 rounded border ${
                            diskSize === s
                              ? "bg-blue-600 border-blue-500 text-white"
                              : "bg-slate-800 border-slate-600"
                          }`}
                        >
                          {s}TB
                        </button>
                      ))}
                    </div>
                  </div>
                  <div>
                    <label className="text-slate-400 text-xs block mb-1">
                      RAID Type
                    </label>
                    <div className="flex gap-2">
                      {["0", "1", "5"].map((r) => (
                        <button
                          key={r}
                          onClick={() => setRaidType(r)}
                          className={`px-3 py-1 rounded border flex-1 ${
                            raidType === r
                              ? "bg-purple-600 border-purple-500 text-white"
                              : "bg-slate-800 border-slate-600"
                          }`}
                        >
                          RAID {r}
                        </button>
                      ))}
                    </div>
                  </div>
                </div>

                <div className="bg-slate-800 p-4 rounded-xl border border-slate-600 space-y-2">
                  <div className="text-xs text-yellow-500 mb-2">{desc}</div>
                  <div className="flex justify-between">
                    <span className="text-slate-400">{t.cap}</span>
                    <span className="text-white font-bold text-xl">
                      {typeof totalCap === "number"
                        ? totalCap + " TB"
                        : totalCap}
                    </span>
                  </div>
                  <div className="flex justify-between text-sm">
                    <span className="text-slate-400">{t.fault}</span>
                    <span className="text-green-400">{faultTol}</span>
                  </div>
                  <div className="flex justify-between text-sm">
                    <span className="text-slate-400">{t.speed}</span>
                    <span className="text-blue-400">{pSpeed}</span>
                  </div>
                </div>
              </div>

              {/* Task 2: Image Calc */}
              <div className="bg-slate-900 border border-slate-700 rounded-xl p-6">
                <h2 className="text-white font-bold mb-4 flex items-center gap-2">
                  <Icon name="Image" /> {t.task2}
                </h2>
                <p className="text-slate-400 text-sm mb-4">{t.calcInfo}</p>
                <div className="bg-slate-800 p-4 rounded border border-slate-600 font-mono text-sm space-y-2">
                  <div className="text-slate-500">{t.formula}</div>
                  <div>1 Image = (24,000,000 × 24) ÷ 8 bytes</div>
                  <div>= 72,000,000 bytes ≈ 72 MB</div>
                  <div className="border-t border-slate-700 pt-2 mt-2">
                    Total = 72 MB × 1000 = 72,000 MB
                  </div>
                  <div className="text-xl text-yellow-400 font-bold mt-2">
                    ≈ {totalImgSizeGB.toFixed(2)} GB
                  </div>
                </div>
              </div>
            </div>
          </div>
        );
      };
      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
