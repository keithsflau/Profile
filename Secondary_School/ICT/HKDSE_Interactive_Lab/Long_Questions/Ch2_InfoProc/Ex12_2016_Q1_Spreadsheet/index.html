<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>HKDSE 2016 Paper 1B Q1 - Spreadsheet Formatting</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
      body {
        background-color: #0f172a;
        color: #e2e8f0;
        font-family: sans-serif;
      }
      .cell {
        transition: all 0.2s;
      }
      .cell:focus {
        outline: 2px solid #3b82f6;
        z-index: 10;
      }
    </style>
  </head>
  <body class="p-4 flex justify-center min-h-screen">
    <div id="root" class="w-full max-w-4xl"></div>
    <script type="text/babel">
      const { useState } = React;
      const createLucideIcon = (name) => {
        const iconData = window.lucide?.icons[name];
        if (!iconData) return (props) => <span>?</span>;
        return ({ size, className, ...props }) =>
          React.createElement(
            "svg",
            {
              width: size || 24,
              height: size || 24,
              fill: "none",
              stroke: "currentColor",
              strokeWidth: 2,
              strokeLinecap: "round",
              strokeLinejoin: "round",
              className: `lucide lucide-${name.toLowerCase()} ${
                className || ""
              }`,
              viewBox: "0 0 24 24",
              ...props,
            },
            iconData.map(([tag, attrs], i) =>
              React.createElement(tag, { ...attrs, key: i })
            )
          );
      };
      const Icon = ({ name, ...p }) => {
        const C = createLucideIcon(name);
        return <C {...p} />;
      };

      const TEXT = {
        en: {
          title: "HKDSE 2016 Q1: Spreadsheet Formatting",
          subtitle: "Membership Numbers & Data Types",
          desc: "Scenario: A Sports Club needs to store 5-digit Membership IDs (e.g., 00123). Inputting them into a standard spreadsheet might cause issues.",
          challenge: "Challenge: Enter '00123' and ensure it stays '00123'.",
          input: "Input Data",
          format: "Cell Format",
          result: "Displayed Value",
          general: "General / Number",
          text: "Text",
          custom: "Custom (00000)",
          submit: "Apply Format",
          explanation: "Explanation",
          expGeneral:
            "In 'General' or 'Number' format, leading zeros are removed because the software treats the input as a mathematical number (123 = 00123).",
          expText:
            "In 'Text' format, the input is treated as a string of characters. Leading zeros are preserved.",
          expCustom:
            "In 'Custom' format (00000), the number is padded with zeros to ensure a fixed width display.",
          success: "Success! The Membership ID is correctly formatted.",
          fail: "Incorrect. The leading zeros were lost.",
          reset: "Reset",
        },
        tc: {
          title: "HKDSE 2016 Q1: 電子試算表格式",
          subtitle: "會員編號與數據類型",
          desc: "情境：體育會需要儲存 5 位數的會員編號（例如 00123）。在標準試算表中輸入可能會導致問題。",
          challenge: "挑戰：輸入 '00123' 並確保它顯示為 '00123'。",
          input: "輸入數據",
          format: "儲存格格式",
          result: "顯示數值",
          general: "一般 / 數字",
          text: "文字 (Text)",
          custom: "自訂 (00000)",
          submit: "套用格式",
          explanation: "解釋",
          expGeneral:
            "在「一般」或「數字」格式下，前導零會被移除，因為軟件將輸入視為數學數字（123 = 00123）。",
          expText: "在「文字」格式下，輸入被視為字串。前導零會被保留。",
          expCustom:
            "在「自訂」格式 (00000) 下，數字會補零以確保固定寬度顯示。",
          success: "成功！會員編號格式正確。",
          fail: "不正確。前導零丟失了。",
          reset: "重置",
        },
      };

      const App = () => {
        const [lang, setLang] = useState("en");
        const t = TEXT[lang];
        const [inputVal, setInputVal] = useState("");
        const [fmt, setFmt] = useState("general"); // general, text, custom
        const [display, setDisplay] = useState(null);
        const [status, setStatus] = useState(null); // success, fail

        const process = () => {
          if (!inputVal) return;

          let res = inputVal;
          // Logic simulation
          if (fmt === "general") {
            // Remove leading zeros if it looks like a number
            if (!isNaN(Number(inputVal))) {
              res = String(Number(inputVal));
            }
          } else if (fmt === "text") {
            // Keep exactly as is
            res = inputVal;
          } else if (fmt === "custom") {
            // Pad to 5 digits
            if (!isNaN(Number(inputVal))) {
              res = String(Number(inputVal)).padStart(5, "0");
            }
          }

          setDisplay(res);

          // Check success (Goal: maintain 00123 OR pad to 5 digits)
          // If user typed 00123, Text keeps 00123 (Success).
          // If user typed 123, Custom makes 00123 (Success).
          // General makes 123 (Fail for 00123 goal).

          const targetLength = 5;
          if (res.length === targetLength && res.startsWith("0")) {
            setStatus("success");
          } else if (
            res.length < targetLength &&
            inputVal.length === targetLength &&
            inputVal.startsWith("0")
          ) {
            setStatus("fail"); // Lost zeros
          } else {
            setStatus("neutral");
          }
        };

        return (
          <div className="space-y-6">
            <div className="flex justify-between items-center bg-slate-800 p-4 rounded-xl border border-slate-700">
              <div className="flex items-center gap-3">
                <div className="p-2 bg-green-600 rounded-lg">
                  <Icon name="Table" className="text-white" />
                </div>
                <div>
                  <h1 className="text-xl font-bold text-white">{t.title}</h1>
                  <p className="text-slate-400 text-xs">{t.subtitle}</p>
                </div>
              </div>
              <button
                onClick={() => setLang((l) => (l === "en" ? "tc" : "en"))}
                className="px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-white font-bold border border-slate-500"
              >
                {lang === "en" ? "中文" : "English"}
              </button>
            </div>

            <div className="bg-slate-900 border border-slate-700 rounded-xl p-6">
              <div className="flex items-start gap-4 mb-6">
                <Icon
                  name="Lightbulb"
                  className="text-yellow-400 shrink-0 mt-1"
                />
                <div>
                  <p className="text-slate-300 italic mb-2">{t.desc}</p>
                  <div className="bg-blue-900/30 text-blue-300 px-3 py-1 rounded inline-block text-sm font-bold border border-blue-500/30">
                    {t.challenge}
                  </div>
                </div>
              </div>

              {/* Spreadsheet UI */}
              <div className="max-w-2xl mx-auto bg-white rounded-lg overflow-hidden shadow-2xl">
                {/* Header */}
                <div className="grid grid-cols-3 bg-slate-200 border-b border-slate-300 font-bold text-slate-700 text-center py-2">
                  <div>A</div>
                  <div>B</div>
                  <div>C</div>
                </div>

                {/* Row 1 */}
                <div className="grid grid-cols-3 border-b border-slate-100">
                  <div className="p-4 border-r border-slate-100 flex items-center justify-center">
                    <input
                      type="text"
                      value={inputVal}
                      onChange={(e) => {
                        setInputVal(e.target.value);
                        setDisplay(null);
                        setStatus(null);
                      }}
                      placeholder="00123"
                      className="w-full text-center font-mono p-2 border border-slate-300 rounded focus:border-blue-500 outline-none text-slate-800"
                    />
                  </div>
                  <div className="p-4 border-r border-slate-100 flex items-center justify-center">
                    <select
                      value={fmt}
                      onChange={(e) => {
                        setFmt(e.target.value);
                        setDisplay(null);
                        setStatus(null);
                      }}
                      className="w-full p-2 border border-slate-300 rounded text-sm text-slate-800 outline-none"
                    >
                      <option value="general">{t.general}</option>
                      <option value="text">{t.text}</option>
                      <option value="custom">{t.custom}</option>
                    </select>
                  </div>
                  <div className="p-4 bg-slate-50 flex items-center justify-center font-mono font-bold text-lg text-slate-800 min-h-[64px]">
                    {display !== null ? (
                      display
                    ) : (
                      <span className="text-slate-300">-</span>
                    )}
                  </div>
                </div>
              </div>

              {/* Actions */}
              <div className="max-w-2xl mx-auto mt-6 flex gap-4">
                <button
                  onClick={process}
                  className="flex-1 py-3 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded-lg shadow-lg flex justify-center items-center gap-2"
                >
                  <Icon name="Play" size={18} /> {t.submit}
                </button>
                <button
                  onClick={() => {
                    setInputVal("");
                    setDisplay(null);
                    setStatus(null);
                  }}
                  className="px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white font-bold rounded-lg shadow-lg"
                >
                  <Icon name="RotateCcw" size={18} />
                </button>
              </div>

              {/* Result Feedback */}
              {status && (
                <div
                  className={`max-w-2xl mx-auto mt-6 p-4 rounded-xl border animate-fade-in ${
                    status === "success"
                      ? "bg-green-900/50 border-green-500 text-green-300"
                      : status === "fail"
                      ? "bg-red-900/50 border-red-500 text-red-300"
                      : "bg-slate-800 border-slate-600 text-slate-300"
                  }`}
                >
                  <div className="flex items-center gap-3 mb-2 font-bold text-lg">
                    <Icon
                      name={
                        status === "success" ? "CheckCircle" : "AlertTriangle"
                      }
                    />
                    {status === "success"
                      ? t.success
                      : status === "fail"
                      ? t.fail
                      : "Check the result."}
                  </div>
                  <div className="text-sm opacity-90 pl-9">
                    {fmt === "general" && t.expGeneral}
                    {fmt === "text" && t.expText}
                    {fmt === "custom" && t.expCustom}
                  </div>
                </div>
              )}
            </div>
          </div>
        );
      };
      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
