<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ex04: 2013 Q2 - URL vs QR Code</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
      body {
        background-color: #0f172a;
        color: #e2e8f0;
        font-family: "Inter", sans-serif;
      }
    </style>
  </head>
  <body class="p-4 md:p-8">
    <div id="root" class="max-w-4xl mx-auto"></div>
    <script type="text/babel">
      const { useState, useEffect, useRef } = React;
      const { QrCode, Keyboard, Timer, RotateCcw, CheckCircle, Smartphone } =
        lucide;

      const TEXT = {
        en: {
          title: "HKDSE 2013 Q2: Input Methods Comparison",
          subtitle:
            "Manual Entry (URL) vs Automated Entry (QR Code). Compare accuracy and speed.",
          instructions: "Try to input the URL below using both methods.",
          target_url:
            "https://www.hkeaa.edu.hk/en/hkdse/assessment/subject_information/category_a_subjects/hkdse_subj.html?A2&1",
          method_manual: "Method A: Manual Typing",
          method_qr: "Method B: QR Code Scan",
          start_typing: "Start Typing",
          scan: "Scan QR Code",
          time: "Time Taken",
          accuracy: "Accuracy",
          error_calc: "Errors",
          reset: "Reset",
          result_manual: "Manual: Slow, Prone to Error.",
          result_qr: "QR: Fast, Accurate, Requires Camera.",
          simulating: "Simulating Scan...",
        },
        tc: {
          title: "HKDSE 2013 Q2: 輸入方法比較",
          subtitle: "手動輸入 (URL) vs 自動輸入 (QR Code)。比較準確度和速度。",
          instructions: "嘗試使用兩種方法輸入下方的 URL。",
          target_url:
            "https://www.hkeaa.edu.hk/en/hkdse/assessment/subject_information/category_a_subjects/hkdse_subj.html?A2&1",
          method_manual: "方法 A: 手動輸入",
          method_qr: "方法 B: QR Code 掃描",
          start_typing: "開始輸入",
          scan: "掃描 QR Code",
          time: "所需時間",
          accuracy: "準確度",
          error_calc: "錯誤",
          reset: "重置",
          result_manual: "手動: 慢，容易出錯。",
          result_qr: "QR: 快，準確，需要鏡頭。",
          simulating: "正在模擬掃描...",
        },
      };

      const App = () => {
        const [lang, setLang] = useState("en");
        const [inputA, setInputA] = useState("");
        const [inputB, setInputB] = useState("");
        const [startTimeA, setStartTimeA] = useState(null);
        const [endTimeA, setEndTimeA] = useState(null);
        const [scanning, setScanning] = useState(false);
        const [scanned, setScanned] = useState(false);
        const t = TEXT[lang];

        // Manual Typing Logic
        const handleChangeA = (e) => {
          if (!startTimeA) setStartTimeA(Date.now());
          setInputA(e.target.value);
          if (e.target.value === t.target_url) {
            setEndTimeA(Date.now());
          }
        };

        const timeA =
          startTimeA && endTimeA
            ? ((endTimeA - startTimeA) / 1000).toFixed(2)
            : "0.00";
        const errorsA =
          inputA.split("").filter((c, i) => c !== t.target_url[i]).length +
          Math.max(0, t.target_url.length - inputA.length);
        const isMatchA = inputA === t.target_url;

        // QR Scan Logic
        const handleScan = () => {
          setScanning(true);
          setTimeout(() => {
            setScanning(false);
            setScanned(true);
            setInputB(t.target_url);
          }, 1500); // 1.5s simulated scan
        };

        return (
          <div className="min-h-screen bg-slate-900 p-4">
            <header className="flex justify-between items-center mb-8 border-b border-slate-700 pb-4">
              <div>
                <h1 className="text-2xl font-bold text-white flex items-center gap-2">
                  <QrCode className="text-blue-400" /> vs{" "}
                  <Keyboard className="text-pink-400" />
                </h1>
                <p className="text-slate-400 mt-1">{t.title}</p>
              </div>
              <button
                onClick={() => setLang((l) => (l === "en" ? "tc" : "en"))}
                className="px-3 py-1 bg-slate-800 rounded border border-slate-600"
              >
                {lang === "en" ? "中文" : "ENG"}
              </button>
            </header>

            <div className="bg-slate-800 p-4 rounded-xl mb-6 border border-slate-600">
              <label className="text-slate-400 text-sm block mb-1">
                Target URL (Goal):
              </label>
              <code className="block bg-black p-3 rounded text-green-400 break-all font-mono text-sm md:text-base select-all">
                {t.target_url}
              </code>
            </div>

            <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
              {/* Manual */}
              <div className="bg-slate-800/50 p-6 rounded-xl border border-pink-500/30 relative">
                <h2 className="text-xl font-bold text-pink-400 mb-4 flex gap-2 items-center">
                  <Keyboard /> {t.method_manual}
                </h2>
                <textarea
                  value={inputA}
                  onChange={handleChangeA}
                  placeholder="Type the URL here..."
                  className="w-full h-32 bg-slate-900 border border-slate-600 rounded p-2 text-white font-mono text-sm break-all focus:border-pink-500 focus:outline-none"
                  disabled={isMatchA}
                />
                <div className="mt-4 grid grid-cols-2 gap-4 text-sm">
                  <div className="bg-slate-900 p-2 rounded border border-slate-700">
                    <span className="text-slate-500 block">{t.time}</span>
                    <span className="text-xl font-mono text-white">
                      {timeA}s
                    </span>
                  </div>
                  <div className="bg-slate-900 p-2 rounded border border-slate-700">
                    <span className="text-slate-500 block">{t.error_calc}</span>
                    <span
                      className={`text-xl font-mono ${
                        errorsA === 0 ? "text-green-400" : "text-red-400"
                      }`}
                    >
                      {errorsA}
                    </span>
                  </div>
                </div>
                {isMatchA && (
                  <div className="absolute inset-0 bg-green-900/80 flex items-center justify-center rounded-xl backdrop-blur-sm">
                    <div className="text-center">
                      <CheckCircle
                        size={48}
                        className="text-white mx-auto mb-2"
                      />
                      <h3 className="text-white font-bold">Complete!</h3>
                      <p className="text-green-200 text-sm">
                        {t.result_manual}
                      </p>
                    </div>
                  </div>
                )}
              </div>

              {/* QR */}
              <div className="bg-slate-800/50 p-6 rounded-xl border border-blue-500/30 relative">
                <h2 className="text-xl font-bold text-blue-400 mb-4 flex gap-2 items-center">
                  <QrCode /> {t.method_qr}
                </h2>
                <div
                  className="h-32 flex items-center justify-center bg-black rounded border border-slate-700 relative overflow-hidden group cursor-pointer"
                  onClick={!scanned ? handleScan : null}
                >
                  {!scanned && !scanning && (
                    <div className="text-center">
                      <Smartphone
                        size={32}
                        className="text-slate-500 mx-auto mb-2 group-hover:text-white transition-colors"
                      />
                      <span className="text-slate-500 text-sm">{t.scan}</span>
                    </div>
                  )}
                  {scanning && (
                    <div className="w-full h-1 bg-green-500 absolute top-0 animate-[scan_1.5s_linear_infinite] shadow-[0_0_10px_#0f0]"></div>
                  )}
                  {scanned && (
                    <div className="text-green-400 font-bold flex gap-2 items-center">
                      <CheckCircle /> Scanned
                    </div>
                  )}
                </div>

                <div className="mt-4 grid grid-cols-2 gap-4 text-sm">
                  <div className="bg-slate-900 p-2 rounded border border-slate-700">
                    <span className="text-slate-500 block">{t.time}</span>
                    <span className="text-xl font-mono text-white">
                      {scanned ? "1.50" : "0.00"}s
                    </span>
                  </div>
                  <div className="bg-slate-900 p-2 rounded border border-slate-700">
                    <span className="text-slate-500 block">{t.accuracy}</span>
                    <span className="text-xl font-mono text-green-400">
                      {scanned ? "100%" : "-"}
                    </span>
                  </div>
                </div>

                {scanned && (
                  <div className="mt-4 p-2 bg-slate-900 rounded border border-blue-900 text-xs text-blue-200">
                    {t.result_qr} URL:{" "}
                    <span className="text-slate-400 truncate block">
                      {inputB}
                    </span>
                  </div>
                )}
              </div>
            </div>

            <button
              onClick={() => {
                setInputA("");
                setInputB("");
                setStartTimeA(null);
                setEndTimeA(null);
                setScanned(false);
                setScanning(false);
              }}
              className="mt-8 mx-auto block px-6 py-2 bg-slate-700 hover:bg-slate-600 rounded-full text-white flex gap-2 items-center"
            >
              <RotateCcw size={16} /> {t.reset}
            </button>

            <style>{`@keyframes scan { 0% { top: 0; } 100% { top: 100%; } }`}</style>
          </div>
        );
      };
      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
