<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HKDSE ICT - Memory Hierarchy</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
        background-color: #0f172a;
        color: #e2e8f0;
      }
      .pyramid-level {
        transition: all 0.3s;
        clip-path: polygon(10% 0, 90% 0, 100% 100%, 0% 100%);
        margin-bottom: 4px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
      }
      .pyramid-level:hover {
        transform: scale(1.02);
        filter: brightness(1.2);
      }
      .level-active {
        filter: brightness(1.3);
        box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
      }
    </style>
  </head>
  <body class="min-h-screen p-8 bg-slate-900 flex justify-center items-center">
    <div id="root" class="w-full max-w-6xl"></div>

    <script type="text/babel">
      const { useState, useEffect } = React;

      // --- LUCIDE ICON SHIM ---
      const LucideIcon = ({ name, size = 24, className = "" }) => {
        const formatName = (n) =>
          n
            .split("-")
            .map((p) => p.charAt(0).toUpperCase() + p.slice(1))
            .join("");
        const iconName = formatName(name);

        const [svgHtml, setSvgHtml] = useState("");

        useEffect(() => {
          if (
            window.lucide &&
            window.lucide.icons &&
            window.lucide.icons[iconName] &&
            typeof window.lucide.icons[iconName].toSvg === "function"
          ) {
            setSvgHtml(
              window.lucide.icons[iconName].toSvg({
                width: size,
                height: size,
                class: className,
              })
            );
          }
        }, [name, size, className, iconName]);

        return (
          <span
            dangerouslySetInnerHTML={{ __html: svgHtml }}
            style={{ display: "inline-flex" }}
          />
        );
      };
      const Cpu = (p) => <LucideIcon name="cpu" {...p} />;
      const HardDrive = (p) => <LucideIcon name="hard-drive" {...p} />;
      const Zap = (p) => <LucideIcon name="zap" {...p} />;
      const Database = (p) => <LucideIcon name="database" {...p} />;
      const ArrowUp = (p) => <LucideIcon name="arrow-up" {...p} />;
      const ArrowDown = (p) => <LucideIcon name="arrow-down" {...p} />;
      // --- END SHIM ---

      const LEVELS = [
        {
          id: "reg",
          name: "Registers",
          size: "< 1 KB",
          speed: "Immediate",
          cost: "Highest",
          icon: Cpu,
          color: "bg-red-600",
          width: "w-[20%]",
        },
        {
          id: "cache",
          name: "Cache (L1/L2/L3)",
          size: "MBs",
          speed: "Very Fast",
          cost: "Very High",
          icon: Zap,
          color: "bg-orange-600",
          width: "w-[40%]",
        },
        {
          id: "ram",
          name: "RAM (Main Memory)",
          size: "GBs",
          speed: "Fast",
          cost: "Medium",
          icon: Database,
          color: "bg-yellow-600",
          width: "w-[60%]",
        },
        {
          id: "ssd",
          name: "Secondary Storage",
          size: "TBs",
          speed: "Slow",
          cost: "Low",
          icon: HardDrive,
          color: "bg-green-600",
          width: "w-[80%]",
        },
      ];

      const App = () => {
        const [activeId, setActiveId] = useState(null);
        const activeLevel = LEVELS.find((l) => l.id === activeId);

        return (
          <div className="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
            <div className="flex flex-col items-center relative py-10">
              <div className="absolute left-0 top-0 bottom-0 flex flex-col justify-between py-12 items-center h-full">
                <div className="flex flex-col items-center text-red-400 text-xs font-bold uppercase tracking-widest gap-2">
                  <ArrowUp size={24} /> Faster Speed
                </div>
                <div className="flex flex-col items-center text-green-400 text-xs font-bold uppercase tracking-widest gap-2">
                  <ArrowDown size={24} /> Larger Size
                </div>
              </div>
              {LEVELS.map((lvl) => (
                <div
                  key={lvl.id}
                  onClick={() => setActiveId(lvl.id)}
                  className={`pyramid-level h-24 text-white text-lg shadow-lg relative ${
                    lvl.color
                  } ${lvl.width} ${
                    activeId === lvl.id
                      ? "level-active z-10"
                      : "opacity-80 hover:opacity-100"
                  }`}
                >
                  <span className="drop-shadow-md flex items-center gap-2">
                    <lvl.icon size={20} /> {lvl.name}
                  </span>
                </div>
              ))}
            </div>

            <div className="bg-slate-800 p-8 rounded-2xl border border-slate-700 min-h-[400px] flex flex-col justify-center">
              {!activeId ? (
                <div className="text-center text-slate-500">
                  <Database size={48} className="mx-auto mb-4 opacity-20" />
                  <h3 className="text-xl font-bold text-slate-400 mb-2">
                    Memory Hierarchy
                  </h3>
                  <p>Click a level on the pyramid to explore.</p>
                </div>
              ) : (
                <div>
                  <div
                    className={`w-16 h-16 ${activeLevel.color} rounded-2xl flex items-center justify-center mb-6 shadow-lg`}
                  >
                    <activeLevel.icon size={32} className="text-white" />
                  </div>
                  <h2 className="text-3xl font-bold text-white mb-2">
                    {activeLevel.name}
                  </h2>
                  <div className="grid grid-cols-2 gap-4 mt-8">
                    <div className="bg-slate-900 p-4 rounded-xl border border-slate-700">
                      <div className="text-slate-500 text-xs uppercase font-bold mb-1">
                        Speed
                      </div>
                      <div className="text-xl text-white font-mono">
                        {activeLevel.speed}
                      </div>
                    </div>
                    <div className="bg-slate-900 p-4 rounded-xl border border-slate-700">
                      <div className="text-slate-500 text-xs uppercase font-bold mb-1">
                        Capacity
                      </div>
                      <div className="text-xl text-white font-mono">
                        {activeLevel.size}
                      </div>
                    </div>
                    <div className="bg-slate-900 p-4 rounded-xl border border-slate-700">
                      <div className="text-slate-500 text-xs uppercase font-bold mb-1">
                        Cost / bit
                      </div>
                      <div className="text-xl text-white font-mono">
                        {activeLevel.cost}
                      </div>
                    </div>
                    <div className="bg-slate-900 p-4 rounded-xl border border-slate-700">
                      <div className="text-slate-500 text-xs uppercase font-bold mb-1">
                        Volatile?
                      </div>
                      <div className="text-xl text-white font-mono">
                        {activeLevel.id === "ssd" ? "No" : "Yes"}
                      </div>
                    </div>
                  </div>
                </div>
              )}
            </div>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
