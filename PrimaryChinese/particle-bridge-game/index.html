<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Á•ûÁ≠ÜÈ¶¨ËâØ - ÈÇèËºØÊ©ãÊ®ëÈÅäÊà≤</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        body { 
            background-color: #0f172a; 
            font-family: 'Noto Sans TC', sans-serif; 
        }
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        .floating { animation: float 2s ease-in-out infinite; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        // ==========================================
        // üìö ÈóúÂç°Êï∏ÊìöÂ∫´ (50Èóú)
        // ==========================================
        const LEVELS = [
            // Á¨¨1-10ÈóúÔºöÂü∫Á§éÈÇèËºØ (Âõ†ÁÇ∫/ÊâÄ‰ª•)
            {
                id: 1,
                question: "____ ‰∏ãÈõ®Ôºå____ ÊàëÂÄë‰∏çÁî®‰∏äÈ´îËÇ≤Ë™≤„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: []
            },
            {
                id: 2,
                question: "____ Â•πÂä™ÂäõÂ≠∏ÁøíÔºå____ Â•πËÄÉË©¶ÂèäÊ†º‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [{ type: 'moving', x: 400, y: 200, width: 40, height: 40, speed: 1, direction: 'vertical' }]
            },
            {
                id: 3,
                question: "____ ‰ªñÂæàÁ¥ØÔºå____ ‰ªñÊó©Êó©‰∏äÂ∫äÁù°Ë¶∫„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [{ type: 'static', x: 350, y: 180, width: 50, height: 50 }]
            },
            {
                id: 4,
                question: "____ Â§©Ê∞£ÂæàÂ•ΩÔºå____ ÊàëÂÄëÂéªÂÖ¨Âúí‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 300, y: 150, width: 30, height: 30, speed: 1.5, direction: 'vertical' },
                    { type: 'moving', x: 500, y: 200, width: 30, height: 30, speed: 1.2, direction: 'vertical' }
                ]
            },
            {
                id: 5,
                question: "____ ÊàëÂøòË®òÂ∏∂ÂäüË™≤Ôºå____ ËÄÅÂ∏´ÁîüÊ∞£‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [{ type: 'static', x: 400, y: 160, width: 60, height: 60 }]
            },
            {
                id: 6,
                question: "____ Â•πÂñúÊ≠°Èü≥Ê®ÇÔºå____ Â•πÊØèÂ§©Á∑¥ÁøíÈãºÁê¥„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 350, y: 180, width: 40, height: 40, speed: 2, direction: 'vertical' },
                    { type: 'static', x: 450, y: 170, width: 40, height: 40 }
                ]
            },
            {
                id: 7,
                question: "____ Â∑¥Â£´ÈÅ≤Âà∞‰∫ÜÔºå____ ÊàëÂÄëÈåØÈÅé‰∫ÜÈõªÂΩ±„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [{ type: 'moving', x: 400, y: 150, width: 50, height: 50, speed: 1.8, direction: 'vertical' }]
            },
            {
                id: 8,
                question: "____ ‰ªñÈ§ì‰∫ÜÔºå____ ‰ªñÂêÉ‰∫Ü‰∏âÊòéÊ≤ª„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'static', x: 320, y: 190, width: 45, height: 45 },
                    { type: 'static', x: 480, y: 175, width: 45, height: 45 }
                ]
            },
            {
                id: 9,
                question: "____ ÈÄôÊú¨Êõ∏ÂæàÊúâË∂£Ôºå____ ÊàëÂæàÂø´ËÆÄÂÆå‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 380, y: 160, width: 35, height: 35, speed: 2.2, direction: 'vertical' },
                    { type: 'moving', x: 420, y: 200, width: 35, height: 35, speed: 1.5, direction: 'vertical' }
                ]
            },
            {
                id: 10,
                question: "____ ‰ªäÂ§©ÊòØ‰ªñÁöÑÁîüÊó•Ôºå____ ÊàëÂÄëÈñãÊ¥æÂ∞ç‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'static', x: 350, y: 180, width: 50, height: 50 },
                    { type: 'moving', x: 450, y: 170, width: 40, height: 40, speed: 1.8, direction: 'vertical' }
                ]
            },
            // Á¨¨11-20ÈóúÔºöÈõñÁÑ∂/‰ΩÜÊòØÈÇèËºØ
            {
                id: 11,
                question: "____ Â§©Ê∞£ÂæàÂÜ∑Ôºå____ ÊàëÂÄëÈÇÑÊòØÂá∫Âéª‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [{ type: 'moving', x: 400, y: 200, width: 45, height: 45, speed: 1.5, direction: 'vertical' }]
            },
            {
                id: 12,
                question: "____ Â•πÂæàÂÆ≥ÊÄïÔºå____ Â•πÈÇÑÊòØÂòóË©¶‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'static', x: 380, y: 175, width: 50, height: 50 },
                    { type: 'moving', x: 420, y: 190, width: 35, height: 35, speed: 2, direction: 'vertical' }
                ]
            },
            {
                id: 13,
                question: "____ ‰ªñÂæàÂøôÔºå____ ‰ªñÈÇÑÊòØÂπ´Âä©‰∫ÜÊúãÂèã„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [{ type: 'moving', x: 400, y: 160, width: 55, height: 55, speed: 1.3, direction: 'vertical' }]
            },
            {
                id: 14,
                question: "____ ËÄÉË©¶ÂæàÈõ£Ôºå____ Â•πÈÇÑÊòØÂèñÂæóÂ•ΩÊàêÁ∏æ„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'static', x: 350, y: 185, width: 45, height: 45 },
                    { type: 'static', x: 450, y: 170, width: 45, height: 45 },
                    { type: 'moving', x: 400, y: 200, width: 30, height: 30, speed: 2.5, direction: 'vertical' }
                ]
            },
            {
                id: 15,
                question: "____ ÂÆÉÂæàË≤¥Ôºå____ ÊàëÂÄëÈÇÑÊòØË≤∑‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [{ type: 'moving', x: 400, y: 150, width: 60, height: 60, speed: 1.2, direction: 'vertical' }]
            },
            {
                id: 16,
                question: "____ ‰ªñÂæàÁ¥ØÔºå____ ‰ªñÁπºÁ∫åÂ∑•‰Ωú„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 370, y: 180, width: 40, height: 40, speed: 1.8, direction: 'vertical' },
                    { type: 'moving', x: 430, y: 190, width: 40, height: 40, speed: 1.6, direction: 'vertical' }
                ]
            },
            {
                id: 17,
                question: "____ È£üÁâ©ÂæàËæ£Ôºå____ ÊàëÈÇÑÊòØÂñúÊ≠°„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [
                    { type: 'static', x: 400, y: 175, width: 55, height: 55 }
                ]
            },
            {
                id: 18,
                question: "____ Â•πÂæàÁ∑äÂºµÔºå____ Â•πË°®ÁèæÂæóÂæàÂ•Ω„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 350, y: 160, width: 45, height: 45, speed: 2.2, direction: 'vertical' },
                    { type: 'static', x: 450, y: 195, width: 45, height: 45 }
                ]
            },
            {
                id: 19,
                question: "____ Ë∑ØÂæàÈï∑Ôºå____ ÊàëÂÄëÈÇÑÊòØËµ∞Ë∑Ø„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 400, y: 200, width: 50, height: 50, speed: 1.4, direction: 'vertical' },
                    { type: 'moving', x: 380, y: 170, width: 35, height: 35, speed: 2.3, direction: 'vertical' }
                ]
            },
            {
                id: 20,
                question: "____ ÊôÇÈñìÂæàÊôöÔºå____ ÊàëÂÄëÈÇÑÊòØÁÜ¨Â§ú‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'static', x: 360, y: 180, width: 50, height: 50 },
                    { type: 'moving', x: 440, y: 165, width: 40, height: 40, speed: 1.9, direction: 'vertical' }
                ]
            },
            // Á¨¨21-30ÈóúÔºöÊ∑∑ÂêàÈÇèËºØ
            {
                id: 21,
                question: "____ ÈôΩÂÖâÊôÆÁÖßÔºå____ ÊàëÂÄëÂéªÊ∏∏Ê≥≥‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 400, y: 190, width: 45, height: 45, speed: 2, direction: 'vertical' },
                    { type: 'static', x: 350, y: 175, width: 40, height: 40 }
                ]
            },
            {
                id: 22,
                question: "____ ÈÅäÊà≤ÂæàÈõ£Ôºå____ ÊàëÂÄëÈÇÑÊòØÂæà‰∫´Âèó„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'static', x: 380, y: 185, width: 50, height: 50 },
                    { type: 'moving', x: 420, y: 170, width: 35, height: 35, speed: 2.1, direction: 'vertical' }
                ]
            },
            {
                id: 23,
                question: "____ ÈõªË©±Èüø‰∫ÜÔºå____ ÊàëÊé•ËÅΩ‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 370, y: 180, width: 40, height: 40, speed: 1.7, direction: 'vertical' },
                    { type: 'moving', x: 430, y: 195, width: 40, height: 40, speed: 1.9, direction: 'vertical' }
                ]
            },
            {
                id: 24,
                question: "____ ÈõªÂΩ±ÂæàÈï∑Ôºå____ ÂÆÉÂæàÁ≤æÂΩ©„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'static', x: 400, y: 170, width: 55, height: 55 }
                ]
            },
            {
                id: 25,
                question: "____ ÈñÄÈéñ‰∫ÜÔºå____ ÊàëÂÄëÈÄ≤‰∏çÂéª„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 400, y: 200, width: 50, height: 50, speed: 1.5, direction: 'vertical' },
                    { type: 'static', x: 360, y: 175, width: 45, height: 45 },
                    { type: 'static', x: 440, y: 180, width: 45, height: 45 }
                ]
            },
            {
                id: 26,
                question: "____ ËõãÁ≥ïÂæàÁîúÔºå____ ÊàëÂêÉÂ§™Â§ö‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 380, y: 160, width: 45, height: 45, speed: 2.2, direction: 'vertical' },
                    { type: 'moving', x: 420, y: 200, width: 45, height: 45, speed: 1.8, direction: 'vertical' }
                ]
            },
            {
                id: 27,
                question: "____ Èü≥Ê®ÇÂæàÂ§ßËÅ≤Ôºå____ ÊàëÂÄëË∑≥Ëàû‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [
                    { type: 'static', x: 350, y: 190, width: 50, height: 50 },
                    { type: 'moving', x: 450, y: 175, width: 40, height: 40, speed: 2, direction: 'vertical' }
                ]
            },
            {
                id: 28,
                question: "____ ÊïÖ‰∫ãÂæàÊÇ≤ÂÇ∑Ôºå____ ÂÆÉÂæàÁæé„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 400, y: 185, width: 50, height: 50, speed: 1.6, direction: 'vertical' }
                ]
            },
            {
                id: 29,
                question: "____ ÁãóÂè´‰∫ÜÔºå____ ÊàëÈÜí‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [
                    { type: 'static', x: 380, y: 180, width: 45, height: 45 },
                    { type: 'moving', x: 420, y: 165, width: 35, height: 35, speed: 2.4, direction: 'vertical' }
                ]
            },
            {
                id: 30,
                question: "____ ÂÉπÊ†ºÂæàÈ´òÔºå____ ÊàëÂÄëÈÇÑÊòØÁúÅÈå¢‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 370, y: 190, width: 40, height: 40, speed: 1.9, direction: 'vertical' },
                    { type: 'moving', x: 430, y: 180, width: 40, height: 40, speed: 2.1, direction: 'vertical' },
                    { type: 'static', x: 400, y: 170, width: 40, height: 40 }
                ]
            },
            // Á¨¨31-40ÈóúÔºöÈÄ≤ÈöéÈÇèËºØ
            {
                id: 31,
                question: "____ ÈõªËÖ¶Áï∂Ê©ü‰∫ÜÔºå____ ÊàëÂÄëÂ§±Âéª‰∫ÜÂ∑•‰ΩúÊàêÊûú„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 400, y: 200, width: 55, height: 55, speed: 1.3, direction: 'vertical' },
                    { type: 'static', x: 360, y: 175, width: 50, height: 50 }
                ]
            },
            {
                id: 32,
                question: "____ Èõ®ÂÅú‰∫ÜÔºå____ ÊàëÂÄëÁπºÁ∫åÈáéÈ§ê„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 380, y: 165, width: 45, height: 45, speed: 2.3, direction: 'vertical' },
                    { type: 'moving', x: 420, y: 195, width: 45, height: 45, speed: 1.7, direction: 'vertical' }
                ]
            },
            {
                id: 33,
                question: "____ ÊãºÂúñÂæàË§áÈõúÔºå____ ÊàëÂÄëÈÇÑÊòØËß£Èñã‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [
                    { type: 'static', x: 400, y: 180, width: 60, height: 60 }
                ]
            },
            {
                id: 34,
                question: "____ È¨ßÈêòÈüø‰∫ÜÔºå____ ÊàëËµ∑Â∫ä‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 350, y: 190, width: 40, height: 40, speed: 2, direction: 'vertical' },
                    { type: 'static', x: 450, y: 170, width: 40, height: 40 },
                    { type: 'moving', x: 400, y: 200, width: 35, height: 35, speed: 2.5, direction: 'vertical' }
                ]
            },
            {
                id: 35,
                question: "____ Èöä‰ºçËêΩÂæå‰∫ÜÔºå____ ‰ªñÂÄëÊ≤íÊúâÊîæÊ£Ñ„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 400, y: 185, width: 50, height: 50, speed: 1.4, direction: 'vertical' }
                ]
            },
            {
                id: 36,
                question: "____ ÂÖâÁ∑öÂæà‰∫ÆÔºå____ ÊàëÈñâ‰∏ä‰∫ÜÁúºÁùõ„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'static', x: 380, y: 175, width: 45, height: 45 },
                    { type: 'moving', x: 420, y: 190, width: 40, height: 40, speed: 2.2, direction: 'vertical' }
                ]
            },
            {
                id: 37,
                question: "____ Â±±ÂæàÈô°Â≥≠Ôºå____ ÊàëÂÄëÈÇÑÊòØÁà¨‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 370, y: 180, width: 45, height: 45, speed: 1.8, direction: 'vertical' },
                    { type: 'moving', x: 430, y: 195, width: 45, height: 45, speed: 2, direction: 'vertical' }
                ]
            },
            {
                id: 38,
                question: "____ Ê∞¥ÂæàÂÜ∑Ôºå____ ÊàëÂÄëÈÇÑÊòØË∑≥ÈÄ≤Âéª‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'static', x: 400, y: 170, width: 55, height: 55 }
                ]
            },
            {
                id: 39,
                question: "____ Èà¥ËÅ≤Èüø‰∫ÜÔºå____ ‰∏ãË™≤‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 400, y: 200, width: 50, height: 50, speed: 1.5, direction: 'vertical' },
                    { type: 'static', x: 360, y: 185, width: 45, height: 45 },
                    { type: 'static', x: 440, y: 175, width: 45, height: 45 }
                ]
            },
            {
                id: 40,
                question: "____ Á¨ëË©±ÂæàËÄÅÔºå____ ÊàëÂÄëÈÇÑÊòØÁ¨ë‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 380, y: 160, width: 40, height: 40, speed: 2.4, direction: 'vertical' },
                    { type: 'moving', x: 420, y: 200, width: 40, height: 40, speed: 1.9, direction: 'vertical' }
                ]
            },
            // Á¨¨41-50ÈóúÔºöÂ∞àÂÆ∂Á¥ö
            {
                id: 41,
                question: "____ È¢®ÂæàÂ§ßÔºå____ È¢®ÁÆèÈ£õÂæóÂæàÈ´ò„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 400, y: 190, width: 55, height: 55, speed: 1.2, direction: 'vertical' },
                    { type: 'static', x: 350, y: 180, width: 50, height: 50 },
                    { type: 'moving', x: 450, y: 195, width: 40, height: 40, speed: 2.1, direction: 'vertical' }
                ]
            },
            {
                id: 42,
                question: "____ ‰ªªÂãôÂæàÁÑ°ËÅäÔºå____ ÊàëÂÄëÈÇÑÊòØÂÆåÊàê‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'static', x: 400, y: 175, width: 60, height: 60 }
                ]
            },
            {
                id: 43,
                question: "____ ÁÅ´Ë≠¶Èüø‰∫ÜÔºå____ ÊâÄÊúâ‰∫∫ÈÉΩÁñèÊï£‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 370, y: 185, width: 45, height: 45, speed: 1.7, direction: 'vertical' },
                    { type: 'moving', x: 430, y: 170, width: 45, height: 45, speed: 2.3, direction: 'vertical' }
                ]
            },
            {
                id: 44,
                question: "____ Ë∑ØÂæàÊöóÔºå____ ÊàëÂÄëÂ∞èÂøÉÂú∞Ëµ∞„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'static', x: 380, y: 190, width: 50, height: 50 },
                    { type: 'moving', x: 420, y: 165, width: 40, height: 40, speed: 2.2, direction: 'vertical' }
                ]
            },
            {
                id: 45,
                question: "____ Ê≠åÊõ≤ÂæàÊÖ¢Ôºå____ ÂÆÉÂæàÁæé„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 400, y: 200, width: 50, height: 50, speed: 1.4, direction: 'vertical' },
                    { type: 'static', x: 360, y: 175, width: 45, height: 45 },
                    { type: 'static', x: 440, y: 180, width: 45, height: 45 }
                ]
            },
            {
                id: 46,
                question: "____ ÊôÇÈêòÊï≤‰∫ÜÂçÅ‰∫å‰∏ãÔºå____ Â∑≤Á∂ìÊòØÂçàÂ§ú‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 380, y: 160, width: 45, height: 45, speed: 2.5, direction: 'vertical' },
                    { type: 'moving', x: 420, y: 200, width: 45, height: 45, speed: 1.8, direction: 'vertical' }
                ]
            },
            {
                id: 47,
                question: "____ Ê©ãÂæàËàäÔºå____ ÂÆÉÈÇÑÊòØÂÆâÂÖ®ÁöÑ„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [
                    { type: 'static', x: 400, y: 180, width: 55, height: 55 }
                ]
            },
            {
                id: 48,
                question: "____ ‰ø°ËôüÂæàÂº±Ôºå____ ÈÄöË©±Êñ∑‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 350, y: 190, width: 40, height: 40, speed: 2, direction: 'vertical' },
                    { type: 'static', x: 450, y: 170, width: 40, height: 40 },
                    { type: 'moving', x: 400, y: 195, width: 35, height: 35, speed: 2.4, direction: 'vertical' }
                ]
            },
            {
                id: 49,
                question: "____ ÊåëÊà∞ÂæàÂ§ßÔºå____ ÊàëÂÄëÈÇÑÊòØÊé•Âèó‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: true },
                    { id: 'B', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...Âõ†ÁÇ∫', correct: false },
                ],
                obstacles: [
                    { type: 'moving', x: 400, y: 185, width: 50, height: 50, speed: 1.3, direction: 'vertical' },
                    { type: 'moving', x: 370, y: 170, width: 40, height: 40, speed: 2.1, direction: 'vertical' },
                    { type: 'moving', x: 430, y: 200, width: 40, height: 40, speed: 1.9, direction: 'vertical' }
                ]
            },
            {
                id: 50,
                question: "____ ÊòüÊòüÈñÉÁàçÔºå____ ÊàëÂÄëÂéªËßÄÊòü‰∫Ü„ÄÇ",
                options: [
                    { id: 'A', text: 'Âõ†ÁÇ∫...ÊâÄ‰ª•', correct: true },
                    { id: 'B', text: 'ÈõñÁÑ∂...‰ΩÜÊòØ', correct: false },
                    { id: 'C', text: '‰ΩÜÊòØ...ÊâÄ‰ª•', correct: false },
                ],
                obstacles: [
                    { type: 'static', x: 380, y: 175, width: 50, height: 50 },
                    { type: 'moving', x: 420, y: 190, width: 45, height: 45, speed: 2, direction: 'vertical' },
                    { type: 'static', x: 360, y: 185, width: 45, height: 45 },
                    { type: 'moving', x: 440, y: 165, width: 40, height: 40, speed: 2.3, direction: 'vertical' }
                ]
            }
        ];

        const ParticleBridgeGame = () => {
            // --- Game Configuration ---
            const CANVAS_WIDTH = 800;
            const CANVAS_HEIGHT = 400;
            const CLIFF_WIDTH = 150;
            const GAP_Y_LIMIT = 400;
            const CHAR_SIZE = 30;
            const START_POS = { x: 50, y: 250 };

            // --- State Management ---
            const [currentLevel, setCurrentLevel] = useState(1);
            const [gameState, setGameState] = useState('QUIZ');
            const [quizSelection, setQuizSelection] = useState(null);
            const [drawnPath, setDrawnPath] = useState([]);
            const [characterPos, setCharacterPos] = useState(START_POS);
            const [obstacles, setObstacles] = useState([]);

            // --- Refs for Canvas & Animation ---
            const canvasRef = useRef(null);
            const requestRef = useRef(null);
            const isDrawing = useRef(false);
            const obstaclePositions = useRef([]);

            // Get current level data
            const currentLevelData = LEVELS.find(l => l.id === currentLevel) || LEVELS[0];

            // Initialize obstacles when level changes
            useEffect(() => {
                if (currentLevelData.obstacles) {
                    const initialObstacles = currentLevelData.obstacles.map(obs => ({
                        ...obs,
                        currentY: obs.y,
                        minY: obs.y - 50,
                        maxY: obs.y + 50,
                        speedDirection: obs.speed || 1
                    }));
                    obstaclePositions.current = initialObstacles;
                    setObstacles(initialObstacles);
                } else {
                    obstaclePositions.current = [];
                    setObstacles([]);
                }
            }, [currentLevel]);

            // Update obstacle positions
            useEffect(() => {
                if (gameState === 'WALKING' || gameState === 'DRAWING') {
                    const interval = setInterval(() => {
                        obstaclePositions.current = obstaclePositions.current.map(obs => {
                            if (obs.type === 'moving' && obs.direction === 'vertical') {
                                let newY = obs.currentY + obs.speedDirection;
                                if (newY >= obs.maxY) {
                                    obs.speedDirection = -Math.abs(obs.speed);
                                    newY = obs.maxY;
                                } else if (newY <= obs.minY) {
                                    obs.speedDirection = Math.abs(obs.speed);
                                    newY = obs.minY;
                                }
                                return { ...obs, currentY: newY };
                            }
                            return obs;
                        });
                        setObstacles([...obstaclePositions.current]);
                    }, 16);
                    return () => clearInterval(interval);
                }
            }, [gameState, currentLevel]);

            // --- Game Loop (The Physics Engine) ---
            const updateGame = () => {
                const ctx = canvasRef.current?.getContext('2d');
                if (!ctx) return;

                // 1. Clear Canvas
                ctx.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);

                // 2. Draw Environment (Cliffs)
                ctx.fillStyle = '#475569';
                ctx.fillRect(0, 280, CLIFF_WIDTH, CANVAS_HEIGHT - 280);
                ctx.fillRect(CANVAS_WIDTH - CLIFF_WIDTH, 280, CLIFF_WIDTH, CANVAS_HEIGHT - 280);

                // 3. Draw Obstacles
                obstaclePositions.current.forEach(obs => {
                    ctx.fillStyle = obs.type === 'moving' ? '#EF4444' : '#DC2626';
                    const y = obs.type === 'moving' ? obs.currentY : obs.y;
                    ctx.fillRect(obs.x, y, obs.width, obs.height);
                    
                    // Add danger indicator for moving obstacles
                    if (obs.type === 'moving') {
                        ctx.strokeStyle = '#FEF3C7';
                        ctx.lineWidth = 2;
                        ctx.strokeRect(obs.x - 2, y - 2, obs.width + 4, obs.height + 4);
                    }
                });

                // 4. Draw The "Magic Bridge" (User's Path)
                if (drawnPath.length > 1) {
                    ctx.beginPath();
                    ctx.moveTo(drawnPath[0].x, drawnPath[0].y);
                    for (let i = 1; i < drawnPath.length; i++) {
                        ctx.lineTo(drawnPath[i].x, drawnPath[i].y);
                    }
                    ctx.strokeStyle = '#FBBF24';
                    ctx.lineWidth = 5;
                    ctx.lineCap = 'round';
                    ctx.stroke();
                    
                    ctx.shadowBlur = 10;
                    ctx.shadowColor = '#FBBF24';
                    ctx.stroke();
                    ctx.shadowBlur = 0;
                }

                // 5. Draw Goal Flag
                ctx.fillStyle = '#10B981';
                ctx.fillRect(CANVAS_WIDTH - 80, 240, 5, 40);
                ctx.beginPath();
                ctx.moveTo(CANVAS_WIDTH - 80, 240);
                ctx.lineTo(CANVAS_WIDTH - 50, 255);
                ctx.lineTo(CANVAS_WIDTH - 80, 270);
                ctx.fill();

                // 6. Character Logic
                if (gameState === 'WALKING') {
                    let newX = characterPos.x + 2.5;
                    let newY = characterPos.y;
                    let onGround = false;

                    // Check Left Cliff Ground
                    if (newX < CLIFF_WIDTH && newY >= 250) {
                        newY = 250;
                        onGround = true;
                    }
                    // Check Right Cliff Ground
                    else if (newX > CANVAS_WIDTH - CLIFF_WIDTH && newY >= 250) {
                        newY = 250;
                        onGround = true;
                    }
                    // Check Bridge Collision
                    else {
                        const ptA = drawnPath.find((p, i) => p.x <= newX && drawnPath[i+1]?.x > newX);
                        const ptB = ptA ? drawnPath[drawnPath.indexOf(ptA) + 1] : null;

                        if (ptA && ptB) {
                            const ratio = (newX - ptA.x) / (ptB.x - ptA.x);
                            const bridgeY = ptA.y + (ptB.y - ptA.y) * ratio;

                            if (Math.abs((newY + CHAR_SIZE) - bridgeY) < 20 || newY + CHAR_SIZE < bridgeY) {
                                newY = bridgeY - CHAR_SIZE;
                                onGround = true;
                            }
                        }
                    }

                    // Check Obstacle Collision
                    const charRect = {
                        x: newX,
                        y: newY,
                        width: CHAR_SIZE,
                        height: CHAR_SIZE
                    };

                    const hitObstacle = obstaclePositions.current.some(obs => {
                        const y = obs.type === 'moving' ? obs.currentY : obs.y;
                        const obsRect = {
                            x: obs.x,
                            y: y,
                            width: obs.width,
                            height: obs.height
                        };
                        return !(charRect.x + charRect.width < obsRect.x ||
                                charRect.x > obsRect.x + obsRect.width ||
                                charRect.y + charRect.height < obsRect.y ||
                                charRect.y > obsRect.y + obsRect.height);
                    });

                    if (hitObstacle) {
                        setGameState('LOST');
                    }

                    // Gravity logic if not on ground
                    if (!onGround) {
                        newY += 6;
                    }

                    setCharacterPos({ x: newX, y: newY });

                    // Win Condition
                    if (newX > CANVAS_WIDTH - 60) {
                        setGameState('WON');
                    }

                    // Lose Condition
                    if (newY > GAP_Y_LIMIT) {
                        setGameState('LOST');
                    }
                }

                // 7. Draw Character
                ctx.fillStyle = gameState === 'WON' ? '#10B981' : '#3B82F6';
                ctx.fillRect(characterPos.x, characterPos.y, CHAR_SIZE, CHAR_SIZE);
                
                ctx.fillStyle = 'white';
                ctx.fillRect(characterPos.x + 18, characterPos.y + 5, 8, 8);
                ctx.fillStyle = 'black';
                ctx.fillRect(characterPos.x + 22, characterPos.y + 7, 4, 4);

                requestRef.current = requestAnimationFrame(updateGame);
            };

            // --- Effects ---
            useEffect(() => {
                requestRef.current = requestAnimationFrame(updateGame);
                return () => cancelAnimationFrame(requestRef.current);
            }, [gameState, characterPos, drawnPath, obstacles]);

            // --- Handlers ---
            const handleOptionClick = (option) => {
                setQuizSelection(option.id);
                if (option.correct) {
                    setGameState('DRAWING');
                } else {
                    alert("ÂÜçË©¶‰∏ÄÊ¨°ÔºÅÈÇèËºØ‰∏äË™™‰∏çÈÄö„ÄÇ");
                    setQuizSelection(null);
                }
            };

            const startDrawing = (e) => {
                if (gameState !== 'DRAWING') return;
                const rect = canvasRef.current.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                isDrawing.current = true;
                setDrawnPath([{ x, y }]);
            };

            const draw = (e) => {
                if (!isDrawing.current || gameState !== 'DRAWING') return;
                const rect = canvasRef.current.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                setDrawnPath(prev => {
                    const lastPoint = prev[prev.length - 1];
                    if (x > lastPoint.x) {
                        return [...prev, { x, y }];
                    }
                    return prev;
                });
            };

            const stopDrawing = () => {
                if (isDrawing.current) {
                    isDrawing.current = false;
                    setGameState('WALKING');
                }
            };

            const resetGame = () => {
                setGameState('QUIZ');
                setQuizSelection(null);
                setDrawnPath([]);
                setCharacterPos(START_POS);
                // Reset obstacles will be handled by useEffect when currentLevel changes
            };

            const nextLevel = () => {
                if (currentLevel < 50) {
                    setCurrentLevel(currentLevel + 1);
                    resetGame();
                }
            };

            const winHandled = useRef(false);

            useEffect(() => {
                if (gameState === 'WON' && !winHandled.current) {
                    winHandled.current = true;
                    setTimeout(() => {
                        if (currentLevel < 50) {
                            if (window.confirm(`Á¨¨ ${currentLevel} ÈóúÂÆåÊàêÔºÅÁπºÁ∫åÁ¨¨ ${currentLevel + 1} ÈóúÔºü`)) {
                                nextLevel();
                            } else {
                                resetGame();
                            }
                        } else {
                            alert('ÊÅ≠ÂñúÔºÅ‰Ω†ÂÆåÊàê‰∫ÜÊâÄÊúâ 50 ÈóúÔºÅ');
                            resetGame();
                            setCurrentLevel(1);
                        }
                        winHandled.current = false;
                    }, 1000);
                } else if (gameState !== 'WON') {
                    winHandled.current = false;
                }
            }, [gameState, currentLevel]);

            return (
                <div className="flex flex-col items-center justify-center min-h-screen bg-slate-900 text-white font-sans p-4">
                    {/* Header */}
                    <div className="max-w-3xl w-full mb-6 text-center space-y-4">
                        <div className="flex items-center justify-between mb-2">
                            <h1 className="text-3xl font-bold text-amber-400">Á•ûÁ≠ÜÈ¶¨ËâØ - ÈÇèËºØÊ©ãÊ®ë</h1>
                            <div className="text-lg font-semibold text-slate-300">
                                Á¨¨ {currentLevel} Èóú / 50
                            </div>
                        </div>
                        
                        <div className="bg-slate-800 p-6 rounded-xl border border-slate-700 shadow-lg">
                            <p className="text-xl mb-6">
                                <span className="inline-block border-b-2 border-amber-400 min-w-[120px] text-center text-amber-400">
                                    {quizSelection ? currentLevelData.options.find(o => o.id === quizSelection).text : "?"}
                                </span>
                                {' '}
                                {currentLevelData.question.split('____')[1]}
                            </p>
                            
                            <div className="flex justify-center gap-4 flex-wrap">
                                {currentLevelData.options.map((opt) => (
                                    <button
                                        key={opt.id}
                                        onClick={() => handleOptionClick(opt)}
                                        disabled={gameState !== 'QUIZ'}
                                        className={`px-6 py-2 rounded-full font-bold transition-all ${
                                            gameState !== 'QUIZ' && !opt.correct ? 'opacity-20' : 'opacity-100'
                                        } ${
                                            quizSelection === opt.id 
                                                ? opt.correct ? 'bg-green-500 hover:bg-green-600' : 'bg-red-500' 
                                                : 'bg-slate-600 hover:bg-slate-500'
                                        }`}
                                    >
                                        {opt.text}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </div>

                    {/* Game Area */}
                    <div className="relative group">
                        <canvas
                            ref={canvasRef}
                            width={CANVAS_WIDTH}
                            height={CANVAS_HEIGHT}
                            onMouseDown={startDrawing}
                            onMouseMove={draw}
                            onMouseUp={stopDrawing}
                            onMouseLeave={stopDrawing}
                            className={`bg-slate-800 rounded-lg shadow-2xl border-2 cursor-crosshair
                                ${gameState === 'DRAWING' ? 'border-amber-400 cursor-cell' : 'border-slate-700 cursor-default'}
                                ${gameState === 'WON' ? 'border-green-500' : ''}
                                ${gameState === 'LOST' ? 'border-red-500' : ''}
                            `}
                        />
                        
                        {/* Instruction Overlay */}
                        {gameState === 'DRAWING' && (
                            <div className="absolute top-4 left-1/2 transform -translate-x-1/2 bg-black/50 px-4 py-2 rounded-full text-amber-300 animate-pulse pointer-events-none">
                                ‚ú® Á•ûÁ≠ÜÂïüÂãïÔºÅÁπ™Ë£ΩÊ©ãÊ®ëÈÅøÈñãÈöúÁ§ôÁâ©ÔºÅ‚ú®
                            </div>
                        )}

                        {/* Game Over / Win Overlay */}
                        {(gameState === 'WON' || gameState === 'LOST') && (
                            <div className="absolute inset-0 flex items-center justify-center bg-black/60 rounded-lg">
                                <div className="text-center">
                                    <h2 className={`text-4xl font-bold mb-2 ${gameState === 'WON' ? 'text-green-400' : 'text-red-400'}`}>
                                        {gameState === 'WON' ? 'ÈóúÂç°ÂÆåÊàêÔºÅ' : 'Ê©ãÊ®ëÂÄíÂ°åÔºÅ'}
                                    </h2>
                                    <div className="flex gap-4 justify-center mt-4">
                                        <button 
                                            onClick={resetGame}
                                            className="bg-white text-slate-900 px-6 py-2 rounded-full font-bold hover:bg-gray-200"
                                        >
                                            ÈáçË©¶ÈóúÂç°
                                        </button>
                                        {gameState === 'WON' && currentLevel < 50 && (
                                            <button 
                                                onClick={nextLevel}
                                                className="bg-green-500 text-white px-6 py-2 rounded-full font-bold hover:bg-green-600"
                                            >
                                                ‰∏ã‰∏ÄÈóú
                                            </button>
                                        )}
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>

                    <p className="mt-4 text-slate-500 text-sm">
                        Á¨¨ {Math.ceil(currentLevel / 10)} ÈöéÊÆµÔºöÈÇèËºØÁ≤íÂ≠êÊåëÊà∞
                    </p>
                </div>
            );
        };

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<ParticleBridgeGame />);
    </script>
</body>
</html>
