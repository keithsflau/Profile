<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>General Studies - Mosquito Control</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <style>
      body {
        font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
        background: #ecfccb;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Mosquito Buster",
          zh: "æ»…èšŠç‰¹å·¥",
          ja: "èšŠãƒã‚¹ã‚¿ãƒ¼",
          ko: "ëª¨ê¸° ë²„ìŠ¤í„°",
          es: "Cazador de mosquitos",
          de: "MÃ¼ckenjÃ¤ger",
          fi: "Hyttysentorjuja",
          fr: "Chasseur de moustiques",
          ar: "ØµØ§Ø¦Ø¯ Ø§Ù„Ø¨Ø¹ÙˆØ¶",
          it: "Cacciatore di Zanzare",
        },
        instruction: {
          en: "Remove stagnant water to stop breeding!",
          zh: "æ¸…é™¤ç©æ°´ï¼Œæœçµ•æ»‹ç”Ÿï¼",
          ja: "æºœã¾ã£ãŸæ°´ã‚’å–ã‚Šé™¤ãã€ç¹æ®–ã‚’é˜²ã”ã†ï¼",
          ko: "ê³ ì¸ ë¬¼ì„ ì œê±°í•˜ì—¬ ë²ˆì‹ì„ ë§‰ìœ¼ì„¸ìš”!",
          es: "Â¡Elimina el agua estancada para detener la crÃ­a!",
          de: "Entferne stehendes Wasser, um die Brut zu stoppen!",
          fi: "Poista seisova vesi estÃ¤Ã¤ksesi lisÃ¤Ã¤ntymisen!",
          fr: "Enlevez l'eau stagnante pour arrÃªter la reproduction !",
          ar: "Ù‚Ù… Ø¨Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…ÙŠØ§Ù‡ Ø§Ù„Ø±Ø§ÙƒØ¯Ø© Ù„ÙˆÙ‚Ù Ø§Ù„ØªÙƒØ§Ø«Ø±!",
          it: "Rimuovi l'acqua stagnante per fermare la riproduzione!",
        },
        clear: {
          en: "Clear Water",
          zh: "å€’æŽ‰ç©æ°´",
          ja: "æ°´ã‚’æ¨ã¦ã‚‹",
          ko: "ë¬¼ ë¹„ìš°ê¸°",
        },
        clean: {
          en: "All Clean!",
          zh: "å…¨éƒ¨æ¸…ç†ä¹¾æ·¨ï¼",
          ja: "ã™ã¹ã¦ãã‚Œã„ï¼",
          ko: "ëª¨ë‘ ê¹¨ë—í•´ìš”!",
        },
      };

      function App() {
        const [lang, setLang] = useState("zh");
        const [items, setItems] = useState([
          { id: 1, x: 20, y: 60, type: "pot", cleared: false },
          { id: 2, x: 50, y: 70, type: "tire", cleared: false },
          { id: 3, x: 80, y: 55, type: "bottle", cleared: false },
          { id: 4, x: 30, y: 80, type: "can", cleared: false },
        ]);

        const getText = (key) => t[key][lang] || t[key]["en"];

        const handleClear = (id) => {
          setItems((prev) =>
            prev.map((i) => (i.id === id ? { ...i, cleared: true } : i))
          );
        };

        const icons = {
          pot: "ðŸº",
          tire: "âš«", // tire proxy
          bottle: "ðŸ¾",
          can: "ðŸ¥«",
        };

        const allCleared = items.every((i) => i.cleared);

        return (
          <div className="min-h-screen flex flex-col items-center p-4">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl font-bold mb-8 text-lime-800">
              {getText("title")}
            </h1>
            <p className="mb-4 font-bold text-slate-500">
              {getText("instruction")}
            </p>

            <div className="relative w-full max-w-3xl aspect-video bg-gradient-to-b from-sky-200 to-lime-200 rounded-3xl border-4 border-lime-500 shadow-2xl overflow-hidden mx-auto">
              {/* Grass */}
              <div className="absolute bottom-0 w-full h-1/3 bg-lime-600"></div>

              {/* Items */}
              {items.map(
                (item) =>
                  !item.cleared && (
                    <div
                      key={item.id}
                      onClick={() => handleClear(item.id)}
                      className="absolute cursor-pointer hover:scale-110 transiton-transform"
                      style={{ left: `${item.x}%`, top: `${item.y}%` }}
                    >
                      <div className="text-6xl relative">
                        {icons[item.type]}
                        {/* Water drop overlay */}
                        <div className="absolute top-0 right-0 text-blue-500 animate-bounce text-2xl">
                          ðŸ’§
                        </div>
                        <div className="absolute -top-4 -right-4 text-xs bg-red-500 text-white px-2 py-1 rounded-full animate-pulse">
                          ðŸ¦Ÿ
                        </div>
                      </div>
                    </div>
                  )
              )}

              {allCleared && (
                <div className="absolute inset-0 bg-black/50 flex items-center justify-center">
                  <motion.div
                    initial={{ scale: 0 }}
                    animate={{ scale: 1 }}
                    className="bg-white p-8 rounded-3xl text-4xl font-black text-green-600 border-4 border-green-500"
                  >
                    âœ¨ {getText("clean")} âœ¨
                  </motion.div>
                </div>
              )}
            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
