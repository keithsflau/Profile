<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>General Studies - Ear Anatomy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <style>
      body {
        font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
        background: #f0fdf4;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Inside the Ear",
          zh: "耳朵內部構造",
          ja: "耳の内部",
          ko: "귀의 내부",
          es: "Dentro del oído",
          de: "Im Ohr",
          fi: "Korvan sisällä",
          fr: "À l'intérieur de l'oreille",
          ar: "داخل الأذن",
          it: "Dentro l'Orecchio",
        },
        instruction: {
          en: "Identify parts of the ear.",
          zh: "辨認耳朵的部位。",
          ja: "耳の部分を特定してください。",
          ko: "귀의 부위를 식별하세요.",
          es: "Identifica las partes del oído.",
          de: "Identifiziere Teile des Ohres.",
          fi: "Tunnista korvan osat.",
          fr: "Identifiez les parties de l'oreille.",
          ar: "حدد أجزاء الأذن.",
          it: "Identifica le parti dell'orecchio.",
        },
        outer: { en: "Outer Ear", zh: "外耳", ja: "外耳", ko: "외이" },
        drum: { en: "Eardrum", zh: "耳膜", ja: "鼓膜", ko: "고막" },
        bones: { en: "Ear Bones", zh: "聽小骨", ja: "耳小骨", ko: "이소골" },
        cochlea: { en: "Cochlea", zh: "耳蝸", ja: "蝸牛", ko: "와우각" },
        nerve: {
          en: "Auditory Nerve",
          zh: "聽神經",
          ja: "聴神経",
          ko: "청신경",
        },

        correct: { en: "Correct!", zh: "正確！", ja: "正解！", ko: "정답!" },
      };

      const parts = [
        { id: "outer", x: 15, y: 50 },
        { id: "drum", x: 40, y: 50 },
        { id: "bones", x: 55, y: 40 },
        { id: "cochlea", x: 75, y: 50 },
        { id: "nerve", x: 90, y: 50 },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [placed, setPlaced] = useState([]);

        const getText = (key) => t[key][lang] || t[key]["en"];

        const handleDrop = (e, targetId) => {
          e.preventDefault();
          const draggedId = e.dataTransfer.getData("id");
          if (draggedId === targetId) {
            setPlaced([...placed, targetId]);
          }
        };

        return (
          <div className="min-h-screen flex flex-col items-center p-4">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl font-bold mb-8 text-emerald-800">
              {getText("title")}
            </h1>
            <p className="mb-8 font-bold text-slate-500">
              {getText("instruction")}
            </p>

            <div className="flex flex-col md:flex-row gap-8 w-full max-w-5xl items-start">
              {/* Visual */}
              <div className="relative w-[500px] h-[300px] bg-white rounded-3xl shadow-xl border-4 border-emerald-200 mx-auto">
                {/* Ear SVG */}
                <svg
                  viewBox="0 0 200 120"
                  className="absolute inset-0 w-full h-full"
                >
                  {/* Outer Ear / Canal */}
                  <path
                    d="M10,20 Q40,20 40,50 L40,70 L10,70"
                    fill="none"
                    stroke="#fca5a5"
                    strokeWidth="4"
                  />
                  <line
                    x1="40"
                    y1="60"
                    x2="80"
                    y2="60"
                    stroke="#fca5a5"
                    strokeWidth="8"
                  />{" "}
                  {/* Canal */}
                  {/* Eardrum */}
                  <line
                    x1="80"
                    y1="50"
                    x2="80"
                    y2="70"
                    stroke="#ef4444"
                    strokeWidth="2"
                  />
                  {/* Bones (Malleus, Incus, Stapes conceptual) */}
                  <path
                    d="M82,55 L95,45 L110,55"
                    fill="none"
                    stroke="#d1d5db"
                    strokeWidth="3"
                  />
                  {/* Cochlea (Snail) */}
                  <path
                    d="M120,60 Q130,30 140,60 T150,60"
                    fill="none"
                    stroke="#10b981"
                    strokeWidth="8"
                    strokeLinecap="round"
                  />
                  {/* Nerve */}
                  <line
                    x1="150"
                    y1="60"
                    x2="190"
                    y2="60"
                    stroke="#fbbf24"
                    strokeWidth="4"
                    strokeDasharray="4"
                  />
                </svg>

                {/* Drop Zones */}
                {parts.map((p) => (
                  <div
                    key={p.id}
                    onDragOver={(e) => e.preventDefault()}
                    onDrop={(e) => handleDrop(e, p.id)}
                    className={`absolute w-20 h-8 -translate-x-1/2 -translate-y-1/2 border-2 border-dashed border-emerald-400 rounded flex items-center justify-center text-xs font-bold transition-colors
                            ${
                              placed.includes(p.id)
                                ? "bg-green-100 border-green-500 text-green-800"
                                : "bg-white/50"
                            }
                         `}
                    style={{ left: `${p.x}%`, top: `${p.y}%` }}
                  >
                    {placed.includes(p.id) ? getText(p.id) : "?"}
                  </div>
                ))}
              </div>

              {/* Tags */}
              <div className="flex flex-wrap gap-4 w-full md:w-64">
                {parts.map(
                  (p) =>
                    !placed.includes(p.id) && (
                      <div
                        key={p.id}
                        draggable
                        onDragStart={(e) => e.dataTransfer.setData("id", p.id)}
                        className="bg-emerald-100 hover:bg-emerald-200 text-emerald-900 px-4 py-2 rounded-lg cursor-grab font-bold border border-emerald-300 w-full text-center"
                      >
                        {getText(p.id)}
                      </div>
                    )
                )}
                {placed.length === parts.length && (
                  <div className="text-2xl font-black text-green-500 animate-bounce w-full text-center">
                    {getText("correct")}
                  </div>
                )}
              </div>
            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  
      
      <!-- Footer -->
      <footer class="text-center py-4 text-slate-500 text-sm">
        <p class="italic mb-1">
          But God made the earth by his power; he founded the world by his wisdom and stretched out the heavens by his
          understanding. Jeremiah 10:12
        </p>
        <p class="text-xs mb-1 mt-2">
          「耶和華用能力創造大地，用智慧建立世界，用聰明鋪張穹蒼。」 耶利米書 10:12
        </p>
        <p class="text-xs mt-2 pt-2 border-t border-slate-300">
          @ 2025 Education Engineering Portfolio | Generated by Gemini Pro 3.0 | Prepared by SF Lau
        </p>
      </footer>
</body>
</html>
