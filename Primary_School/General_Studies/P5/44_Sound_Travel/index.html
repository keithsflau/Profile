<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>General Studies - Sound Travel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <style>
      body {
        font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
        background: #fdf2f8;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Sound Traveler",
          zh: "è²éŸ³å‚³æ’­è€…",
          ja: "éŸ³ã®æ—…äºº",
          ko: "ì†Œë¦¬ ì—¬í–‰ìž",
          es: "Viajero del sonido",
          de: "Schallreisender",
          fi: "Ã„Ã¤nimatkailija",
          fr: "Voyageur sonore",
          ar: "Ù…Ø³Ø§ÙØ± Ø§Ù„ØµÙˆØª",
          it: "Viaggiatore del Suono",
        },
        instruction: {
          en: "Tap to see how fast sound travels!",
          zh: "é»žæ“ŠæŸ¥çœ‹è²éŸ³å‚³æ’­çš„é€Ÿåº¦ï¼",
          ja: "ã‚¿ãƒƒãƒ—ã—ã¦ã€éŸ³ãŒã©ã‚Œãã‚‰ã„é€Ÿãä¼ã‚ã‚‹ã‹è¦‹ã¦ã¿ã‚ˆã†ï¼",
          ko: "íƒ­í•˜ì—¬ ì†Œë¦¬ê°€ ì–¼ë§ˆë‚˜ ë¹¨ë¦¬ ì´ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”!",
          es: "Â¡Toca para ver quÃ© tan rÃ¡pido viaja el sonido!",
          de: "Tippe, um zu sehen, wie schnell der Schall reist!",
          fi: "Napauta nÃ¤hdÃ¤ksesi kuinka nopeasti Ã¤Ã¤ni kulkee!",
          fr: "Tapez pour voir Ã  quelle vitesse le son voyage !",
          ar: "Ø§Ø¶ØºØ· Ù„ØªØ±Ù‰ Ù…Ø¯Ù‰ Ø³Ø±Ø¹Ø© Ø§Ù†ØªÙ‚Ø§Ù„ Ø§Ù„ØµÙˆØª!",
          it: "Tocca per vedere quanto velocemente viaggia il suono!",
        },
        solid: {
          en: "Solid (Metal)",
          zh: "å›ºé«” (é‡‘å±¬)",
          ja: "å›ºä½“ (é‡‘å±ž)",
          ko: "ê³ ì²´ (ê¸ˆì†)",
        },
        liquid: {
          en: "Liquid (Water)",
          zh: "æ¶²é«” (æ°´)",
          ja: "æ¶²ä½“ (æ°´)",
          ko: "ì•¡ì²´ (ë¬¼)",
        },
        gas: {
          en: "Gas (Air)",
          zh: "æ°£é«” (ç©ºæ°£)",
          ja: "æ°—ä½“ (ç©ºæ°—)",
          ko: "ê¸°ì²´ (ê³µê¸°)",
        },

        fastest: {
          en: "Fastest!",
          zh: "æœ€å¿«ï¼",
          ja: "æœ€é€Ÿï¼",
          ko: "ê°€ìž¥ ë¹ ë¦„!",
        },
        slowest: { en: "Slowest", zh: "æœ€æ…¢", ja: "æœ€ã‚‚é…ã„", ko: "ê°€ìž¥ ëŠë¦¼" },
      };

      const mediums = [
        { id: "solid", speed: 0.5, particles: "dense" }, // 0.5s duration
        { id: "liquid", speed: 1.5, particles: "medium" },
        { id: "gas", speed: 3.0, particles: "sparse" },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [playing, setPlaying] = useState(null);

        const getText = (key) => t[key][lang] || t[key]["en"];

        const play = (m) => {
          setPlaying(null);
          setTimeout(() => setPlaying(m), 50);
        };

        return (
          <div className="min-h-screen flex flex-col items-center p-4">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl font-bold mb-8 text-pink-700">
              {getText("title")}
            </h1>
            <p className="mb-8 font-bold text-slate-500">
              {getText("instruction")}
            </p>

            <div className="w-full max-w-2xl flex flex-col gap-6">
              {mediums.map((m) => (
                <div
                  key={m.id}
                  className="relative bg-white p-4 rounded-xl shadow border-2 border-pink-100 overflow-hidden"
                >
                  <div className="flex justify-between items-center mb-4 relative z-10">
                    <div className="font-bold text-xl text-slate-700">
                      {getText(m.id)}
                    </div>
                    <button
                      onClick={() => play(m)}
                      className="w-10 h-10 bg-pink-500 text-white rounded-full flex items-center justify-center shadow hover:scale-110 transition-transform"
                    >
                      ðŸ”Š
                    </button>
                  </div>

                  {/* Particle Track */}
                  <div className="h-16 bg-slate-100 rounded-lg relative overflow-hidden flex items-center px-2">
                    {/* Static Particles Background */}
                    <div className="absolute inset-0 flex flex-wrap gap-1 p-2 opacity-30">
                      {Array.from({
                        length:
                          m.particles === "dense"
                            ? 100
                            : m.particles === "medium"
                            ? 40
                            : 10,
                      }).map((_, i) => (
                        <div
                          key={i}
                          className="w-2 h-2 bg-slate-500 rounded-full"
                        ></div>
                      ))}
                    </div>

                    {/* Sound Wave */}
                    {playing && playing.id === m.id && (
                      <motion.div
                        className="absolute left-0 h-full w-4 bg-pink-500/50 blur-md"
                        initial={{ left: 0 }}
                        animate={{ left: "100%" }}
                        transition={{ duration: m.speed, ease: "linear" }}
                      ></motion.div>
                    )}
                  </div>

                  {m.id === "solid" && (
                    <div className="text-xs text-right mt-1 text-green-500 font-bold">
                      {getText("fastest")}
                    </div>
                  )}
                  {m.id === "gas" && (
                    <div className="text-xs text-right mt-1 text-orange-500 font-bold">
                      {getText("slowest")}
                    </div>
                  )}
                </div>
              ))}
            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
