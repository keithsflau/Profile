<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>General Studies - Carbon Footprint</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <style>
      body {
        font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
        background: #fdf4ff;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Carbon Footprint Calculator",
          zh: "ç¢³è¶³è·¡è¨ˆç®—å™¨",
          ja: "äºŒé…¸åŒ–ç‚­ç´ æŽ’å‡ºé‡è¨ˆç®—æ©Ÿ",
          ko: "íƒ„ì†Œ ë°œìžêµ­ ê³„ì‚°ê¸°",
          es: "Calculadora de huella de carbono",
          de: "CO2-FuÃŸabdruck-Rechner",
          fi: "HiilijalanjÃ¤lkilaskuri",
          fr: "Calculateur d'empreinte carbone",
          ar: "Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¨ØµÙ…Ø© Ø§Ù„ÙƒØ±Ø¨ÙˆÙ†ÙŠØ©",
          it: "Calcolatore Impronta Carbonio",
        },
        instruction: {
          en: "Calculate your estimated yearly CO2 usage.",
          zh: "è¨ˆç®—ä½ é è¨ˆçš„å¹´åº¦äºŒæ°§åŒ–ç¢³æŽ’æ”¾é‡ã€‚",
          ja: "æŽ¨å®šå¹´é–“CO2ä½¿ç”¨é‡ã‚’è¨ˆç®—ã—ã¾ã™ã€‚",
          ko: "ì˜ˆìƒ ì—°ê°„ CO2 ì‚¬ìš©ëŸ‰ì„ ê³„ì‚°í•˜ì„¸ìš”.",
          es: "Calcula tu uso anual estimado de CO2.",
          de: "Berechne deinen geschÃ¤tzten jÃ¤hrlichen CO2-Verbrauch.",
          fi: "Laske arvioitu vuotuinen CO2-kÃ¤yttÃ¶si.",
          fr: "Calculez votre consommation annuelle estimÃ©e de CO2.",
          ar: "Ø§Ø­Ø³Ø¨ Ø§Ø³ØªÙ‡Ù„Ø§ÙƒÙƒ Ø§Ù„Ø³Ù†ÙˆÙŠ Ø§Ù„Ù…Ù‚Ø¯Ø± Ù…Ù† Ø«Ø§Ù†ÙŠ Ø£ÙƒØ³ÙŠØ¯ Ø§Ù„ÙƒØ±Ø¨ÙˆÙ†.",
          it: "Calcola il consumo annuo stimato di CO2.",
        },
        transport: {
          en: "Transport (Car/Bus/MTR)",
          zh: "äº¤é€š (æ±½è»Š/å·´å£«/æ¸¯éµ)",
          ja: "äº¤é€š (è»Š/ãƒã‚¹/åœ°ä¸‹é‰„)",
          ko: "êµí†µ (ìžë™ì°¨/ë²„ìŠ¤/ì§€í•˜ì² )",
          es: "Transporte",
          de: "Verkehr",
          fi: "Liikenne",
          fr: "Transport",
          ar: "Ù†Ù‚Ù„",
          it: "Trasporti",
        },
        diet: {
          en: "Diet (Meat vs Veg)",
          zh: "é£²é£Ÿ (è‚‰é¡ž vs è”¬èœ)",
          ja: "é£Ÿäº‹ (è‚‰ vs é‡Žèœ)",
          ko: "ì‹ë‹¨ (ê³ ê¸° vs ì±„ì†Œ)",
          es: "Dieta",
          de: "ErnÃ¤hrung",
          fi: "Ruokavalio",
          fr: "RÃ©gime alimentaire",
          ar: "Ù†Ø¸Ø§Ù… ØºØ°Ø§Ø¦ÙŠ",
          it: "Dieta",
        },
        energy: {
          en: "Home Electricity",
          zh: "å®¶å±…ç”¨é›»",
          ja: "å®¶åº­ç”¨é›»æ°—",
          ko: "ê°€ì •ìš© ì „ê¸°",
          es: "Electricidad del hogar",
          de: "Hausstrom",
          fi: "Kodin sÃ¤hkÃ¶",
          fr: "Ã‰lectricitÃ© domestique",
          ar: "ÙƒÙ‡Ø±Ø¨Ø§Ø¡ Ø§Ù„Ù…Ù†Ø²Ù„",
          it: "ElettricitÃ  Casa",
        },

        result: {
          en: "Total CO2:",
          zh: "ç¸½äºŒæ°§åŒ–ç¢³ï¼š",
          ja: "ç·CO2ï¼š",
          ko: "ì´ CO2:",
          es: "CO2 total:",
          de: "Gesamt-CO2:",
          fi: "CO2 yhteensÃ¤:",
          fr: "Total CO2 :",
          ar: "Ø¥Ø¬Ù…Ø§Ù„ÙŠ CO2:",
          it: "CO2 Totale:",
        },
        offset: {
          en: "Trees needed to offset:",
          zh: "éœ€è¦ç¨®æ¤çš„æ¨¹æœ¨ï¼š",
          ja: "ç›¸æ®ºã«å¿…è¦ãªæœ¨ï¼š",
          ko: "ìƒì‡„ì— í•„ìš”í•œ ë‚˜ë¬´:",
          es: "Ãrboles necesarios para compensar:",
          de: "BÃ¤ume zum Ausgleich:",
          fi: "Puita tarvitaan kompensoimaan:",
          fr: "Arbres nÃ©cessaires pour compenser :",
          ar: "Ø§Ù„Ø£Ø´Ø¬Ø§Ø± Ø§Ù„Ù„Ø§Ø²Ù…Ø© Ù„Ù„ØªØ¹ÙˆÙŠØ¶:",
          it: "Alberi necessari per compensare:",
        },
        tons: { en: "tons", zh: "å™¸", ja: "ãƒˆãƒ³", ko: "í†¤" },
      };

      function App() {
        const [lang, setLang] = useState("zh");
        const [transport, setTransport] = useState(2); // 0-5 scale
        const [diet, setDiet] = useState(2); // 0 (Vegan) - 5 (Heavy Meat)
        const [energy, setEnergy] = useState(2); // 0-5

        const getText = (key) => t[key][lang] || t[key]["en"];

        // Approx Calc (tons per year)
        // Transport: 0 -> 0.5t (Walk/Bike), 5 -> 5t (SUV daily)
        // Diet: 0 -> 1t, 5 -> 3t
        // Energy: 0 -> 0.5t, 5 -> 4t

        const co2 =
          transport * 0.9 + 0.5 + (diet * 0.4 + 1) + (energy * 0.7 + 0.5);
        const trees = Math.ceil(co2 * 6); // Approx 6 trees remove 1 ton CO2 in lifetime? Or per year? Let's say 1 tree absorbs ~20kg/year. So 50 trees for 1 ton. That's a lot visually. Let's say "Trees needed to plant" scaling down for kid UI. Let's display visual trees.

        return (
          <div className="min-h-screen flex flex-col items-center p-4">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl font-bold mb-8 text-slate-700">
              ðŸ‘£ {getText("title")}
            </h1>

            <div className="w-full max-w-2xl bg-white p-8 rounded-3xl shadow-xl flex flex-col gap-8">
              {/* Sliders */}
              <InputRow
                label={getText("transport")}
                value={transport}
                setValue={setTransport}
                icon="ðŸš—"
                minLabel="Walk"
                maxLabel="Drive"
              />
              <InputRow
                label={getText("diet")}
                value={diet}
                setValue={setDiet}
                icon="ðŸ–"
                minLabel="Veg"
                maxLabel="Meat"
              />
              <InputRow
                label={getText("energy")}
                value={energy}
                setValue={setEnergy}
                icon="ðŸ’¡"
                minLabel="Low"
                maxLabel="High"
              />

              {/* Result */}
              <div className="bg-slate-50 p-6 rounded-2xl border-t-4 border-slate-300">
                <div className="flex justify-between items-center mb-4">
                  <span className="text-xl font-bold text-slate-600">
                    {getText("result")}
                  </span>
                  <span className="text-4xl font-black text-slate-800">
                    {co2.toFixed(1)} {getText("tons")}
                  </span>
                </div>

                {/* Footprint Visual */}
                <div className="w-full flex justify-center py-4">
                  <div
                    className="bg-black/80 mask-footprint w-20 transition-all duration-500 rounded-full"
                    style={{
                      height: `${co2 * 20}px`,
                      width: `${co2 * 10}px`,
                      opacity: 0.1 + co2 / 12,
                    }}
                  ></div>
                  {/* Using simpler visual: Circle size */}
                  <div
                    className="bg-gray-800 rounded-full flex items-center justify-center text-white font-bold transition-all duration-500"
                    style={{
                      width: `${Math.max(50, co2 * 30)}px`,
                      height: `${Math.max(50, co2 * 30)}px`,
                    }}
                  >
                    CO2
                  </div>
                </div>

                <div className="mt-4">
                  <div className="font-bold text-green-700 mb-2">
                    {getText("offset")}
                  </div>
                  <div className="flex flex-wrap gap-1">
                    {[...Array(trees)].map((_, i) => (
                      <motion.span
                        key={i}
                        initial={{ scale: 0 }}
                        animate={{ scale: 1 }}
                        transition={{ delay: i * 0.05 }}
                        className="text-xl"
                      >
                        ðŸŒ³
                      </motion.span>
                    ))}
                  </div>
                </div>
              </div>
            </div>
          </div>
        );
      }

      function InputRow({ label, value, setValue, icon, minLabel, maxLabel }) {
        return (
          <div>
            <div className="flex items-center gap-2 font-bold text-slate-700 mb-2 text-lg">
              <span className="text-2xl">{icon}</span> {label}
            </div>
            <input
              type="range"
              min="0"
              max="5"
              step="1"
              value={value}
              onChange={(e) => setValue(Number(e.target.value))}
              className="w-full h-4 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-purple-600"
            />
            <div className="flex justify-between text-xs text-slate-400 font-bold uppercase mt-1">
              <span>{minLabel}</span>
              <span>{maxLabel}</span>
            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
