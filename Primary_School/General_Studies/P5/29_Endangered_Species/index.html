<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>General Studies - Endangered Species</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <style>
      body {
        font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
        background: #f0fdfa;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Protect Local Species",
          zh: "ä¿è­·æœ¬åœ°ç‰©ç¨®",
          ja: "åœ°å…ƒã®ç¨®ã‚’ä¿è­·",
          ko: "ì§€ì—­ ìƒë¬¼ ë³´í˜¸",
          es: "Proteger las especies locales",
          de: "SchÃ¼tze lokale Arten",
          fi: "Suojele paikallisia lajeja",
          fr: "ProtÃ©ger les espÃ¨ces locales",
          ar: "Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø­Ù„ÙŠØ©",
          it: "Proteggi le Specie Locali",
        },
        instruction: {
          en: "Find the endangered species hidden in Hong Kong!",
          zh: "æ‰¾å‡ºéš±è—åœ¨é¦™æ¸¯çš„ç€•å±ç‰©ç¨®ï¼",
          ja: "é¦™æ¸¯ã«éš ã‚Œã¦ã„ã‚‹çµ¶æ»…å±æƒ§ç¨®ã‚’è¦‹ã¤ã‘ã‚ˆã†ï¼",
          ko: "í™ì½©ì— ìˆ¨ê²¨ì§„ ë©¸ì¢… ìœ„ê¸° ì¢…ì„ ì°¾ìœ¼ì„¸ìš”!",
          es: "Â¡Encuentra las especies en peligro de extinciÃ³n en Hong Kong!",
          de: "Finde die gefÃ¤hrdeten Arten in Hongkong!",
          fi: "Etsi uhanalaiset lajit Hongkongista!",
          fr: "Trouvez les espÃ¨ces menacÃ©es cachÃ©es Ã  Hong Kong !",
          ar: "Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ù‡Ø¯Ø¯Ø© Ø¨Ø§Ù„Ø§Ù†Ù‚Ø±Ø§Ø¶ Ø§Ù„Ù…Ø®ÙÙŠØ© ÙÙŠ Ù‡ÙˆÙ†Øº ÙƒÙˆÙ†Øº!",
          it: "Trova le specie in via di estinzione nascoste a Hong Kong!",
        },
        dolphin: {
          en: "Chinese White Dolphin",
          zh: "ä¸­è¯ç™½æµ·è±š",
          ja: "ã‚·ãƒŠã‚¦ã‚¹ã‚¤ãƒ­ã‚¤ãƒ«ã‚«",
          ko: "ì¤‘í™”í°ëŒê³ ëž˜",
        },
        frog: {
          en: "Romer's Tree Frog",
          zh: "ç›§æ°å°æ¨¹è›™",
          ja: "ãƒ­ãƒžãƒ¼ã‚ºãƒ„ãƒªãƒ¼ãƒ•ãƒ­ãƒƒã‚°",
          ko: "ë¡œë¨¸ ì²­ê°œêµ¬ë¦¬",
        },
        pangolin: {
          en: "Pangolin",
          zh: "ç©¿å±±ç”²",
          ja: "ã‚»ãƒ³ã‚¶ãƒ³ã‚³ã‚¦",
          ko: "ì²œì‚°ê°‘",
        },

        found: {
          en: "Found!",
          zh: "ç™¼ç¾äº†ï¼",
          ja: "è¦‹ã¤ã‘ãŸï¼",
          ko: "ì°¾ì•˜ë‹¤!",
        },
      };

      const animals = [
        { id: "dolphin", icon: "ðŸ¬", bg: "bg-sky-200" },
        { id: "frog", icon: "ðŸ¸", bg: "bg-green-800" },
        { id: "pangolin", icon: "ðŸ¦Ž", bg: "bg-stone-500" },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [found, setFound] = useState([]);

        const getText = (key) => t[key][lang] || t[key]["en"];

        const find = (id) => {
          if (!found.includes(id)) setFound([...found, id]);
        };

        return (
          <div className="min-h-screen flex flex-col items-center p-4">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl font-bold mb-8 text-teal-800">
              {getText("title")}
            </h1>
            <p className="mb-4 font-bold text-slate-500">
              {getText("instruction")}
            </p>

            <div className="grid grid-cols-1 md:grid-cols-3 gap-8 w-full max-w-5xl">
              {animals.map((a) => (
                <div
                  key={a.id}
                  onClick={() => find(a.id)}
                  className={`h-64 rounded-3xl relative overflow-hidden cursor-pointer shadow-xl hover:scale-105 transition-transform ${a.bg} border-4 border-white`}
                >
                  {/* Foliage / Waves cover */}
                  <div className="absolute inset-0 opacity-80 flex flex-wrap gap-2 content-center justify-center pointer-events-none">
                    {Array.from({ length: 20 }).map((_, i) => (
                      <div key={i} className="text-4xl opacity-50">
                        ðŸŒ¿
                      </div>
                    ))}
                  </div>

                  {/* Animal (Hidden mostly) */}
                  <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-8xl">
                    {a.icon}
                  </div>

                  {/* Revealed Overlay */}
                  {found.includes(a.id) && (
                    <div className="absolute inset-0 bg-white/90 flex flex-col items-center justify-center p-4 text-center">
                      <div className="text-6xl mb-2">{a.icon}</div>
                      <div className="font-bold text-teal-900 text-xl">
                        {getText(a.id)}
                      </div>
                      <div className="text-green-500 font-bold mt-2">
                        âœ“ {getText("found")}
                      </div>
                    </div>
                  )}
                </div>
              ))}
            </div>

            <div className="mt-8 font-bold text-slate-400">
              Found: {found.length} / {animals.length}
            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
