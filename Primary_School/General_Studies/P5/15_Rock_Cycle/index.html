<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>General Studies - Rock Cycle</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <style>
      body {
        font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
        background: #44403c;
        color: white;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "The Rock Cycle",
          zh: "Â≤©Áü≥Âæ™Áí∞",
          ja: "Â≤©Áü≥„É™„Çµ„Ç§„ÇØ„É´",
          ko: "ÏïîÏÑùÏùò ÏàúÌôò",
          es: "El ciclo de las rocas",
          de: "Der Gesteinskreislauf",
          fi: "Kivien kiertokulku",
          fr: "Le cycle des roches",
          ar: "ÿØŸàÿ±ÿ© ÿßŸÑÿµÿÆŸàÿ±",
          it: "Il Ciclo delle Rocce",
        },
        instruction: {
          en: "Explore how rocks change over time.",
          zh: "Êé¢Á¥¢Â≤©Áü≥Èö®ÊôÇÈñìËÆäÂåñÁöÑÈÅéÁ®ã„ÄÇ",
          ja: "Â≤©Áü≥„ÅåÊôÇÈñì„Å®„Å®„ÇÇ„Å´„Å©„ÅÆ„Çà„ÅÜ„Å´Â§âÂåñ„Åô„Çã„ÅãË™ø„Åπ„Å¶„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ",
          ko: "ÏãúÍ∞ÑÏù¥ ÏßÄÎÇ®Ïóê Îî∞Îùº ÏïîÏÑùÏù¥ Ïñ¥ÎñªÍ≤å Î≥ÄÌïòÎäîÏßÄ ÏïåÏïÑÎ≥¥ÏÑ∏Ïöî.",
          es: "Explora c√≥mo cambian las rocas con el tiempo.",
          de: "Erforsche, wie sich Gesteine im Laufe der Zeit ver√§ndern.",
          fi: "Tutki, miten kivet muuttuvat ajan my√∂t√§.",
          fr: "D√©couvrez comment les roches changent avec le temps.",
          ar: "ÿßÿ≥ÿ™ŸÉÿ¥ŸÅ ŸÉŸäŸÅ ÿ™ÿ™ÿ∫Ÿäÿ± ÿßŸÑÿµÿÆŸàÿ± ÿ®ŸÖÿ±Ÿàÿ± ÿßŸÑŸàŸÇÿ™.",
          it: "Esplora come le rocce cambiano nel tempo.",
        },
        magma: {
          en: "Magma",
          zh: "Â≤©Êºø",
          ja: "„Éû„Ç∞„Éû",
          ko: "ÎßàÍ∑∏Îßà",
          es: "Magma",
          de: "Magma",
          fi: "Magma",
          fr: "Magma",
          ar: "ÿßŸÑÿµŸáÿßÿ±ÿ©",
          it: "Magma",
        },
        igneous: {
          en: "Igneous Rock",
          zh: "ÁÅ´ÊàêÂ≤©",
          ja: "ÁÅ´ÊàêÂ≤©",
          ko: "ÌôîÏÑ±Ïïî",
          es: "Roca √≠gnea",
          de: "Magmatisches Gestein",
          fi: "Magmakivi",
          fr: "Roche magmatique",
          ar: "ÿµÿÆŸàÿ± ŸÜÿßÿ±Ÿäÿ©",
          it: "Roccia Ignea",
        },
        sediment: {
          en: "Sediment",
          zh: "Ê≤âÁ©çÁâ©",
          ja: "Â†ÜÁ©çÁâ©",
          ko: "Ìá¥Ï†ÅÎ¨º",
          es: "Sedimento",
          de: "Sediment",
          fi: "Sedimentti",
          fr: "S√©diment",
          ar: "ÿ±Ÿàÿßÿ≥ÿ®",
          it: "Sedimento",
        },
        sedimentary: {
          en: "Sedimentary Rock",
          zh: "Ê≤âÁ©çÂ≤©",
          ja: "Â†ÜÁ©çÂ≤©",
          ko: "Ìá¥Ï†ÅÏïî",
          es: "Roca sedimentaria",
          de: "Sedimentgestein",
          fi: "Sedimenttikivi",
          fr: "Roche s√©dimentaire",
          ar: "ÿµÿÆŸàÿ± ÿ±ÿ≥Ÿàÿ®Ÿäÿ©",
          it: "Roccia Sedimentaria",
        },
        metamorphic: {
          en: "Metamorphic Rock",
          zh: "ËÆäË≥™Â≤©",
          ja: "Â§âÊàêÂ≤©",
          ko: "Î≥ÄÏÑ±Ïïî",
          es: "Roca metam√≥rfica",
          de: "Metamorphes Gestein",
          fi: "Metamorfinen kivi",
          fr: "Roche m√©tamorphique",
          ar: "ÿµÿÆŸàÿ± ŸÖÿ™ÿ≠ŸàŸÑÿ©",
          it: "Roccia Metamorfica",
        },

        process_cool: { en: "Cooling", zh: "ÂÜ∑Âçª", ja: "ÂÜ∑Âç¥", ko: "ÎÉâÍ∞Å" },
        process_weather: {
          en: "Weathering",
          zh: "È¢®Âåñ‰æµËùï",
          ja: "È¢®Âåñ",
          ko: "ÌíçÌôî",
        },
        process_compact: {
          en: "Compaction",
          zh: "Â£ìÂØ¶",
          ja: "ÂúßÁ∏Æ",
          ko: "ÏïïÏ∂ï",
        },
        process_heat: {
          en: "Heat & Pressure",
          zh: "È´òÊ∫´È´òÂ£ì",
          ja: "ÁÜ±„Å®ÂúßÂäõ",
          ko: "Ïó¥Í≥º ÏïïÎ†•",
        },
        process_melt: { en: "Melting", zh: "ÁÜîÂåñ", ja: "Ê∫∂Ëûç", ko: "Ïö©Ìï¥" },
      };

      const stages = [
        {
          id: "magma",
          icon: "üåã",
          color: "bg-red-600",
          next: "igneous",
          process: "process_cool",
        },
        {
          id: "igneous",
          icon: "ü™®",
          color: "bg-gray-600",
          next: "sediment",
          process: "process_weather",
        },
        {
          id: "sediment",
          icon: "üèúÔ∏è",
          color: "bg-yellow-600",
          next: "sedimentary",
          process: "process_compact",
        },
        {
          id: "sedimentary",
          icon: "üß±",
          color: "bg-orange-700",
          next: "metamorphic",
          process: "process_heat",
        },
        {
          id: "metamorphic",
          icon: "üíé",
          color: "bg-purple-700",
          next: "magma",
          process: "process_melt",
        },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [currentStageId, setCurrentStageId] = useState("magma");

        const getText = (key) => t[key][lang] || t[key]["en"];
        const currentStage = stages.find((s) => s.id === currentStageId);

        const handleNext = () => {
          setCurrentStageId(currentStage.next);
        };

        return (
          <div className="min-h-screen flex flex-col items-center p-4">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl font-bold mb-8 text-stone-300">
              {getText("title")}
            </h1>

            <div className="relative w-full max-w-2xl h-[500px]">
              {/* Circular Cycle Visualization */}
              <div className="absolute inset-0 border-[20px] border-stone-700 rounded-full opacity-50"></div>

              {/* Stages positioned in circle */}
              {stages.map((s, i) => {
                const angle = (i * 360) / stages.length - 90; // Start top
                const radius = 200;
                const x = Math.cos((angle * Math.PI) / 180) * radius;
                const y = Math.sin((angle * Math.PI) / 180) * radius;

                const isActive = s.id === currentStageId;

                return (
                  <div
                    key={s.id}
                    onClick={() => setCurrentStageId(s.id)}
                    className={`absolute w-24 h-24 rounded-full flex items-center justify-center text-4xl shadow-lg border-4 transition-all cursor-pointer z-10
                            ${s.color} ${
                      isActive
                        ? "border-white scale-125 z-20"
                        : "border-stone-500 opacity-60"
                    }
                         `}
                    style={{
                      left: `calc(50% + ${x}px)`,
                      top: `calc(50% + ${y}px)`,
                      transform: "translate(-50%, -50%)",
                    }}
                  >
                    {s.icon}
                  </div>
                );
              })}

              {/* Center Info Card */}
              <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 text-center">
                <div className="text-6xl mb-4 animate-bounce">
                  {currentStage.icon}
                </div>
                <h2 className="text-2xl font-bold mb-2">
                  {getText(currentStage.id)}
                </h2>

                <div className="text-stone-400 mb-4 text-xs font-mono">
                  NEXT PROCESS:
                </div>
                <button
                  onClick={handleNext}
                  className="bg-stone-100 text-stone-900 px-6 py-3 rounded-full font-bold hover:bg-white transition-transform active:scale-95 shadow-lg"
                >
                  ‚û°Ô∏è {getText(currentStage.process)}
                </button>
              </div>
            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
