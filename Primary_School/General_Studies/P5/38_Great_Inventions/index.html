<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>General Studies - Great Inventions</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <style>
      body {
        font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
        background: #fef3c7;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Four Great Inventions",
          zh: "å››å¤§ç™¼æ˜Ž",
          ja: "å››å¤§ç™ºæ˜Ž",
          ko: "4ëŒ€ ë°œëª…í’ˆ",
          es: "Las cuatro grandes invenciones",
          de: "Die vier groÃŸen Erfindungen",
          fi: "NeljÃ¤ suurta keksintÃ¶Ã¤",
          fr: "Les quatre grandes inventions",
          ar: "Ø§Ù„Ø§Ø®ØªØ±Ø§Ø¹Ø§Øª Ø§Ù„Ø£Ø±Ø¨Ø¹Ø© Ø§Ù„Ø¹Ø¸ÙŠÙ…Ø©",
          it: "Le Quattro Grandi Invenzioni",
        },
        instruction: {
          en: "Identify the invention.",
          zh: "èªå‡ºé€™å€‹ç™¼æ˜Žã€‚",
          ja: "ç™ºæ˜Žã‚’ç‰¹å®šã—ã¦ãã ã•ã„ã€‚",
          ko: "ë°œëª…í’ˆì„ ì‹ë³„í•˜ì„¸ìš”.",
          es: "Identifica la invenciÃ³n.",
          de: "Identifiziere die Erfindung.",
          fi: "Tunnista keksintÃ¶.",
          fr: "Identifiez l'invention.",
          ar: "Ø­Ø¯Ø¯ Ø§Ù„Ø§Ø®ØªØ±Ø§Ø¹.",
          it: "Identifica l'invenzione.",
        },
        compass: { en: "Compass", zh: "æŒ‡å—é‡", ja: "ç¾…é‡ç›¤", ko: "ë‚˜ì¹¨ë°˜" },
        gunpowder: { en: "Gunpowder", zh: "ç«è—¥", ja: "ç«è–¬", ko: "í™”ì•½" },
        paper: { en: "Papermaking", zh: "é€ ç´™è¡“", ja: "è£½ç´™æ³•", ko: "ì œì§€ìˆ " },
        printing: { en: "Printing", zh: "å°åˆ·è¡“", ja: "å°åˆ·è¡“", ko: "ì¸ì‡„ìˆ " },

        correct: { en: "Correct!", zh: "æ­£ç¢ºï¼", ja: "æ­£è§£ï¼", ko: "ì •ë‹µ!" },
      };

      const inventions = [
        { id: "compass", icon: "ðŸ§­", color: "bg-blue-100" },
        { id: "gunpowder", icon: "ðŸŽ†", color: "bg-red-100" },
        { id: "paper", icon: "ðŸ“œ", color: "bg-yellow-100" },
        { id: "printing", icon: "ðŸ–¨ï¸", color: "bg-purple-100" },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [targetIdx, setTargetIdx] = useState(0);
        const [feedback, setFeedback] = useState(null);

        const getText = (key) => t[key][lang] || t[key]["en"];
        const target = inventions[targetIdx];

        const handleGuess = (id) => {
          if (feedback) return;
          if (id === target.id) {
            setFeedback("correct");
            setTimeout(() => {
              setFeedback(null);
              setTargetIdx((targetIdx + 1) % inventions.length);
            }, 1000);
          }
        };

        return (
          <div className="min-h-screen flex flex-col items-center p-4">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl font-bold mb-8 text-amber-800">
              {getText("title")}
            </h1>

            <div className="w-full max-w-md bg-white p-8 rounded-3xl shadow-xl flex flex-col items-center mb-8 border-4 border-amber-200">
              <p className="mb-8 font-bold text-slate-400">
                {getText("instruction")}
              </p>
              <div className="text-9xl mb-8 animate-bounce">{target.icon}</div>
              {feedback && (
                <div className="text-3xl font-black text-green-600">
                  {getText("correct")}
                </div>
              )}
            </div>

            <div className="grid grid-cols-2 gap-4 w-full max-w-lg">
              {inventions.map((inv) => (
                <button
                  key={inv.id}
                  onClick={() => handleGuess(inv.id)}
                  className={`p-6 rounded-2xl shadow-md text-xl font-bold transition-all hover:scale-105 active:scale-95 flex flex-col items-center ${inv.color}`}
                >
                  <span className="mb-2 text-2xl opacity-50">{inv.icon}</span>
                  {getText(inv.id)}
                </button>
              ))}
            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
