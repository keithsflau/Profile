<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>General Studies - Green Energy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <style>
      body {
        font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
        background: #f0fdf4;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Green Energy City",
          zh: "Á∂†Ëâ≤ËÉΩÊ∫êÂüéÂ∏Ç",
          ja: "„Ç∞„É™„Éº„É≥„Ç®„Éç„É´„ÇÆ„ÉºÈÉΩÂ∏Ç",
          ko: "Í∑∏Î¶∞ ÏóêÎÑàÏßÄ ÎèÑÏãú",
          es: "Ciudad de energ√≠a verde",
          de: "Gr√ºne Energiestadt",
          fi: "Vihre√§n energian kaupunki",
          fr: "Ville √† √©nergie verte",
          ar: "ŸÖÿØŸäŸÜÿ© ÿßŸÑÿ∑ÿßŸÇÿ© ÿßŸÑÿÆÿ∂ÿ±ÿßÿ°",
          it: "Citt√† dell'Energia Verde",
        },
        instruction: {
          en: "Power the city with renewable energy!",
          zh: "Áî®ÂèØÂÜçÁîüËÉΩÊ∫êÁÇ∫ÂüéÂ∏Ç‰æõÈõªÔºÅ",
          ja: "ÂÜçÁîüÂèØËÉΩ„Ç®„Éç„É´„ÇÆ„Éº„ÅßÈÉΩÂ∏Ç„Å´ÈõªÂäõ„Çí‰æõÁµ¶„Åó„Åæ„Åó„Çá„ÅÜÔºÅ",
          ko: "Ïû¨ÏÉù Í∞ÄÎä• ÏóêÎÑàÏßÄÎ°ú ÎèÑÏãúÏóê Ï†ÑÎ†•ÏùÑ Í≥µÍ∏âÌïòÏÑ∏Ïöî!",
          es: "¬°Alimenta la ciudad con energ√≠a renovable!",
          de: "Versorge die Stadt mit erneuerbarer Energie!",
          fi: "Anna kaupungille virtaa uusiutuvalla energialla!",
          fr: "Alimentez la ville avec de l'√©nergie renouvelable !",
          ar: "ŸÇŸÖ ÿ®ÿ™ÿ≤ŸàŸäÿØ ÿßŸÑŸÖÿØŸäŸÜÿ© ÿ®ÿßŸÑÿ∑ÿßŸÇÿ© ÿßŸÑŸÖÿ™ÿ¨ÿØÿØÿ©!",
          it: "Alimenta la citt√† con energia rinnovabile!",
        },
        solar: {
          en: "Solar Panels",
          zh: "Â§™ÈôΩËÉΩÊùø",
          ja: "„ÇΩ„Éº„É©„Éº„Éë„Éç„É´",
          ko: "ÌÉúÏñëÍ¥ë Ìå®ÎÑê",
        },
        wind: {
          en: "Wind Turbine",
          zh: "È¢®ÂäõÁôºÈõªÊ©ü",
          ja: "È¢®Âäõ„Çø„Éº„Éì„É≥",
          ko: "ÌíçÎ†• ÌÑ∞Îπà",
        },
        hydro: {
          en: "Hydro Dam",
          zh: "Ê∞¥ÂäõÁôºÈõªÁ´ô",
          ja: "Ê∞¥Âäõ„ÉÄ„É†",
          ko: "ÏàòÎ†• Îåê",
        },
        coal: {
          en: "Coal Plant (Dirty!)",
          zh: "ÁáÉÁÖ§ÁôºÈõªÂª† (Ê±°Êüì!)",
          ja: "Áü≥ÁÇ≠Â∑•Â†¥ (Ê±ö„ÅÑ!)",
          ko: "ÏÑùÌÉÑ Î∞úÏ†ÑÏÜå (ÎçîÎü¨ÏõÄ!)",
        },

        power: {
          en: "Power Output",
          zh: "ÈõªÂäõËº∏Âá∫",
          ja: "Âá∫Âäõ",
          ko: "Ï†ÑÎ†• Ï∂úÎ†•",
        },
        pollution: { en: "Pollution", zh: "Ê±°Êüì", ja: "Ê±öÊüì", ko: "Ïò§Ïóº" },
      };

      function App() {
        const [lang, setLang] = useState("zh");
        const [grid, setGrid] = useState([null, null, null]);

        const getText = (key) => t[key][lang] || t[key]["en"];

        const addSource = (idx, type) => {
          const newGrid = [...grid];
          newGrid[idx] = type;
          setGrid(newGrid);
        };

        const stats = grid.reduce(
          (acc, curr) => {
            if (curr === "solar") {
              acc.power += 20;
            }
            if (curr === "wind") {
              acc.power += 30;
            }
            if (curr === "hydro") {
              acc.power += 40;
            }
            if (curr === "coal") {
              acc.power += 50;
              acc.poll += 50;
            }
            return acc;
          },
          { power: 0, poll: 0 }
        );

        return (
          <div className="min-h-screen flex flex-col items-center p-4">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl font-bold mb-8 text-green-700">
              {getText("title")}
            </h1>
            <p className="mb-8 font-bold text-slate-500">
              {getText("instruction")}
            </p>

            <div className="w-full max-w-4xl grid grid-cols-1 md:grid-cols-3 gap-8 mb-8">
              {[0, 1, 2].map((i) => (
                <div
                  key={i}
                  className="aspect-square bg-green-50 border-4 border-dashed border-green-200 rounded-3xl flex flex-col items-center justify-center relative overflow-hidden"
                >
                  {grid[i] ? (
                    <div className="text-center">
                      <div className="text-6xl mb-4">
                        {grid[i] === "solar"
                          ? "‚òÄÔ∏è"
                          : grid[i] === "wind"
                          ? "üå¨Ô∏è"
                          : grid[i] === "hydro"
                          ? "üíß"
                          : "üè≠"}
                      </div>
                      <div className="font-bold text-green-900">
                        {getText(grid[i])}
                      </div>
                      <button
                        onClick={() => addSource(i, null)}
                        className="mt-2 text-xs text-red-500 underline"
                      >
                        Remove
                      </button>
                    </div>
                  ) : (
                    <div className="text-slate-400 font-bold">Empty Plot</div>
                  )}
                </div>
              ))}
            </div>

            <div className="bg-white p-6 rounded-2xl shadow-lg w-full max-w-2xl mb-8">
              <div className="mb-4">
                <div className="flex justify-between font-bold mb-1">
                  <span>{getText("power")}</span>
                  <span>{stats.power}/100</span>
                </div>
                <div className="h-4 bg-slate-100 rounded-full overflow-hidden">
                  <div
                    className="h-full bg-yellow-400 transition-all duration-500"
                    style={{ width: `${Math.min(100, stats.power)}%` }}
                  ></div>
                </div>
              </div>
              <div>
                <div className="flex justify-between font-bold mb-1">
                  <span>{getText("pollution")}</span>
                  <span
                    className={
                      stats.poll > 0 ? "text-red-500" : "text-green-500"
                    }
                  >
                    {stats.poll}
                  </span>
                </div>
                <div className="h-4 bg-slate-100 rounded-full overflow-hidden">
                  <div
                    className="h-full bg-slate-700 transition-all duration-500"
                    style={{ width: `${Math.min(100, stats.poll)}%` }}
                  ></div>
                </div>
              </div>
            </div>

            <div className="flex gap-4 flex-wrap justify-center">
              <button
                onClick={() =>
                  addSource(
                    grid.findIndex((x) => !x),
                    "solar"
                  )
                }
                disabled={!grid.includes(null)}
                className="px-6 py-3 bg-yellow-100 text-yellow-800 rounded-xl font-bold hover:bg-yellow-200 disabled:opacity-50"
              >
                ‚òÄÔ∏è {getText("solar")}
              </button>
              <button
                onClick={() =>
                  addSource(
                    grid.findIndex((x) => !x),
                    "wind"
                  )
                }
                disabled={!grid.includes(null)}
                className="px-6 py-3 bg-blue-100 text-blue-800 rounded-xl font-bold hover:bg-blue-200 disabled:opacity-50"
              >
                üå¨Ô∏è {getText("wind")}
              </button>
              <button
                onClick={() =>
                  addSource(
                    grid.findIndex((x) => !x),
                    "hydro"
                  )
                }
                disabled={!grid.includes(null)}
                className="px-6 py-3 bg-cyan-100 text-cyan-800 rounded-xl font-bold hover:bg-cyan-200 disabled:opacity-50"
              >
                üíß {getText("hydro")}
              </button>
              <button
                onClick={() =>
                  addSource(
                    grid.findIndex((x) => !x),
                    "coal"
                  )
                }
                disabled={!grid.includes(null)}
                className="px-6 py-3 bg-slate-200 text-slate-800 rounded-xl font-bold hover:bg-slate-300 disabled:opacity-50"
              >
                üè≠ {getText("coal")}
              </button>
            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
