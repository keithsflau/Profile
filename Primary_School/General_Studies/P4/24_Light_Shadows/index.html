<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>General Studies - Light and Shadows</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <style>
      body {
        font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
        background: skyblue;
        overflow: hidden;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Sun & Shadows",
          zh: "太陽與影子",
          ja: "太陽と影",
          ko: "태양과 그림자",
          es: "Sol y sombras",
          de: "Sonne & Schatten",
          fi: "Aurinko ja varjot",
          fr: "Soleil et ombres",
          ar: "الشمس والظلال",
          it: "Sole e Ombre",
        },
        instruction: {
          en: "Move the sun to see how the shadow changes!",
          zh: "移動太陽，觀察影子的變化！",
          ja: "太陽を動かして影がどう変わるか見てみよう！",
          ko: "태양을 움직여 그림자가 어떻게 변하는지 확인하세요!",
          es: "¡Mueve el sol para ver cómo cambia la sombra!",
          de: "Bewege die Sonne, um zu sehen, wie sich der Schatten ändert!",
          fi: "Siirrä aurinkoa nähdäksesi kuinka varjo muuttuu!",
          fr: "Déplacez le soleil pour voir comment l'ombre change !",
          ar: "حرك الشمس لترى كيف يتغير الظل!",
          it: "Muovi il sole per vedere come cambia l'ombra!",
        },
        morning: {
          en: "Morning",
          zh: "早上",
          ja: "朝",
          ko: "아침",
          es: "Mañana",
          de: "Morgen",
          fi: "Aamu",
          fr: "Matin",
          ar: "صباح",
          it: "Mattina",
        },
        noon: {
          en: "Noon",
          zh: "中午",
          ja: "正午",
          ko: "정오",
          es: "Mediodía",
          de: "Mittag",
          fi: "Keskipäivä",
          fr: "Midi",
          ar: "ظهر",
          it: "Mezzogiorno",
        },
        afternoon: {
          en: "Afternoon",
          zh: "下午",
          ja: "午後",
          ko: "오후",
          es: "Tarde",
          de: "Nachmittag",
          fi: "Iltapäivä",
          fr: "Après-midi",
          ar: "بعد الظهر",
          it: "Pomeriggio",
        },
        long: {
          en: "Long Shadow",
          zh: "長影子",
          ja: "長い影",
          ko: "긴 그림자",
          es: "Sombra larga",
          de: "Langer Schatten",
          fi: "Pitkä varjo",
          fr: "Ombre longue",
          ar: "ظل طويل",
          it: "Ombra Lunga",
        },
        short: {
          en: "Short Shadow",
          zh: "短影子",
          ja: "短い影",
          ko: "짧은 그림자",
          es: "Sombra corta",
          de: "Kurzer Schatten",
          fi: "Lyhyt varjo",
          fr: "Ombre courte",
          ar: "ظل قصير",
          it: "Ombra Corta",
        },
      };

      function App() {
        const [lang, setLang] = useState("zh");
        const [sunPos, setSunPos] = useState(50); // 0 (Left Horizon) to 100 (Right Horizon)

        const getText = (key) => t[key][lang] || t[key]["en"];

        // Calculations
        // Sun X: mapped to width
        // Sun Y: Arc. y = - (x - 50)^2 .... simplified: sin wave
        // 0 -> PI

        const angle = (sunPos / 100) * Math.PI;
        const height = Math.sin(angle) * 80; // height percentage

        const sunX = sunPos;
        const sunY = 80 - height; // 80% is ground approx

        // Shadow
        const shadowLenRaw = (50 - sunPos) * 3;

        const timeLabel =
          sunPos < 30 ? "morning" : sunPos > 70 ? "afternoon" : "noon";
        const shadowLabel = Math.abs(shadowLenRaw) > 50 ? "long" : "short";

        return (
          <div
            className={`min-h-screen flex flex-col p-4 transition-colors duration-1000 ${
              sunPos < 20 || sunPos > 80 ? "bg-orange-200" : "bg-sky-300"
            }`}
          >
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl font-bold mb-4 text-white drop-shadow-md text-center">
              {getText("title")}
            </h1>
            <p className="text-center text-white font-bold drop-shadow-md mb-8">
              {getText("instruction")}
            </p>

            <div className="flex-1 relative w-full overflow-hidden">
              {/* Sun */}
              <div
                className="absolute w-24 h-24 bg-yellow-400 rounded-full shadow-[0_0_50px_rgba(255,255,0,0.8)] flex items-center justify-center cursor-pointer font-bold text-yellow-800"
                style={{ left: `calc(${sunX}% - 3rem)`, top: `${sunY}%` }}
              >
                ☀️
              </div>

              {/* Stick / Object */}
              <div className="absolute bottom-10 left-1/2 -translate-x-1/2 w-4 h-40 bg-amber-800 rounded-t-lg z-10 flex flex-col items-center">
                <div className="w-12 h-12 bg-green-500 rounded-full -mt-6"></div>{" "}
                {/* Tree Top */}
              </div>

              {/* Shadow */}
              <div
                className="absolute bottom-10 left-1/2 w-4 h-40 bg-black/20 origin-bottom rounded-t-lg z-0 blur-sm"
                style={{
                  transform: `translateX(-50%) rotate(${
                    (sunPos - 50) * 1.5
                  }deg) scaleY(${1 + Math.abs(50 - sunPos) / 20})`,
                }}
              >
                <div className="w-12 h-12 bg-black/20 rounded-full -mt-6"></div>
              </div>

              {/* Ground */}
              <div className="absolute bottom-0 w-full h-10 bg-green-700"></div>
            </div>

            {/* Controls */}
            <div className="bg-white/90 p-6 rounded-2xl shadow-xl w-full max-w-2xl mx-auto mt-4 text-center">
              <input
                type="range"
                min="0"
                max="100"
                value={sunPos}
                onChange={(e) => setSunPos(Number(e.target.value))}
                className="w-full h-6 bg-slate-200 rounded-lg appearance-none cursor-pointer mb-4"
              />
              <div className="flex justify-between font-bold text-slate-500 uppercase text-sm">
                <span>East (Morning)</span>
                <span>Noon</span>
                <span>West (Afternoon)</span>
              </div>

              <div className="mt-4 flex justify-around items-center">
                <div className="text-2xl font-black text-slate-800">
                  {getText(timeLabel)}
                </div>
                <div className="text-xl font-bold text-slate-600">
                  {getText(shadowLabel)}
                </div>
              </div>
            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
