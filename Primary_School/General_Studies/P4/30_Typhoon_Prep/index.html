<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>General Studies - Typhoon Prep</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <style>
      body {
        font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
        background: #334155;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Typhoon Preparation",
          zh: "é¢±é¢¨æº–å‚™",
          ja: "å°é¢¨ã®æº–å‚™",
          ko: "íƒœí’ ëŒ€ë¹„",
          es: "PreparaciÃ³n para tifones",
          de: "Taifun-Vorbereitung",
          fi: "Taifuunivalmistelut",
          fr: "PrÃ©paration aux typhons",
          ar: "Ø§Ù„Ø§Ø³ØªØ¹Ø¯Ø§Ø¯ Ù„Ù„Ø¥Ø¹ØµØ§Ø±",
          it: "Preparazione Tifone",
        },
        instruction: {
          en: "Tap the items you need to pack for a typhoon!",
          zh: "é»žæ“Šä½ éœ€è¦ç‚ºé¢±é¢¨æº–å‚™çš„ç‰©å“ï¼",
          ja: "å°é¢¨ã®ãŸã‚ã«æº–å‚™ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‚¢ã‚¤ãƒ†ãƒ ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ãã ã•ã„ï¼",
          ko: "íƒœí’ì— ëŒ€ë¹„í•´ ì±™ê²¨ì•¼ í•  ë¬¼ê±´ì„ íƒ­í•˜ì„¸ìš”!",
          es: "Â¡Toca los artÃ­culos que necesitas empacar para un tifÃ³n!",
          de: "Tippe auf die GegenstÃ¤nde, die du fÃ¼r einen Taifun einpacken musst!",
          fi: "Napauta tavaroita, jotka sinun tÃ¤ytyy pakata taifuunia varten!",
          fr: "Tapez sur les articles que vous devez emballer pour un typhon !",
          ar: "Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø­Ø²Ù…Ù‡Ø§ Ù„Ù„Ø¥Ø¹ØµØ§Ø±!",
          it: "Tocca gli oggetti che devi preparare per un tifone!",
        },
        packed: {
          en: "Packed Items:",
          zh: "å·²æ‰“åŒ…ç‰©å“ï¼š",
          ja: "æ¢±åŒ…æ¸ˆã¿ã‚¢ã‚¤ãƒ†ãƒ ï¼š",
          ko: "í¬ìž¥ëœ ë¬¼í’ˆ:",
          es: "ArtÃ­culos empacados:",
          de: "Gepackte Artikel:",
          fi: "Pakatut tavarat:",
          fr: "Articles emballÃ©s :",
          ar: "Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø¹Ø¨Ø£Ø©:",
          it: "Oggetti Imballati:",
        },
        ready: {
          en: "You are Ready!",
          zh: "ä½ æº–å‚™å¥½äº†ï¼",
          ja: "æº–å‚™å®Œäº†ï¼",
          ko: "ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤!",
          es: "Â¡EstÃ¡s listo!",
          de: "Du bist bereit!",
          fi: "Olet valmis!",
          fr: "Vous Ãªtes prÃªt !",
          ar: "Ø£Ù†Øª Ù…Ø³ØªØ¹Ø¯!",
          it: "Sei Pronto!",
        },

        // Items
        tape: {
          en: "Adhesive Tape",
          zh: "è† ç´™",
          ja: "ç²˜ç€ãƒ†ãƒ¼ãƒ—",
          ko: "ì ‘ì°© í…Œì´í”„",
          es: "Cinta adhesiva",
          de: "Klebeband",
          fi: "Teippi",
          fr: "Ruban adhÃ©sif",
          ar: "Ø´Ø±ÙŠØ· Ù„Ø§ØµÙ‚",
          it: "Nastro Adesivo",
        },
        food: {
          en: "Canned Food",
          zh: "ç½é ­é£Ÿå“",
          ja: "ç¼¶è©°",
          ko: "í†µì¡°ë¦¼",
          es: "Comida enlatada",
          de: "Konserven",
          fi: "SÃ¤ilykeruoka",
          fr: "Nourriture en conserve",
          ar: "Ø·Ø¹Ø§Ù… Ù…Ø¹Ù„Ø¨",
          it: "Cibo in Scatola",
        },
        water: {
          en: "Bottled Water",
          zh: "ç“¶è£æ°´",
          ja: "ãƒœãƒˆãƒ«å…¥ã‚Šé£²æ–™æ°´",
          ko: "ìƒìˆ˜",
          es: "Agua embotellada",
          de: "Flaschenwasser",
          fi: "Pullotettu vesi",
          fr: "Eau en bouteille",
          ar: "Ù…ÙŠØ§Ù‡ Ù…Ø¹Ø¨Ø£Ø©",
          it: "Acqua in Bottiglia",
        },
        torch: {
          en: "Flashlight",
          zh: "æ‰‹é›»ç­’",
          ja: "æ‡ä¸­é›»ç¯",
          ko: "ì†ì „ë“±",
          es: "Linterna",
          de: "Taschenlampe",
          fi: "Taskulamppu",
          fr: "Lampe de poche",
          ar: "Ù…ØµØ¨Ø§Ø­ ÙŠØ¯ÙˆÙŠ",
          it: "Torcia",
        },
        radio: {
          en: "Radio",
          zh: "æ”¶éŸ³æ©Ÿ",
          ja: "ãƒ©ã‚¸ã‚ª",
          ko: "ë¼ë””ì˜¤",
          es: "Radio",
          de: "Radio",
          fi: "Radio",
          fr: "Radio",
          ar: "Ø±Ø§Ø¯ÙŠÙˆ",
          it: "Radio",
        },
        games: {
          en: "Board Games",
          zh: "æ¡Œä¸ŠéŠæˆ²",
          ja: "ãƒœãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ ",
          ko: "ë³´ë“œ ê²Œìž„",
          es: "Juegos de mesa",
          de: "Brettspiele",
          fi: "Lautapelit",
          fr: "Jeux de sociÃ©tÃ©",
          ar: "Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ø·Ø§ÙˆÙ„Ø©",
          it: "Giochi da Tavolo",
        },

        // Distractors
        kite: {
          en: "Kite",
          zh: "é¢¨ç®",
          ja: "å‡§",
          ko: "ì—°",
          es: "Cometa",
          de: "Drachen",
          fi: "Leija",
          fr: "Cerf-volant",
          ar: "Ø·Ø§Ø¦Ø±Ø© ÙˆØ±Ù‚ÙŠØ©",
          it: "Aquilone",
        },
        bike: {
          en: "Bicycle",
          zh: "è‡ªè¡Œè»Š",
          ja: "è‡ªè»¢è»Š",
          ko: "ìžì „ê±°",
          es: "Bicicleta",
          de: "Fahrrad",
          fi: "PolkupyÃ¶rÃ¤",
          fr: "VÃ©lo",
          ar: "Ø¯Ø±Ø§Ø¬Ø©",
          it: "Bicicletta",
        },
        swimsuit: {
          en: "Swimsuit",
          zh: "æ³³è¡£",
          ja: "æ°´ç€",
          ko: "ìˆ˜ì˜ë³µ",
          es: "Traje de baÃ±o",
          de: "Badeanzug",
          fi: "Uimapuku",
          fr: "Maillot de bain",
          ar: "Ù…Ù„Ø§Ø¨Ø³ Ø³Ø¨Ø§Ø­Ø©",
          it: "Costume da Bagno",
        },
      };

      const items = [
        { id: "tape", needed: true, icon: "ðŸ©¹" }, // adhesive bandage but close enough for tape icon
        { id: "food", needed: true, icon: "ðŸ¥«" },
        { id: "water", needed: true, icon: "ðŸ’§" },
        { id: "torch", needed: true, icon: "ðŸ”¦" },
        { id: "radio", needed: true, icon: "ðŸ“»" },
        { id: "games", needed: false, icon: "ðŸŽ²" }, // Optional but ok, let's make it needed for sanity? No, survival items.
        { id: "kite", needed: false, icon: "ðŸª" },
        { id: "bike", needed: false, icon: "ðŸš²" },
        { id: "swimsuit", needed: false, icon: "ðŸ©³" },
      ];
      // Let's say Games are optional/distractor for strict survival, but good for boredom. Let's stick to essential basics. Needed: tape, food, water, torch, radio.

      function App() {
        const [lang, setLang] = useState("zh");
        const [packed, setPacked] = useState([]);
        const [message, setMessage] = useState("");

        const getText = (key) => t[key][lang] || t[key]["en"];

        const handlePack = (item) => {
          if (packed.includes(item.id)) return;

          if (item.needed) {
            setPacked([...packed, item.id]);
            // Check win
            const neededCount = items.filter((i) => i.needed).length;
            if (packed.length + 1 === neededCount) {
              setMessage("ready");
            }
          } else {
            // Shake or something?
            setMessage("Why would you need a " + getText(item.id) + "?");
            setTimeout(() => setMessage(""), 2000);
          }
        };

        const isPacked = (id) => packed.includes(id);

        return (
          <div className="min-h-screen flex flex-col items-center p-4 text-white">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl font-bold mb-8 text-yellow-400">
              ðŸŒ€ {getText("title")}
            </h1>

            <p className="mb-8 text-slate-300 font-bold text-center">
              {getText("instruction")}
            </p>

            <div className="grid grid-cols-2 md:grid-cols-3 gap-6 w-full max-w-4xl">
              {items.map((item) => (
                <motion.button
                  key={item.id}
                  whileHover={{ scale: 1.05 }}
                  whileTap={{ scale: 0.95 }}
                  onClick={() => handlePack(item)}
                  className={`p-6 rounded-2xl flex flex-col items-center justify-center gap-4 shadow-xl border-4 transition-colors
                        ${
                          isPacked(item.id)
                            ? "bg-green-600 border-green-400 opacity-50 cursor-default"
                            : "bg-slate-700 border-slate-600 hover:bg-slate-600 cursor-pointer"
                        }
                     `}
                >
                  <div className="text-6xl">{item.icon}</div>
                  <div className="font-bold text-center">
                    {getText(item.id)}
                  </div>
                  {isPacked(item.id) && (
                    <div className="absolute inset-0 flex items-center justify-center text-6xl text-green-200 font-black rotate-[-20deg]">
                      Packed!
                    </div>
                  )}
                </motion.button>
              ))}
            </div>

            {/* Message Area */}
            <div className="fixed bottom-10 bg-slate-800/90 border border-slate-500 px-8 py-4 rounded-full text-xl font-bold text-center shadow-2xl min-h-[4rem] flex items-center justify-center">
              {message === "ready" ? (
                <span className="text-green-400 text-2xl">
                  âœ… {getText("ready")}
                </span>
              ) : (
                <span className="text-yellow-200">{message}</span>
              )}
            </div>

            {/* Progress */}
            <div className="fixed top-20 right-4 bg-black/50 p-4 rounded-xl backdrop-blur-sm">
              <div className="text-xs text-slate-400 uppercase font-bold mb-2">
                {getText("packed")}
              </div>
              <div className="flex gap-2">
                {packed.map((id) => (
                  <span key={id} className="text-2xl">
                    {items.find((i) => i.id === id).icon}
                  </span>
                ))}
                {[
                  ...Array(
                    items.filter((i) => i.needed).length - packed.length
                  ),
                ].map((_, i) => (
                  <span key={i} className="text-2xl opacity-20">
                    âšª
                  </span>
                ))}
              </div>
            </div>

            {/* Rain Effect Overlay */}
            <div className="fixed inset-0 pointer-events-none z-[-1] opacity-20 bg-[url('https://cdn.pixabay.com/animation/2023/06/25/21/55/21-55-46-95_512.gif')] bg-cover"></div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
