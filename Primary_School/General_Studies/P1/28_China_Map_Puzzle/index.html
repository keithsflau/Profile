<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å°ä¸€å¸¸è­˜ï¼šä¸­åœ‹åœ°åœ–æ‹¼åœ– | China Map Puzzle</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: linear-gradient(135deg, #fefce8 0%, #fde047 100%);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "China Map Fun",
          zh: "ä¸­åœ‹åœ°åœ–å°ç™¾ç§‘",
          ja: "ä¸­å›½åœ°å›³",
        },
        instruction: {
          en: "Drag the icons to the correct place on the map!",
          zh: "æŠŠåœ–ç¤ºæ‹–åˆ°åœ°åœ–ä¸Šæ­£ç¢ºçš„ä½ç½®ï¼",
          ja: "åœ°å›³ä¸Šã®æ­£ã—ã„å ´æ‰€ã«ã‚¢ã‚¤ã‚³ãƒ³ã‚’ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦ãã ã•ã„ï¼",
        },
        bj: { en: "Beijing (Capital)", zh: "åŒ—äº¬ (é¦–éƒ½)" },
        hk: { en: "Hong Kong", zh: "é¦™æ¸¯" },
        sichuan: { en: "Sichuan (Panda Home)", zh: "å››å· (ç†Šè²“æ•…é„‰)" },

        flag: { en: "National Flag", zh: "åœ‹æ——" },
        panda: { en: "Panda", zh: "ç†Šè²“" },
        bauhinia: { en: "Bauhinia", zh: "æ´‹ç´«èŠ" },

        check: { en: "Check", zh: "æª¢æŸ¥" },
        reset: { en: "Reset", zh: "é‡ç½®" },
        correct: { en: "Great Geography Skill!", zh: "åœ°ç†å°åšå£«ï¼" },
        wrong: { en: "Try again!", zh: "å†è©¦ä¸€æ¬¡ï¼" },
      };

      const locations = [
        { id: "bj", name: "bj", x: 65, y: 30, targetItem: "flag" },
        { id: "sichuan", name: "sichuan", x: 45, y: 55, targetItem: "panda" },
        { id: "hk", name: "hk", x: 68, y: 75, targetItem: "bauhinia" },
      ];

      const items = [
        { id: "flag", icon: "ğŸ‡¨ğŸ‡³", label: "flag" },
        { id: "panda", icon: "ğŸ¼", label: "panda" },
        { id: "bauhinia", icon: "ğŸŒ¸", label: "bauhinia" },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [placements, setPlacements] = useState({}); // locId -> itemId
        const [status, setStatus] = useState(null);

        const getText = (key) => t[key][lang] || t[key]["en"];

        const handleDrop = (itemId, locId) => {
          setPlacements((prev) => ({
            ...prev,
            [locId]: itemId,
          }));
          setStatus(null);
        };

        const check = () => {
          const allCorrect = locations.every(
            (loc) => placements[loc.id] === loc.targetItem
          );
          if (allCorrect) setStatus("correct");
          else setStatus("wrong");
        };

        const reset = () => {
          setPlacements({});
          setStatus(null);
        };

        return (
          <div className="min-h-screen p-4 flex flex-col items-center">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl md:text-5xl font-black text-rose-700 mb-4 mt-8 drop-shadow-sm">
              ğŸ—ºï¸ {getText("title")}
            </h1>
            <p className="font-bold text-rose-800 mb-8">
              {getText("instruction")}
            </p>

            {/* Map Container */}
            <div className="relative w-full max-w-md aspect-[4/3] bg-yellow-100 rounded-3xl border-4 border-yellow-300 shadow-xl overflow-hidden mb-8">
              {/* Abstract China Map Shape (Made with lots of blobs/circles for P1 simplified view) */}
              {/* Chicken Shape: Head top right, Belly center, Tail left */}

              {/* Base */}
              <div className="absolute top-[10%] left-[10%] w-[80%] h-[80%] bg-white rounded-[40%_60%_70%_30%_/_40%_50%_60%_50%] opacity-50 border-2 border-slate-200"></div>

              {/* Locations */}
              {locations.map((loc) => {
                const placedItemId = placements[loc.id];
                const placedItem = items.find((i) => i.id === placedItemId);

                return (
                  <div
                    key={loc.id}
                    className={`absolute w-24 h-24 -ml-12 -mt-12 rounded-full border-2 border-dashed flex flex-col items-center justify-center cursor-pointer transition-all ${
                      status === "correct"
                        ? "border-green-500 bg-green-100/80"
                        : placedItem
                        ? "border-rose-400 bg-white/80"
                        : "border-slate-400 bg-white/40 hover:bg-white/60"
                    }`}
                    style={{ left: `${loc.x}%`, top: `${loc.y}%` }}
                    onDragOver={(e) => e.preventDefault()}
                    onDrop={(e) => {
                      e.preventDefault();
                      const iId = e.dataTransfer.getData("itemId");
                      if (iId) handleDrop(iId, loc.id);
                    }}
                    onClick={() => {
                      // Remove
                      const next = { ...placements };
                      delete next[loc.id];
                      setPlacements(next);
                      setStatus(null);
                    }}
                  >
                    {placedItem ? (
                      <motion.button
                        initial={{ scale: 0 }}
                        animate={{ scale: 1 }}
                        className="text-center"
                      >
                        <div className="text-4xl">{placedItem.icon}</div>
                      </motion.button>
                    ) : (
                      <div className="text-center">
                        <div className="text-2xl opacity-30">ğŸ“</div>
                      </div>
                    )}
                    <div
                      className={`absolute -bottom-8 bg-white/80 px-2 py-1 rounded text-xs font-bold whitespace-nowrap shadow-sm ${
                        placedItem ? "text-black" : "text-slate-500"
                      }`}
                    >
                      {getText(loc.name)}
                    </div>
                  </div>
                );
              })}
            </div>

            {status && (
              <div
                className={`text-2xl font-black mb-6 ${
                  status === "correct" ? "text-green-600" : "text-red-500"
                }`}
              >
                {getText(status)}
              </div>
            )}

            <div className="flex gap-4">
              {/* Items Bank */}
              <div className="flex gap-4 bg-white/60 p-4 rounded-2xl">
                {items.map((item) => {
                  // Hide if placed
                  const isPlaced = Object.values(placements).includes(item.id);
                  if (isPlaced)
                    return <div key={item.id} className="w-20 h-20"></div>;

                  return (
                    <div
                      key={item.id}
                      draggable
                      onDragStart={(e) =>
                        e.dataTransfer.setData("itemId", item.id)
                      }
                      className="w-20 h-20 bg-white rounded-xl shadow-md flex flex-col items-center justify-center cursor-grab active:cursor-grabbing hover:scale-110 transition-transform"
                    >
                      <div className="text-4xl mb-1">{item.icon}</div>
                      <div className="text-[10px] font-bold text-slate-600">
                        {getText(item.label)}
                      </div>
                    </div>
                  );
                })}
              </div>

              <div className="flex flex-col gap-2">
                <button
                  onClick={check}
                  className="bg-rose-500 text-white px-4 py-2 rounded-xl font-bold hover:bg-rose-600 shadow h-full"
                >
                  {getText("check")}
                </button>
                <button
                  onClick={reset}
                  className="bg-slate-200 text-slate-600 px-4 py-2 rounded-xl font-bold hover:bg-slate-300 shadow h-full"
                >
                  {getText("reset")}
                </button>
              </div>
            </div>
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  
      
      <!-- Footer -->
      <footer class="text-center py-4 text-slate-500 text-sm">
        <p class="italic mb-1">
          But God made the earth by his power; he founded the world by his wisdom and stretched out the heavens by his
          understanding. Jeremiah 10:12
        </p>
        <p class="text-xs mb-1 mt-2">
          ã€Œè€¶å’Œè¯ç”¨èƒ½åŠ›å‰µé€ å¤§åœ°ï¼Œç”¨æ™ºæ…§å»ºç«‹ä¸–ç•Œï¼Œç”¨è°æ˜é‹ªå¼µç©¹è’¼ã€‚ã€ è€¶åˆ©ç±³æ›¸ 10:12
        </p>
        <p class="text-xs mt-2 pt-2 border-t border-slate-300">
          @ 2025 Education Engineering Portfolio | Generated by Gemini Pro 3.0 | Prepared by SF Lau
        </p>
      </footer>
</body>
</html>
