<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å°ä¸€å¸¸è­˜ï¼šå‹•ç‰©åˆ†é¡å¤§å¸« | Animal Sorting</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: #f0f9ff;
        overflow: hidden; /* Game layout mostly static */
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Animal Sorter",
          zh: "å‹•ç‰©åˆ†é¡å¤§å¸«",
          ja: "å‹•ç‰©åˆ†é¡",
        },
        instruction: {
          en: "Where does this animal live?",
          zh: "é€™ç¨®å‹•ç‰©ä½åœ¨å“ªè£¡ï¼Ÿ",
          ja: "ã“ã®å‹•ç‰©ã¯ã©ã“ã«ä½ã‚“ã§ã„ã¾ã™ã‹ï¼Ÿ",
        },
        sky: { en: "Sky", zh: "å¤©ç©º" },
        land: { en: "Land", zh: "é™¸åœ°" },
        sea: { en: "Sea", zh: "æµ·æ´‹" },
        correct: { en: "Correct!", zh: "ç­”å°äº†ï¼" },
        completed: { en: "All Animals Home!", zh: "æ‰€æœ‰å‹•ç‰©éƒ½å›å®¶äº†ï¼" },
        restart: { en: "Play Again", zh: "å†ç©ä¸€æ¬¡" },
      };

      const animals = [
        { id: "eagle", icon: "ğŸ¦…", habitat: "sky" },
        { id: "parrot", icon: "ğŸ¦œ", habitat: "sky" },
        { id: "bee", icon: "ğŸ", habitat: "sky" },

        { id: "lion", icon: "ğŸ¦", habitat: "land" },
        { id: "elephant", icon: "ğŸ˜", habitat: "land" },
        { id: "rabbit", icon: "ğŸ‡", habitat: "land" },

        { id: "fish", icon: "ğŸŸ", habitat: "sea" },
        { id: "whale", icon: "ğŸ‹", habitat: "sea" },
        { id: "octopus", icon: "ğŸ™", habitat: "sea" },
        { id: "shrimp", icon: "ğŸ¦", habitat: "sea" },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [queue, setQueue] = useState([]);
        const [current, setCurrent] = useState(null);
        const [score, setScore] = useState(0);
        const [feedback, setFeedback] = useState(null);

        const getText = (key) => t[key][lang] || t[key]["en"];

        useEffect(() => {
          resetGame();
        }, []);

        const resetGame = () => {
          const shuffled = [...animals].sort(() => Math.random() - 0.5);
          setQueue(shuffled.slice(1));
          setCurrent(shuffled[0]);
          setScore(0);
          setFeedback(null);
        };

        const handleZoneClick = (zone) => {
          if (!current) return;
          if (current.habitat === zone) {
            setFeedback("correct");
            setScore((s) => s + 10);

            // Delayed next
            setTimeout(() => {
              setFeedback(null);
              if (queue.length > 0) {
                const next = queue[0];
                setQueue(queue.slice(1));
                setCurrent(next);
              } else {
                setCurrent(null); // Win
              }
            }, 500);
          } else {
            // penalty or visual shake?
            // visual feedback embedded in button?
            // simpler to just ignore or show 'wrong'
            const btn = document.getElementById(`zone-${zone}`);
            if (btn) {
              btn.classList.add("animate-ping");
              setTimeout(() => btn.classList.remove("animate-ping"), 500);
            }
          }
        };

        return (
          <div className="h-screen flex flex-col items-center relative">
            <LanguageSelector lang={lang} setLang={setLang} />

            {/* Zones Background */}
            <div className="absolute inset-0 z-0 flex flex-col">
              {/* Sky */}
              <button
                id="zone-sky"
                onClick={() => handleZoneClick("sky")}
                className="flex-1 bg-sky-200 border-b-4 border-sky-300 flex items-start justify-center pt-8 text-sky-700 font-black text-4xl hover:bg-sky-300 transition-colors active:opacity-80"
              >
                {getText("sky")} â˜ï¸
              </button>
              {/* Land */}
              <button
                id="zone-land"
                onClick={() => handleZoneClick("land")}
                className="flex-1 bg-green-200 border-b-4 border-green-300 flex items-center justify-center text-green-800 font-black text-4xl hover:bg-green-300 transition-colors active:opacity-80"
              >
                {getText("land")} ğŸŒ³
              </button>
              {/* Sea */}
              <button
                id="zone-sea"
                onClick={() => handleZoneClick("sea")}
                className="flex-1 bg-blue-500 flex items-end justify-center pb-8 text-white font-black text-4xl hover:bg-blue-600 transition-colors active:opacity-80"
              >
                {getText("sea")} ğŸŒŠ
              </button>
            </div>

            {/* Game UI Layer */}
            <div className="z-10 w-full h-full pointer-events-none flex flex-col items-center justify-center">
              <h1 className="absolute top-4 left-4 text-3xl font-black text-white drop-shadow-md">
                {getText("title")}
              </h1>

              {current ? (
                <div className="pointer-events-auto flex flex-col items-center">
                  <div className="bg-white/90 p-6 rounded-3xl shadow-2xl mb-4 text-center">
                    <p className="text-xl font-bold text-slate-600 mb-2">
                      {getText("instruction")}
                    </p>
                    <motion.div
                      key={current.id}
                      initial={{ scale: 0 }}
                      animate={{ scale: 1 }}
                      className="text-9xl filter drop-shadow-lg"
                    >
                      {current.icon}
                    </motion.div>
                  </div>
                  {feedback && (
                    <motion.div
                      initial={{ scale: 0 }}
                      animate={{ scale: 1 }}
                      className="bg-green-500 text-white px-8 py-3 rounded-full font-black text-2xl shadow-xl"
                    >
                      {getText("correct")}
                    </motion.div>
                  )}
                </div>
              ) : (
                <div className="pointer-events-auto text-center bg-white/90 p-12 rounded-3xl shadow-2xl">
                  <h2 className="text-4xl font-black text-slate-800 mb-6">
                    {getText("completed")}
                  </h2>
                  <button
                    onClick={resetGame}
                    className="bg-sky-500 text-white px-10 py-4 rounded-full font-black text-2xl hover:bg-sky-600 shadow-xl"
                  >
                    {getText("restart")} ğŸ”„
                  </button>
                </div>
              )}
            </div>
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  
      
      <!-- Footer -->
      <footer class="text-center py-4 text-slate-500 text-sm">
        <p class="italic mb-1">
          But God made the earth by his power; he founded the world by his wisdom and stretched out the heavens by his
          understanding. Jeremiah 10:12
        </p>
        <p class="text-xs mb-1 mt-2">
          ã€Œè€¶å’Œè¯ç”¨èƒ½åŠ›å‰µé€ å¤§åœ°ï¼Œç”¨æ™ºæ…§å»ºç«‹ä¸–ç•Œï¼Œç”¨è°æ˜é‹ªå¼µç©¹è’¼ã€‚ã€ è€¶åˆ©ç±³æ›¸ 10:12
        </p>
        <p class="text-xs mt-2 pt-2 border-t border-slate-300">
          @ 2025 Education Engineering Portfolio | Generated by Gemini Pro 3.0 | Prepared by SF Lau
        </p>
      </footer>
</body>
</html>
