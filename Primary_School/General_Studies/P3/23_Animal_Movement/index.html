<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å°ä¸‰å¸¸è­˜ï¼šå‹•ç‰©é‹å‹•æœƒ | Animal Movement</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: linear-gradient(135deg, #bef264 0%, #a3e635 100%);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Animal Movement",
          zh: "å‹•ç‰©é‹å‹•æœƒ",
          ja: "å‹•ç‰©ã®å‹•ã",
          ko: "ë™ë¬¼ì˜ ì›€ì§ì„",
          es: "Movimiento Animal",
          de: "Tierbewegung",
          fi: "ElÃ¤inten liikkuminen",
          fr: "Mouvement des animaux",
          ar: "Ø­Ø±ÙƒØ© Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª",
          it: "Movimento degli Animali",
        },
        instruction: {
          en: "How does it move?",
          zh: "å®ƒæ˜¯æ€æ¨£ç§»å‹•çš„ï¼Ÿ",
          ja: "ã©ã†ã‚„ã£ã¦å‹•ãã®ï¼Ÿ",
          ko: "ì–´ë–»ê²Œ ì›€ì§ì¼ê¹Œìš”?",
          es: "Â¿CÃ³mo se mueve?",
          de: "Wie bewegt es sich?",
          fi: "Miten se liikkuu?",
          fr: "Comment bouge-t-il ?",
          ar: "ÙƒÙŠÙ ÙŠØªØ­Ø±ÙƒØŸ",
          it: "Come si muove?",
        },

        fly: {
          en: "Fly",
          zh: "é£›è¡Œ",
          ja: "é£›ã¶",
          ko: "ë‚ ê¸°",
          es: "Volar",
          de: "Fliegen",
          fi: "LentÃ¤Ã¤",
          fr: "Voler",
          ar: "ÙŠØ·ÙŠØ±",
          it: "Volare",
        },
        swim: {
          en: "Swim",
          zh: "æ¸¸æ³³",
          ja: "æ³³ã",
          ko: "í—¤ì—„ì¹˜ê¸°",
          es: "Nadar",
          de: "Schwimmen",
          fi: "Uida",
          fr: "Nager",
          ar: "ÙŠØ³Ø¨Ø­",
          it: "Nuotare",
        },
        hop: {
          en: "Hop",
          zh: "è·³èº",
          ja: "è·³ã­ã‚‹",
          ko: "ë›°ê¸°",
          es: "Saltar",
          de: "HÃ¼pfen",
          fi: "HyppiÃ¤",
          fr: "Sautiller",
          ar: "ÙŠÙ‚ÙØ²",
          it: "Saltellare",
        },
        run: {
          en: "Run/Walk",
          zh: "å¥”è·‘/è¡Œèµ°",
          ja: "èµ°ã‚‹/æ­©ã",
          ko: "ë‹¬ë¦¬ê¸°/ê±·ê¸°",
          es: "Correr/Caminar",
          de: "Laufen/Gehen",
          fi: "Juosta/KÃ¤vellÃ¤",
          fr: "Courir/Marcher",
          ar: "Ø±ÙƒØ¶/Ù…Ø´ÙŠ",
          it: "Correre/Camminare",
        },
        crawl: {
          en: "Crawl",
          zh: "çˆ¬è¡Œ",
          ja: "é€™ã†",
          ko: "ê¸°ì–´ê°€ê¸°",
          es: "Arrastrarse",
          de: "Kriechen",
          fi: "RyÃ¶miÃ¤",
          fr: "Ramper",
          ar: "Ø²Ø­Ù",
          it: "Strisciare",
        },

        eagle: {
          en: "Eagle",
          zh: "è€é·¹",
          ja: "é·²",
          ko: "ë…ìˆ˜ë¦¬",
          es: "Ãguila",
          de: "Adler",
          fi: "Kotka",
          fr: "Aigle",
          ar: "Ù†Ø³Ø±",
          it: "Aquila",
        },
        dolphin: {
          en: "Dolphin",
          zh: "æµ·è±š",
          ja: "ã‚¤ãƒ«ã‚«",
          ko: "ëŒê³ ë˜",
          es: "DelfÃ­n",
          de: "Delfin",
          fi: "Delfiini",
          fr: "Dauphin",
          ar: "Ø¯Ù„ÙÙŠÙ†",
          it: "Delfino",
        },
        kangaroo: {
          en: "Kangaroo",
          zh: "è¢‹é¼ ",
          ja: "ã‚«ãƒ³ã‚¬ãƒ«ãƒ¼",
          ko: "ìº¥ê±°ë£¨",
          es: "Canguro",
          de: "KÃ¤nguru",
          fi: "Kenguru",
          fr: "Kangourou",
          ar: "ÙƒÙ†ØºØ±",
          it: "Canguro",
        },
        cheetah: {
          en: "Cheetah",
          zh: "çµè±¹",
          ja: "ãƒãƒ¼ã‚¿ãƒ¼",
          ko: "ì¹˜íƒ€",
          es: "Guepardo",
          de: "Gepard",
          fi: "Gepardi",
          fr: "GuÃ©pard",
          ar: "ÙÙ‡Ø¯",
          it: "Ghepardo",
        },
        snake: {
          en: "Snake",
          zh: "è›‡",
          ja: "è›‡",
          ko: "ë±€",
          es: "Serpiente",
          de: "Schlange",
          fi: "KÃ¤Ã¤rme",
          fr: "Serpent",
          ar: "Ø«Ø¹Ø¨Ø§Ù†",
          it: "Serpente",
        },
        frog: {
          en: "Frog",
          zh: "é’è›™",
          ja: "ã‚«ã‚¨ãƒ«",
          ko: "ê°œêµ¬ë¦¬",
          es: "Rana",
          de: "Frosch",
          fi: "Sammakko",
          fr: "Grenouille",
          ar: "Ø¶ÙØ¯Ø¹",
          it: "Rana",
        },
        horse: {
          en: "Horse",
          zh: "é¦¬",
          ja: "é¦¬",
          ko: "ë§",
          es: "Caballo",
          de: "Pferd",
          fi: "Hevonen",
          fr: "Cheval",
          ar: "Ø­ØµØ§Ù†",
          it: "Cavallo",
        },
        butterfly: {
          en: "Butterfly",
          zh: "è´è¶",
          ja: "è¶",
          ko: "ë‚˜ë¹„",
          es: "Mariposa",
          de: "Schmetterling",
          fi: "Perhonen",
          fr: "Papillon",
          ar: "ÙØ±Ø§Ø´Ø©",
          it: "Farfalla",
        },
        fish: {
          en: "Fish",
          zh: "é­š",
          ja: "é­š",
          ko: "ë¬¼ê³ ê¸°",
          es: "Pez",
          de: "Fisch",
          fi: "Kala",
          fr: "Poisson",
          ar: "Ø³Ù…ÙƒØ©",
          it: "Pesce",
        },
        worm: {
          en: "Earthworm",
          zh: "èš¯èš“",
          ja: "ãƒŸãƒŸã‚º",
          ko: "ì§€ë ì´",
          es: "Lombriz",
          de: "Regenwurm",
          fi: "Liero",
          fr: "Ver de terre",
          ar: "Ø¯ÙˆØ¯Ø© Ø§Ù„Ø£Ø±Ø¶",
          it: "Lombrico",
        },

        correct: {
          en: "Correct!",
          zh: "ç­”å°äº†ï¼",
          ja: "æ­£è§£ï¼",
          ko: "ì •ë‹µì…ë‹ˆë‹¤!",
          es: "Â¡Correcto!",
          de: "Richtig!",
          fi: "Oikein!",
          fr: "Correct !",
          ar: "ØµØ­ÙŠØ­!",
          it: "Corretto!",
        },
        wrong: {
          en: "Try Again",
          zh: "å†è©¦ä¸€æ¬¡",
          ja: "ã‚‚ã†ä¸€åº¦",
          ko: "ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”",
          es: "IntÃ©ntalo de nuevo",
          de: "Versuch es nochmal",
          fi: "YritÃ¤ uudelleen",
          fr: "RÃ©essayez",
          ar: "Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",
          it: "Riprova",
        },
        completed: {
          en: "Movement Master!",
          zh: "é‹å‹•å°ˆå®¶ï¼",
          ja: "å‹•ãã®é”äººï¼",
          ko: "ì›€ì§ì„ ë§ˆìŠ¤í„°!",
          es: "Â¡Maestro del Movimiento!",
          de: "Bewegungsmeister!",
          fi: "Liikemestari!",
          fr: "MaÃ®tre du mouvement !",
          ar: "Ø®Ø¨ÙŠØ± Ø§Ù„Ø­Ø±ÙƒØ©!",
          it: "Maestro del Movimento!",
        },
        reset: {
          en: "Play Again",
          zh: "å†ç©ä¸€æ¬¡",
          ja: "ã‚‚ã†ä¸€åº¦ãƒ—ãƒ¬ã‚¤",
          ko: "ë‹¤ì‹œ í•˜ê¸°",
          es: "Jugar de Nuevo",
          de: "Nochmal spielen",
          fi: "Pelaa uudelleen",
          fr: "Rejouer",
          ar: "Ø§Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",
          it: "Gioca di Nuovo",
        },
      };

      const moves = [
        { id: "fly", icon: "ğŸ•Šï¸", color: "bg-sky-400" },
        { id: "swim", icon: "ğŸŠ", color: "bg-blue-500" },
        { id: "hop", icon: "ğŸ¦˜", color: "bg-green-500" },
        { id: "run", icon: "ğŸ†", color: "bg-orange-500" },
        { id: "crawl", icon: "ğŸ›", color: "bg-amber-600" },
      ];

      const animals = [
        { id: "eagle", type: "fly", icon: "ğŸ¦…" },
        { id: "butterfly", type: "fly", icon: "ğŸ¦‹" },
        { id: "dolphin", type: "swim", icon: "ğŸ¬" },
        { id: "fish", type: "swim", icon: "ğŸŸ" },
        { id: "kangaroo", type: "hop", icon: "ğŸ¦˜" },
        { id: "frog", type: "hop", icon: "ğŸ¸" },
        { id: "cheetah", type: "run", icon: "ğŸ†" },
        { id: "horse", type: "run", icon: "ğŸ" },
        { id: "snake", type: "crawl", icon: "ğŸ" },
        { id: "worm", type: "crawl", icon: "ğŸª±" },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [queue, setQueue] = useState([]);
        const [current, setCurrent] = useState(null);
        const [feedback, setFeedback] = useState(null);
        const [score, setScore] = useState(0);

        const getText = (key) => t[key][lang] || t[key]["en"];

        useEffect(() => {
          initGame();
        }, []);

        const initGame = () => {
          const q = [...animals].sort(() => Math.random() - 0.5);
          setQueue(q);
          setCurrent(q[0]);
          setScore(0);
          setFeedback(null);
        };

        const handleMatch = (moveId) => {
          if (feedback) return;

          if (current.type === moveId) {
            setFeedback("correct");
            setScore((s) => s + 10);
            setTimeout(() => {
              setFeedback(null);
              const nextIdx = queue.indexOf(current) + 1;
              if (nextIdx < queue.length) setCurrent(queue[nextIdx]);
              else setCurrent(null);
            }, 800);
          } else {
            setFeedback("wrong");
            setScore((s) => Math.max(0, s - 5));
            setTimeout(() => setFeedback(null), 800);
          }
        };

        // Animation variant based on movement type
        const variants = {
          fly: {
            y: [0, -20, 0],
            x: [0, 5, -5, 0],
            transition: { repeat: Infinity, duration: 2 },
          },
          swim: {
            x: [0, 20, 0, -20, 0],
            rotate: [0, 5, 0, -5, 0],
            transition: { repeat: Infinity, duration: 3 },
          },
          hop: {
            y: [0, -30, 0],
            scale: [1, 1.1, 0.9, 1],
            transition: { repeat: Infinity, duration: 1 },
          },
          run: { x: [-5, 5], transition: { repeat: Infinity, duration: 0.2 } },
          crawl: {
            scaleX: [1, 1.2, 1],
            transition: { repeat: Infinity, duration: 2 },
          },
        };

        return (
          <div className="min-h-screen p-4 flex flex-col items-center select-none font-sans overflow-hidden">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl md:text-5xl font-black text-lime-900 mb-2 mt-8 drop-shadow-sm bg-white/50 px-6 py-2 rounded-full">
              ğŸƒ {getText("title")}
            </h1>

            <div className="font-bold text-lime-800 text-xl mb-4 bg-white/40 px-4 py-1 rounded-full">
              Score: {score}
            </div>

            {current ? (
              <div className="w-full max-w-4xl flex flex-col items-center flex-1 justify-center relative">
                {/* Animal Display */}
                <div className="relative mb-12 z-20 h-64 flex items-center justify-center w-full">
                  <div className="bg-white/90 p-12 rounded-full shadow-2xl border-8 border-lime-500 w-64 h-64 flex flex-col items-center justify-center">
                    <motion.div
                      className="text-8xl mb-2"
                      animate={variants[current.type]} // Animate based on ACTUAL type to hint? Or maybe static?
                      // Let's animate it to give a HINT!
                    >
                      {current.icon}
                    </motion.div>
                    <div className="text-2xl font-black text-slate-700 leading-tight bg-white px-2 rounded mt-2">
                      {getText(current.id)}
                    </div>
                  </div>

                  {feedback && (
                    <div
                      className={`absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-30 px-6 py-4 rounded-3xl font-black text-4xl shadow-2xl whitespace-nowrap ${
                        feedback === "correct"
                          ? "bg-green-600 text-white"
                          : "bg-red-500 text-white"
                      }`}
                    >
                      {getText(feedback)}
                    </div>
                  )}
                </div>

                <p className="font-bold text-lime-900 mb-8 bg-white/60 px-8 py-2 rounded-full text-2xl">
                  {getText("instruction")}
                </p>

                {/* Options */}
                <div className="flex flex-wrap gap-4 w-full justify-center">
                  {moves.map((m) => (
                    <button
                      key={m.id}
                      onClick={() => handleMatch(m.id)}
                      className={`${m.color} text-white rounded-2xl p-4 flex flex-col items-center shadow-lg active:scale-95 transition-transform hover:scale-105 border-b-8 border-black/20 min-w-[120px]`}
                    >
                      <div className="text-4xl mb-2">{m.icon}</div>
                      <div className="font-black text-xl">{getText(m.id)}</div>
                    </button>
                  ))}
                </div>
              </div>
            ) : (
              <div className="bg-white/90 p-12 rounded-3xl shadow-xl text-center mt-20">
                <div className="text-8xl mb-4">ğŸ…</div>
                <h2 className="text-4xl font-black text-lime-800 mb-6">
                  {getText("completed")}
                </h2>
                <button
                  onClick={initGame}
                  className="bg-lime-600 text-white px-10 py-4 rounded-full font-black text-2xl hover:bg-lime-700 shadow-xl"
                >
                  {getText("reset")} ğŸ”„
                </button>
              </div>
            )}
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
