<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å°ä¸‰å¸¸è­˜ï¼šè­·é½’å°å¤©ä½¿ | Healthy Teeth</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: linear-gradient(135deg, #e0f2fe 0%, #bae6fd 100%);
        cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><text y="20" font-size="20">ğŸª¥</text></svg>')
            2 20,
          auto;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect, useRef } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Healthy Teeth",
          zh: "è­·é½’å°å¤©ä½¿",
          ja: "å¥åº·ãªæ­¯",
          ko: "ê±´ê°•í•œ ì¹˜ì•„",
          es: "Dientes Sanos",
          de: "Gesunde ZÃ¤hne",
          fi: "Terveet hampaat",
          fr: "Dents saines",
          ar: "Ø£Ø³Ù†Ø§Ù† ØµØ­ÙŠØ©",
          it: "Denti Sani",
        },
        instruction: {
          en: "Brush away the dirt!",
          zh: "æŠŠç‰™é½’åˆ·ä¹¾æ·¨ï¼",
          ja: "æ­¯ã®æ±šã‚Œã‚’ç£¨ãè½ã¨ãã†ï¼",
          ko: "ì¹˜ì•„ì˜ ë•Œë¥¼ ë‹¦ì•„ë‚´ì„¸ìš”!",
          es: "Â¡Cepilla la suciedad!",
          de: "Putz den Schmutz weg!",
          fi: "Harjaa lika pois!",
          fr: "Brossez la saletÃ© !",
          ar: "Ù†Ø¸Ù Ø§Ù„Ø£ÙˆØ³Ø§Ø® Ø¨Ø§Ù„ÙØ±Ø´Ø§Ø©!",
          it: "Spazzola via lo sporco!",
        },
        clean: {
          en: "Sparkling Clean!",
          zh: "ä¹¾æ·¨äº®ç™½ï¼",
          ja: "ãƒ”ã‚«ãƒ”ã‚«æ¸…æ½”ï¼",
          ko: "ë°˜ì§ë°˜ì§ ê¹¨ë—í•´ìš”!",
          es: "Â¡Reluciente de Limpio!",
          de: "Blitzsauber!",
          fi: "Hohtavan puhdasta!",
          fr: "Ã‰tincelant de propretÃ© !",
          ar: "Ù†Ø¸ÙŠÙ Ù„Ø§Ù…Ø¹!",
          it: "Splendente Pulito!",
        },
        reset: {
          en: "Brush Again",
          zh: "å†åˆ·ä¸€æ¬¡",
          ja: "ã‚‚ã†ä¸€åº¦ç£¨ã",
          ko: "ë‹¤ì‹œ ë‹¦ê¸°",
          es: "Cepillar de Nuevo",
          de: "Nochmal putzen",
          fi: "Harjaa uudelleen",
          fr: "Brosser Ã  nouveau",
          ar: "Ø§ØºØ³Ù„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",
          it: "Spazzola di Nuovo",
        },
        food_instruction: {
          en: "Which foods are bad for teeth?",
          zh: "å“ªäº›é£Ÿç‰©å°ç‰™é½’ä¸å¥½ï¼Ÿ",
          ja: "æ­¯ã«æ‚ªã„é£Ÿã¹ç‰©ã¯ã©ã‚Œï¼Ÿ",
          ko: "ì–´ë–¤ ìŒì‹ì´ ì¹˜ì•„ì— í•´ë¡œìš¸ê¹Œìš”?",
          es: "Â¿QuÃ© alimentos son malos para los dientes?",
          de: "Welche Lebensmittel sind schlecht fÃ¼r die ZÃ¤hne?",
          fi: "MitkÃ¤ ruoat ovat pahaksi hampaille?",
          fr: "Quels aliments sont mauvais pour les dents ?",
          ar: "Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ø£Ø·Ø¹Ù…Ø© Ø§Ù„Ø¶Ø§Ø±Ø© Ø¨Ø§Ù„Ø£Ø³Ù†Ø§Ù†ØŸ",
          it: "Quali cibi fanno male ai denti?",
        },
        bad_food: {
          en: "Sugary Food",
          zh: "é«˜ç³–é£Ÿç‰©",
          ja: "ç”˜ã„é£Ÿã¹ç‰©",
          ko: "ë‹¨ ìŒì‹",
          es: "Comida Azucarada",
          de: "Zuckerhaltiges Essen",
          fi: "Sokerinen ruoka",
          fr: "Nourriture sucrÃ©e",
          ar: "Ø·Ø¹Ø§Ù… Ø³ÙƒØ±ÙŠ",
          it: "Cibo Zuccherato",
        },
        good_food: {
          en: "Healthy Food",
          zh: "å¥åº·é£Ÿç‰©",
          ja: "å¥åº·çš„ãªé£Ÿã¹ç‰©",
          ko: "ê±´ê°•í•œ ìŒì‹",
          es: "Comida Saludable",
          de: "Gesundes Essen",
          fi: "Terveellinen ruoka",
          fr: "Nourriture saine",
          ar: "Ø·Ø¹Ø§Ù… ØµØ­ÙŠ",
          it: "Cibo Sano",
        },
        level2: {
          en: "Next: Food Quiz",
          zh: "ä¸‹ä¸€é—œï¼šé£Ÿç‰©å•ç­”",
          ja: "æ¬¡ã¸ï¼šé£Ÿã¹ç‰©ã‚¯ã‚¤ã‚º",
          ko: "ë‹¤ìŒ: ìŒì‹ í€´ì¦ˆ",
          es: "Siguiente: Cuestionario",
          de: "Weiter: Essens-Quiz",
          fi: "Seuraava: Ruokavisa",
          fr: "Suivant : Quiz alimentaire",
          ar: "Ø§Ù„ØªØ§Ù„ÙŠ: Ù…Ø³Ø§Ø¨Ù‚Ø© Ø§Ù„Ø·Ø¹Ø§Ù…",
          it: "Avanti: Quiz sul Cibo",
        },
        correct: {
          en: "Correct!",
          zh: "ç­”å°äº†ï¼",
          ja: "æ­£è§£ï¼",
          ko: "ì •ë‹µì…ë‹ˆë‹¤!",
          es: "Â¡Correcto!",
          de: "Richtig!",
          fi: "Oikein!",
          fr: "Correct !",
          ar: "ØµØ­ÙŠØ­!",
          it: "Corretto!",
        },
        wrong: {
          en: "Think again!",
          zh: "æƒ³ä¸€æƒ³ï¼",
          ja: "ã‚‚ã†ä¸€åº¦è€ƒãˆã¦ï¼",
          ko: "ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”!",
          es: "Â¡PiÃ©nsalo de nuevo!",
          de: "Denk nochmal nach!",
          fi: "Mieti uudelleen!",
          fr: "RÃ©flÃ©chissez encore !",
          ar: "ÙÙƒØ± Ù…Ø±Ø© Ø£Ø®Ø±Ù‰!",
          it: "Pensaci ancora!",
        },
      };

      // Tooth positions in a simplified arc
      const teethPos = [
        { id: 1, x: 20, y: 60 },
        { id: 2, x: 30, y: 70 },
        { id: 3, x: 40, y: 75 },
        { id: 4, x: 50, y: 75 },
        { id: 5, x: 60, y: 75 },
        { id: 6, x: 70, y: 70 },
        { id: 7, x: 80, y: 60 },

        { id: 8, x: 25, y: 40 },
        { id: 9, x: 35, y: 30 },
        { id: 10, x: 45, y: 25 },
        { id: 11, x: 55, y: 25 },
        { id: 12, x: 65, y: 30 },
        { id: 13, x: 75, y: 40 },
      ];

      const foods = [
        { id: "candy", icon: "ğŸ¬", type: "bad" },
        { id: "apple", icon: "ğŸ", type: "good" },
        { id: "soda", icon: "ğŸ¥¤", type: "bad" },
        { id: "milk", icon: "ğŸ¥›", type: "good" },
        { id: "cake", icon: "ğŸ°", type: "bad" },
        { id: "carrot", icon: "ğŸ¥•", type: "good" },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [mode, setMode] = useState("brush"); // brush, quiz
        const [dirt, setDirt] = useState(
          teethPos.map((t) => ({ id: t.id, level: 10 })) // 10 = very dirty, 0 = clean
        );
        const [quizState, setQuizState] = useState({
          current: 0,
          score: 0,
          feedback: null,
        });

        const getText = (key) => t[key][lang] || t[key]["en"];

        // Brushing Logic
        const handleBrush = (id) => {
          if (mode !== "brush") return;
          setDirt((prev) =>
            prev.map((d) => {
              if (d.id === id && d.level > 0) {
                return { ...d, level: Math.max(0, d.level - 1) };
              }
              return d;
            })
          );
        };

        const allClean = dirt.every((d) => d.level === 0);

        // Quiz Logic
        const handleQuizAnswer = (answer) => {
          if (quizState.feedback) return;
          const currentFood = foods[quizState.current];
          const isCorrect =
            (currentFood.type === "bad" && answer === "bad") ||
            (currentFood.type === "good" && answer === "good");

          setQuizState((prev) => ({
            ...prev,
            feedback: isCorrect ? "correct" : "wrong",
          }));

          setTimeout(() => {
            if (quizState.current < foods.length - 1) {
              setQuizState((prev) => ({
                ...prev,
                current: prev.current + 1,
                feedback: null,
                score: isCorrect ? prev.score + 1 : prev.score,
              }));
            } else {
              // Start over quiz or go back to brush?
              // Let's just reset quiz for endless play or cycle back
              setQuizState({ current: 0, score: 0, feedback: null });
              setMode("brush"); // Back to brushing
              setDirt(teethPos.map((t) => ({ id: t.id, level: 10 }))); // Get dirty again
            }
          }, 1000);
        };

        return (
          <div className="min-h-screen p-4 flex flex-col items-center select-none overflow-hidden">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl md:text-5xl font-black text-blue-600 mb-4 mt-8 drop-shadow-sm bg-white/50 px-6 py-2 rounded-full">
              ğŸ¦· {getText("title")}
            </h1>

            {mode === "brush" && (
              <div className="flex flex-col items-center w-full max-w-2xl">
                <p className="font-bold text-blue-800 mb-6 text-xl">
                  {getText("instruction")}
                </p>

                <div className="relative w-full aspect-square bg-white rounded-full shadow-2xl border-8 border-blue-200 overflow-hidden flex items-center justify-center">
                  {/* Mouth Background */}
                  <div className="absolute inset-0 bg-red-100 rounded-full scale-90 border-8 border-red-200"></div>

                  {/* Tongue */}
                  <div className="absolute bottom-10 left-1/2 -translate-x-1/2 w-32 h-20 bg-red-300 rounded-t-full"></div>

                  {/* Teeth */}
                  {teethPos.map((tp) => {
                    const dirtLevel = dirt.find((d) => d.id === tp.id).level;
                    return (
                      <div
                        key={tp.id}
                        className="absolute w-16 h-20 bg-white rounded-xl shadow-md flex items-center justify-center cursor-pointer transition-transform active:scale-95 hover:bg-slate-50 border-2 border-slate-100"
                        style={{
                          left: `${tp.x}%`,
                          top: `${tp.y}%`,
                          transform: "translate(-50%, -50%)",
                        }}
                        onMouseEnter={() => handleBrush(tp.id)} // Hover to brush on PC
                        onTouchMove={() => handleBrush(tp.id)} // Touch drag to brush
                        onClick={() => handleBrush(tp.id)} // Click/Tap fallback
                      >
                        {dirtLevel > 0 ? (
                          <div
                            className="text-yellow-600 font-bold opacity-80"
                            style={{ opacity: dirtLevel / 10 }}
                          >
                            {["ğŸ¦ ", "ğŸŒ¿", "ğŸ«", "ğŸª"][tp.id % 4]}
                          </div>
                        ) : (
                          <div className="text-2xl animate-pulse">âœ¨</div>
                        )}

                        {/* Dirt Overlay */}
                        {dirtLevel > 0 && (
                          <div
                            className="absolute inset-0 bg-yellow-900/20 rounded-xl"
                            style={{ opacity: dirtLevel / 10 }}
                          ></div>
                        )}
                      </div>
                    );
                  })}

                  {allClean && (
                    <div className="absolute inset-0 z-20 flex flex-col items-center justify-center bg-white/80 backdrop-blur-sm animate-fade-in">
                      <div className="text-8xl mb-4">ğŸ¦·âœ¨</div>
                      <h2 className="text-4xl font-black text-blue-600 mb-6">
                        {getText("clean")}
                      </h2>
                      <button
                        onClick={() => setMode("quiz")}
                        className="bg-blue-500 text-white px-8 py-3 rounded-full font-bold shadow-xl hover:bg-blue-600 text-xl"
                      >
                        {getText("level2")} â¡ï¸
                      </button>
                    </div>
                  )}
                </div>
              </div>
            )}

            {mode === "quiz" && (
              <div className="flex flex-col items-center w-full max-w-lg mt-8">
                <div className="bg-white p-8 rounded-3xl shadow-xl w-full text-center">
                  <h2 className="text-2xl font-black text-slate-700 mb-6">
                    {getText("food_instruction")}
                  </h2>

                  <div className="text-9xl mb-8 animate-bounce-slow">
                    {foods[quizState.current].icon}
                  </div>

                  <div className="flex gap-4 w-full">
                    <button
                      onClick={() => handleQuizAnswer("good")}
                      disabled={!!quizState.feedback}
                      className="flex-1 bg-green-100 hover:bg-green-200 text-green-800 py-6 rounded-2xl font-bold text-xl border-4 border-green-300"
                    >
                      ğŸ˜ {getText("good_food")}
                    </button>
                    <button
                      onClick={() => handleQuizAnswer("bad")}
                      disabled={!!quizState.feedback}
                      className="flex-1 bg-red-100 hover:bg-red-200 text-red-800 py-6 rounded-2xl font-bold text-xl border-4 border-red-300"
                    >
                      ğŸ˜– {getText("bad_food")}
                    </button>
                  </div>

                  {quizState.feedback && (
                    <div
                      className={`mt-6 p-4 rounded-xl font-black text-2xl ${
                        quizState.feedback === "correct"
                          ? "bg-green-500 text-white"
                          : "bg-red-500 text-white"
                      }`}
                    >
                      {getText(quizState.feedback)}
                    </div>
                  )}
                </div>
              </div>
            )}
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
