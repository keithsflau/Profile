<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Â∞è‰∏âÂ∏∏Ë≠òÔºöÊ§çÁâ©ÁîüÂëΩÈÄ±Êúü | Plant Lifecycle</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: linear-gradient(180deg, #dcfce7 0%, #4ade80 100%);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Plant Lifecycle",
          zh: "Ê§çÁâ©ÁîüÂëΩÈÄ±Êúü",
          ja: "Ê§çÁâ©„ÅÆ„É©„Ç§„Éï„Çµ„Ç§„ÇØ„É´",
          ko: "ÏãùÎ¨ºÏùò ÏÉùÎ™Ö Ï£ºÍ∏∞",
          es: "Ciclo de Vida de las Plantas",
          de: "Lebenszyklus der Pflanzen",
          fi: "Kasvin elinkaari",
          fr: "Cycle de vie des plantes",
          ar: "ÿØŸàÿ±ÿ© ÿ≠Ÿäÿßÿ© ÿßŸÑŸÜÿ®ÿßÿ™",
          it: "Ciclo Vitale delle Piante",
        },
        instruction: {
          en: "Put them in order!",
          zh: "ÊåâÈ†ÜÂ∫èÊéíÂàóÔºÅ",
          ja: "È†ÜÁï™„Å´‰∏¶„Åπ„Å¶ÔºÅ",
          ko: "ÏàúÏÑúÎåÄÎ°ú ÎÜìÏúºÏÑ∏Ïöî!",
          es: "¬°Ponlos en orden!",
          de: "Bring sie in die richtige Reihenfolge!",
          fi: "Laita ne j√§rjestykseen!",
          fr: "Mettez-les dans l'ordre !",
          ar: "ÿ±ÿ™ÿ®ŸáŸÖ!",
          it: "Mettili in ordine!",
        },

        seed: {
          en: "1. Seed",
          zh: "1. Á®ÆÂ≠ê",
          ja: "1. Á®Æ",
          ko: "1. Ïî®Ïïó",
          es: "1. Semilla",
          de: "1. Samen",
          fi: "1. Siemen",
          fr: "1. Graine",
          ar: "1. ÿ®ÿ∞ÿ±ÿ©",
          it: "1. Seme",
        },
        germination: {
          en: "2. Germination",
          zh: "2. ÁôºËäΩ",
          ja: "2. Áô∫ËäΩ",
          ko: "2. Î∞úÏïÑ",
          es: "2. Germinaci√≥n",
          de: "2. Keimung",
          fi: "2. It√§minen",
          fr: "2. Germination",
          ar: "2. ÿ•ŸÜÿ®ÿßÿ™",
          it: "2. Germinazione",
        },
        sprout: {
          en: "3. Sprout",
          zh: "3. ÂπºËãó",
          ja: "3. ËäΩ",
          ko: "3. ÏÉàÏãπ",
          es: "3. Brote",
          de: "3. Spross",
          fi: "3. Verso",
          fr: "3. Pousse",
          ar: "3. ÿ®ÿ±ÿπŸÖ",
          it: "3. Germoglio",
        },
        adult: {
          en: "4. Adult Plant",
          zh: "4. ÊàêÈï∑",
          ja: "4. ÊàêÊú®",
          ko: "4. ÏÑ±Ï≤¥ ÏãùÎ¨º",
          es: "4. Planta Adulta",
          de: "4. Ausgewachsene Pflanze",
          fi: "4. Aikuinen kasvi",
          fr: "4. Plante adulte",
          ar: "4. ŸÜÿ®ÿßÿ™ ÿ®ÿßŸÑÿ∫",
          it: "4. Pianta Adulta",
        },
        flower: {
          en: "5. Flowering",
          zh: "5. ÈñãËä±",
          ja: "5. ÈñãËä±",
          ko: "5. Í∞úÌôî",
          es: "5. Floraci√≥n",
          de: "5. Bl√ºte",
          fi: "5. Kukinta",
          fr: "5. Floraison",
          ar: "5. ÿ•ÿ≤Ÿáÿßÿ±",
          it: "5. Fioritura",
        },
        fruit: {
          en: "6. Fruiting",
          zh: "6. ÁµêÊûú",
          ja: "6. ÁµêÂÆü",
          ko: "6. Í≤∞Ïã§",
          es: "6. Fructificaci√≥n",
          de: "6. Fr√ºchte tragen",
          fi: "6. Hedelm√§nmuodostus",
          fr: "6. Fructification",
          ar: "6. ÿ•ÿ´ŸÖÿßÿ±",
          it: "6. Fruttificazione",
        },

        check: {
          en: "Check Order",
          zh: "Ê™¢Êü•È†ÜÂ∫è",
          ja: "È†ÜÂ∫è„ÇíÁ¢∫Ë™ç",
          ko: "ÏàúÏÑú ÌôïÏù∏",
          es: "Verificar Orden",
          de: "Reihenfolge pr√ºfen",
          fi: "Tarkista j√§rjestys",
          fr: "V√©rifier l'ordre",
          ar: "ÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ™ÿ±ÿ™Ÿäÿ®",
          it: "Controlla Ordine",
        },
        perfect: {
          en: "Perfect Order!",
          zh: "È†ÜÂ∫èÊ≠£Á¢∫ÔºÅ",
          ja: "ÂÆåÁíß„Å™È†ÜÂ∫èÔºÅ",
          ko: "ÏôÑÎ≤ΩÌïú ÏàúÏÑúÏûÖÎãàÎã§!",
          es: "¬°Orden Perfecto!",
          de: "Perfekte Reihenfolge!",
          fi: "T√§ydellinen j√§rjestys!",
          fr: "Ordre parfait !",
          ar: "ÿ™ÿ±ÿ™Ÿäÿ® ŸÖÿ´ÿßŸÑŸä!",
          it: "Ordine Perfetto!",
        },
        wrong: {
          en: "Something is wrong...",
          zh: "È†ÜÂ∫èÊúâË™§...",
          ja: "‰Ωï„Åã„ÅåÈñìÈÅï„Å£„Å¶„ÅÑ„Åæ„Åô...",
          ko: "Î¨¥Ïñ∏Í∞Ä ÏûòÎ™ªÎêòÏóàÏäµÎãàÎã§...",
          es: "Algo est√° mal...",
          de: "Etwas stimmt nicht...",
          fi: "Jokin on pieless√§...",
          fr: "Quelque chose ne va pas...",
          ar: "ŸáŸÜÿßŸÉ ÿÆÿ∑ÿ£ ŸÖÿß...",
          it: "Qualcosa non va...",
        },
        reset: {
          en: "Play Again",
          zh: "ÂÜçÁé©‰∏ÄÊ¨°",
          ja: "„ÇÇ„ÅÜ‰∏ÄÂ∫¶„Éó„É¨„Ç§",
          ko: "Îã§Ïãú ÌïòÍ∏∞",
          es: "Jugar de Nuevo",
          de: "Nochmal spielen",
          fi: "Pelaa uudelleen",
          fr: "Rejouer",
          ar: "ÿßŸÑÿπÿ® ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ",
          it: "Gioca di Nuovo",
        },
      };

      // Lifecycle of a Bean or Tomato mostly
      const correctOrder = [
        "seed",
        "germination",
        "sprout",
        "adult",
        "flower",
        "fruit",
      ];

      const stages = [
        { id: "seed", icon: "üå∞" },
        { id: "germination", icon: "üå±" },
        { id: "sprout", icon: "üåø" },
        { id: "adult", icon: "üå≥" },
        { id: "flower", icon: "üåº" },
        { id: "fruit", icon: "üçé" },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [userOrder, setUserOrder] = useState([]);
        const [pool, setPool] = useState([]);
        const [feedback, setFeedback] = useState(null);

        const getText = (key) => t[key][lang] || t[key]["en"];

        useEffect(() => {
          initGame();
        }, []);

        const initGame = () => {
          setPool([...stages].sort(() => Math.random() - 0.5));
          setUserOrder([]);
          setFeedback(null);
        };

        const addToLine = (item) => {
          if (feedback === "perfect") return;
          setUserOrder((prev) => [...prev, item]);
          setPool((prev) => prev.filter((i) => i.id !== item.id));
          setFeedback(null);
        };

        const removeFromLine = (item) => {
          if (feedback === "perfect") return;
          setPool((prev) => [...prev, item]);
          setUserOrder((prev) => prev.filter((i) => i.id !== item.id));
          setFeedback(null);
        };

        const check = () => {
          if (userOrder.length !== correctOrder.length) return;

          const isCorrect = userOrder.every(
            (item, i) => item.id === correctOrder[i]
          );
          if (isCorrect) {
            setFeedback("perfect");
          } else {
            setFeedback("wrong");
          }
        };

        return (
          <div className="min-h-screen p-4 flex flex-col items-center select-none font-sans overflow-hidden">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl md:text-5xl font-black text-green-800 mb-2 mt-8 drop-shadow-sm bg-white/50 px-6 py-2 rounded-full">
              üåª {getText("title")}
            </h1>
            <p className="font-bold text-green-900 mb-8">
              {getText("instruction")}
            </p>

            {/* Timeline Area (Drop Zone) */}
            <div className="w-full max-w-6xl min-h-[200px] mb-8 relative">
              {/* Line connection visual */}
              <div className="absolute top-1/2 left-4 right-4 h-2 bg-green-800/20 rounded-full -z-10"></div>

              <div className="flex flex-wrap items-center justify-center gap-4 min-h-[200px] bg-white/40 rounded-3xl p-6 border-4 border-dashed border-green-800/30">
                <AnimatePresence>
                  {userOrder.map((item, index) => (
                    <motion.button
                      key={item.id}
                      layoutId={item.id}
                      onClick={() => removeFromLine(item)}
                      className="bg-white p-4 rounded-2xl shadow-xl flex flex-col items-center w-32 md:w-40 border-b-4 border-green-600 hover:scale-105 transition-transform"
                      initial={{ scale: 0 }}
                      animate={{ scale: 1 }}
                      exit={{ scale: 0 }}
                    >
                      <div className="text-6xl mb-2">{item.icon}</div>
                      <div className="font-bold text-sm md:text-base text-green-900 leading-tight">
                        {getText(item.id)}
                      </div>
                      <div className="absolute -top-3 -right-3 bg-green-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold shadow-md">
                        {index + 1}
                      </div>
                    </motion.button>
                  ))}
                </AnimatePresence>

                {userOrder.length === 0 && (
                  <div className="text-green-800/50 font-black text-2xl animate-pulse">
                    Start Here
                  </div>
                )}
              </div>
            </div>

            {/* Feedback */}
            <div className="h-16 mb-4">
              {feedback && (
                <motion.div
                  initial={{ scale: 0 }}
                  animate={{ scale: 1 }}
                  className={`px-8 py-3 rounded-2xl font-black text-2xl shadow-xl ${
                    feedback === "perfect"
                      ? "bg-green-600 text-white"
                      : "bg-red-500 text-white"
                  }`}
                >
                  {getText(feedback)}
                </motion.div>
              )}
            </div>

            {/* Action Button */}
            {userOrder.length === correctOrder.length &&
              feedback !== "perfect" && (
                <button
                  onClick={check}
                  className="bg-green-600 text-white px-12 py-4 rounded-full font-black text-2xl shadow-xl hover:bg-green-700 mb-8 animate-bounce"
                >
                  {getText("check")}
                </button>
              )}

            {feedback === "perfect" && (
              <button
                onClick={initGame}
                className="bg-blue-500 text-white px-12 py-4 rounded-full font-black text-2xl shadow-xl hover:bg-blue-600 mb-8"
              >
                {getText("reset")} üîÑ
              </button>
            )}

            {/* Pool (Source) */}
            <div className="flex flex-wrap justify-center gap-4 p-4">
              <AnimatePresence>
                {pool.map((item) => (
                  <motion.button
                    key={item.id}
                    layoutId={item.id}
                    onClick={() => addToLine(item)}
                    className="bg-white/80 p-4 rounded-2xl shadow flex flex-col items-center w-24 h-24 md:w-28 md:h-28 justify-center border-2 border-green-200 hover:bg-white hover:border-green-400 active:scale-95 transition-all"
                    initial={{ opacity: 0 }}
                    animate={{ opacity: 1 }}
                    exit={{ opacity: 0 }}
                  >
                    <div className="text-4xl md:text-5xl">{item.icon}</div>
                  </motion.button>
                ))}
              </AnimatePresence>
            </div>
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
