<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Â∞è‰∏âÂ∏∏Ë≠òÔºöÁí∞‰øù 4R | 4R Recycling</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: radial-gradient(circle at center, #86efac 0%, #15803d 100%);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "4R Challenge",
          zh: "Áí∞‰øù 4R ÊåëÊà∞",
          ja: "4R„ÉÅ„É£„É¨„É≥„Ç∏",
          ko: "4R Ï±åÎ¶∞ÏßÄ",
          es: "Desaf√≠o 4R",
          de: "4R-Herausforderung",
          fi: "4R-haaste",
          fr: "D√©fi 4R",
          ar: "ÿ™ÿ≠ÿØŸä 4R",
          it: "Sfida 4R",
        },
        instruction: {
          en: "Which R is this?",
          zh: "ÈÄôÊòØÂì™‰∏ÄÂÄã RÔºü",
          ja: "„Åì„Çå„ÅØ„Å©„ÅÆR„Åß„Åô„ÅãÔºü",
          ko: "Ïñ¥Îñ§ RÏù∏Í∞ÄÏöî?",
          es: "¬øQu√© R es esta?",
          de: "Welches R ist das?",
          fi: "Mik√§ R t√§m√§ on?",
          fr: "Quel R est-ce ?",
          ar: "ÿ£Ÿä R Ÿáÿ∞ÿßÿü",
          it: "Quale R √® questa?",
        },

        reduce: {
          en: "Reduce",
          zh: "Ê∏õÂ∞ë‰ΩøÁî®",
          ja: "„É™„Éá„É•„Éº„Çπ (Ê∏õ„Çâ„Åô)",
          ko: "Ï†àÏïΩ (Reduce)",
          es: "Reducir",
          de: "Reduzieren",
          fi: "V√§henn√§",
          fr: "R√©duire",
          ar: "ÿ™ŸÇŸÑŸäŸÑ",
          it: "Ridurre",
        },
        reuse: {
          en: "Reuse",
          zh: "Áâ©Áõ°ÂÖ∂Áî®",
          ja: "„É™„É¶„Éº„Çπ (ÂÜçÂà©Áî®)",
          ko: "Ïû¨ÏÇ¨Ïö© (Reuse)",
          es: "Reutilizar",
          de: "Wiederverwenden",
          fi: "K√§yt√§ uudelleen",
          fr: "R√©utiliser",
          ar: "ÿ•ÿπÿßÿØÿ© ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ",
          it: "Riutilizzare",
        },
        recycle: {
          en: "Recycle",
          zh: "Âæ™Áí∞ÂÜçÈÄ†",
          ja: "„É™„Çµ„Ç§„ÇØ„É´ (ÂÜçÁîüÂà©Áî®)",
          ko: "Ïû¨ÌôúÏö© (Recycle)",
          es: "Reciclar",
          de: "Recyceln",
          fi: "Kierr√§t√§",
          fr: "Recycler",
          ar: "ÿ•ÿπÿßÿØÿ© ÿßŸÑÿ™ÿØŸàŸäÿ±",
          it: "Riciclare",
        },
        replace: {
          en: "Replace",
          zh: "Êõø‰ª£‰ΩøÁî®",
          ja: "„É™„Éó„É¨„Ç§„Çπ (‰ª£Êõø)",
          ko: "ÎåÄÏ≤¥ (Replace)",
          es: "Reemplazar",
          de: "Ersetzen",
          fi: "Korvaa",
          fr: "Remplacer",
          ar: "ÿßÿ≥ÿ™ÿ®ÿØÿßŸÑ",
          it: "Sostituire",
        },

        desc_reduce: {
          en: "Buy less, waste less",
          zh: "Â∞ëË≤∑ÔºåÂ∞ëÊµ™Ë≤ª",
          ja: "ÁÑ°ÈßÑ„ÇíÊ∏õ„Çâ„Åô",
          ko: "Ï†ÅÍ≤å ÏÇ¨Í≥† ÎÇ≠ÎπÑ Ï§ÑÏù¥Í∏∞",
          es: "Compra menos, desperdicia menos",
          de: "Kaufe weniger, verschwende weniger",
          fi: "Osta v√§hemm√§n, tuhlaa v√§hemm√§n",
          fr: "Achetez moins, gaspillez moins",
          ar: "ÿßÿ¥ÿ™ÿ±Ÿä ÿ£ŸÇŸÑÿå ÿ£ŸáÿØÿ± ÿ£ŸÇŸÑ",
          it: "Compra meno, spreca meno",
        },
        desc_reuse: {
          en: "Use it again",
          zh: "ÈáçË§á‰ΩøÁî®",
          ja: "„ÇÇ„ÅÜ‰∏ÄÂ∫¶‰Ωø„ÅÜ",
          ko: "Îã§Ïãú ÏÇ¨Ïö©ÌïòÍ∏∞",
          es: "√ösalo de nuevo",
          de: "Benutze es wieder",
          fi: "K√§yt√§ uudelleen",
          fr: "Utilisez-le √† nouveau",
          ar: "ÿßÿ≥ÿ™ÿÆÿØŸÖŸá ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ",
          it: "Usalo di nuovo",
        },
        desc_recycle: {
          en: "Make into new things",
          zh: "Ë£ΩÊàêÊñ∞Áâ©ÂìÅ",
          ja: "Êñ∞„Åó„ÅÑ„ÇÇ„ÅÆ„Å´Â§â„Åà„Çã",
          ko: "ÏÉàÎ°úÏö¥ Î¨ºÍ±¥ÏúºÎ°ú ÎßåÎì§Í∏∞",
          es: "Convertir en cosas nuevas",
          de: "Zu neuen Dingen machen",
          fi: "Tee uusiksi asioiksi",
          fr: "Faire de nouvelles choses",
          ar: "ÿ™ÿ≠ŸàŸäŸÑ ÿ•ŸÑŸâ ÿ£ÿ¥Ÿäÿßÿ° ÿ¨ÿØŸäÿØÿ©",
          it: "Trasforma in cose nuove",
        },
        desc_replace: {
          en: "Use eco-friendly items",
          zh: "Áî®Áí∞‰øùÁî¢ÂìÅ‰ª£Êõø",
          ja: "Áí∞Â¢É„Å´ÂÑ™„Åó„ÅÑ„ÇÇ„ÅÆ„Çí‰Ωø„ÅÜ",
          ko: "ÏπúÌôòÍ≤Ω Ï†úÌíà ÏÇ¨Ïö©ÌïòÍ∏∞",
          es: "Usa art√≠culos ecol√≥gicos",
          de: "Benutze umweltfreundliche Artikel",
          fi: "K√§yt√§ ymp√§rist√∂yst√§v√§llisi√§ tuotteita",
          fr: "Utilisez des articles √©cologiques",
          ar: "ÿßÿ≥ÿ™ÿÆÿØŸÖ ŸÖŸàÿßÿØ ÿµÿØŸäŸÇÿ© ŸÑŸÑÿ®Ÿäÿ¶ÿ©",
          it: "Usa articoli ecologici",
        },

        // Items
        item_towel: {
          en: "Handkerchief instead of Tissue",
          zh: "Áî®ÊâãÂ∏ï‰ª£ÊõøÁ¥ôÂ∑æ",
          ja: "„ÉÜ„Ç£„ÉÉ„Ç∑„É•„ÅÆ‰ª£„Çè„Çä„Å´„Éè„É≥„Ç´„ÉÅ",
          ko: "ÌôîÏû•ÏßÄ ÎåÄÏã† ÏÜêÏàòÍ±¥",
          es: "Pa√±uelo en lugar de pa√±uelo de papel",
          de: "Taschentuch statt Papiertuch",
          fi: "Nen√§liina paperiliinan sijaan",
          fr: "Mouchoir au lieu de mouchoir en papier",
          ar: "ÿßŸÑŸÖŸÜÿØŸäŸÑ ÿ®ÿØŸÑÿßŸã ŸÖŸÜ ÿßŸÑŸÖŸÜÿßÿØŸäŸÑ ÿßŸÑŸàÿ±ŸÇŸäÿ©",
          it: "Fazzoletto invece di fazzoletto di carta",
        },
        item_bottle: {
          en: "Refill Water Bottle",
          zh: "Ëá™ÂÇôÊ∞¥Ê®Ω",
          ja: "Ê∞¥Á≠í„ÇíÊåÅ„Å°Ê≠©„Åè",
          ko: "Î¨ºÎ≥ë Î¶¨ÌïÑ",
          es: "Rellenar botella de agua",
          de: "Wasserflasche auff√ºllen",
          fi: "T√§yt√§ vesipullo",
          fr: "Remplir la bouteille d'eau",
          ar: "ÿ•ÿπÿßÿØÿ© ŸÖŸÑÿ° ÿ≤ÿ¨ÿßÿ¨ÿ© ÿßŸÑŸÖÿßÿ°",
          it: "Riempi borraccia",
        },
        item_can: {
          en: "Aluminum Can",
          zh: "ÈãÅÁΩê",
          ja: "„Ç¢„É´„ÉüÁº∂",
          ko: "ÏïåÎ£®ÎØ∏ÎäÑ Ï∫î",
          es: "Lata de aluminio",
          de: "Alu-Dose",
          fi: "Alumiinit√∂lkki",
          fr: "Canette en aluminium",
          ar: "ÿπŸÑÿ®ÿ© ÿ£ŸÑŸàŸÖŸÜŸäŸàŸÖ",
          it: "Lattina di alluminio",
        },
        item_bag: {
          en: "Bring your own bag",
          zh: "Ëá™ÂÇôË≥ºÁâ©Ë¢ã",
          ja: "„Éû„Ç§„Éê„ÉÉ„Ç∞„ÇíÊåÅÂèÇ",
          ko: "Ïû•Î∞îÍµ¨Îãà Í∞ÄÏ†∏Ïò§Í∏∞",
          es: "Trae tu propia bolsa",
          de: "Bringe deine eigene Tasche mit",
          fi: "Tuo oma kassi",
          fr: "Apportez votre propre sac",
          ar: "ÿ£ÿ≠ÿ∂ÿ± ÿ≠ŸÇŸäÿ®ÿ™ŸÉ ÿßŸÑÿÆÿßÿµÿ©",
          it: "Porta la tua borsa",
        },
        item_paper: {
          en: "Write on both sides",
          zh: "Á¥ôÂºµÈõôÈù¢Áî®",
          ja: "‰∏°Èù¢„Å´Êõ∏„Åè",
          ko: "ÏñëÎ©¥ ÏÇ¨Ïö©",
          es: "Escribir en ambos lados",
          de: "Auf beiden Seiten schreiben",
          fi: "Kirjoita molemmille puolille",
          fr: "√âcrire des deux c√¥t√©s",
          ar: "ÿßŸÉÿ™ÿ® ÿπŸÑŸâ ŸÉŸÑÿß ÿßŸÑÿ¨ÿßŸÜÿ®ŸäŸÜ",
          it: "Scrivi su entrambi i lati",
        },
        item_plastic: {
          en: "Plastic Bottle -> Jersey",
          zh: "ËÜ†Ê®Ω -> ÁêÉË°£",
          ja: "„Éö„ÉÉ„Éà„Éú„Éà„É´ -> „Ç∏„É£„Éº„Ç∏",
          ko: "ÌîåÎùºÏä§Ìã± Î≥ë -> Ïö¥ÎèôÎ≥µ",
          es: "Botella de pl√°stico -> Camiseta",
          de: "Plastikflasche -> Trikot",
          fi: "Muovipullo -> Paita",
          fr: "Bouteille en plastique -> Maillot",
          ar: "ÿ≤ÿ¨ÿßÿ¨ÿ© ÿ®ŸÑÿßÿ≥ÿ™ŸäŸÉŸäÿ© -> ŸÇŸÖŸäÿµ",
          it: "Bottiglia di plastica -> Maglia",
        },
        item_donation: {
          en: "Donate old clothes",
          zh: "ÊçêË¥àËàäË°£",
          ja: "Âè§ÁùÄ„ÇíÂØÑ‰ªò",
          ko: "Ìóå Ïò∑ Í∏∞Î∂Ä",
          es: "Donar ropa vieja",
          de: "Alte Kleidung spenden",
          fi: "Lahjoita vanhat vaatteet",
          fr: "Donner de vieux v√™tements",
          ar: "ÿ™ÿ®ÿ±ÿπ ÿ®ÿßŸÑŸÖŸÑÿßÿ®ÿ≥ ÿßŸÑŸÇÿØŸäŸÖÿ©",
          it: "Dona vecchi vestiti",
        },
        item_less: {
          en: "Buy only what you need",
          zh: "Âè™Ë≤∑ÈúÄË¶ÅÁöÑÊù±Ë•ø",
          ja: "ÂøÖË¶Å„Å™„ÇÇ„ÅÆ„Å†„ÅëË≤∑„ÅÜ",
          ko: "ÌïÑÏöîÌïú Í≤ÉÎßå ÏÇ¨Í∏∞",
          es: "Compra solo lo que necesitas",
          de: "Kaufe nur was du brauchst",
          fi: "Osta vain mit√§ tarvitset",
          fr: "Achetez seulement ce dont vous avez besoin",
          ar: "ÿßÿ¥ÿ™ÿ±Ÿä ŸÖÿß ÿ™ÿ≠ÿ™ÿßÿ¨Ÿá ŸÅŸÇÿ∑",
          it: "Compra solo ci√≤ di cui hai bisogno",
        },

        correct: {
          en: "Correct!",
          zh: "Á≠îÂ∞ç‰∫ÜÔºÅ",
          ja: "Ê≠£Ëß£ÔºÅ",
          ko: "Ï†ïÎãµÏûÖÎãàÎã§!",
          es: "¬°Correcto!",
          de: "Richtig!",
          fi: "Oikein!",
          fr: "Correct !",
          ar: "ÿµÿ≠Ÿäÿ≠!",
          it: "Corretto!",
        },
        wrong: {
          en: "Try Again",
          zh: "ÂÜçË©¶‰∏ÄÊ¨°",
          ja: "„ÇÇ„ÅÜ‰∏ÄÂ∫¶",
          ko: "Îã§Ïãú ÏãúÎèÑÌïòÏÑ∏Ïöî",
          es: "Int√©ntalo de nuevo",
          de: "Versuch es nochmal",
          fi: "Yrit√§ uudelleen",
          fr: "R√©essayez",
          ar: "ÿ≠ÿßŸàŸÑ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ",
          it: "Riprova",
        },
        completed: {
          en: "Green Hero!",
          zh: "Áí∞‰øùÂ∞èÂÖàÈãíÔºÅ",
          ja: "„Ç®„Ç≥„Éí„Éº„É≠„ÉºÔºÅ",
          ko: "ÌôòÍ≤Ω ÏòÅÏõÖ!",
          es: "¬°H√©roe Verde!",
          de: "Umweltheld!",
          fi: "Vihre√§ sankari!",
          fr: "H√©ros vert !",
          ar: "ÿ®ÿ∑ŸÑ ÿ£ÿÆÿ∂ÿ±!",
          it: "Eroe Verde!",
        },
        reset: {
          en: "Play Again",
          zh: "ÂÜçÁé©‰∏ÄÊ¨°",
          ja: "„ÇÇ„ÅÜ‰∏ÄÂ∫¶„Éó„É¨„Ç§",
          ko: "Îã§Ïãú ÌïòÍ∏∞",
          es: "Jugar de Nuevo",
          de: "Nochmal spielen",
          fi: "Pelaa uudelleen",
          fr: "Rejouer",
          ar: "ÿßŸÑÿπÿ® ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ",
          it: "Gioca di Nuovo",
        },
      };

      const categories = [
        { id: "reduce", color: "bg-red-500", icon: "üìâ" },
        { id: "reuse", color: "bg-yellow-500", icon: "üîÑ" },
        { id: "recycle", color: "bg-blue-500", icon: "‚ôªÔ∏è" },
        { id: "replace", color: "bg-green-500", icon: "üåø" },
      ];

      const items = [
        { id: "item_towel", type: "replace", icon: "ü§ß‚û°Ô∏èüü©" },
        { id: "item_bottle", type: "reuse", icon: "üö∞" }, // Can be reuse or replace (disposable). Standard: Reuse
        { id: "item_can", type: "recycle", icon: "ü•´" },
        { id: "item_bag", type: "reduce", icon: "üõçÔ∏è" }, // Reduce plastic bags usage
        { id: "item_paper", type: "reduce", icon: "üìÑ" }, // Also reuse. But Reduce waste is key. Let's strictly map for P3.
        { id: "item_plastic", type: "recycle", icon: "üëï" },
        { id: "item_donation", type: "reuse", icon: "üëö" },
        { id: "item_less", type: "reduce", icon: "üõí" },
      ];

      // Strict mapping overrides for clearer teaching
      // Reduce: Buy less, use less (Paper both sides, No plastic bag)
      // Reuse: Use again (Water bottle refill, Donate clothes)
      // Recycle: Blue/Brown/Yellow bins (Can, Plastic to Jersey)
      // Replace: Use X instead of Y (Handkerchief instead of tissue)

      function App() {
        const [lang, setLang] = useState("zh");
        const [queue, setQueue] = useState([]);
        const [current, setCurrent] = useState(null);
        const [feedback, setFeedback] = useState(null);
        const [score, setScore] = useState(0);

        const getText = (key) => t[key][lang] || t[key]["en"];

        useEffect(() => {
          initGame();
        }, []);

        const initGame = () => {
          const q = [...items].sort(() => Math.random() - 0.5);
          setQueue(q);
          setCurrent(q[0]);
          setScore(0);
          setFeedback(null);
        };

        const handleSort = (catId) => {
          if (feedback) return;

          if (current.type === catId) {
            setFeedback("correct");
            setScore((s) => s + 10);
            setTimeout(() => {
              setFeedback(null);
              const nextIdx = queue.indexOf(current) + 1;
              if (nextIdx < queue.length) setCurrent(queue[nextIdx]);
              else setCurrent(null);
            }, 800);
          } else {
            setFeedback("wrong");
            setScore((s) => Math.max(0, s - 5));
            setTimeout(() => setFeedback(null), 800);
          }
        };

        return (
          <div className="min-h-screen p-4 flex flex-col items-center select-none font-sans overflow-hidden">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl md:text-5xl font-black text-white mb-2 mt-8 drop-shadow-md z-10">
              ‚ôªÔ∏è {getText("title")}
            </h1>

            <div className="font-bold text-green-900 bg-white/60 px-6 py-2 rounded-full mb-6 text-xl">
              Score: {score}
            </div>

            {current ? (
              <div className="w-full max-w-4xl flex flex-col items-center flex-1 justify-center relative">
                {/* Item Card */}
                <div className="relative z-20 mb-8">
                  <motion.div
                    key={current.id}
                    initial={{ scale: 0, rotate: 180 }}
                    animate={{ scale: 1, rotate: 0 }}
                    exit={{ scale: 0 }}
                    className="bg-white p-10 rounded-[3rem] shadow-2xl border-8 border-green-200 flex flex-col items-center text-center w-80 h-80 justify-center"
                  >
                    <div className="text-8xl mb-4">{current.icon}</div>
                    <div className="text-2xl font-black text-slate-700 leading-tight">
                      {getText(current.id)}
                    </div>
                  </motion.div>

                  {feedback && (
                    <div
                      className={`absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-30 px-6 py-4 rounded-3xl font-black text-3xl shadow-2xl whitespace-nowrap ${
                        feedback === "correct"
                          ? "bg-green-600 text-white"
                          : "bg-red-500 text-white"
                      }`}
                    >
                      {getText(feedback)}
                    </div>
                  )}
                </div>

                <p className="font-bold text-white mb-8 text-2xl drop-shadow-lg">
                  {getText("instruction")}
                </p>

                {/* Bins / Categories */}
                <div className="grid grid-cols-2 md:grid-cols-4 gap-4 w-full">
                  {categories.map((cat) => (
                    <button
                      key={cat.id}
                      onClick={() => handleSort(cat.id)}
                      className={`${cat.color} text-white rounded-2xl p-4 flex flex-col items-center shadow-lg hover:brightness-110 active:scale-95 transition-all border-b-8 border-black/20`}
                    >
                      <div className="text-5xl mb-2">{cat.icon}</div>
                      <div className="font-black text-xl md:text-2xl">
                        {getText(cat.id)}
                      </div>
                      <div className="text-xs md:text-sm font-bold opacity-80 mt-1 leading-tight text-center">
                        {getText(`desc_${cat.id}`)}
                      </div>
                    </button>
                  ))}
                </div>
              </div>
            ) : (
              <div className="bg-white/95 p-12 rounded-[3rem] shadow-2xl text-center mt-20 backdrop-blur-sm">
                <div className="text-8xl mb-4">üåç</div>
                <h2 className="text-4xl font-black text-green-700 mb-6">
                  {getText("completed")}
                </h2>
                <p className="text-2xl font-bold text-slate-600 mb-8">
                  Score: {score}
                </p>
                <button
                  onClick={initGame}
                  className="bg-green-600 text-white px-12 py-4 rounded-full font-black text-2xl hover:bg-green-700 shadow-xl"
                >
                  {getText("reset")} üîÑ
                </button>
              </div>
            )}
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
