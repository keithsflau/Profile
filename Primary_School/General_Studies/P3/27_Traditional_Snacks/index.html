<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å°ä¸‰å¸¸è­˜ï¼šæ‡·èˆŠå°é£Ÿåº— | Traditional Snacks</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: radial-gradient(circle at center, #fdba74 0%, #ea580c 100%);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Traditional Snacks",
          zh: "æ‡·èˆŠå°é£Ÿåº—",
          ja: "ä¼çµ±çš„ãªãŠè“å­",
          ko: "ì „í†µ ê°„ì‹",
          es: "Bocadillos Tradicionales",
          de: "Traditionelle Snacks",
          fi: "Perinteiset vÃ¤lipalat",
          fr: "Collations traditionnelles",
          ar: "Ø§Ù„ÙˆØ¬Ø¨Ø§Øª Ø§Ù„Ø®ÙÙŠÙØ© Ø§Ù„ØªÙ‚Ù„ÙŠØ¯ÙŠØ©",
          it: "Spuntini Tradizionali",
        },
        instruction: {
          en: "Give the customer what they want!",
          zh: "çµ¦é¡§å®¢æƒ³è¦çš„é£Ÿç‰©ï¼",
          ja: "ãŠå®¢ã•ã‚“ã®æ¬²ã—ã„ã‚‚ã®ã‚’ã‚ã’ã¦ï¼",
          ko: "ì†ë‹˜ì´ ì›í•˜ëŠ” ê²ƒì„ ì£¼ì„¸ìš”!",
          es: "Â¡Dale al cliente lo que quiere!",
          de: "Gib dem Kunden, was er will!",
          fi: "Anna asiakkaalle mitÃ¤ hÃ¤n haluaa!",
          fr: "Donnez au client ce qu'il veut !",
          ar: "Ø£Ø¹Ø· Ø§Ù„Ø²Ø¨ÙˆÙ† Ù…Ø§ ÙŠØ±ÙŠØ¯!",
          it: "Dai al cliente ciÃ² che vuole!",
        },

        eggtart: {
          en: "Egg Tart",
          zh: "è›‹æ’»",
          ja: "ã‚¨ãƒƒã‚°ã‚¿ãƒ«ãƒˆ",
          ko: "ì—ê·¸ íƒ€ë¥´íŠ¸",
          es: "Tarta de huevo",
          de: "EÃ¶rtchen",
          fi: "Munatorttu",
          fr: "Tarte aux Å“ufs",
          ar: "ØªØ§Ø±Øª Ø§Ù„Ø¨ÙŠØ¶",
          it: "Crostata all'uovo",
        },
        pineapplebun: {
          en: "Pineapple Bun",
          zh: "è è˜¿åŒ…",
          ja: "ãƒ‘ã‚¤ãƒŠãƒƒãƒ—ãƒ«ãƒ‘ãƒ³",
          ko: "íŒŒì¸ì• í”Œ ë²ˆ",
          es: "Bollo de piÃ±a",
          de: "AnanasbrÃ¶tchen",
          fi: "AnanassÃ¤mpylÃ¤",
          fr: "Pain ananas",
          ar: "ÙƒØ¹ÙƒØ© Ø§Ù„Ø£Ù†Ø§Ù†Ø§Ø³",
          it: "Panino all'ananas",
        },
        fishball: {
          en: "Fishballs",
          zh: "å’–å–±é­šè›‹",
          ja: "ãƒ•ã‚£ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ«",
          ko: "ì–´ë¬µ",
          es: "Bolas de pescado",
          de: "FischbÃ¤llchen",
          fi: "Kalapullat",
          fr: "Boulettes de poisson",
          ar: "ÙƒØ±Ø§Øª Ø§Ù„Ø³Ù…Ùƒ",
          it: "Polpette di pesce",
        },
        putchaiko: {
          en: "Put Chai Ko",
          zh: "ç µä»”ç³•",
          ja: "ãƒ—ãƒãƒ£ã‚¤ã‚³ãƒ¼",
          ko: "íŒ¥ë–¡",
          es: "Pastel de arroz",
          de: "Reiskuchen",
          fi: "Riisiikakku",
          fr: "GÃ¢teau de riz",
          ar: "ÙƒØ¹ÙƒØ© Ø§Ù„Ø£Ø±Ø²",
          it: "Torta di riso",
        },
        gridcake: {
          en: "Grid Cake",
          zh: "æ ¼ä»”é¤…",
          ja: "ãƒ¯ãƒƒãƒ•ãƒ«",
          ko: "ì™€í”Œ",
          es: "Gofre",
          de: "Waffel",
          fi: "Vohveli",
          fr: "Gaufre",
          ar: "ÙˆØ§ÙÙ„",
          it: "Waffle",
        },
        eggwaffle: {
          en: "Egg Waffle",
          zh: "é›è›‹ä»”",
          ja: "ã‚¨ãƒƒã‚°ãƒ¯ãƒƒãƒ•ãƒ«",
          ko: "ê³„ë€ë¹µ",
          es: "Gofre de huevo",
          de: "Eierwaffel",
          fi: "Munavohveli",
          fr: "Gaufre aux Å“ufs",
          ar: "ÙˆØ§ÙÙ„ Ø§Ù„Ø¨ÙŠØ¶",
          it: "Waffle all'uovo",
        },

        order: {
          en: "I would like a...",
          zh: "æˆ‘æƒ³è¦ä¸€å€‹...",
          ja: "ã“ã‚Œã‚’ãã ã•ã„...",
          ko: "ì£¼ì„¸ìš”...",
          es: "Me gustarÃ­a un...",
          de: "Ich hÃ¤tte gerne ein...",
          fi: "Haluaisin...",
          fr: "Je voudrais un...",
          ar: "Ø£Ø±ÙŠØ¯...",
          it: "Vorrei un...",
        },
        correct: {
          en: "Yummy!",
          zh: "å¥½å‘³ï¼",
          ja: "ãŠã„ã—ã„ï¼",
          ko: "ë§›ìˆì–´ìš”!",
          es: "Â¡Delicioso!",
          de: "Lecker!",
          fi: "Nam!",
          fr: "Miam !",
          ar: "Ù„Ø°ÙŠØ°!",
          it: "Delizioso!",
        },
        wrong: {
          en: "Not this one!",
          zh: "ä¸æ˜¯é€™å€‹ï¼",
          ja: "ã“ã‚Œã˜ã‚ƒãªã„ï¼",
          ko: "ì´ê²Œ ì•„ë‹ˆì—ìš”!",
          es: "Â¡Este no!",
          de: "Nicht das!",
          fi: "Ei tÃ¤mÃ¤!",
          fr: "Pas celui-lÃ  !",
          ar: "Ù„ÙŠØ³ Ù‡Ø°Ø§!",
          it: "Non questo!",
        },
        completed: {
          en: "Shop Closed!",
          zh: "å…¨éƒ¨å”®ç½„ï¼",
          ja: "é–‰åº—ï¼",
          ko: "ì˜ì—… ì¢…ë£Œ!",
          es: "Â¡Tienda Cerrada!",
          de: "GeschÃ¤ft geschlossen!",
          fi: "Kauppa kiinni!",
          fr: "Magasin fermÃ© !",
          ar: "Ø§Ù„Ù…ØªØ¬Ø± Ù…ØºÙ„Ù‚!",
          it: "Negozio Chiuso!",
        },
        reset: {
          en: "Open Shop",
          zh: "é‡æ–°é–‹å¼µ",
          ja: "é–‹åº—",
          ko: "ê°œì ",
          es: "Abrir Tienda",
          de: "GeschÃ¤ft Ã¶ffnen",
          fi: "Avaa kauppa",
          fr: "Ouvrir le magasin",
          ar: "Ø§ÙØªØ­ Ø§Ù„Ù…ØªØ¬Ø±",
          it: "Apri Negozio",
        },
      };

      const snacks = [
        { id: "eggtart", icon: "ğŸ¥§", color: "bg-yellow-100" },
        { id: "pineapplebun", icon: "ğŸ¥¯", color: "bg-orange-100" },
        { id: "fishball", icon: "ğŸ¡", color: "bg-orange-200" },
        { id: "putchaiko", icon: "ğŸ®", color: "bg-amber-800 text-white" }, // Brown sugar cake approximation
        { id: "eggwaffle", icon: "ğŸ§‡", color: "bg-yellow-200" }, // Simulating bubble waffle
        { id: "gridcake", icon: "ğŸ¥", color: "bg-orange-50" }, // Simulating grid cake
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [queue, setQueue] = useState([]);
        const [current, setCurrent] = useState(null);
        const [feedback, setFeedback] = useState(null);
        const [score, setScore] = useState(0);

        const getText = (key) => t[key][lang] || t[key]["en"];

        useEffect(() => {
          initGame();
        }, []);

        const initGame = () => {
          // Generate random orders
          const q = [];
          for (let i = 0; i < 10; i++) {
            q.push(snacks[Math.floor(Math.random() * snacks.length)]);
          }
          setQueue(q);
          setCurrent(q[0]);
          setScore(0);
          setFeedback(null);
        };

        const handleServe = (snackId) => {
          if (feedback) return;
          if (!current) return;

          if (current.id === snackId) {
            setFeedback("correct");
            setScore((s) => s + 10);
            setTimeout(() => {
              setFeedback(null);
              const nextIdx = queue.indexOf(current) + 1; // This logic is flawed if duplicates exist differently.
              // Queue logic fix: pop from start
              const newQueue = queue.slice(1);
              setQueue(newQueue);
              if (newQueue.length > 0) setCurrent(newQueue[0]);
              else setCurrent(null);
            }, 800);
          } else {
            setFeedback("wrong");
            setScore((s) => Math.max(0, s - 5));
            setTimeout(() => setFeedback(null), 500);
          }
        };

        return (
          <div className="min-h-screen p-4 flex flex-col items-center select-none font-sans overflow-hidden">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl md:text-5xl font-black text-orange-900 mb-2 mt-8 drop-shadow-sm bg-white/50 px-6 py-2 rounded-full">
              ğŸ¥¯ {getText("title")}
            </h1>

            <div className="font-bold text-orange-900 text-xl mb-4 bg-white/40 px-4 py-1 rounded-full border-2 border-orange-300">
              ğŸ’° Earnings: ${score}
            </div>

            {current ? (
              <div className="w-full max-w-4xl flex flex-col items-center flex-1 justify-center relative">
                {/* Customer Bubble */}
                <div className="relative mb-12">
                  <div className="bg-white p-8 rounded-[2rem] shadow-2xl border-b-8 border-orange-200 relative w-[20rem] text-center">
                    <div className="absolute -bottom-6 left-1/2 -translate-x-1/2 w-0 h-0 border-l-[20px] border-l-transparent border-r-[20px] border-r-transparent border-t-[30px] border-orange-200"></div>

                    <div className="text-xl font-bold text-slate-500 mb-4">
                      {getText("order")}
                    </div>
                    <div className="text-4xl font-black text-orange-800">
                      {getText(current.id)}
                    </div>

                    {feedback && (
                      <motion.div
                        initial={{ scale: 0 }}
                        animate={{ scale: 1 }}
                        className={`absolute inset-0 rounded-[2rem] flex items-center justify-center font-black text-3xl text-white z-10 ${
                          feedback === "correct" ? "bg-green-500" : "bg-red-500"
                        }`}
                      >
                        {getText(feedback)}
                      </motion.div>
                    )}
                  </div>

                  {/* Customer Avatar */}
                  <div className="mt-8 text-8xl text-center">ğŸ˜‹</div>
                </div>

                {/* Counter / Shop */}
                <div className="bg-orange-100/80 p-8 rounded-t-[3rem] w-full shadow-inner border-t-8 border-orange-300 flex flex-col items-center flex-1">
                  <div className="font-bold text-orange-800 mb-6 text-xl">
                    {getText("instruction")}
                  </div>

                  <div className="grid grid-cols-2 md:grid-cols-3 gap-6 w-full max-w-2xl">
                    {snacks.map((snack) => (
                      <button
                        key={snack.id}
                        onClick={() => handleServe(snack.id)}
                        className={`${snack.color} p-4 rounded-xl shadow-lg border-b-4 border-black/10 active:scale-95 transition-all hover:brightness-110 flex flex-col items-center`}
                      >
                        <div className="text-6xl mb-2 drop-shadow-md">
                          {snack.icon}
                        </div>
                        <div className="font-bold text-slate-800 leading-tight">
                          {getText(snack.id)}
                        </div>
                      </button>
                    ))}
                  </div>
                </div>
              </div>
            ) : (
              <div className="bg-white/90 p-12 rounded-3xl shadow-xl text-center mt-20">
                <div className="text-8xl mb-4">ğŸª</div>
                <h2 className="text-4xl font-black text-orange-800 mb-6">
                  {getText("completed")}
                </h2>
                <p className="text-2xl font-bold text-slate-600 mb-8">
                  Total: ${score}
                </p>
                <button
                  onClick={initGame}
                  className="bg-orange-600 text-white px-10 py-4 rounded-full font-black text-2xl hover:bg-orange-700 shadow-xl"
                >
                  {getText("reset")} ğŸ”„
                </button>
              </div>
            )}
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
