<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Â∞è‰∏âÂ∏∏Ë≠òÔºöÂ§©Ê∞£Ë≠¶ÂëäË®äËôü | Weather Signals</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: radial-gradient(circle at center, #cbd5e1 0%, #64748b 100%);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Weather Signals",
          zh: "Â§©Ê∞£Ë≠¶ÂëäË®äËôü",
          ja: "Ê∞óË±°Ë≠¶Â†±",
          ko: "ÎÇ†Ïî® Í≤ΩÎ≥¥",
          es: "Se√±ales Meteorol√≥gicas",
          de: "Wettersignale",
          fi: "S√§√§merkit",
          fr: "Signaux m√©t√©orologiques",
          ar: "ÿ•ÿ¥ÿßÿ±ÿßÿ™ ÿßŸÑÿ∑ŸÇÿ≥",
          it: "Segnali Meteorologici",
        },
        instruction: {
          en: "Match the signal!",
          zh: "ÈÖçÂ∞çÊ≠£Á¢∫ÁöÑË®äËôüÔºÅ",
          ja: "Ê≠£„Åó„ÅÑ‰ø°Âè∑„ÇíÂêà„Çè„Åõ„Å¶„Åè„Å†„Åï„ÅÑÔºÅ",
          ko: "Ïã†Ìò∏Î•º ÎßûÏ∂îÏÑ∏Ïöî!",
          es: "¬°Empareja la se√±al!",
          de: "Ordne das Signal zu!",
          fi: "Yhdist√§ merkki!",
          fr: "Associez le signal !",
          ar: "ÿ∑ÿßÿ®ŸÇ ÿßŸÑÿ•ÿ¥ÿßÿ±ÿ©!",
          it: "Abbina il segnale!",
        },

        t1: {
          en: "T1 Standby",
          zh: "‰∏ÄËôüÊàíÂÇôË®äËôü",
          ja: "T1 Ë≠¶Êàí",
          ko: "T1 ÎåÄÍ∏∞",
          es: "T1 Espera",
          de: "T1 Bereitschaft",
          fi: "T1 Valmiustila",
          fr: "T1 Veille",
          ar: "T1 ÿßÿ≥ÿ™ÿπÿØÿßÿØ",
          it: "T1 Standby",
        },
        t3: {
          en: "T3 Strong Wind",
          zh: "‰∏âËôüÂº∑È¢®Ë®äËôü",
          ja: "T3 Âº∑È¢®",
          ko: "T3 Í∞ïÌíç",
          es: "T3 Viento Fuerte",
          de: "T3 Starker Wind",
          fi: "T3 Kova tuuli",
          fr: "T3 Vent fort",
          ar: "T3 ÿ±Ÿäÿßÿ≠ ŸÇŸàŸäÿ©",
          it: "T3 Vento Forte",
        },
        t8: {
          en: "T8 Gale or Storm",
          zh: "ÂÖ´ËôüÁÉàÈ¢®ÊàñÊö¥È¢®Ë®äËôü",
          ja: "T8 Êö¥È¢®",
          ko: "T8 Í∞ïÌíç ÎòêÎäî Ìè≠Ìíç",
          es: "T8 Vendaval o Tormenta",
          de: "T8 Sturm",
          fi: "T8 Myrsky",
          fr: "T8 coup de vent ou temp√™te",
          ar: "T8 ÿπÿßÿµŸÅÿ©",
          it: "T8 Burrasca o Tempesta",
        },

        amber: {
          en: "Amber Rain",
          zh: "ÈªÉËâ≤Êö¥Èõ®",
          ja: "ÈªÑËâ≤Ë±™Èõ®",
          ko: "Ìô©ÏÉâ Ìò∏Ïö∞",
          es: "Lluvia √Åmbar",
          de: "Gelber Regen",
          fi: "Keltainen sade",
          fr: "Pluie ambr√©e",
          ar: "ŸÖÿ∑ÿ± ŸÉŸáÿ±ŸÖÿßŸÜŸä",
          it: "Pioggia Ambra",
        },
        red: {
          en: "Red Rain",
          zh: "Á¥ÖËâ≤Êö¥Èõ®",
          ja: "Ëµ§Ëâ≤Ë±™Èõ®",
          ko: "Ï†ÅÏÉâ Ìò∏Ïö∞",
          es: "Lluvia Roja",
          de: "Roter Regen",
          fi: "Punainen sade",
          fr: "Pluie rouge",
          ar: "ŸÖÿ∑ÿ± ÿ£ÿ≠ŸÖÿ±",
          it: "Pioggia Rossa",
        },
        black: {
          en: "Black Rain",
          zh: "ÈªëËâ≤Êö¥Èõ®",
          ja: "ÈªíËâ≤Ë±™Èõ®",
          ko: "ÌùëÏÉâ Ìò∏Ïö∞",
          es: "Lluvia Negra",
          de: "Schwarzer Regen",
          fi: "Musta sade",
          fr: "Pluie noire",
          ar: "ŸÖÿ∑ÿ± ÿ£ÿ≥ŸàÿØ",
          it: "Pioggia Nera",
        },

        hot: {
          en: "Very Hot",
          zh: "ÈÖ∑ÁÜ±Â§©Ê∞£",
          ja: "ÁåõÊöë",
          ko: "Îß§Ïö∞ ÎçîÏõÄ",
          es: "Muy Caliente",
          de: "Sehr hei√ü",
          fi: "Todella kuuma",
          fr: "Tr√®s chaud",
          ar: "ÿ≠ÿßÿ± ÿ¨ÿØÿß",
          it: "Molto Caldo",
        },
        cold: {
          en: "Cold",
          zh: "ÂØíÂÜ∑Â§©Ê∞£",
          ja: "ÂØíÂÜ∑",
          ko: "Ï∂îÏõÄ",
          es: "Fr√≠o",
          de: "Kalt",
          fi: "Kylm√§",
          fr: "Froid",
          ar: "ÿ®ÿßÿ±ÿØ",
          it: "Freddo",
        },
        thunder: {
          en: "Thunderstorm",
          zh: "Èõ∑Êö¥",
          ja: "Èõ∑Èõ®",
          ko: "ÎáåÏö∞",
          es: "Tormenta el√©ctrica",
          de: "Gewitter",
          fi: "Ukkosmyrsky",
          fr: "Orage",
          ar: "ÿπÿßÿµŸÅÿ© ÿ±ÿπÿØŸäÿ©",
          it: "Temporale",
        },

        desc_t1: {
          en: "Typhoon is near",
          zh: "È¢±È¢®Êé•Ëøë",
          ja: "Âè∞È¢®„ÅåËøë„Å•„ÅÑ„Å¶„ÅÑ„Åæ„Åô",
          ko: "ÌÉúÌíçÏù¥ Ï†ëÍ∑º Ï§ëÏûÖÎãàÎã§",
          es: "El tif√≥n est√° cerca",
          de: "Taifun ist nah",
          fi: "Taifuuni on l√§hell√§",
          fr: "Le typhon est proche",
          ar: "ÿßŸÑÿ•ÿπÿµÿßÿ± ŸÇÿ±Ÿäÿ®",
          it: "Il tifone √® vicino",
        },
        desc_t3: {
          en: "Wind is strong",
          zh: "È¢®Âã¢Â¢ûÂº∑",
          ja: "È¢®„ÅåÂº∑„ÅÑ",
          ko: "Î∞îÎûåÏù¥ Í∞ïÌï©ÎãàÎã§",
          es: "El viento es fuerte",
          de: "Wind ist stark",
          fi: "Tuuli on voimakas",
          fr: "Le vent est fort",
          ar: "ÿßŸÑÿ±Ÿäÿßÿ≠ ŸÇŸàŸäÿ©",
          it: "Il vento √® forte",
        },
        desc_t8: {
          en: "No school/work",
          zh: "ÂÅúË™≤ÂÅúÂ∑•",
          ja: "Â≠¶Ê†°„Éª‰ªï‰∫ã‰ºë„Åø",
          ko: "Ìú¥Íµê/Ìú¥Î¨¥",
          es: "Sin escuela/trabajo",
          de: "Keine Schule/Arbeit",
          fi: "Ei koulua/t√∂it√§",
          fr: "Pas d'√©cole/travail",
          ar: "ŸÑÿß ŸÖÿØÿ±ÿ≥ÿ©/ÿπŸÖŸÑ",
          it: "Niente scuola/lavoro",
        },

        desc_amber: {
          en: "Heavy rain",
          zh: "Â§ßÈõ®",
          ja: "Â§ßÈõ®",
          ko: "Ìè≠Ïö∞",
          es: "Lluvia fuerte",
          de: "Starker Regen",
          fi: "Rankkasade",
          fr: "Forte pluie",
          ar: "ŸÖÿ∑ÿ± ÿ∫ÿ≤Ÿäÿ±",
          it: "Pioggia forte",
        },
        desc_red: {
          en: "Very heavy rain",
          zh: "ÂæàÂ§ßÈõ®",
          ja: "ÊøÄ„Åó„ÅÑÈõ®",
          ko: "Îß§Ïö∞ ÎßéÏùÄ ÎπÑ",
          es: "Lluvia muy fuerte",
          de: "Sehr starker Regen",
          fi: "Eritt√§in rankkasade",
          fr: "Pluie tr√®s forte",
          ar: "ŸÖÿ∑ÿ± ÿ∫ÿ≤Ÿäÿ± ÿ¨ÿØÿß",
          it: "Pioggia molto forte",
        },
        desc_black: {
          en: "Dangerous rain",
          zh: "Ê•µÂ§ßÈõ®",
          ja: "Âç±Èô∫„Å™Èõ®",
          ko: "ÏúÑÌóòÌïú ÎπÑ",
          es: "Lluvia peligrosa",
          de: "Gef√§hrlicher Regen",
          fi: "Vaarallinen sade",
          fr: "Pluie dangereuse",
          ar: "ŸÖÿ∑ÿ± ÿÆÿ∑Ÿäÿ±",
          it: "Pioggia pericolosa",
        },

        desc_hot: {
          en: "Drink water",
          zh: "Â§öÂñùÊ∞¥",
          ja: "Ê∞¥„ÇíÈ£≤„ÇÄ",
          ko: "Î¨ºÏùÑ ÎßàÏãúÏÑ∏Ïöî",
          es: "Bebe agua",
          de: "Trink Wasser",
          fi: "Juo vett√§",
          fr: "Buvez de l'eau",
          ar: "ÿßÿ¥ÿ±ÿ® ÿßŸÑŸÖÿßÿ°",
          it: "Bevi acqua",
        },
        desc_cold: {
          en: "Wear warm clothes",
          zh: "Â§öÁ©øË°£Êúç",
          ja: "Êöñ„Åã„ÅÑÊúç„ÇíÁùÄ„Çã",
          ko: "Îî∞ÎúªÌïòÍ≤å ÏûÖÏúºÏÑ∏Ïöî",
          es: "Usa ropa abrigada",
          de: "Zieh warme Kleidung an",
          fi: "Pukeudu l√§mpim√§sti",
          fr: "Portez des v√™tements chauds",
          ar: "ÿßÿ±ÿ™ÿØ ŸÖŸÑÿßÿ®ÿ≥ ÿØÿßŸÅÿ¶ÿ©",
          it: "Indossa vestiti caldi",
        },
        desc_thunder: {
          en: "Stay indoors",
          zh: "ÁïôÂú®ÂÆ§ÂÖß",
          ja: "Â±ãÂÜÖ„Å´Áïô„Åæ„Çã",
          ko: "Ïã§ÎÇ¥Ïóê Î®∏Î¨¥ÏÑ∏Ïöî",
          es: "Qu√©date adentro",
          de: "Bleib drinnen",
          fi: "Pysy sis√§ll√§",
          fr: "Restez √† l'int√©rieur",
          ar: "ÿßÿ®ŸÇ ŸÅŸä ÿßŸÑÿØÿßÿÆŸÑ",
          it: "Rimani al chiuso",
        },

        correct: {
          en: "Correct!",
          zh: "Ê≠£Á¢∫ÔºÅ",
          ja: "Ê≠£Ëß£ÔºÅ",
          ko: "Ï†ïÎãµÏûÖÎãàÎã§!",
          es: "¬°Correcto!",
          de: "Richtig!",
          fi: "Oikein!",
          fr: "Correct !",
          ar: "ÿµÿ≠Ÿäÿ≠!",
          it: "Corretto!",
        },
        wrong: {
          en: "Wrong Signal!",
          zh: "ÈåØË™§Ë®äËôüÔºÅ",
          ja: "ÈñìÈÅï„Å£„Åü‰ø°Âè∑ÔºÅ",
          ko: "ÏûòÎ™ªÎêú Ïã†Ìò∏!",
          es: "¬°Se√±al incorrecta!",
          de: "Falsches Signal!",
          fi: "V√§√§r√§ merkki!",
          fr: "Mauvais signal !",
          ar: "ÿ•ÿ¥ÿßÿ±ÿ© ÿÆÿßÿ∑ÿ¶ÿ©!",
          it: "Segnale errato!",
        },
        completed: {
          en: "Weather Expert!",
          zh: "Â§©Ê∞£Â∞èÂ∞àÂÆ∂ÔºÅ",
          ja: "„ÅäÂ§©Ê∞ó„Ç®„Ç≠„Çπ„Éë„Éº„ÉàÔºÅ",
          ko: "ÎÇ†Ïî® Ï†ÑÎ¨∏Í∞Ä!",
          es: "¬°Experto en Clima!",
          de: "Wetterexperte!",
          fi: "S√§√§asiantuntija!",
          fr: "Expert m√©t√©o !",
          ar: "ÿÆÿ®Ÿäÿ± ÿßŸÑÿ∑ŸÇÿ≥!",
          it: "Esperto Meteo!",
        },
        reset: {
          en: "Play Again",
          zh: "ÂÜçÁé©‰∏ÄÊ¨°",
          ja: "„ÇÇ„ÅÜ‰∏ÄÂ∫¶„Éó„É¨„Ç§",
          ko: "Îã§Ïãú ÌïòÍ∏∞",
          es: "Jugar de Nuevo",
          de: "Nochmal spielen",
          fi: "Pelaa uudelleen",
          fr: "Rejouer",
          ar: "ÿßŸÑÿπÿ® ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ",
          it: "Gioca di Nuovo",
        },
      };

      // Simplified visuals for signals using text/emoji/color blocks to simulate HK Observatory icons
      const signals = [
        {
          id: "t1",
          type: "typhoon",
          color: "bg-white text-black",
          label: "1",
          shape: "T",
        },
        {
          id: "t3",
          type: "typhoon",
          color: "bg-white text-black",
          label: "3",
          shape: "T",
        },
        {
          id: "t8",
          type: "typhoon",
          color: "bg-white text-black",
          label: "8",
          shape: "T",
        },

        {
          id: "amber",
          type: "rain",
          color: "bg-yellow-400 text-black",
          label: "üåßÔ∏è",
          shape: "Box",
        },
        {
          id: "red",
          type: "rain",
          color: "bg-red-500 text-white",
          label: "üåßÔ∏è",
          shape: "Box",
        },
        {
          id: "black",
          type: "rain",
          color: "bg-black text-white border-2 border-white",
          label: "üåßÔ∏è",
          shape: "Box",
        },

        {
          id: "hot",
          type: "temp",
          color: "bg-red-600 text-yellow-300",
          label: "H",
          shape: "Circle",
        }, // H for Hot (Simulated)
        {
          id: "cold",
          type: "temp",
          color: "bg-blue-600 text-white",
          label: "C",
          shape: "Circle",
        }, // C for Cold
        {
          id: "thunder",
          type: "other",
          color: "bg-yellow-500 text-black",
          label: "‚ö°",
          shape: "Triangle",
        },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [queue, setQueue] = useState([]);
        const [current, setCurrent] = useState(null);
        const [feedback, setFeedback] = useState(null);
        const [options, setOptions] = useState([]);

        const getText = (key) => t[key][lang] || t[key]["en"];

        useEffect(() => {
          initGame();
        }, []);

        const initGame = () => {
          const q = [...signals].sort(() => Math.random() - 0.5);
          setQueue(q);
          nextRound(q[0]);
        };

        const nextRound = (target) => {
          if (!target) {
            setCurrent(null);
            return;
          }
          setCurrent(target);
          setFeedback(null);

          // Generate options: target + 3 random distractors
          const distractors = signals
            .filter((s) => s.id !== target.id)
            .sort(() => Math.random() - 0.5)
            .slice(0, 3);
          const opts = [target, ...distractors].sort(() => Math.random() - 0.5);
          setOptions(opts);
        };

        const handleChoice = (opt) => {
          if (feedback) return;
          if (opt.id === current.id) {
            setFeedback("correct");
            setTimeout(() => {
              const nextIdx = queue.indexOf(current) + 1;
              if (nextIdx < queue.length) nextRound(queue[nextIdx]);
              else setCurrent(null);
            }, 1000);
          } else {
            setFeedback("wrong");
            setTimeout(() => setFeedback(null), 800);
          }
        };

        return (
          <div className="min-h-screen p-4 flex flex-col items-center select-none font-sans overflow-hidden">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl md:text-5xl font-black text-yellow-300 mb-4 mt-8 drop-shadow-md">
              ‚ö†Ô∏è {getText("title")}
            </h1>

            {current ? (
              <div className="w-full max-w-2xl flex flex-col items-center flex-1 justify-center relatives">
                {/* Prompt Card */}
                <div className="bg-white p-8 rounded-3xl shadow-2xl border-b-8 border-slate-300 w-full text-center mb-8 relative z-10">
                  <h2 className="text-4xl font-black text-slate-800 mb-2">
                    {getText(current.id)}
                  </h2>
                  <p className="text-xl text-slate-500 font-bold bg-slate-100 py-2 px-4 rounded-full inline-block">
                    {getText(`desc_${current.id}`)}
                  </p>

                  {feedback && (
                    <div
                      className={`absolute inset-0 bg-white/95 flex items-center justify-center text-4xl font-black rounded-3xl ${
                        feedback === "correct"
                          ? "text-green-600"
                          : "text-red-500"
                      }`}
                    >
                      {getText(feedback)}
                    </div>
                  )}
                </div>

                {/* Options Grid */}
                <div className="grid grid-cols-2 gap-6 w-full">
                  {options.map((opt) => (
                    <button
                      key={opt.id}
                      onClick={() => handleChoice(opt)}
                      className="bg-white/10 backdrop-blur-sm p-4 rounded-xl border-4 border-white/20 hover:bg-white/20 hover:scale-105 active:scale-95 transition-all flex flex-col items-center justify-center shadow-lg group"
                    >
                      {/* Signal Icon Simulation */}
                      <div
                        className={`w-28 h-28 flex items-center justify-center font-black text-6xl shadow-xl 
                                    ${
                                      opt.shape === "T"
                                        ? "border-4 border-black"
                                        : opt.shape === "Circle"
                                        ? "rounded-full"
                                        : "rounded-lg"
                                    }
                                    ${opt.color}
                                `}
                      >
                        {opt.label}
                      </div>
                    </button>
                  ))}
                </div>
              </div>
            ) : (
              <div className="bg-white/90 p-12 rounded-3xl shadow-xl text-center mt-20">
                <div className="text-8xl mb-4">üå™Ô∏è</div>
                <h2 className="text-3xl font-black text-slate-800 mb-6">
                  {getText("completed")}
                </h2>
                <button
                  onClick={initGame}
                  className="bg-blue-600 text-white px-10 py-4 rounded-full font-black text-xl hover:bg-blue-700 shadow-xl"
                >
                  {getText("reset")} üîÑ
                </button>
              </div>
            )}

            <p className="font-bold text-white/80 mt-8 mb-4">
              {getText("instruction")}
            </p>
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
