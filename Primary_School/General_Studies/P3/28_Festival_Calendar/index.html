<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Â∞è‰∏âÂ∏∏Ë≠òÔºöÁØÄÊó•Êó•ÊõÜ | Festival Calendar</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: radial-gradient(circle at center, #f5d0fe 0%, #c026d3 100%);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Festival Calendar",
          zh: "ÁØÄÊó•Êó•ÊõÜ",
          ja: "„Éï„Çß„Çπ„ÉÜ„Ç£„Éê„É´„Ç´„É¨„É≥„ÉÄ„Éº",
          ko: "Ï∂ïÏ†ú Îã¨Î†•",
          es: "Calendario de Festivales",
          de: "Festkalender",
          fi: "Juhlakalenteri",
          fr: "Calendrier des festivals",
          ar: "ÿ™ŸÇŸàŸäŸÖ ÿßŸÑŸÖŸáÿ±ÿ¨ÿßŸÜÿßÿ™",
          it: "Calendario dei Festival",
        },
        instruction: {
          en: "Sort festivals by order of the year!",
          zh: "ÊåâÊôÇÈñìÈ†ÜÂ∫èÊéíÂàóÁØÄÊó•ÔºÅ",
          ja: "‰ªäÂπ¥„ÅÆÈ†ÜÁï™„Å´‰∏¶„Åπ„Å¶ÔºÅ",
          ko: "Ïò¨Ìï¥ ÏàúÏÑúÎåÄÎ°ú Ï∂ïÏ†úÎ•º Ï†ïÎ†¨ÌïòÏÑ∏Ïöî!",
          es: "¬°Ordena los festivales por orden del a√±o!",
          de: "Sortiere die Feste nach der Reihenfolge im Jahr!",
          fi: "Lajittele juhlat vuoden j√§rjestyksess√§!",
          fr: "Triez les festivals par ordre chronologique !",
          ar: "ÿ±ÿ™ÿ® ÿßŸÑŸÖŸáÿ±ÿ¨ÿßŸÜÿßÿ™ ÿ≠ÿ≥ÿ® ÿ™ÿ±ÿ™Ÿäÿ® ÿßŸÑÿ≥ŸÜÿ©!",
          it: "Ordina i festival in ordine annuale!",
        },

        cny: {
          en: "Lunar New Year",
          zh: "Ëæ≤ÊõÜÊñ∞Âπ¥",
          ja: "ÊóßÊ≠£Êúà",
          ko: "ÏÑ§ÎÇ†",
          es: "A√±o Nuevo Lunar",
          de: "Mondneujahr",
          fi: "Kiinalainen uusivuosi",
          fr: "Nouvel An lunaire",
          ar: "ÿ±ÿ£ÿ≥ ÿßŸÑÿ≥ŸÜÿ© ÿßŸÑŸÇŸÖÿ±Ÿäÿ©",
          it: "Capodanno Lunare",
        },
        easter: {
          en: "Easter",
          zh: "Âæ©Ê¥ªÁØÄ",
          ja: "„Ç§„Éº„Çπ„Çø„Éº",
          ko: "Î∂ÄÌôúÏ†à",
          es: "Pascua",
          de: "Ostern",
          fi: "P√§√§si√§inen",
          fr: "P√¢ques",
          ar: "ÿπŸäÿØ ÿßŸÑŸÅÿµÿ≠",
          it: "Pasqua",
        },
        dragon: {
          en: "Dragon Boat Festival",
          zh: "Á´ØÂçàÁØÄ",
          ja: "Á´ØÂçà„ÅÆÁØÄÂè•",
          ko: "Îã®Ïò§Ï†à",
          es: "Festival del Bote del Drag√≥n",
          de: "Drachenbootfest",
          fi: "Lohik√§√§rmevenejuhla",
          fr: "F√™te des bateaux-dragons",
          ar: "ŸÖŸáÿ±ÿ¨ÿßŸÜ ŸÇŸàÿßÿ±ÿ® ÿßŸÑÿ™ŸÜŸäŸÜ",
          it: "Festa delle Barche Drago",
        },
        midautumn: {
          en: "Mid-Autumn Festival",
          zh: "‰∏≠ÁßãÁØÄ",
          ja: "‰∏≠ÁßãÁØÄ",
          ko: "Ï∂îÏÑù",
          es: "Festival del Medio Oto√±o",
          de: "Mondfest",
          fi: "Keskisyksyn juhla",
          fr: "F√™te de la mi-automne",
          ar: "ŸÖŸáÿ±ÿ¨ÿßŸÜ ŸÖŸÜÿ™ÿµŸÅ ÿßŸÑÿÆÿ±ŸäŸÅ",
          it: "Festa di Met√† Autunno",
        },
        xmas: {
          en: "Christmas",
          zh: "ËÅñË™ïÁØÄ",
          ja: "„ÇØ„É™„Çπ„Éû„Çπ",
          ko: "ÌÅ¨Î¶¨Ïä§ÎßàÏä§",
          es: "Navidad",
          de: "Weihnachten",
          fi: "Joulu",
          fr: "No√´l",
          ar: "ÿπŸäÿØ ÿßŸÑŸÖŸäŸÑÿßÿØ",
          it: "Natale",
        },

        janfeb: {
          en: "Jan/Feb",
          zh: "‰∏ÄÊúà/‰∫åÊúà",
          ja: "1Êúà/2Êúà",
          ko: "1Ïõî/2Ïõî",
          es: "Ene/Feb",
          de: "Jan/Feb",
          fi: "Tammi/Helmi",
          fr: "Jan/F√©v",
          ar: "ŸäŸÜÿßŸäÿ±/ŸÅÿ®ÿ±ÿßŸäÿ±",
          it: "Gen/Feb",
        },
        marapr: {
          en: "Mar/Apr",
          zh: "‰∏âÊúà/ÂõõÊúà",
          ja: "3Êúà/4Êúà",
          ko: "3Ïõî/4Ïõî",
          es: "Mar/Abr",
          de: "M√§r/Apr",
          fi: "Maalis/Huhti",
          fr: "Mar/Avr",
          ar: "ŸÖÿßÿ±ÿ≥/ÿ£ÿ®ÿ±ŸäŸÑ",
          it: "Mar/Apr",
        },
        mayjun: {
          en: "May/Jun",
          zh: "‰∫îÊúà/ÂÖ≠Êúà",
          ja: "5Êúà/6Êúà",
          ko: "5Ïõî/6Ïõî",
          es: "May/Jun",
          de: "Mai/Jun",
          fi: "Touko/Kes√§",
          fr: "Mai/Juin",
          ar: "ŸÖÿßŸäŸà/ŸäŸàŸÜŸäŸà",
          it: "Mag/Giu",
        },
        septoct: {
          en: "Sep/Oct",
          zh: "‰πùÊúà/ÂçÅÊúà",
          ja: "9Êúà/10Êúà",
          ko: "9Ïõî/10Ïõî",
          es: "Sep/Oct",
          de: "Sep/Okt",
          fi: "Syys/Loka",
          fr: "Sep/Oct",
          ar: "ÿ≥ÿ®ÿ™ŸÖÿ®ÿ±/ÿ£ŸÉÿ™Ÿàÿ®ÿ±",
          it: "Set/Ott",
        },
        dec: {
          en: "December",
          zh: "ÂçÅ‰∫åÊúà",
          ja: "12Êúà",
          ko: "12Ïõî",
          es: "Diciembre",
          de: "Dezember",
          fi: "Joulukuu",
          fr: "D√©cembre",
          ar: "ÿØŸäÿ≥ŸÖÿ®ÿ±",
          it: "Dicembre",
        },

        check: {
          en: "Check Order",
          zh: "Ê™¢Êü•È†ÜÂ∫è",
          ja: "È†ÜÂ∫è„ÇíÁ¢∫Ë™ç",
          ko: "ÏàúÏÑú ÌôïÏù∏",
          es: "Verificar Orden",
          de: "Reihenfolge pr√ºfen",
          fi: "Tarkista j√§rjestys",
          fr: "V√©rifier l'ordre",
          ar: "ÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ™ÿ±ÿ™Ÿäÿ®",
          it: "Controlla Ordine",
        },
        perfect: {
          en: "Perfect Order!",
          zh: "È†ÜÂ∫èÊ≠£Á¢∫ÔºÅ",
          ja: "ÂÆåÁíß„Å™È†ÜÂ∫èÔºÅ",
          ko: "ÏôÑÎ≤ΩÌïú ÏàúÏÑúÏûÖÎãàÎã§!",
          es: "¬°Orden Perfecto!",
          de: "Perfekte Reihenfolge!",
          fi: "T√§ydellinen j√§rjestys!",
          fr: "Ordre parfait !",
          ar: "ÿ™ÿ±ÿ™Ÿäÿ® ŸÖÿ´ÿßŸÑŸä!",
          it: "Ordine Perfetto!",
        },
        wrong: {
          en: "Wrong Order!",
          zh: "È†ÜÂ∫èÈåØË™§ÔºÅ",
          ja: "ÈñìÈÅï„Å£„ÅüÈ†ÜÂ∫èÔºÅ",
          ko: "ÏûòÎ™ªÎêú ÏàúÏÑúÏûÖÎãàÎã§!",
          es: "¬°Orden Incorrecto!",
          de: "Falsche Reihenfolge!",
          fi: "V√§√§r√§ j√§rjestys!",
          fr: "Mauvais ordre !",
          ar: "ÿ™ÿ±ÿ™Ÿäÿ® ÿÆÿßÿ∑ÿ¶!",
          it: "Ordine Errato!",
        },
        reset: {
          en: "Play Again",
          zh: "ÂÜçÁé©‰∏ÄÊ¨°",
          ja: "„ÇÇ„ÅÜ‰∏ÄÂ∫¶„Éó„É¨„Ç§",
          ko: "Îã§Ïãú ÌïòÍ∏∞",
          es: "Jugar de Nuevo",
          de: "Nochmal spielen",
          fi: "Pelaa uudelleen",
          fr: "Rejouer",
          ar: "ÿßŸÑÿπÿ® ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ",
          it: "Gioca di Nuovo",
        },
      };

      const correctOrder = ["cny", "easter", "dragon", "midautumn", "xmas"];

      const festivals = [
        { id: "cny", icon: "üßß", time: "janfeb" },
        { id: "easter", icon: "üê∞", time: "marapr" },
        { id: "dragon", icon: "üö£", time: "mayjun" },
        { id: "midautumn", icon: "ü•Æ", time: "septoct" },
        { id: "xmas", icon: "üéÑ", time: "dec" },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [line, setLine] = useState([]);
        const [pool, setPool] = useState([]);
        const [feedback, setFeedback] = useState(null);

        const getText = (key) => t[key][lang] || t[key]["en"];

        useEffect(() => {
          initGame();
        }, []);

        const initGame = () => {
          setPool([...festivals].sort(() => Math.random() - 0.5));
          setLine([]);
          setFeedback(null);
        };

        const moveToLine = (item) => {
          if (feedback === "perfect") return;
          setLine((prev) => [...prev, item]);
          setPool((prev) => prev.filter((i) => i.id !== item.id));
          setFeedback(null);
        };

        const moveToPool = (item) => {
          if (feedback === "perfect") return;
          setPool((prev) => [...prev, item]);
          setLine((prev) => prev.filter((i) => i.id !== item.id));
          setFeedback(null);
        };

        const check = () => {
          if (line.length !== correctOrder.length) return;

          const isCorrect = line.every(
            (item, i) => item.id === correctOrder[i]
          );
          if (isCorrect) {
            setFeedback("perfect");
          } else {
            setFeedback("wrong");
          }
        };

        return (
          <div className="min-h-screen p-4 flex flex-col items-center select-none font-sans overflow-hidden">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl md:text-5xl font-black text-fuchsia-900 mb-2 mt-8 drop-shadow-sm bg-white/50 px-6 py-2 rounded-full">
              üóìÔ∏è {getText("title")}
            </h1>
            <div className="font-bold text-fuchsia-900 mb-6 bg-white/40 px-4 py-1 rounded-full">
              {getText("instruction")}
            </div>

            {/* Timeline View */}
            <div className="w-full max-w-6xl min-h-[220px] bg-white/80 rounded-3xl p-6 border-4 border-fuchsia-400 mb-8 relative shadow-lg">
              {/* Visual Thread */}
              <div className="absolute top-1/2 left-0 w-full h-2 bg-fuchsia-200"></div>

              <div className="flex flex-wrap items-center justify-center gap-4 relative z-10 w-full min-h-[160px]">
                <AnimatePresence>
                  {line.map((item, index) => (
                    <motion.div
                      layoutId={item.id}
                      key={item.id}
                      className="relative group"
                    >
                      {/* Time Label */}
                      <div className="absolute -top-10 left-1/2 -translate-x-1/2 bg-fuchsia-600 text-white text-xs font-bold px-2 py-1 rounded shadow opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap">
                        {getText(item.time)}
                      </div>

                      <button
                        onClick={() => moveToPool(item)}
                        className="bg-white p-4 rounded-xl shadow-lg border-2 border-fuchsia-400 hover:scale-110 transition-transform flex flex-col items-center w-28 md:w-36 h-36 justify-center"
                      >
                        <div className="text-6xl mb-2">{item.icon}</div>
                        <div className="text-sm font-bold text-center leading-tight">
                          {getText(item.id)}
                        </div>
                      </button>

                      <div className="absolute -top-3 -right-3 bg-fuchsia-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold shadow-md">
                        {index + 1}
                      </div>
                    </motion.div>
                  ))}
                </AnimatePresence>

                {line.length === 0 && (
                  <div className="text-fuchsia-800/30 text-3xl font-black animate-pulse">
                    Drag Here
                  </div>
                )}
              </div>
            </div>

            {/* Controls */}
            <div className="h-16 mb-4">
              {feedback ? (
                <div className="flex gap-4 items-center">
                  <div
                    className={`px-8 py-2 rounded-2xl font-black text-2xl shadow-xl ${
                      feedback === "perfect"
                        ? "bg-green-500 text-white"
                        : "bg-red-500 text-white"
                    }`}
                  >
                    {getText(feedback)}
                  </div>
                  {feedback === "perfect" && (
                    <button
                      onClick={initGame}
                      className="bg-blue-600 text-white px-8 py-2 rounded-2xl font-black text-2xl shadow-xl hover:bg-blue-700 animate-bounce"
                    >
                      {getText("reset")} üîÑ
                    </button>
                  )}
                </div>
              ) : (
                line.length === correctOrder.length && (
                  <button
                    onClick={check}
                    className="bg-fuchsia-600 text-white px-10 py-3 rounded-full font-black text-2xl shadow-xl hover:bg-fuchsia-700"
                  >
                    {getText("check")}
                  </button>
                )
              )}
            </div>

            {/* Pool */}
            <div className="flex flex-wrap justify-center gap-4 bg-fuchsia-200/50 p-6 rounded-3xl w-full max-w-4xl border-t-4 border-fuchsia-300">
              <AnimatePresence>
                {pool.map((item) => (
                  <motion.button
                    key={item.id}
                    layoutId={item.id}
                    onClick={() => moveToLine(item)}
                    className="bg-white p-4 rounded-xl shadow border-2 border-white hover:border-fuchsia-500 active:scale-95 transition-all w-24 h-24 flex flex-col items-center justify-center"
                    initial={{ opacity: 0 }}
                    animate={{ opacity: 1 }}
                    exit={{ opacity: 0 }}
                  >
                    <div className="text-4xl md:text-5xl">{item.icon}</div>
                  </motion.button>
                ))}
              </AnimatePresence>
            </div>
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
