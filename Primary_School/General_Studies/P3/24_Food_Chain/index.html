<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å°ä¸‰å¸¸è­˜ï¼šé£Ÿç‰©éˆ | Food Chain</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: linear-gradient(135deg, #fef3c7 0%, #fcd34d 100%);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Food Chain",
          zh: "é£Ÿç‰©éˆ",
          ja: "é£Ÿç‰©é€£é–",
          ko: "ë¨¹ì´ ì‚¬ìŠ¬",
          es: "Cadena Alimentaria",
          de: "Nahrungskette",
          fi: "Ravintoketju",
          fr: "ChaÃ®ne alimentaire",
          ar: "Ø§Ù„Ø³Ù„Ø³Ù„Ø© Ø§Ù„ØºØ°Ø§Ø¦ÙŠØ©",
          it: "Catena Alimentare",
        },
        instruction: {
          en: "Who eats whom? Build the chain!",
          zh: "èª°åƒèª°ï¼Ÿæ’åˆ—é£Ÿç‰©éˆï¼",
          ja: "èª°ãŒèª°ã‚’é£Ÿã¹ã‚‹ï¼Ÿé–ã‚’ä½œã‚ã†ï¼",
          ko: "ëˆ„ê°€ ëˆ„êµ¬ë¥¼ ë¨¹ë‚˜ìš”? ì‚¬ìŠ¬ì„ ë§Œë“œì„¸ìš”!",
          es: "Â¿QuiÃ©n come a quiÃ©n? Â¡Construye la cadena!",
          de: "Wer frisst wen? Baue die Kette!",
          fi: "Kuka syÃ¶ kenet? Rakenna ketju!",
          fr: "Qui mange qui ? Construisez la chaÃ®ne !",
          ar: "Ù…Ù† ÙŠØ£ÙƒÙ„ Ù…Ù†ØŸ Ø§Ø¨Ù†ÙŠ Ø§Ù„Ø³Ù„Ø³Ù„Ø©!",
          it: "Chi mangia chi? Costruisci la catena!",
        },

        sun: {
          en: "Sun",
          zh: "å¤ªé™½",
          ja: "å¤ªé™½",
          ko: "íƒœì–‘",
          es: "Sol",
          de: "Sonne",
          fi: "Aurinko",
          fr: "Soleil",
          ar: "Ø´Ù…Ø³",
          it: "Sole",
        },
        grass: {
          en: "Grass",
          zh: "è‰",
          ja: "è‰",
          ko: "í’€",
          es: "Hierba",
          de: "Gras",
          fi: "Ruoho",
          fr: "Herbe",
          ar: "Ø¹Ø´Ø¨",
          it: "Erba",
        },
        rabbit: {
          en: "Rabbit",
          zh: "å…”å­",
          ja: "ã‚¦ã‚µã‚®",
          ko: "í† ë¼",
          es: "Conejo",
          de: "Kaninchen",
          fi: "Kani",
          fr: "Lapin",
          ar: "Ø£Ø±Ù†Ø¨",
          it: "Coniglio",
        },
        snake: {
          en: "Snake",
          zh: "è›‡",
          ja: "è›‡",
          ko: "ë±€",
          es: "Serpiente",
          de: "Schlange",
          fi: "KÃ¤Ã¤rme",
          fr: "Serpent",
          ar: "Ø«Ø¹Ø¨Ø§Ù†",
          it: "Serpente",
        },
        eagle: {
          en: "Eagle",
          zh: "è€é·¹",
          ja: "é·²",
          ko: "ë…ìˆ˜ë¦¬",
          es: "Ãguila",
          de: "Adler",
          fi: "Kotka",
          fr: "Aigle",
          ar: "Ù†Ø³Ø±",
          it: "Aquila",
        },

        caterpillar: {
          en: "Caterpillar",
          zh: "æ¯›èŸ²",
          ja: "èŠ‹è™«",
          ko: "ì• ë²Œë ˆ",
          es: "Oruga",
          de: "Raupe",
          fi: "Toukka",
          fr: "Chenille",
          ar: "ÙŠØ±Ù‚Ø©",
          it: "Bruco",
        },
        bird: {
          en: "Bird",
          zh: "å°é³¥",
          ja: "é³¥",
          ko: "ìƒˆ",
          es: "PÃ¡jaro",
          de: "Vogel",
          fi: "Lintu",
          fr: "Oiseau",
          ar: "Ø·Ø§Ø¦Ø±",
          it: "Uccello",
        },

        corn: {
          en: "Corn",
          zh: "ç²Ÿç±³",
          ja: "ãƒˆã‚¦ãƒ¢ãƒ­ã‚³ã‚·",
          ko: "ì˜¥ìˆ˜ìˆ˜",
          es: "MaÃ­z",
          de: "Mais",
          fi: "Maissi",
          fr: "MaÃ¯s",
          ar: "Ø°Ø±Ø©",
          it: "Mais",
        },
        rat: {
          en: "Rat",
          zh: "è€é¼ ",
          ja: "ãƒã‚ºãƒŸ",
          ko: "ì¥",
          es: "Rata",
          de: "Ratte",
          fi: "Rotta",
          fr: "Rat",
          ar: "Ø¬Ø±Ø°",
          it: "Ratto",
        },
        owl: {
          en: "Owl",
          zh: "è²“é ­é·¹",
          ja: "ãƒ•ã‚¯ãƒ­ã‚¦",
          ko: "ë¶€ì—‰ì´",
          es: "BÃºho",
          de: "Eule",
          fi: "PÃ¶llÃ¶",
          fr: "Hibou",
          ar: "Ø¨ÙˆÙ…Ø©",
          it: "Gufo",
        },

        check: {
          en: "Check",
          zh: "æª¢æŸ¥",
          ja: "ç¢ºèª",
          ko: "í™•ì¸",
          es: "Comprobar",
          de: "PrÃ¼fen",
          fi: "Tarkista",
          fr: "VÃ©rifier",
          ar: "ØªØ­Ù‚Ù‚",
          it: "Controlla",
        },
        correct: {
          en: "Correct Chain!",
          zh: "é£Ÿç‰©éˆæ­£ç¢ºï¼",
          ja: "æ­£è§£ï¼",
          ko: "ì •ë‹µì…ë‹ˆë‹¤!",
          es: "Â¡Cadena Correcta!",
          de: "Richtige Kette!",
          fi: "Oikea ketju!",
          fr: "ChaÃ®ne correcte !",
          ar: "Ø³Ù„Ø³Ù„Ø© ØµØ­ÙŠØ­Ø©!",
          it: "Catena Corretta!",
        },
        wrong: {
          en: "Chain Broken!",
          zh: "é£Ÿç‰©éˆéŒ¯èª¤ï¼",
          ja: "é–ãŒåˆ‡ã‚Œã¦ã„ã¾ã™ï¼",
          ko: "ì‚¬ìŠ¬ì´ ëŠì–´ì¡Œì–´ìš”!",
          es: "Â¡Cadena Rota!",
          de: "Kette unterbrochen!",
          fi: "Ketju rikki!",
          fr: "ChaÃ®ne brisÃ©e !",
          ar: "Ø§Ù„Ø³Ù„Ø³Ù„Ø© Ù…ÙƒØ³ÙˆØ±Ø©!",
          it: "Catena Espzzata!",
        },
        reset: {
          en: "Next Chain",
          zh: "ä¸‹ä¸€å€‹",
          ja: "æ¬¡ã®é–",
          ko: "ë‹¤ìŒ ì‚¬ìŠ¬",
          es: "Siguiente Cadena",
          de: "NÃ¤chste Kette",
          fi: "Seuraava ketju",
          fr: "ChaÃ®ne suivante",
          ar: "Ø§Ù„Ø³Ù„Ø³Ù„Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©",
          it: "Prossima Catena",
        },
        level: {
          en: "Level",
          zh: "é—œå¡",
          ja: "ãƒ¬ãƒ™ãƒ«",
          ko: "ë ˆë²¨",
          es: "Nivel",
          de: "Level",
          fi: "Taso",
          fr: "Niveau",
          ar: "Ù…Ø³ØªÙˆÙ‰",
          it: "Livello",
        },
      };

      const chains = [
        // Level 1: Simple 3
        {
          items: ["sun", "grass", "rabbit", "eagle"],
          order: ["sun", "grass", "rabbit", "eagle"],
        },
        // Level 2:
        {
          items: ["sun", "grass", "caterpillar", "bird", "eagle"],
          order: ["sun", "grass", "caterpillar", "bird", "eagle"],
        },
        // Level 3:
        {
          items: ["sun", "corn", "rat", "snake", "eagle"],
          order: ["sun", "corn", "rat", "snake", "eagle"],
        },
      ];

      const visuals = {
        sun: "â˜€ï¸",
        grass: "ğŸŒ±",
        rabbit: "ğŸ‡",
        snake: "ğŸ",
        eagle: "ğŸ¦…",
        caterpillar: "ğŸ›",
        bird: "ğŸ¦",
        corn: "ğŸŒ½",
        rat: "ğŸ€",
        owl: "ğŸ¦‰",
      };

      function App() {
        const [lang, setLang] = useState("zh");
        const [level, setLevel] = useState(0);
        const [pool, setPool] = useState([]);
        const [line, setLine] = useState([]);
        const [feedback, setFeedback] = useState(null);

        const getText = (key) => t[key][lang] || t[key]["en"];

        useEffect(() => {
          loadLevel(0);
        }, []);

        const loadLevel = (lvl) => {
          if (lvl >= chains.length) {
            setLevel(0); // Loop or end
            loadLevel(0);
            return;
          }
          setLevel(lvl);
          setFeedback(null);
          setLine([]);
          // Shuffle pool
          const newPool = [...chains[lvl].items].sort(
            () => Math.random() - 0.5
          );
          setPool(newPool);
        };

        const moveToLine = (item) => {
          if (feedback === "correct") return;
          setLine((prev) => [...prev, item]);
          setPool((prev) => prev.filter((i) => i !== item));
          setFeedback(null);
        };

        const moveToPool = (item) => {
          if (feedback === "correct") return;
          setPool((prev) => [...prev, item]);
          setLine((prev) => prev.filter((i) => i !== item));
          setFeedback(null);
        };

        const check = () => {
          const currentChain = chains[level];
          if (line.length !== currentChain.order.length) {
            setFeedback("wrong");
            return;
          }

          // Check exact match
          const isCorrect = line.every(
            (item, i) => item === currentChain.order[i]
          );
          if (isCorrect) {
            setFeedback("correct");
          } else {
            setFeedback("wrong");
          }
        };

        const nextLevel = () => {
          loadLevel(level + 1);
        };

        return (
          <div className="min-h-screen p-4 flex flex-col items-center select-none font-sans overflow-hidden">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl md:text-5xl font-black text-amber-700 mb-2 mt-8 drop-shadow-sm bg-white/50 px-6 py-2 rounded-full">
              ğŸ”— {getText("title")}
            </h1>
            <div className="font-bold text-amber-800 mb-6 bg-white/40 px-4 py-1 rounded-full">
              {getText("level")}: {level + 1}
            </div>

            <p className="font-bold text-amber-900 mb-4 text-xl">
              {getText("instruction")}
            </p>

            {/* Chain Area */}
            <div className="w-full max-w-5xl min-h-[160px] bg-white/80 rounded-3xl p-6 border-4 border-amber-300 flex flex-wrap items-center justify-center gap-2 mb-8 shadow-inner">
              {line.length === 0 && (
                <div className="text-amber-800/30 text-2xl font-black animate-pulse">
                  Drag items here
                </div>
              )}

              <AnimatePresence>
                {line.map((item, i) => (
                  <div key={`${item}-${i}`} className="flex items-center">
                    {i > 0 && (
                      <div className="text-3xl text-amber-600 mx-1 font-black">
                        â¡
                      </div>
                    )}
                    <motion.button
                      layoutId={item}
                      onClick={() => moveToPool(item)}
                      className="bg-white p-4 rounded-xl shadow-lg border-2 border-amber-500 hover:bg-red-50 hover:border-red-400 transition-colors"
                    >
                      <div className="text-4xl md:text-5xl">
                        {visuals[item]}
                      </div>
                      <div className="text-xs font-bold mt-1 text-slate-700">
                        {getText(item)}
                      </div>
                    </motion.button>
                  </div>
                ))}
              </AnimatePresence>
            </div>

            {/* Controls */}
            <div className="h-16 mb-6">
              {feedback ? (
                <div className="flex gap-4 items-center">
                  <div
                    className={`px-8 py-2 rounded-2xl font-black text-2xl shadow-xl ${
                      feedback === "correct"
                        ? "bg-green-500 text-white"
                        : "bg-red-500 text-white"
                    }`}
                  >
                    {getText(feedback)}
                  </div>
                  {feedback === "correct" && (
                    <button
                      onClick={nextLevel}
                      className="bg-blue-600 text-white px-8 py-2 rounded-2xl font-black text-2xl shadow-xl hover:bg-blue-700 animate-bounce"
                    >
                      {getText("reset")} â¡
                    </button>
                  )}
                </div>
              ) : (
                line.length === chains[level].items.length && (
                  <button
                    onClick={check}
                    className="bg-green-600 text-white px-10 py-3 rounded-full font-black text-2xl shadow-xl hover:bg-green-700"
                  >
                    {getText("check")}
                  </button>
                )
              )}
            </div>

            {/* Pool Area */}
            <div className="w-full max-w-4xl p-6 bg-amber-200/50 rounded-3xl flex flex-wrap justify-center gap-4 border-t-4 border-amber-300">
              <AnimatePresence>
                {pool.map((item) => (
                  <motion.button
                    key={item}
                    layoutId={item}
                    onClick={() => moveToLine(item)}
                    className="bg-white p-4 rounded-xl shadow border-2 border-white hover:border-amber-500 transition-all active:scale-95"
                  >
                    <div className="text-4xl md:text-5xl">{visuals[item]}</div>
                    <div className="text-xs font-bold mt-1 text-slate-700">
                      {getText(item)}
                    </div>
                  </motion.button>
                ))}
              </AnimatePresence>
            </div>
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  
      
      <!-- Footer -->
      <footer class="text-center py-4 text-slate-500 text-sm">
        <p class="italic mb-1">
          But God made the earth by his power; he founded the world by his wisdom and stretched out the heavens by his
          understanding. Jeremiah 10:12
        </p>
        <p class="text-xs mb-1 mt-2">
          ã€Œè€¶å’Œè¯ç”¨èƒ½åŠ›å‰µé€ å¤§åœ°ï¼Œç”¨æ™ºæ…§å»ºç«‹ä¸–ç•Œï¼Œç”¨è°æ˜é‹ªå¼µç©¹è’¼ã€‚ã€ è€¶åˆ©ç±³æ›¸ 10:12
        </p>
        <p class="text-xs mt-2 pt-2 border-t border-slate-300">
          @ 2025 Education Engineering Portfolio | Generated by Gemini Pro 3.0 | Prepared by SF Lau
        </p>
      </footer>
</body>
</html>
