<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Â∞è‰∏âÂ∏∏Ë≠òÔºöÈò≤Ê∞¥Ê∏¨Ë©¶ | Waterproof Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: linear-gradient(135deg, #a5f3fc 0%, #22d3ee 100%);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Waterproof Test",
          zh: "Èò≤Ê∞¥Ê∏¨Ë©¶",
          ja: "Èò≤Ê∞¥„ÉÜ„Çπ„Éà",
          ko: "Î∞©Ïàò ÌÖåÏä§Ìä∏",
          es: "Prueba de Impermeabilidad",
          de: "Wasserdichtigkeitstest",
          fi: "Vedenpit√§vyystesti",
          fr: "Test d'√©tanch√©it√©",
          ar: "ÿßÿÆÿ™ÿ®ÿßÿ± ŸÖŸÇÿßŸàŸÖÿ© ÿßŸÑŸÖÿßÿ°",
          it: "Test di Impermeabilit√†",
        },
        instruction: {
          en: "Spray water to test!",
          zh: "Âô¥Ê∞¥ÈÄ≤Ë°åÊ∏¨Ë©¶ÔºÅ",
          ja: "Ê∞¥„Çí„Çπ„Éó„É¨„Éº„Åó„Å¶„ÉÜ„Çπ„ÉàÔºÅ",
          ko: "Î¨ºÏùÑ ÎøåÎ†§ ÌÖåÏä§Ìä∏ÌïòÏÑ∏Ïöî!",
          es: "¬°Roc√≠a agua para probar!",
          de: "Spr√ºhe Wasser zum Testen!",
          fi: "Suihkuta vett√§ testataksesi!",
          fr: "Vaporisez de l'eau pour tester !",
          ar: "ÿ±ÿ¥ ÿßŸÑŸÖÿßÿ° ŸÑŸÑÿßÿÆÿ™ÿ®ÿßÿ±!",
          it: "Spruzza acqua per testare!",
        },

        spray: {
          en: "Spray Water",
          zh: "Âô¥Ê∞¥",
          ja: "Ê∞¥„Çí„Çπ„Éó„É¨„Éº",
          ko: "Î¨º ÎøåÎ¶¨Í∏∞",
          es: "Rociar Agua",
          de: "Wasser spr√ºhen",
          fi: "Suihkuta vett√§",
          fr: "Vaporiser de l'eau",
          ar: "ÿ±ÿ¥ ÿßŸÑŸÖÿßÿ°",
          it: "Spruzza Acqua",
        },
        next: {
          en: "Next Material",
          zh: "‰∏ã‰∏ÄÂÄãÁâ©Êñô",
          ja: "Ê¨°„ÅÆÁ¥†Êùê",
          ko: "Îã§Ïùå Ïû¨Î£å",
          es: "Siguiente Material",
          de: "N√§chstes Material",
          fi: "Seuraava materiaali",
          fr: "Mat√©riau suivant",
          ar: "ÿßŸÑŸÖÿßÿØÿ© ÿßŸÑÿ™ÿßŸÑŸäÿ©",
          it: "Materiale Successivo",
        },

        result_dry: {
          en: "It stays dry! (Waterproof)",
          zh: "‰øùÊåÅ‰πæÁàΩÔºÅ (Èò≤Ê∞¥)",
          ja: "‰πæ„ÅÑ„Åü„Åæ„Åæ„Åß„ÅôÔºÅ (Èò≤Ê∞¥)",
          ko: "ÎßàÎ•∏ ÏÉÅÌÉú Ïú†ÏßÄ! (Î∞©Ïàò)",
          es: "¬°Se mantiene seco! (Impermeable)",
          de: "Es bleibt trocken! (Wasserdicht)",
          fi: "Se pysyy kuivana! (Vedenpit√§v√§)",
          fr: "Il reste sec ! (Imperm√©able)",
          ar: "Ÿäÿ®ŸÇŸâ ÿ¨ÿßŸÅÿßŸã! (ŸÖŸÇÿßŸàŸÖ ŸÑŸÑŸÖÿßÿ°)",
          it: "Resta asciutto! (Impermeabile)",
        },
        result_wet: {
          en: "It gets wet! (Absorbent)",
          zh: "ËÆäÊøï‰∫ÜÔºÅ (Âê∏Ê∞¥)",
          ja: "Êø°„Çå„Åæ„Åó„ÅüÔºÅ (Âê∏Ê∞¥ÊÄß)",
          ko: "Ï†ñÏóàÏäµÎãàÎã§! (Ìù°ÏàòÏÑ±)",
          es: "¬°Se moja! (Absorbente)",
          de: "Es wird nass! (Saugf√§hig)",
          fi: "Se kastuu! (Imukykyinen)",
          fr: "Il devient mouill√© ! (Absorbant)",
          ar: "Ÿäÿµÿ®ÿ≠ ŸÖÿ®ŸÑŸÑÿßŸã! (ŸÖÿßÿµ)",
          it: "Si bagna! (Assorbente)",
        },

        paper: {
          en: "Paper",
          zh: "ÁôΩÁ¥ô",
          ja: "Á¥ô",
          ko: "Ï¢ÖÏù¥",
          es: "Papel",
          de: "Papier",
          fi: "Paperi",
          fr: "Papier",
          ar: "Ÿàÿ±ŸÇÿ©",
          it: "Carta",
        },
        plastic: {
          en: "Plastic Sheet",
          zh: "ËÜ†Áâá",
          ja: "„Éó„É©„Çπ„ÉÅ„ÉÉ„ÇØ„Ç∑„Éº„Éà",
          ko: "ÌîåÎùºÏä§Ìã± ÏãúÌä∏",
          es: "L√°mina de pl√°stico",
          de: "Plastikfolie",
          fi: "Muovikalvo",
          fr: "Feuille de plastique",
          ar: "ÿ≠?ŸäŸÅÿ© ÿ®ŸÑÿßÿ≥ÿ™ŸäŸÉŸäÿ©",
          it: "Foglio di plastica",
        },
        cloth: {
          en: "Cotton Cloth",
          zh: "Ê£âÂ∏É",
          ja: "Á∂øÂ∏É",
          ko: "Î©¥Ìè¨",
          es: "Tela de algod√≥n",
          de: "Baumwolltuch",
          fi: "Puuvillakangas",
          fr: "Tissu en coton",
          ar: "ŸÇŸÖÿßÿ¥ ŸÇÿ∑ŸÜŸä",
          it: "Panno di cotone",
        },
        foil: {
          en: "Aluminium Foil",
          zh: "ÈãÅÁÆîÁ¥ô",
          ja: "„Ç¢„É´„Éü„Éõ„Ç§„É´",
          ko: "ÏïåÎ£®ÎØ∏ÎäÑ Ìò∏Ïùº",
          es: "Papel de aluminio",
          de: "Alufolie",
          fi: "Alumiinifolio",
          fr: "Papier aluminium",
          ar: "ÿ±ŸÇÿßÿ¶ŸÇ ÿßŸÑÿ£ŸÑŸàŸÖŸÜŸäŸàŸÖ",
          it: "Foglio di alluminio",
        },
        sponge: {
          en: "Sponge",
          zh: "Êµ∑Á∂ø",
          ja: "„Çπ„Éù„É≥„Ç∏",
          ko: "Ïä§ÌéÄÏßÄ",
          es: "Esponja",
          de: "Schwamm",
          fi: "Sieni",
          fr: "√âponge",
          ar: "ÿ•ÿ≥ŸÅŸÜÿ¨ÿ©",
          it: "Spugna",
        },
        raincoat: {
          en: "Raincoat",
          zh: "Èõ®Ë°£",
          ja: "„É¨„Ç§„É≥„Ç≥„Éº„Éà",
          ko: "Ïö∞ÎπÑ",
          es: "Impermeable",
          de: "Regenmantel",
          fi: "Sadetakki",
          fr: "Imperm√©able",
          ar: "ŸÖÿπÿ∑ŸÅ ŸàÿßŸÇ ŸÖŸÜ ÿßŸÑŸÖÿ∑ÿ±",
          it: "Impermeabile",
        },

        correct: {
          en: "Test Complete!",
          zh: "Ê∏¨Ë©¶ÂÆåÊàêÔºÅ",
          ja: "„ÉÜ„Çπ„ÉàÂÆå‰∫ÜÔºÅ",
          ko: "ÌÖåÏä§Ìä∏ ÏôÑÎ£å!",
          es: "¬°Prueba Completa!",
          de: "Test abgeschlossen!",
          fi: "Testi valmis!",
          fr: "Test termin√© !",
          ar: "ÿßŸÉÿ™ŸÖŸÑ ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ±!",
          it: "Test Completato!",
        },
        reset: {
          en: "Test Again",
          zh: "ÈáçÊñ∞Ê∏¨Ë©¶",
          ja: "ÂÜç„ÉÜ„Çπ„Éà",
          ko: "Îã§Ïãú ÌÖåÏä§Ìä∏",
          es: "Probar de Nuevo",
          de: "Nochmal testen",
          fi: "Testaa uudelleen",
          fr: "Tester √† nouveau",
          ar: "ÿßÿÆÿ™ÿ®ÿ± ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ",
          it: "Testa di Nuvo",
        },
      };

      const items = [
        { id: "paper", waterproof: false, icon: "üìÑ", color: "bg-white" },
        {
          id: "plastic",
          waterproof: true,
          icon: "üí≥",
          color: "bg-blue-100 opacity-80",
        }, // Simulating transparency
        { id: "cloth", waterproof: false, icon: "üëï", color: "bg-red-100" },
        { id: "foil", waterproof: true, icon: "ü•à", color: "bg-gray-300" },
        {
          id: "raincoat",
          waterproof: true,
          icon: "üß•",
          color: "bg-yellow-300",
        },
        { id: "sponge", waterproof: false, icon: "üßΩ", color: "bg-yellow-100" }, // Absorbent
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [currentItem, setCurrentItem] = useState(null);
        const [queue, setQueue] = useState([]);
        const [wetness, setWetness] = useState(0); // 0 to 100
        const [tested, setTested] = useState(false);
        const [animating, setAnimating] = useState(false);

        const getText = (key) => t[key][lang] || t[key]["en"];

        useEffect(() => {
          initGame();
        }, []);

        const initGame = () => {
          const q = [...items].sort(() => Math.random() - 0.5);
          setQueue(q);
          setCurrentItem(q[0]);
          setWetness(0);
          setTested(false);
        };

        const handleSpray = () => {
          if (tested || animating) return;

          setAnimating(true);
          setTimeout(() => {
            setAnimating(false);
            setTested(true);
            if (!currentItem.waterproof) {
              setWetness(100);
            } else {
              setWetness(0); // Drops bead up but item inner dry
            }
          }, 1500); // Animation duration
        };

        const next = () => {
          const nextIdx = queue.indexOf(currentItem) + 1;
          if (nextIdx < queue.length) {
            setCurrentItem(queue[nextIdx]);
            setWetness(0);
            setTested(false);
          } else {
            initGame();
          }
        };

        return (
          <div className="min-h-screen p-4 flex flex-col items-center select-none font-sans overflow-hidden">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl md:text-5xl font-black text-cyan-900 mb-4 mt-8 drop-shadow-sm bg-white/50 px-6 py-2 rounded-full">
              üöø {getText("title")}
            </h1>

            {currentItem && (
              <div className="w-full max-w-lg flex flex-col items-center flex-1 justify-center relative">
                {/* Test Area */}
                <div className="relative w-full aspect-square bg-slate-800 rounded-3xl shadow-2xl overflow-hidden border-8 border-slate-600 mb-8 flex items-center justify-center">
                  {/* Item Holder */}
                  <div
                    className={`w-64 h-64 ${currentItem.color} rounded-xl shadow-lg flex items-center justify-center text-9xl relative transition-all duration-1000`}
                    style={{
                      filter:
                        wetness > 0 ? "brightness(0.8) sepia(0.2)" : "none",
                      transform:
                        wetness > 0 && !currentItem.waterproof
                          ? "scale(0.95)"
                          : "none", // Soggy effect
                    }}
                  >
                    {currentItem.icon}

                    {/* Water Layer */}
                    {(tested || animating) && (
                      <div className="absolute inset-0 overflow-hidden rounded-xl">
                        {/* Spray Animation */}
                        {animating && (
                          <div className="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-full w-20 h-full bg-blue-400/50 blur-xl animate-spray"></div>
                        )}

                        {/* Beads (If waterproof) */}
                        {currentItem.waterproof && tested && (
                          <div className="absolute inset-0">
                            {[...Array(20)].map((_, i) => (
                              <div
                                key={i}
                                className="absolute bg-blue-400/80 rounded-full shadow-inner border border-white/50"
                                style={{
                                  width: Math.random() * 20 + 10 + "px",
                                  height: Math.random() * 20 + 10 + "px",
                                  top: Math.random() * 80 + "%",
                                  left: Math.random() * 80 + "%",
                                }}
                              ></div>
                            ))}
                          </div>
                        )}

                        {/* Soak (If not waterproof) */}
                        {!currentItem.waterproof && tested && (
                          <div className="absolute inset-0 bg-blue-900/30 mix-blend-multiply"></div>
                        )}
                      </div>
                    )}
                  </div>

                  {/* Nozzle Visual */}
                  <div className="absolute top-4 left-1/2 -translate-x-1/2 w-16 h-24 bg-gray-700 rounded-b-xl border-4 border-gray-500 z-20 flex flex-col items-center">
                    <div className="w-2 h-4 bg-black rounded-full mt-auto mb-2"></div>
                    {animating && (
                      <div className="absolute bottom-0 translate-y-full flex flex-col items-center">
                        <div className="w-0 h-0 border-l-[20px] border-l-transparent border-r-[20px] border-r-transparent border-t-[50px] border-blue-400/50 blur-sm"></div>
                      </div>
                    )}
                  </div>

                  {tested && (
                    <div
                      className={`absolute bottom-8 px-6 py-2 rounded-xl font-black text-2xl shadow-xl z-30 ${
                        currentItem.waterproof
                          ? "bg-green-500 text-white"
                          : "bg-blue-600 text-white"
                      }`}
                    >
                      {currentItem.waterproof
                        ? getText("result_dry")
                        : getText("result_wet")}
                    </div>
                  )}
                </div>

                <div className="text-2xl font-black text-cyan-900 mb-6">
                  {getText(currentItem.id)}
                </div>

                {!tested ? (
                  <button
                    onClick={handleSpray}
                    disabled={animating}
                    className={`bg-cyan-600 text-white px-12 py-6 rounded-full font-black text-3xl shadow-xl border-b-8 border-cyan-800 active:border-b-0 active:translate-y-2 transition-all ${
                      animating ? "opacity-50" : "hover:bg-cyan-500"
                    }`}
                  >
                    üíß {getText("spray")}
                  </button>
                ) : (
                  <button
                    onClick={next}
                    className="bg-green-500 text-white px-12 py-4 rounded-full font-black text-2xl shadow-xl hover:bg-green-600 hover:scale-105 transition-all"
                  >
                    {getText("next")} ‚û°Ô∏è
                  </button>
                )}
              </div>
            )}
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
