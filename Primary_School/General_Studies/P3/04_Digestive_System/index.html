<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å°ä¸‰å¸¸è­˜ï¼šæ¶ˆåŒ–ç³»çµ± | Digestive System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: radial-gradient(circle at center, #fce7f3 0%, #fae8ff 100%);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Digestive System",
          zh: "æ¶ˆåŒ–ç³»çµ±",
          ja: "æ¶ˆåŒ–å™¨ç³»",
        },
        instruction: {
          en: "Drag organs to their place!",
          zh: "å°‡å™¨å®˜æ‹–æ”¾åˆ°æ­£ç¢ºä½ç½®ï¼",
          ja: "è‡“å™¨ã‚’æ­£ã—ã„å ´æ‰€ã«ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦ãã ã•ã„ï¼",
        },

        mouth: { en: "Mouth", zh: "å£è…”" },
        esophagus: { en: "Esophagus", zh: "é£Ÿé“" },
        stomach: { en: "Stomach", zh: "èƒƒ" },
        small_int: { en: "Small Intestine", zh: "å°è…¸" },
        large_int: { en: "Large Intestine", zh: "å¤§è…¸" },

        func_mouth: { en: "Chew food", zh: "å’€åš¼é£Ÿç‰©" },
        func_esophagus: { en: "Transport food", zh: "é‹é€é£Ÿç‰©" },
        func_stomach: { en: "Digest food", zh: "æ¶ˆåŒ–é£Ÿç‰©" },
        func_small_int: { en: "Absorb nutrients", zh: "å¸æ”¶ç‡Ÿé¤Š" },
        func_large_int: { en: "Absorb water", zh: "å¸æ”¶æ°´åˆ†" },

        completed: { en: "System Assembled!", zh: "ç³»çµ±çµ„è£å®Œæˆï¼" },
        reset: { en: "Reset", zh: "é‡ç½®" },
      };

      const organs = [
        { id: "mouth", x: 50, y: 10, w: 20, h: 10 },
        { id: "esophagus", x: 50, y: 25, w: 10, h: 20 },
        { id: "stomach", x: 55, y: 45, w: 25, h: 15 },
        { id: "large_int", x: 50, y: 65, w: 35, h: 25 },
        { id: "small_int", x: 50, y: 65, w: 20, h: 15 }, // Overlaps visually/z-index usually inside large
      ];

      // Simplified paths for SVG
      const shapes = {
        mouth: "M0,5 Q10,10 20,5 Q10,0 0,5 Z",
        esophagus: "M5,0 L15,0 L12,40 L8,40 Z",
        stomach: "M5,0 Q20,0 25,10 Q30,25 15,30 Q0,25 5,0 Z",
        large_int: "M5,30 L5,5 L35,5 L35,30 L25,30 L25,15 L15,15 L15,30 Z", // Boxy arch
        small_int: "M5,5 Q10,0 15,5 Q20,10 15,15 Q10,20 5,15 Q0,10 5,5 Z", // Squiggly
      };

      const colors = {
        mouth: "#fca5a5",
        esophagus: "#f87171",
        stomach: "#ef4444",
        small_int: "#f472b6",
        large_int: "#db2777",
      };

      function App() {
        const [lang, setLang] = useState("zh");
        const [placed, setPlaced] = useState({}); // organId -> bool
        const [selected, setSelected] = useState(null);
        const [completed, setCompleted] = useState(false);

        const getText = (key) => t[key][lang] || t[key]["en"];

        useEffect(() => {
          if (Object.keys(placed).length === organs.length) {
            setCompleted(true);
          }
        }, [placed]);

        const handleZoneClick = (id) => {
          if (selected && selected === id) {
            setPlaced((prev) => ({ ...prev, [id]: true }));
            setSelected(null);
          }
        };

        const reset = () => {
          setPlaced({});
          setCompleted(false);
          setSelected(null);
        };

        const available = organs.filter((o) => !placed[o.id]);

        return (
          <div className="min-h-screen p-4 flex flex-col items-center select-none font-sans">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl md:text-5xl font-black text-pink-700 mb-4 mt-8 drop-shadow-sm bg-white/50 px-6 py-2 rounded-full">
              ğŸ§˜ {getText("title")}
            </h1>
            <p className="font-bold text-pink-600 mb-6">
              {getText("instruction")}
            </p>

            <div className="flex flex-col md:flex-row gap-12 w-full max-w-5xl items-start justify-center">
              {/* Body Map */}
              <div className="relative w-full md:w-1/2 aspect-[1/2] max-h-[70vh] bg-white rounded-[3rem] shadow-2xl border-4 border-pink-100 p-8 flex justify-center">
                <div className="absolute inset-0 bg-[url('https://cdn-icons-png.flaticon.com/512/7483/7483983.png')] opacity-5 bg-center bg-no-repeat bg-contain"></div>

                {/* Interactive Outline Container */}
                <div className="relative w-full h-full">
                  {/* Silhouette (CSS or SVG) */}
                  <svg
                    viewBox="0 0 100 100"
                    className="w-full h-full opacity-20 pointer-events-none absolute"
                  >
                    <path
                      d="M50 5 Q70 5 70 15 L75 35 L80 95 L20 95 L25 35 L30 15 Q30 5 50 5Z"
                      fill="#ffd1d1"
                    />
                  </svg>

                  {/* Drop Zones */}
                  {organs.map((organ) => (
                    <button
                      key={organ.id}
                      onClick={() => handleZoneClick(organ.id)}
                      disabled={placed[organ.id]}
                      className={`absolute transition-all border-2 border-dashed rounded-lg flex items-center justify-center
                                     ${
                                       placed[organ.id]
                                         ? "border-transparent"
                                         : "border-slate-300 bg-white/50 hover:bg-pink-100"
                                     }
                                     ${
                                       selected === organ.id
                                         ? "animate-pulse bg-pink-200 border-pink-500"
                                         : ""
                                     }
                                 `}
                      style={{
                        left: `${organ.x}%`,
                        top: `${organ.y}%`,
                        width: `${organ.w}%`,
                        height: `${organ.h}%`,
                        transform: "translate(-50%, -50%)",
                        zIndex: organ.id === "large_int" ? 1 : 2, // Z-index layering
                      }}
                    >
                      {placed[organ.id] && (
                        <motion.div
                          initial={{ scale: 0 }}
                          animate={{ scale: 1 }}
                          className="w-full h-full flex flex-col items-center justify-center"
                        >
                          {/* Simplified Organ Visual */}
                          <div
                            className="w-full h-full rounded shadow-sm opacity-90"
                            style={{
                              backgroundColor: colors[organ.id],
                              maskImage: `url("data:image/svg+xml;utf8,<svg viewBox='0 0 100 100'><path d='${
                                shapes[organ.id]
                              }' /></svg>")`,
                            }}
                          ></div>
                          <span className="text-4xl absolute">
                            {["ğŸ‘„", "Pipe", "ğŸ¥£", "ã€°ï¸", "â­•"].find(
                              (_, i) => organs.indexOf(organ) === i
                            )}
                          </span>
                          {/* Fallback icons as I didn't impl complex SVG paths correctly in inline CSS mask lol. Let's use Emojis/Text overlay */}
                        </motion.div>
                      )}

                      {/* Label Tooltip */}
                      {placed[organ.id] && (
                        <div className="absolute left-full ml-2 bg-white px-2 py-1 rounded shadow text-xs font-bold whitespace-nowrap z-50">
                          <div className="text-pink-600 text-sm">
                            {getText(organ.id)}
                          </div>
                          <div className="text-slate-400 text-[10px]">
                            {getText(`func_${organ.id}`)}
                          </div>
                        </div>
                      )}
                    </button>
                  ))}
                </div>
              </div>

              {/* Organ Bank */}
              <div className="w-full md:w-1/3 flex flex-col gap-4">
                <h3 className="text-center font-bold text-slate-500 bg-white px-4 py-1 rounded-full shadow mb-4">
                  Parts
                </h3>
                <div className="flex flex-wrap gap-4 justify-center">
                  {available.map((organ) => (
                    <button
                      key={organ.id}
                      onClick={() =>
                        setSelected(selected === organ.id ? null : organ.id)
                      }
                      className={`p-4 rounded-2xl shadow-lg flex flex-col items-center transition-all w-28
                                      ${
                                        selected === organ.id
                                          ? "bg-pink-500 text-white scale-110 ring-4 ring-pink-200"
                                          : "bg-white hover:bg-pink-50 text-slate-700"
                                      }
                                  `}
                    >
                      <div className="text-4xl mb-2">
                        {/* Manual Mapping for visual clarity */}
                        {organ.id === "mouth" && "ğŸ‘„"}
                        {organ.id === "esophagus" && "ğŸ¥¢"}
                        {organ.id === "stomach" && "ğŸ¥£"}
                        {organ.id === "small_int" && "ã€°ï¸"}
                        {organ.id === "large_int" && "â­•"}
                      </div>
                      <div className="text-sm font-bold text-center leading-tight">
                        {getText(organ.id)}
                      </div>
                    </button>
                  ))}
                </div>

                {completed && (
                  <motion.div
                    initial={{ scale: 0 }}
                    animate={{ scale: 1 }}
                    className="mt-8 bg-green-100 border-4 border-green-200 p-6 rounded-3xl text-center shadow-xl"
                  >
                    <div className="text-6xl mb-2">ğŸ‰</div>
                    <h2 className="text-2xl font-black text-green-700 mb-4">
                      {getText("completed")}
                    </h2>
                    <button
                      onClick={reset}
                      className="bg-green-600 text-white px-8 py-3 rounded-full font-bold hover:bg-green-700 shadow"
                    >
                      {getText("reset")} ğŸ”„
                    </button>
                  </motion.div>
                )}
              </div>
            </div>
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  
      
      <!-- Footer -->
      <footer class="text-center py-4 text-slate-500 text-sm">
        <p class="italic mb-1">
          But God made the earth by his power; he founded the world by his wisdom and stretched out the heavens by his
          understanding. Jeremiah 10:12
        </p>
        <p class="text-xs mb-1 mt-2">
          ã€Œè€¶å’Œè¯ç”¨èƒ½åŠ›å‰µé€ å¤§åœ°ï¼Œç”¨æ™ºæ…§å»ºç«‹ä¸–ç•Œï¼Œç”¨è°æ˜é‹ªå¼µç©¹è’¼ã€‚ã€ è€¶åˆ©ç±³æ›¸ 10:12
        </p>
        <p class="text-xs mt-2 pt-2 border-t border-slate-300">
          @ 2025 Education Engineering Portfolio | Generated by Gemini Pro 3.0 | Prepared by SF Lau
        </p>
      </footer>
</body>
</html>
