<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å°ä¸‰å¸¸è­˜ï¼šéš§é“æ”¶è²»å“¡ | Tunnel Toll</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Tunnel Toll",
          zh: "éš§é“æ”¶è²»å“¡",
          ja: "ãƒˆãƒ³ãƒãƒ«æ–™é‡‘",
          ko: "í„°ë„ í†µí–‰ë£Œ",
          es: "Peaje del TÃºnel",
          de: "Tunnelmaut",
          fi: "Tunnelimaksu",
          fr: "PÃ©age du tunnel",
          ar: "Ø±Ø³ÙˆÙ… Ø§Ù„Ù†ÙÙ‚",
          it: "Pedaggio del Tunnel",
        },
        instruction: {
          en: "Calculate the total toll!",
          zh: "è¨ˆç®—ç¸½æ”¶è²»ï¼",
          ja: "åˆè¨ˆæ–™é‡‘ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ï¼",
          ko: "ì´ í†µí–‰ë£Œë¥¼ ê³„ì‚°í•˜ì„¸ìš”!",
          es: "Â¡Calcula el peaje total!",
          de: "Berechne die Gesamtmaut!",
          fi: "Laske kokonaismaksu!",
          fr: "Calculez le pÃ©age total !",
          ar: "Ø§Ø­Ø³Ø¨ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±Ø³ÙˆÙ…!",
          it: "Calcola il pedaggio totale!",
        },

        car: {
          en: "Car ($5)",
          zh: "ç§å®¶è»Š ($5)",
          ja: "è»Š ($5)",
          ko: "ìë™ì°¨ ($5)",
          es: "Coche ($5)",
          de: "Auto ($5)",
          fi: "Auto ($5)",
          fr: "Voiture ($5)",
          ar: "Ø³ÙŠØ§Ø±Ø© ($5)",
          it: "Auto ($5)",
        },
        van: {
          en: "Van ($10)",
          zh: "è¼•å‹è²¨è»Š ($10)",
          ja: "ãƒãƒ³ ($10)",
          ko: "ë°´ ($10)",
          es: "Furgoneta ($10)",
          de: "Transporter ($10)",
          fi: "Pakettiauto ($10)",
          fr: "Camionnette ($10)",
          ar: "ÙØ§Ù† ($10)",
          it: "Furgone ($10)",
        },
        bus: {
          en: "Bus ($20)",
          zh: "å·´å£« ($20)",
          ja: "ãƒã‚¹ ($20)",
          ko: "ë²„ìŠ¤ ($20)",
          es: "AutobÃºs ($20)",
          de: "Bus ($20)",
          fi: "Bussi ($20)",
          fr: "Bus ($20)",
          ar: "Ø­Ø§ÙÙ„Ø© ($20)",
          it: "Autobus ($20)",
        },

        total: {
          en: "Total:",
          zh: "ç¸½è¨ˆ:",
          ja: "åˆè¨ˆ:",
          ko: "í•©ê³„:",
          es: "Total:",
          de: "Gesamt:",
          fi: "YhteensÃ¤:",
          fr: "Total :",
          ar: "Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹:",
          it: "Totale:",
        },
        submit: {
          en: "Collect",
          zh: "æ”¶è²»",
          ja: "å¾´å",
          ko: "ì§•ìˆ˜",
          es: "Cobrar",
          de: "Kassieren",
          fi: "KerÃ¤Ã¤",
          fr: "Collecter",
          ar: "Ø¬Ù…Ø¹",
          it: "Riscuoti",
        },

        correct: {
          en: "Fees Collected!",
          zh: "æ”¶è²»æ­£ç¢ºï¼",
          ja: "æ–™é‡‘å¾´åå®Œäº†ï¼",
          ko: "ìš”ê¸ˆ ì§•ìˆ˜ ì™„ë£Œ!",
          es: "Â¡Tasas Cobradas!",
          de: "GebÃ¼hren kassiert!",
          fi: "Maksut kerÃ¤tty!",
          fr: "Frais collectÃ©s !",
          ar: "ØªÙ… ØªØ­ØµÙŠÙ„ Ø§Ù„Ø±Ø³ÙˆÙ…!",
          it: "Pedaggi Riscossi!",
        },
        wrong: {
          en: "Wrong amount!",
          zh: "é‡‘é¡éŒ¯èª¤ï¼",
          ja: "é‡‘é¡ãŒé–“é•ã£ã¦ã„ã¾ã™ï¼",
          ko: "ê¸ˆì•¡ì´ í‹€ë ¸ìŠµë‹ˆë‹¤!",
          es: "Â¡Cantidad incorrecta!",
          de: "Falscher Betrag!",
          fi: "VÃ¤Ã¤rÃ¤ summa!",
          fr: "Mauvais montant !",
          ar: "Ù…Ø¨Ù„Øº Ø®Ø§Ø·Ø¦!",
          it: "Importo errato!",
        },
        score: {
          en: "Revenue",
          zh: "æ”¶å…¥",
          ja: "åç›Š",
          ko: "ìˆ˜ì…",
          es: "Ingresos",
          de: "Einnahmen",
          fi: "Tulot",
          fr: "Revenu",
          ar: "Ø¥ÙŠØ±Ø§Ø¯Ø§Øª",
          it: "Entrate",
        },
      };

      const prices = {
        car: 5,
        van: 10,
        bus: 20,
      };

      const vehicles = [
        { id: "car", icon: "ğŸš—", price: 5 },
        { id: "van", icon: "ğŸš", price: 10 },
        { id: "bus", icon: "ğŸšŒ", price: 20 },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [queue, setQueue] = useState([]);
        const [input, setInput] = useState(0);
        const [score, setScore] = useState(0);
        const [feedback, setFeedback] = useState(null);

        const getText = (key) => t[key][lang] || t[key]["en"];

        useEffect(() => {
          generateQueue();
        }, []);

        const generateQueue = () => {
          // Random 2-4 vehicles
          const count = Math.floor(Math.random() * 3) + 2;
          const newQueue = [];
          for (let i = 0; i < count; i++) {
            newQueue.push(
              vehicles[Math.floor(Math.random() * vehicles.length)]
            );
          }
          setQueue(newQueue);
          setInput(0);
          setFeedback(null);
        };

        const correctTotal = queue.reduce((acc, v) => acc + v.price, 0);

        const check = () => {
          if (input === correctTotal) {
            setScore((s) => s + correctTotal);
            setFeedback("correct");
            setTimeout(generateQueue, 1500);
          } else {
            setFeedback("wrong");
            setTimeout(() => setFeedback(null), 1000);
          }
        };

        return (
          <div className="min-h-screen p-4 flex flex-col items-center select-none font-sans overflow-hidden text-white">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl md:text-5xl font-black text-yellow-400 mb-4 mt-8 drop-shadow-[0_0_10px_rgba(250,204,21,0.5)]">
              ğŸ›‚ {getText("title")}
            </h1>

            <div className="w-full max-w-4xl flex flex-col items-center flex-1 relative">
              <div className="absolute top-0 right-0 font-black text-2xl text-green-400 border-2 border-green-500 rounded-xl px-4 py-2">
                {getText("score")}: ${score}
              </div>

              {/* Tunnel Queue Scene */}
              <div className="w-full h-48 bg-slate-800 rounded-3xl border-b-8 border-slate-600 relative overflow-hidden flex items-end px-12 mb-8 mt-16 shadow-inner">
                {/* Road Markings */}
                <div className="absolute bottom-4 left-0 w-full h-0 border-t-4 border-dashed border-white/20"></div>

                <AnimatePresence>
                  {queue.map((v, i) => (
                    <motion.div
                      key={`${i}-${v.id}`} // Unique key per generation
                      initial={{ x: 300, opacity: 0 }}
                      animate={{ x: 0, opacity: 1 }}
                      exit={{ x: -300, opacity: 0 }}
                      transition={{ delay: i * 0.2 }}
                      className="relative mr-4 mb-2"
                    >
                      <div className="text-7xl drop-shadow-lg">{v.icon}</div>
                      <div className="absolute top-0 right-0 bg-black/50 text-white text-xs font-bold px-1 rounded backdrop-blur">
                        ${v.price}
                      </div>
                    </motion.div>
                  ))}
                </AnimatePresence>

                {/* Toll Booth */}
                <div className="absolute right-0 bottom-0 h-full w-24 bg-yellow-600 border-l-4 border-yellow-700 z-10 flex items-center justify-center">
                  <div className="bg-black p-2 rounded text-red-500 font-mono font-bold">
                    STOP
                  </div>
                </div>
              </div>

              {/* Calculator / Input */}
              <div className="bg-slate-700 p-8 rounded-[2rem] shadow-2xl w-full max-w-md border-4 border-slate-600">
                <div className="bg-black/40 rounded-xl p-4 mb-6 text-right font-mono text-5xl text-green-400 shadow-inner">
                  ${input}
                </div>

                <div className="grid grid-cols-3 gap-4">
                  {[1, 2, 3, 4, 5, 6, 7, 8, 9, "C", 0].map((btn) => (
                    <button
                      key={btn}
                      onClick={() => {
                        if (btn === "C") setInput(0);
                        else
                          setInput((curr) =>
                            parseInt(`${curr}${btn}`.substring(0, 3))
                          ); // Limit length
                      }}
                      className="bg-slate-600 hover:bg-slate-500 text-white font-black text-2xl py-4 rounded-xl shadow active:scale-95 transition-transform border-b-4 border-slate-800 active:border-b-0 active:translate-y-1"
                    >
                      {btn}
                    </button>
                  ))}
                  <button
                    onClick={check}
                    className="bg-green-500 hover:bg-green-600 text-white font-black text-xl py-4 rounded-xl shadow active:scale-95 transition-transform border-b-4 border-green-700 active:border-b-0 active:translate-y-1"
                  >
                    {getText("submit")}
                  </button>
                </div>
              </div>

              {feedback && (
                <motion.div
                  initial={{ scale: 0 }}
                  animate={{ scale: 1 }}
                  className={`absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 p-6 rounded-3xl font-black text-3xl shadow-2xl z-20 whitespace-nowrap ${
                    feedback === "correct"
                      ? "bg-green-500 text-white"
                      : "bg-red-500 text-white"
                  }`}
                >
                  {getText(feedback)}
                </motion.div>
              )}
            </div>

            <div className="mt-8 flex gap-4 opacity-70 text-sm">
              <div className="flex flex-col items-center">
                <span className="text-2xl">ğŸš—</span> ${prices.car}
              </div>
              <div className="flex flex-col items-center">
                <span className="text-2xl">ğŸš</span> ${prices.van}
              </div>
              <div className="flex flex-col items-center">
                <span className="text-2xl">ğŸšŒ</span> ${prices.bus}
              </div>
            </div>
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  
      
      <!-- Footer -->
      <footer class="text-center py-4 text-slate-500 text-sm">
        <p class="italic mb-1">
          But God made the earth by his power; he founded the world by his wisdom and stretched out the heavens by his
          understanding. Jeremiah 10:12
        </p>
        <p class="text-xs mb-1 mt-2">
          ã€Œè€¶å’Œè¯ç”¨èƒ½åŠ›å‰µé€ å¤§åœ°ï¼Œç”¨æ™ºæ…§å»ºç«‹ä¸–ç•Œï¼Œç”¨è°æ˜é‹ªå¼µç©¹è’¼ã€‚ã€ è€¶åˆ©ç±³æ›¸ 10:12
        </p>
        <p class="text-xs mt-2 pt-2 border-t border-slate-300">
          @ 2025 Education Engineering Portfolio | Generated by Gemini Pro 3.0 | Prepared by SF Lau
        </p>
      </footer>
</body>
</html>
