<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å°äºŒå¸¸è­˜ï¼šä¿è­·èº«é«” | Safe Touch</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: linear-gradient(135deg, #fef2f2 0%, #ffe4e6 100%);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Safe Touch",
          zh: "ä¿è­·èº«é«”",
          ja: "èº«ä½“ã‚’å®ˆã‚ã†",
        },
        instruction: {
          en: "Can a stranger touch here?",
          zh: "é™Œç”Ÿäººå¯ä»¥è§¸æ‘¸é€™è£¡å—ï¼Ÿ",
          ja: "çŸ¥ã‚‰ãªã„äººãŒã“ã“ã‚’è§¦ã£ã¦ã‚‚ã„ã„ã§ã™ã‹ï¼Ÿ",
        },
        yes: { en: "Maybe / Ask First", zh: "å•å‡†å®¶é•· / æ¡æ‰‹" },
        no: { en: "NO! Private!", zh: "ä¸å¯ä»¥ï¼ç§éš±éƒ¨ä½ï¼" },
        correct: { en: "Correct!", zh: "ç­”å°äº†ï¼" },
        wrong: { en: "Be careful!", zh: "è¦å°å¿ƒï¼" },

        head: { en: "Head", zh: "é ­éƒ¨" },
        hand: { en: "Hand", zh: "æ‰‹" },
        shoulder: { en: "Shoulder", zh: "è‚©è†€" },
        knee: { en: "Knee", zh: "è†è“‹" },

        mouth: { en: "Mouth", zh: "å˜´å·´" },
        chest: { en: "Chest (Swimsuit)", zh: "èƒ¸éƒ¨ (æ³³è¡£é®è“‹)" },
        privates: { en: "Between Legs", zh: "å…©è…¿ä¹‹é–“ (æ³³è¡£é®è“‹)" },
        bottom: { en: "Bottom", zh: "è‡€éƒ¨" },

        score: { en: "Score", zh: "åˆ†æ•¸" },
        next: { en: "Next", zh: "ä¸‹ä¸€é¡Œ" },
      };

      const zones = [
        { id: "hand", type: "safe", x: 15, y: 45, r: 10 }, // L Hand
        { id: "shoulder", type: "safe", x: 35, y: 25, r: 8 }, // Shoulder
        { id: "head", type: "safe", x: 50, y: 10, r: 12 }, // Head

        { id: "chest", type: "private", x: 50, y: 35, r: 12 },
        { id: "privates", type: "private", x: 50, y: 55, r: 12 },
        { id: "mouth", type: "private", x: 50, y: 18, r: 5 }, // Close to private in context of strangers
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [qIdx, setQIdx] = useState(0);
        const [shuffledZones, setShuffledZones] = useState([]);
        const [feedback, setFeedback] = useState(null);
        const [score, setScore] = useState(0);

        const getText = (key) => t[key][lang] || t[key]["en"];

        useEffect(() => {
          const s = [...zones].sort(() => Math.random() - 0.5);
          setShuffledZones(s);
        }, []);

        const currentZone = shuffledZones[qIdx];

        const handleAnswer = (ans) => {
          if (feedback) return;
          // logic: private -> no, safe -> yes/maybe
          const correctAns = currentZone.type === "private" ? "no" : "yes";

          if (ans === correctAns) {
            setFeedback("correct");
            setScore((s) => s + 10);
          } else {
            setFeedback("wrong");
          }
        };

        const next = () => {
          if (qIdx < shuffledZones.length - 1) {
            setQIdx(qIdx + 1);
            setFeedback(null);
          } else {
            // Restart
            setQIdx(0);
            setFeedback(null);
            setScore(0);
            const s = [...zones].sort(() => Math.random() - 0.5);
            setShuffledZones(s);
          }
        };

        return (
          <div className="min-h-screen p-4 flex flex-col items-center">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl md:text-5xl font-black text-rose-800 mb-4 mt-8 drop-shadow-sm bg-white/50 px-6 py-2 rounded-full">
              ğŸ›¡ï¸ {getText("title")}
            </h1>
            <div className="font-bold text-rose-700 bg-white px-4 py-1 rounded-full mb-4 shadow">
              {getText("score")}: {score}
            </div>

            {currentZone && (
              <div className="flex flex-col items-center w-full max-w-lg">
                {/* Character View */}
                <div className="relative w-64 h-80 bg-white rounded-3xl shadow-xl border-4 border-rose-200 mb-6">
                  {/* Simple Body */}
                  <div className="absolute inset-0 flex flex-col items-center justify-center opacity-30">
                    <div className="w-20 h-20 bg-slate-400 rounded-full mb-2"></div>
                    <div className="w-24 h-32 bg-slate-400 rounded-xl mb-2"></div>
                    <div className="flex gap-2">
                      <div className="w-8 h-24 bg-slate-400 rounded-full"></div>
                      <div className="w-8 h-24 bg-slate-400 rounded-full"></div>
                    </div>
                    <div className="absolute top-28 left-4 w-8 h-24 rounded-full bg-slate-400 -rotate-12"></div>
                    <div className="absolute top-28 right-4 w-8 h-24 rounded-full bg-slate-400 rotate-12"></div>
                  </div>

                  {/* Highlight */}
                  <motion.div
                    key={currentZone.id}
                    initial={{ scale: 0 }}
                    animate={{ scale: 1 }}
                    className="absolute bg-rose-500/50 border-4 border-rose-600 rounded-full animate-pulse"
                    style={{
                      left: `${currentZone.x}%`,
                      top: `${currentZone.y}%`,
                      width: `${currentZone.r * 2}%`,
                      height: `${currentZone.r * 2}%`,
                      transform: "translate(-50%, -50%)",
                    }}
                  />

                  <div className="absolute -bottom-16 w-full text-center">
                    <h2 className="text-2xl font-black text-rose-900 bg-white/80 rounded-xl py-2 shadow border-2 border-rose-100">
                      {getText(currentZone.id)} ?
                    </h2>
                  </div>
                </div>

                <p className="font-bold text-slate-600 mb-6 mt-12 bg-white/50 px-4 py-2 rounded-xl text-center">
                  {getText("instruction")}
                </p>

                {feedback ? (
                  <div className="text-center w-full">
                    <div
                      className={`text-3xl font-black mb-4 ${
                        feedback === "correct"
                          ? "text-green-600"
                          : "text-red-500"
                      }`}
                    >
                      {getText(feedback)}
                    </div>
                    <button
                      onClick={next}
                      className="bg-rose-500 text-white px-12 py-3 rounded-full font-black text-xl hover:bg-rose-600 shadow-xl"
                    >
                      {getText("next")} â¡ï¸
                    </button>
                  </div>
                ) : (
                  <div className="flex gap-4 w-full">
                    <button
                      onClick={() => handleAnswer("yes")}
                      className="flex-1 bg-green-100 hover:bg-green-200 text-green-800 py-4 rounded-xl font-bold shadow-lg border-b-4 border-green-300 active:border-b-0 active:translate-y-1 text-lg leading-tight"
                    >
                      {getText("yes")}
                    </button>
                    <button
                      onClick={() => handleAnswer("no")}
                      className="flex-1 bg-red-500 hover:bg-red-600 text-white py-4 rounded-xl font-bold shadow-lg border-b-4 border-red-700 active:border-b-0 active:translate-y-1 text-lg leading-tight"
                    >
                      {getText("no")}
                    </button>
                  </div>
                )}
              </div>
            )}
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  
      
      <!-- Footer -->
      <footer class="text-center py-4 text-slate-500 text-sm">
        <p class="italic mb-1">
          But God made the earth by his power; he founded the world by his wisdom and stretched out the heavens by his
          understanding. Jeremiah 10:12
        </p>
        <p class="text-xs mb-1 mt-2">
          ã€Œè€¶å’Œè¯ç”¨èƒ½åŠ›å‰µé€ å¤§åœ°ï¼Œç”¨æ™ºæ…§å»ºç«‹ä¸–ç•Œï¼Œç”¨è°æ˜é‹ªå¼µç©¹è’¼ã€‚ã€ è€¶åˆ©ç±³æ›¸ 10:12
        </p>
        <p class="text-xs mt-2 pt-2 border-t border-slate-300">
          @ 2025 Education Engineering Portfolio | Generated by Gemini Pro 3.0 | Prepared by SF Lau
        </p>
      </footer>
</body>
</html>
