<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å°äºŒå¸¸è­˜ï¼šå‹•ç‰©çš„å®¶ | Animal Habitats</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: linear-gradient(135deg, #bae6fd 0%, #e0f2fe 100%);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Animal Habitats",
          zh: "å‹•ç‰©çš„å®¶",
          ja: "å‹•ç‰©ã®ç”Ÿæ¯åœ°",
          ko: "ë™ë¬¼ì˜ ì„œì‹ì§€",
          es: "HÃ¡bitats de Animales",
          de: "TierlebensrÃ¤ume",
          fi: "ElÃ¤inten elinympÃ¤ristÃ¶t",
          fr: "Habitats des animaux",
          ar: "Ù…ÙˆØ§Ø·Ù† Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª",
          it: "Habitat degli Animali",
        },
        instruction: {
          en: "Put animals in their habitats!",
          zh: "æŠŠå‹•ç‰©æ”¾å›ç‰ å€‘çš„å®¶ï¼",
          ja: "å‹•ç‰©ã‚’ç”Ÿæ¯åœ°ã«æˆ»ã—ã¦ã‚ã’ã‚ˆã†ï¼",
          ko: "ë™ë¬¼ë“¤ì„ ì„œì‹ì§€ì— ë†“ì•„ì£¼ì„¸ìš”!",
          es: "Â¡Pon a los animales en sus hÃ¡bitats!",
          de: "Setze Tiere in ihre LebensrÃ¤ume!",
          fi: "Laita elÃ¤imet elinympÃ¤ristÃ¶ihinsÃ¤!",
          fr: "Placez les animaux dans leurs habitats !",
          ar: "Ø¶Ø¹ Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª ÙÙŠ Ù…ÙˆØ§Ø·Ù†Ù‡Ø§!",
          it: "Metti gli animali nei loro habitat!",
        },

        land: {
          en: "Land",
          zh: "é™¸åœ°",
          ja: "é™¸",
          ko: "ìœ¡ì§€",
          es: "Tierra",
          de: "Land",
          fi: "Maa",
          fr: "Terre",
          ar: "Ø£Ø±Ø¶",
          it: "Terra",
        },
        sea: {
          en: "Sea",
          zh: "æµ·æ´‹",
          ja: "æµ·",
          ko: "ë°”ë‹¤",
          es: "Mar",
          de: "Meer",
          fi: "Meri",
          fr: "Mer",
          ar: "Ø¨Ø­Ø±",
          it: "Mare",
        },
        sky: {
          en: "Sky",
          zh: "å¤©ç©º",
          ja: "ç©º",
          ko: "í•˜ëŠ˜",
          es: "Cielo",
          de: "Himmel",
          fi: "Taivas",
          fr: "Ciel",
          ar: "Ø³Ù…Ø§Ø¡",
          it: "Cielo",
        },

        lion: {
          en: "Lion",
          zh: "ç…å­",
          ja: "ãƒ©ã‚¤ã‚ªãƒ³",
          ko: "ì‚¬ì",
          es: "LeÃ³n",
          de: "LÃ¶we",
          fi: "Leijona",
          fr: "Lion",
          ar: "Ø£Ø³Ø¯",
          it: "Leone",
        },
        elephant: {
          en: "Elephant",
          zh: "å¤§è±¡",
          ja: "è±¡",
          ko: "ì½”ë¼ë¦¬",
          es: "Elefante",
          de: "Elefant",
          fi: "Norsu",
          fr: "Ã‰lÃ©phant",
          ar: "ÙÙŠÙ„",
          it: "Elefante",
        },
        rabbit: {
          en: "Rabbit",
          zh: "å…”å­",
          ja: "ã‚¦ã‚µã‚®",
          ko: "í† ë¼",
          es: "Conejo",
          de: "Hase",
          fi: "Kani",
          fr: "Lapin",
          ar: "Ø£Ø±Ù†Ø¨",
          it: "Coniglio",
        },

        fish: {
          en: "Fish",
          zh: "é­š",
          ja: "é­š",
          ko: "ë¬¼ê³ ê¸°",
          es: "Pez",
          de: "Fisch",
          fi: "Kala",
          fr: "Poisson",
          ar: "Ø³Ù…ÙƒØ©",
          it: "Pesce",
        },
        whale: {
          en: "Whale",
          zh: "é¯¨é­š",
          ja: "ã‚¯ã‚¸ãƒ©",
          ko: "ê³ ë˜",
          es: "Ballena",
          de: "Wal",
          fi: "Valas",
          fr: "Baleine",
          ar: "Ø­ÙˆØª",
          it: "Balena",
        },
        crab: {
          en: "Crab",
          zh: "èƒèŸ¹",
          ja: "ã‚«ãƒ‹",
          ko: "ê²Œ",
          es: "Cangrejo",
          de: "Krabbe",
          fi: "Rapu",
          fr: "Crabe",
          ar: "Ø³Ù„Ø·Ø¹ÙˆÙ†",
          it: "Granchio",
        },

        bird: {
          en: "Bird",
          zh: "å°é³¥",
          ja: "é³¥",
          ko: "ìƒˆ",
          es: "PÃ¡jaro",
          de: "Vogel",
          fi: "Lintu",
          fr: "Oiseau",
          ar: "Ø·Ø§Ø¦Ø±",
          it: "Uccello",
        },
        eagle: {
          en: "Eagle",
          zh: "è€é·¹",
          ja: "é·²",
          ko: "ë…ìˆ˜ë¦¬",
          es: "Ãguila",
          de: "Adler",
          fi: "Kotka",
          fr: "Aigle",
          ar: "Ù†Ø³Ø±",
          it: "Aquila",
        },
        bat: {
          en: "Bat",
          zh: "è™è ",
          ja: "ã‚³ã‚¦ãƒ¢ãƒª",
          ko: "ë°•ì¥",
          es: "MurciÃ©lago",
          de: "Fledermaus",
          fi: "Lepakko",
          fr: "Chauve-souris",
          ar: "Ø®ÙØ§Ø´",
          it: "Pipistrello",
        },

        correct: {
          en: "Correct!",
          zh: "æ­£ç¢ºï¼",
          ja: "æ­£è§£ï¼",
          ko: "ì •ë‹µì…ë‹ˆë‹¤!",
          es: "Â¡Correcto!",
          de: "Richtig!",
          fi: "Oikein!",
          fr: "Correct !",
          ar: "ØµØ­ÙŠØ­!",
          it: "Corretto!",
        },
        wrong: {
          en: "Wrong Habitat!",
          zh: "ä½éŒ¯åœ°æ–¹äº†ï¼",
          ja: "ç”Ÿæ¯åœ°ãŒé•ã„ã¾ã™ï¼",
          ko: "ì„œì‹ì§€ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤!",
          es: "Â¡HÃ¡bitat Incorrecto!",
          de: "Falscher Lebensraum!",
          fi: "VÃ¤Ã¤rÃ¤ elinympÃ¤ristÃ¶!",
          fr: "Mauvais habitat !",
          ar: "Ù…ÙˆØ·Ù† Ø®Ø§Ø·Ø¦!",
          it: "Habitat Sbagliato!",
        },
        completed: {
          en: "All animals represent happy!",
          zh: "æ‰€æœ‰å‹•ç‰©éƒ½å¾ˆé–‹å¿ƒï¼",
          ja: "å‹•ç‰©ãŸã¡ã¯ã¿ã‚“ãªå¹¸ã›ãã†ã§ã™ï¼",
          ko: "ëª¨ë“  ë™ë¬¼ë“¤ì´ í–‰ë³µí•´í•´ìš”!",
          es: "Â¡Todos los animales estÃ¡n felices!",
          de: "Alle Tiere sind glÃ¼cklich!",
          fi: "Kaikki elÃ¤imet ovat onnellisia!",
          fr: "Tous les animaux sont heureux !",
          ar: "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª Ø³Ø¹ÙŠØ¯Ø©!",
          it: "Tutti gli animali sono felici!",
        },
        reset: {
          en: "Play Again",
          zh: "å†ç©ä¸€æ¬¡",
          ja: "ã‚‚ã†ä¸€åº¦ãƒ—ãƒ¬ã‚¤",
          ko: "ë‹¤ì‹œ í•˜ê¸°",
          es: "Jugar de Nuevo",
          de: "Nochmal spielen",
          fi: "Pelaa uudelleen",
          fr: "Rejouer",
          ar: "Ø§Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",
          it: "Gioca di Nuovo",
        },
      };

      const animals = [
        { id: "lion", icon: "ğŸ¦", habitat: "land" },
        { id: "whale", icon: "ğŸ‹", habitat: "sea" },
        { id: "eagle", icon: "ğŸ¦…", habitat: "sky" },
        { id: "fish", icon: "ğŸ ", habitat: "sea" },
        { id: "rabbit", icon: "ğŸ‡", habitat: "land" },
        { id: "bird", icon: "ğŸ¦", habitat: "sky" },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [queue, setQueue] = useState([]);
        const [current, setCurrent] = useState(null);
        const [feedback, setFeedback] = useState(null);
        const [placed, setPlaced] = useState({ land: [], sea: [], sky: [] });

        const getText = (key) => t[key][lang] || t[key]["en"];

        useEffect(() => {
          reset();
        }, []);

        const reset = () => {
          const q = [...animals].sort(() => Math.random() - 0.5);
          setQueue(q);
          setCurrent(q[0]);
          setPlaced({ land: [], sea: [], sky: [] });
          setFeedback(null);
        };

        const handlePlace = (hab) => {
          if (feedback) return;
          if (current.habitat === hab) {
            setFeedback("correct");
            setPlaced((prev) => ({ ...prev, [hab]: [...prev[hab], current] }));
            setTimeout(() => {
              setFeedback(null);
              const nextIdx = queue.indexOf(current) + 1;
              if (nextIdx < queue.length) setCurrent(queue[nextIdx]);
              else setCurrent(null);
            }, 800);
          } else {
            setFeedback("wrong");
            setTimeout(() => setFeedback(null), 1000);
          }
        };

        return (
          <div className="min-h-screen p-4 flex flex-col items-center select-none overflow-hidden">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl md:text-5xl font-black text-sky-800 mb-4 mt-8 drop-shadow-sm bg-white/50 px-6 py-2 rounded-full z-10">
              ğŸŒ {getText("title")}
            </h1>

            {!current && (
              <div className="absolute inset-0 bg-white/80 z-50 flex flex-col items-center justify-center">
                <div className="text-8xl mb-4">ğŸ‰</div>
                <h2 className="text-3xl font-black text-green-600 mb-6">
                  {getText("completed")}
                </h2>
                <button
                  onClick={reset}
                  className="bg-green-600 text-white px-10 py-4 rounded-full font-black text-xl hover:bg-green-700 shadow-xl"
                >
                  {getText("reset")} ğŸ”„
                </button>
              </div>
            )}

            {/* Habitat Zones */}
            <div className="flex-1 w-full max-w-5xl flex flex-col gap-2 relative">
              {/* Sky */}
              <div
                onClick={() => current && handlePlace("sky")}
                className="flex-1 bg-sky-200 rounded-3xl border-4 border-white shadow-inner relative flex flex-wrap content-start p-4 hover:brightness-105 cursor-pointer transition-all"
              >
                <span className="absolute top-2 left-2 font-bold text-sky-600 bg-white/50 px-3 py-1 rounded-full">
                  {getText("sky")}
                </span>
                <div className="text-4xl absolute top-4 right-10 opacity-50">
                  â˜ï¸
                </div>
                {placed.sky.map((a, i) => (
                  <motion.div
                    key={i}
                    initial={{ scale: 0 }}
                    animate={{ scale: 1 }}
                    className="text-5xl m-2"
                  >
                    {a.icon}
                  </motion.div>
                ))}
              </div>

              {/* Land */}
              <div
                onClick={() => current && handlePlace("land")}
                className="flex-1 bg-green-200 rounded-3xl border-4 border-white shadow-inner relative flex flex-wrap content-center p-4 hover:brightness-105 cursor-pointer transition-all"
              >
                <span className="absolute top-2 left-2 font-bold text-green-700 bg-white/50 px-3 py-1 rounded-full">
                  {getText("land")}
                </span>
                <div className="text-4xl absolute bottom-4 right-10 opacity-50">
                  ğŸŒ²
                </div>
                {placed.land.map((a, i) => (
                  <motion.div
                    key={i}
                    initial={{ scale: 0 }}
                    animate={{ scale: 1 }}
                    className="text-5xl m-2"
                  >
                    {a.icon}
                  </motion.div>
                ))}
              </div>

              {/* Sea */}
              <div
                onClick={() => current && handlePlace("sea")}
                className="flex-1 bg-blue-300 rounded-3xl border-4 border-white shadow-inner relative flex flex-wrap content-end p-4 hover:brightness-105 cursor-pointer transition-all"
              >
                <span className="absolute top-2 left-2 font-bold text-blue-800 bg-white/50 px-3 py-1 rounded-full">
                  {getText("sea")}
                </span>
                <div className="text-4xl absolute bottom-4 right-10 opacity-50">
                  ğŸŒŠ
                </div>
                {placed.sea.map((a, i) => (
                  <motion.div
                    key={i}
                    initial={{ scale: 0 }}
                    animate={{ scale: 1 }}
                    className="text-5xl m-2"
                  >
                    {a.icon}
                  </motion.div>
                ))}
              </div>

              {/* Draggable (Clickable) Item Overlay */}
              {current && (
                <motion.div
                  initial={{ scale: 0 }}
                  animate={{ scale: 1 }}
                  key={current.id}
                  className="absolute inset-0 flex items-center justify-center pointer-events-none"
                >
                  <div className="bg-white p-6 rounded-full shadow-2xl border-4 border-orange-300 flex flex-col items-center animate-bounce-slow">
                    <div className="text-7xl mb-2">{current.icon}</div>
                    <div className="font-bold text-slate-600 bg-slate-100 px-2 rounded">
                      {getText(current.id)}
                    </div>
                  </div>
                </motion.div>
              )}

              {feedback && (
                <div
                  className={`absolute inset-0 flex items-center justify-center pointer-events-none z-20`}
                >
                  <motion.div
                    initial={{ scale: 0 }}
                    animate={{ scale: 1.5 }}
                    className={`p-6 rounded-2xl font-black text-3xl shadow-2xl border-4 border-white ${
                      feedback === "correct"
                        ? "bg-green-500 text-white"
                        : "bg-red-500 text-white"
                    }`}
                  >
                    {getText(feedback)}
                  </motion.div>
                </div>
              )}
            </div>

            <p className="mt-4 font-bold text-slate-500 animate-pulse">
              {getText("instruction")}
            </p>
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
