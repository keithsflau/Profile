<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å°äºŒå¸¸è­˜ï¼šé¦™æ¸¯ä»Šæ˜” | Old & New HK</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: linear-gradient(135deg, #fdf4ff 0%, #fae8ff 100%);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Old & New HK",
          zh: "é¦™æ¸¯ä»Šæ˜”",
          ja: "é¦™æ¸¯ã®ä»Šæ˜”",
        },
        instruction: {
          en: "Match Old and New items!",
          zh: "å°‡æ–°èˆŠç‰©å“é…å°èµ·ä¾†ï¼",
          ja: "å¤ã„ã‚‚ã®ã¨æ–°ã—ã„ã‚‚ã®ã‚’åˆã‚ã›ã¦ãã ã•ã„ï¼",
        },
        correct: { en: "Correct Match!", zh: "é…å°æ­£ç¢ºï¼" },
        wrong: { en: "Not a match.", zh: "ä¸æ˜¯ä¸€å°çš„ã€‚" },

        rickshaw: { en: "Rickshaw", zh: "äººåŠ›è»Š" },
        taxi: { en: "Taxi", zh: "çš„å£«" },

        abacus: { en: "Abacus", zh: "ç®—ç›¤" },
        calculator: { en: "Calculator", zh: "è¨ˆç®—æ©Ÿ" },

        fan: { en: "Paper Fan", zh: "è‘µæ‰‡" },
        ac: { en: "Air Conditioner", zh: "å†·æ°£æ©Ÿ" },

        letter: { en: "Letter", zh: "æ›¸ä¿¡" },
        email: { en: "Email / Phone", zh: "é›»éƒµ / æ‰‹æ©Ÿ" },

        well: { en: "Water Well", zh: "æ°´äº•" },
        tap: { en: "Water Tap", zh: "æ°´é¾é ­" },

        score: { en: "Score", zh: "åˆ†æ•¸" },
        completed: { en: "History Expert!", zh: "æ­·å²å°å°ˆå®¶ï¼" },
        restart: { en: "Play Again", zh: "å†ç©ä¸€æ¬¡" },
      };

      const pairs = [
        {
          id: 1,
          old: { key: "rickshaw", icon: "ğŸ›º" },
          new: { key: "taxi", icon: "ğŸš•" },
        },
        {
          id: 2,
          old: { key: "abacus", icon: "ğŸ§®" },
          new: { key: "calculator", icon: "ğŸ“±" },
        },
        {
          id: 3,
          old: { key: "fan", icon: "ğŸ‹" },
          new: { key: "ac", icon: "â„ï¸" },
        },
        {
          id: 4,
          old: { key: "letter", icon: "âœ‰ï¸" },
          new: { key: "email", icon: "ğŸ“§" },
        },
        {
          id: 5,
          old: { key: "well", icon: "ğŸ•³ï¸" },
          new: { key: "tap", icon: "ğŸš°" },
        },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [leftItems, setLeftItems] = useState([]);
        const [rightItems, setRightItems] = useState([]);
        const [selectedLeft, setSelectedLeft] = useState(null);
        const [selectedRight, setSelectedRight] = useState(null);
        const [matches, setMatches] = useState([]);
        const [feedback, setFeedback] = useState(null);

        const getText = (key) => t[key][lang] || t[key]["en"];

        useEffect(() => {
          initGame();
        }, []);

        const initGame = () => {
          const left = pairs
            .map((p) => ({ ...p.old, pairId: p.id, side: "old" }))
            .sort(() => Math.random() - 0.5);
          const right = pairs
            .map((p) => ({ ...p.new, pairId: p.id, side: "new" }))
            .sort(() => Math.random() - 0.5);
          setLeftItems(left);
          setRightItems(right);
          setMatches([]);
          setFeedback(null);
          setSelectedLeft(null);
          setSelectedRight(null);
        };

        const handleSelect = (item, side) => {
          if (feedback) return;
          if (side === "old") setSelectedLeft(item);
          else setSelectedRight(item);
        };

        useEffect(() => {
          if (selectedLeft && selectedRight) {
            if (selectedLeft.pairId === selectedRight.pairId) {
              // Match
              setFeedback("correct");
              setTimeout(() => {
                setMatches((prev) => [...prev, selectedLeft.pairId]);
                setSelectedLeft(null);
                setSelectedRight(null);
                setFeedback(null);
              }, 1000);
            } else {
              // Wrong
              setFeedback("wrong");
              setTimeout(() => {
                setSelectedLeft(null);
                setSelectedRight(null);
                setFeedback(null);
              }, 1000);
            }
          }
        }, [selectedLeft, selectedRight]);

        const allMatched = matches.length === pairs.length;

        return (
          <div className="min-h-screen p-4 flex flex-col items-center select-none">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl md:text-5xl font-black text-fuchsia-900 mb-4 mt-8 drop-shadow-sm bg-white/50 px-6 py-2 rounded-full">
              ğŸ•°ï¸ {getText("title")}
            </h1>
            <p className="font-bold text-fuchsia-800 mb-8">
              {getText("instruction")}
            </p>

            {!allMatched ? (
              <div className="flex w-full max-w-4xl gap-8 justify-between">
                {/* Old Side */}
                <div className="flex-1 flex flex-col gap-4">
                  <h2 className="text-center font-bold text-slate-500 mb-2">
                    Old (æ˜”æ—¥)
                  </h2>
                  {leftItems.map((item, i) => {
                    const isMatched = matches.includes(item.pairId);
                    const isSelected = selectedLeft === item;
                    return (
                      <motion.button
                        key={i}
                        disabled={isMatched}
                        onClick={() => handleSelect(item, "old")}
                        className={`p-4 rounded-xl shadow-md border-4 flex items-center justify-between transition-all ${
                          isMatched
                            ? "opacity-0 pointer-events-none"
                            : isSelected
                            ? "border-fuchsia-500 bg-fuchsia-100 scale-105"
                            : "border-white bg-white hover:bg-slate-50"
                        }`}
                        layout
                      >
                        <span className="text-4xl">{item.icon}</span>
                        <span className="font-bold text-slate-700">
                          {getText(item.key)}
                        </span>
                      </motion.button>
                    );
                  })}
                </div>

                {/* Feedback Center */}
                <div className="w-16 flex flex-col justify-center items-center">
                  {feedback && (
                    <motion.div
                      initial={{ scale: 0 }}
                      animate={{ scale: 1 }}
                      className={`text-4xl p-4 rounded-full shadow-xl z-10 ${
                        feedback === "correct"
                          ? "bg-green-500 text-white"
                          : "bg-red-500 text-white"
                      }`}
                    >
                      {feedback === "correct" ? "âœ…" : "âŒ"}
                    </motion.div>
                  )}
                </div>

                {/* New Side */}
                <div className="flex-1 flex flex-col gap-4">
                  <h2 className="text-center font-bold text-slate-500 mb-2">
                    New (ä»Šæ—¥)
                  </h2>
                  {rightItems.map((item, i) => {
                    const isMatched = matches.includes(item.pairId);
                    const isSelected = selectedRight === item;
                    return (
                      <motion.button
                        key={i}
                        disabled={isMatched}
                        onClick={() => handleSelect(item, "new")}
                        className={`p-4 rounded-xl shadow-md border-4 flex items-center justify-between flex-row-reverse transition-all ${
                          isMatched
                            ? "opacity-0 pointer-events-none"
                            : isSelected
                            ? "border-blue-500 bg-blue-100 scale-105"
                            : "border-white bg-white hover:bg-slate-50"
                        }`}
                        layout
                      >
                        <span className="text-4xl">{item.icon}</span>
                        <span className="font-bold text-slate-700">
                          {getText(item.key)}
                        </span>
                      </motion.button>
                    );
                  })}
                </div>
              </div>
            ) : (
              <div className="bg-white/90 p-12 rounded-3xl shadow-xl text-center mt-12">
                <div className="text-8xl mb-4">ğŸ“œ</div>
                <h2 className="text-3xl font-black text-fuchsia-800 mb-6">
                  {getText("completed")}
                </h2>
                <button
                  onClick={initGame}
                  className="bg-fuchsia-600 text-white px-10 py-4 rounded-full font-black text-xl hover:bg-fuchsia-700 shadow-xl"
                >
                  {getText("restart")} ğŸ”„
                </button>
              </div>
            )}
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  
      
      <!-- Footer -->
      <footer class="text-center py-4 text-slate-500 text-sm">
        <p class="italic mb-1">
          But God made the earth by his power; he founded the world by his wisdom and stretched out the heavens by his
          understanding. Jeremiah 10:12
        </p>
        <p class="text-xs mb-1 mt-2">
          ã€Œè€¶å’Œè¯ç”¨èƒ½åŠ›å‰µé€ å¤§åœ°ï¼Œç”¨æ™ºæ…§å»ºç«‹ä¸–ç•Œï¼Œç”¨è°æ˜é‹ªå¼µç©¹è’¼ã€‚ã€ è€¶åˆ©ç±³æ›¸ 10:12
        </p>
        <p class="text-xs mt-2 pt-2 border-t border-slate-300">
          @ 2025 Education Engineering Portfolio | Generated by Gemini Pro 3.0 | Prepared by SF Lau
        </p>
      </footer>
</body>
</html>
