<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å°äºŒå¸¸è­˜ï¼šé¦™æ¸¯ä»Šæ˜” | Old & New HK</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: linear-gradient(135deg, #fdf4ff 0%, #fae8ff 100%);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Old & New HK",
          zh: "é¦™æ¸¯ä»Šæ˜”",
          ja: "é¦™æ¸¯ã®ä»Šæ˜”",
          ko: "í™ì½©ì˜ ì–´ì œì™€ ì˜¤ëŠ˜",
          es: "Viejo y Nuevo HK",
          de: "Alt & Neu HK",
          fi: "Vanha & Uusi HK",
          fr: "Ancien & Nouveau HK",
          ar: "Ù‡ÙˆÙ†Ø¬ ÙƒÙˆÙ†Ø¬ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© ÙˆØ§Ù„Ø¬Ø¯ÙŠØ¯Ø©",
          it: "Vecchia e Nuova HK",
        },
        instruction: {
          en: "Match Old and New items!",
          zh: "å°‡æ–°èˆŠç‰©å“é…å°èµ·ä¾†ï¼",
          ja: "å¤ã„ã‚‚ã®ã¨æ–°ã—ã„ã‚‚ã®ã‚’åˆã‚ã›ã¦ãã ã•ã„ï¼",
          ko: "ì˜› ë¬¼ê±´ê³¼ ìƒˆ ë¬¼ê±´ì„ ì§ì§€ì–´ ë³´ì„¸ìš”!",
          es: "Â¡Empareja artÃ­culos viejos y nuevos!",
          de: "Ordne alte und neue GegenstÃ¤nde zu!",
          fi: "YhdistÃ¤ vanhat ja uudet esineet!",
          fr: "Associez les anciens et les nouveaux objets !",
          ar: "ØªØ·Ø§Ø¨Ù‚ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© ÙˆØ§Ù„Ø¬Ø¯ÙŠØ¯Ø©!",
          it: "Abbina oggetti vecchi e nuovi!",
        },
        correct: {
          en: "Correct Match!",
          zh: "é…å°æ­£ç¢ºï¼",
          ja: "æ­£è§£ï¼",
          ko: "ì •ë‹µì…ë‹ˆë‹¤!",
          es: "Â¡Emparejamiento Correcto!",
          de: "Richtig zugeordnet!",
          fi: "Oikea pari!",
          fr: "Bonne correspondance !",
          ar: "ØªØ·Ø§Ø¨Ù‚ ØµØ­ÙŠØ­!",
          it: "Abbinamento Corretto!",
        },
        wrong: {
          en: "Not a match.",
          zh: "ä¸æ˜¯ä¸€å°çš„ã€‚",
          ja: "é•ã„ã¾ã™ã€‚",
          ko: "ì§ì´ ì•„ë‹™ë‹ˆë‹¤.",
          es: "No coinciden.",
          de: "Kein Treffer.",
          fi: "Ei tÃ¤smÃ¤Ã¤.",
          fr: "Ne correspond pas.",
          ar: "Ù„ÙŠØ³Øª Ù…Ø·Ø§Ø¨Ù‚Ø©.",
          it: "Non corrispondono.",
        },

        rickshaw: {
          en: "Rickshaw",
          zh: "äººåŠ›è»Š",
          ja: "äººåŠ›è»Š",
          ko: "ì¸ë ¥ê±°",
          es: "Rickshaw",
          de: "Rikscha",
          fi: "Riksa",
          fr: "Pousse-pousse",
          ar: "Ø¹Ø±Ø¨Ø©",
          it: "RisciÃ²",
        },
        taxi: {
          en: "Taxi",
          zh: "çš„å£«",
          ja: "ã‚¿ã‚¯ã‚·ãƒ¼",
          ko: "íƒì‹œ",
          es: "Taxi",
          de: "Taxi",
          fi: "Taksi",
          fr: "Taxi",
          ar: "Ø³ÙŠØ§Ø±Ø© Ø£Ø¬Ø±Ø©",
          it: "Taxi",
        },

        abacus: {
          en: "Abacus",
          zh: "ç®—ç›¤",
          ja: "ãã‚ã°ã‚“",
          ko: "ì£¼íŒ",
          es: "Ãbaco",
          de: "Abakus",
          fi: "Helmitaulu",
          fr: "Abaque",
          ar: "Ù…Ø¹Ø¯Ø§Ø¯",
          it: "Abaco",
        },
        calculator: {
          en: "Calculator",
          zh: "è¨ˆç®—æ©Ÿ",
          ja: "é›»å“",
          ko: "ê³„ì‚°ê¸°",
          es: "Calculadora",
          de: "Taschenrechner",
          fi: "Laskin",
          fr: "Calculatrice",
          ar: "Ø¢Ù„Ø© Ø­Ø§Ø³Ø¨Ø©",
          it: "Calcolatrice",
        },

        fan: {
          en: "Paper Fan",
          zh: "è‘µæ‰‡",
          ja: "ç´™æ‰‡",
          ko: "ë¶€ì±„",
          es: "Abanico de Papel",
          de: "PapierfÃ¤cher",
          fi: "Paperiviuhka",
          fr: "Ã‰ventail en papier",
          ar: "Ù…Ø±ÙˆØ­Ø© ÙˆØ±Ù‚ÙŠØ©",
          it: "Ventaglio di Carta",
        },
        ac: {
          en: "Air Conditioner",
          zh: "å†·æ°£æ©Ÿ",
          ja: "ã‚¨ã‚¢ã‚³ãƒ³",
          ko: "ì—ì–´ì»¨",
          es: "Aire Acondicionado",
          de: "Klimaanlage",
          fi: "Ilmastointi",
          fr: "Climatiseur",
          ar: "Ù…ÙƒÙŠÙ Ù‡ÙˆØ§Ø¡",
          it: "Aria Condizionata",
        },

        letter: {
          en: "Letter",
          zh: "æ›¸ä¿¡",
          ja: "æ‰‹ç´™",
          ko: "í¸ì§€",
          es: "Carta",
          de: "Brief",
          fi: "Kirje",
          fr: "Lettre",
          ar: "Ø±Ø³Ø§Ù„Ø©",
          it: "Lettera",
        },
        email: {
          en: "Email / Phone",
          zh: "é›»éƒµ / æ‰‹æ©Ÿ",
          ja: "ãƒ¡ãƒ¼ãƒ« / é›»è©±",
          ko: "ì´ë©”ì¼ / ì „í™”",
          es: "Email / TelÃ©fono",
          de: "E-Mail / Telefon",
          fi: "SÃ¤hkÃ¶posti / Puhelin",
          fr: "Email / TÃ©lÃ©phone",
          ar: "Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ / Ù‡Ø§ØªÙ",
          it: "Email / Telefono",
        },

        well: {
          en: "Water Well",
          zh: "æ°´äº•",
          ja: "äº•æˆ¸",
          ko: "ìš°ë¬¼",
          es: "Pozo de Agua",
          de: "Brunnen",
          fi: "Kaivo",
          fr: "Puits",
          ar: "Ø¨Ø¦Ø± Ù…Ø§Ø¡",
          it: "Pozzo d'Acqua",
        },
        tap: {
          en: "Water Tap",
          zh: "æ°´é¾é ­",
          ja: "æ°´é“ã®è›‡å£",
          ko: "ìˆ˜ë„ê¼­ì§€",
          es: "Grifo",
          de: "Wasserhahn",
          fi: "Vesihana",
          fr: "Robinet",
          ar: "ØµÙ†Ø¨ÙˆØ± Ù…Ø§Ø¡",
          it: "Rubinetto",
        },

        score: {
          en: "Score",
          zh: "åˆ†æ•¸",
          ja: "ã‚¹ã‚³ã‚¢",
          ko: "ì ìˆ˜",
          es: "PuntuaciÃ³n",
          de: "Punktzahl",
          fi: "Pisteet",
          fr: "Score",
          ar: "Ù†ØªÙŠØ¬Ø©",
          it: "Punteggio",
        },
        completed: {
          en: "History Expert!",
          zh: "æ­·å²å°å°ˆå®¶ï¼",
          ja: "æ­´å²ã®ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆï¼",
          ko: "ì—­ì‚¬ ì „ë¬¸ê°€!",
          es: "Â¡Experto en Historia!",
          de: "Geschichtsexperte!",
          fi: "Historia-asiantuntija!",
          fr: "Expert en histoire !",
          ar: "Ø®Ø¨ÙŠØ± Ø§Ù„ØªØ§Ø±ÙŠØ®!",
          it: "Esperto di Storia!",
        },
        restart: {
          en: "Play Again",
          zh: "å†ç©ä¸€æ¬¡",
          ja: "ã‚‚ã†ä¸€åº¦ãƒ—ãƒ¬ã‚¤",
          ko: "ë‹¤ì‹œ í•˜ê¸°",
          es: "Jugar de Nuevo",
          de: "Nochmal spielen",
          fi: "Pelaa uudelleen",
          fr: "Rejouer",
          ar: "Ø§Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",
          it: "Gioca di Nuovo",
        },
      };

      const pairs = [
        {
          id: 1,
          old: { key: "rickshaw", icon: "ğŸ›º" },
          new: { key: "taxi", icon: "ğŸš•" },
        },
        {
          id: 2,
          old: { key: "abacus", icon: "ğŸ§®" },
          new: { key: "calculator", icon: "ğŸ“±" },
        },
        {
          id: 3,
          old: { key: "fan", icon: "ğŸ‹" },
          new: { key: "ac", icon: "â„ï¸" },
        },
        {
          id: 4,
          old: { key: "letter", icon: "âœ‰ï¸" },
          new: { key: "email", icon: "ğŸ“§" },
        },
        {
          id: 5,
          old: { key: "well", icon: "ğŸ•³ï¸" },
          new: { key: "tap", icon: "ğŸš°" },
        },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [leftItems, setLeftItems] = useState([]);
        const [rightItems, setRightItems] = useState([]);
        const [selectedLeft, setSelectedLeft] = useState(null);
        const [selectedRight, setSelectedRight] = useState(null);
        const [matches, setMatches] = useState([]);
        const [feedback, setFeedback] = useState(null);

        const getText = (key) => t[key][lang] || t[key]["en"];

        useEffect(() => {
          initGame();
        }, []);

        const initGame = () => {
          const left = pairs
            .map((p) => ({ ...p.old, pairId: p.id, side: "old" }))
            .sort(() => Math.random() - 0.5);
          const right = pairs
            .map((p) => ({ ...p.new, pairId: p.id, side: "new" }))
            .sort(() => Math.random() - 0.5);
          setLeftItems(left);
          setRightItems(right);
          setMatches([]);
          setFeedback(null);
          setSelectedLeft(null);
          setSelectedRight(null);
        };

        const handleSelect = (item, side) => {
          if (feedback) return;
          if (side === "old") setSelectedLeft(item);
          else setSelectedRight(item);
        };

        useEffect(() => {
          if (selectedLeft && selectedRight) {
            if (selectedLeft.pairId === selectedRight.pairId) {
              // Match
              setFeedback("correct");
              setTimeout(() => {
                setMatches((prev) => [...prev, selectedLeft.pairId]);
                setSelectedLeft(null);
                setSelectedRight(null);
                setFeedback(null);
              }, 1000);
            } else {
              // Wrong
              setFeedback("wrong");
              setTimeout(() => {
                setSelectedLeft(null);
                setSelectedRight(null);
                setFeedback(null);
              }, 1000);
            }
          }
        }, [selectedLeft, selectedRight]);

        const allMatched = matches.length === pairs.length;

        return (
          <div className="min-h-screen p-4 flex flex-col items-center select-none">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl md:text-5xl font-black text-fuchsia-900 mb-4 mt-8 drop-shadow-sm bg-white/50 px-6 py-2 rounded-full">
              ğŸ•°ï¸ {getText("title")}
            </h1>
            <p className="font-bold text-fuchsia-800 mb-8">
              {getText("instruction")}
            </p>

            {!allMatched ? (
              <div className="flex w-full max-w-4xl gap-8 justify-between">
                {/* Old Side */}
                <div className="flex-1 flex flex-col gap-4">
                  <h2 className="text-center font-bold text-slate-500 mb-2">
                    Old (æ˜”æ—¥)
                  </h2>
                  {leftItems.map((item, i) => {
                    const isMatched = matches.includes(item.pairId);
                    const isSelected = selectedLeft === item;
                    return (
                      <motion.button
                        key={i}
                        disabled={isMatched}
                        onClick={() => handleSelect(item, "old")}
                        className={`p-4 rounded-xl shadow-md border-4 flex items-center justify-between transition-all ${
                          isMatched
                            ? "opacity-0 pointer-events-none"
                            : isSelected
                            ? "border-fuchsia-500 bg-fuchsia-100 scale-105"
                            : "border-white bg-white hover:bg-slate-50"
                        }`}
                        layout
                      >
                        <span className="text-4xl">{item.icon}</span>
                        <span className="font-bold text-slate-700">
                          {getText(item.key)}
                        </span>
                      </motion.button>
                    );
                  })}
                </div>

                {/* Feedback Center */}
                <div className="w-16 flex flex-col justify-center items-center">
                  {feedback && (
                    <motion.div
                      initial={{ scale: 0 }}
                      animate={{ scale: 1 }}
                      className={`text-4xl p-4 rounded-full shadow-xl z-10 ${
                        feedback === "correct"
                          ? "bg-green-500 text-white"
                          : "bg-red-500 text-white"
                      }`}
                    >
                      {feedback === "correct" ? "âœ…" : "âŒ"}
                    </motion.div>
                  )}
                </div>

                {/* New Side */}
                <div className="flex-1 flex flex-col gap-4">
                  <h2 className="text-center font-bold text-slate-500 mb-2">
                    New (ä»Šæ—¥)
                  </h2>
                  {rightItems.map((item, i) => {
                    const isMatched = matches.includes(item.pairId);
                    const isSelected = selectedRight === item;
                    return (
                      <motion.button
                        key={i}
                        disabled={isMatched}
                        onClick={() => handleSelect(item, "new")}
                        className={`p-4 rounded-xl shadow-md border-4 flex items-center justify-between flex-row-reverse transition-all ${
                          isMatched
                            ? "opacity-0 pointer-events-none"
                            : isSelected
                            ? "border-blue-500 bg-blue-100 scale-105"
                            : "border-white bg-white hover:bg-slate-50"
                        }`}
                        layout
                      >
                        <span className="text-4xl">{item.icon}</span>
                        <span className="font-bold text-slate-700">
                          {getText(item.key)}
                        </span>
                      </motion.button>
                    );
                  })}
                </div>
              </div>
            ) : (
              <div className="bg-white/90 p-12 rounded-3xl shadow-xl text-center mt-12">
                <div className="text-8xl mb-4">ğŸ“œ</div>
                <h2 className="text-3xl font-black text-fuchsia-800 mb-6">
                  {getText("completed")}
                </h2>
                <button
                  onClick={initGame}
                  className="bg-fuchsia-600 text-white px-10 py-4 rounded-full font-black text-xl hover:bg-fuchsia-700 shadow-xl"
                >
                  {getText("restart")} ğŸ”„
                </button>
              </div>
            )}
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
