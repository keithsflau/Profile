<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>General Studies - Evolution Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <style>
      body {
        font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
        background: #f0fdf4;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Evolution: Survival",
          zh: "é€²åŒ–è«–ï¼šé©è€…ç”Ÿå­˜",
          ja: "é€²åŒ–ï¼šç”Ÿå­˜ç«¶äº‰",
          ko: "ì§„í™”: ìƒì¡´",
          es: "EvoluciÃ³n: Supervivencia",
          de: "Evolution: Ãœberleben",
          fi: "Evoluutio: Selviytyminen",
          fr: "Ã‰volution : Survie",
          ar: "Ø§Ù„ØªØ·ÙˆØ±: Ø§Ù„Ø¨Ù‚Ø§Ø¡",
          it: "Evoluzione: Sopravvivenza",
        },
        instruction: {
          en: "Choose the bird beak that fits the food.",
          zh: "é¸æ“‡é©åˆé£Ÿç‰©çš„é³¥å–™ã€‚",
          ja: "é£Ÿã¹ç‰©ã«åˆã£ãŸé³¥ã®ãã¡ã°ã—ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚",
          ko: "ìŒì‹ì— ë§ëŠ” ìƒˆì˜ ë¶€ë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”.",
          es: "Elige el pico de pÃ¡jaro que se adapte a la comida.",
          de: "WÃ¤hle den Vogelschnabel, der zum Futter passt.",
          fi: "Valitse ruoka-aineeseen sopiva linnun nokka.",
          fr: "Choisissez le bec d'oiseau adaptÃ© Ã  la nourriture.",
          ar: "Ø§Ø®ØªØ± Ù…Ù†Ù‚Ø§Ø± Ø§Ù„Ø·Ø§Ø¦Ø± Ø§Ù„Ø°ÙŠ ÙŠÙ†Ø§Ø³Ø¨ Ø§Ù„Ø·Ø¹Ø§Ù….",
          it: "Scegli il becco d'uccello adatto al cibo.",
        },
        seeds: {
          en: "Hard Seeds",
          zh: "å …ç¡¬ç¨®å­",
          ja: "ç¡¬ã„ç¨®",
          ko: "ë”±ë”±í•œ ì”¨ì•—",
        },
        insects: {
          en: "Insects in holes",
          zh: "æ´è£¡çš„æ˜†èŸ²",
          ja: "ç©´ã®ä¸­ã®æ˜†è™«",
          ko: "êµ¬ë© ì†ì˜ ê³¤ì¶©",
        },
        nectar: {
          en: "Flower Nectar",
          zh: "èŠ±èœœ",
          ja: "èŠ±ã®èœœ",
          ko: "ê½ƒì˜ ê¿€",
        },

        beak_big: {
          en: "Big Strong Beak",
          zh: "å¤§è€Œå¼·å£¯çš„å–™",
          ja: "å¤§ããã¦å¼·ã„ã‚¯ãƒãƒã‚·",
          ko: "í¬ê³  ê°•í•œ ë¶€ë¦¬",
        },
        beak_long: {
          en: "Long Thin Beak",
          zh: "é•·è€Œç´°çš„å–™",
          ja: "é•·ãã¦ç´°ã„ã‚¯ãƒãƒã‚·",
          ko: "ê¸¸ê³  ì–‡ì€ ë¶€ë¦¬",
        },
        beak_thin: {
          en: "Thin Probe Beak",
          zh: "æ¢é‡ç‹€å–™",
          ja: "æ¢ã‚Šé‡ã®ã‚ˆã†ãªã‚¯ãƒãƒã‚·",
          ko: "ê°€ëŠë‹¤ë€ íƒì¹¨ ë¶€ë¦¬",
        },

        survived: {
          en: "Survived!",
          zh: "å­˜æ´»ï¼",
          ja: "ç”Ÿãæ®‹ã£ãŸï¼",
          ko: "ìƒì¡´!",
        },
        starved: {
          en: "Starved...",
          zh: "é¤“æ­»äº†...",
          ja: "é¤“æ­»ã—ãŸ...",
          ko: "êµ¶ì–´ ì£½ìŒ...",
        },
      };

      const rules = [
        { food: "seeds", bestBeak: "beak_big", foodIcon: "ğŸŒ°" },
        { food: "insects", bestBeak: "beak_long", foodIcon: "ğŸ•³ï¸ğŸ›" },
        { food: "nectar", bestBeak: "beak_thin", foodIcon: "ğŸŒº" },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [environment, setEnvironment] = useState(0); // Index of rules
        const [feedback, setFeedback] = useState(null);

        const getText = (key) => t[key][lang] || t[key]["en"];
        const currentEnv = rules[environment];

        const handleChoice = (beakType) => {
          if (feedback) return;
          if (beakType === currentEnv.bestBeak) {
            setFeedback("survived");
            setTimeout(() => {
              setFeedback(null);
              setEnvironment((environment + 1) % rules.length);
            }, 1500);
          } else {
            setFeedback("starved");
            setTimeout(() => setFeedback(null), 1000);
          }
        };

        return (
          <div className="min-h-screen flex flex-col items-center justify-center p-4">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl font-bold mb-8 text-green-800">
              {getText("title")}
            </h1>

            <div className="w-full max-w-2xl bg-white p-8 rounded-3xl shadow-xl border-4 border-green-200 flex flex-col items-center">
              <div className="font-bold text-slate-500 mb-8">
                {getText("instruction")}
              </div>

              {/* Environment Display */}
              <div className="bg-green-50 w-full p-8 rounded-2xl mb-8 text-center flex flex-col items-center">
                <div className="text-6xl mb-4">{currentEnv.foodIcon}</div>
                <div className="text-2xl font-bold text-slate-800">
                  {getText(currentEnv.food)}
                </div>
              </div>

              {/* Beak Choices */}
              <div className="flex gap-4 w-full">
                <BeakCard
                  id="beak_big"
                  icon="ğŸ¦œ"
                  visualClass="scale-x-125 font-black" // Visual hack
                  getText={getText}
                  onClick={() => handleChoice("beak_big")}
                />
                <BeakCard
                  id="beak_long"
                  icon="ğŸ¦"
                  visualClass="scale-x-75 scale-y-125"
                  getText={getText}
                  onClick={() => handleChoice("beak_long")}
                />
                <BeakCard
                  id="beak_thin"
                  icon="ğŸ¦…"
                  visualClass="rotate-12"
                  getText={getText}
                  onClick={() => handleChoice("beak_thin")}
                />
              </div>

              {feedback && (
                <div
                  className={`mt-8 text-4xl font-black ${
                    feedback === "survived" ? "text-green-600" : "text-red-500"
                  } animate-bounce`}
                >
                  {getText(feedback)}
                </div>
              )}
            </div>
          </div>
        );
      }

      function BeakCard({ id, icon, visualClass, getText, onClick }) {
        return (
          <button
            onClick={onClick}
            className="flex-1 bg-slate-100 hover:bg-slate-200 border-2 border-slate-300 rounded-xl p-4 flex flex-col items-center gap-2 transition-transform active:scale-95"
          >
            <div className={`text-5xl transform origin-center ${visualClass}`}>
              {icon}
            </div>
            <div className="text-xs font-bold">{getText(id)}</div>
          </button>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  
      
      <!-- Footer -->
      <footer class="text-center py-4 text-slate-500 text-sm">
        <p class="italic mb-1">
          But God made the earth by his power; he founded the world by his wisdom and stretched out the heavens by his
          understanding. Jeremiah 10:12
        </p>
        <p class="text-xs mb-1 mt-2">
          ã€Œè€¶å’Œè¯ç”¨èƒ½åŠ›å‰µé€ å¤§åœ°ï¼Œç”¨æ™ºæ…§å»ºç«‹ä¸–ç•Œï¼Œç”¨è°æ˜é‹ªå¼µç©¹è’¼ã€‚ã€ è€¶åˆ©ç±³æ›¸ 10:12
        </p>
        <p class="text-xs mt-2 pt-2 border-t border-slate-300">
          @ 2025 Education Engineering Portfolio | Generated by Gemini Pro 3.0 | Prepared by SF Lau
        </p>
      </footer>
</body>
</html>
