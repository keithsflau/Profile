<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>General Studies - History Civilizations</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <style>
      body {
        font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
        background: #fffbeb;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Ancient Civilizations",
          zh: "å¤ä»£æ–‡æ˜Ž",
          ja: "å¤ä»£æ–‡æ˜Ž",
          ko: "ê³ ëŒ€ ë¬¸ëª…",
          es: "Civilizaciones antiguas",
          de: "Antike Zivilisationen",
          fi: "Muinaiset sivilisaatiot",
          fr: "Civilisations anciennes",
          ar: "Ø§Ù„Ø­Ø¶Ø§Ø±Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©",
          it: "Antiche CiviltÃ ",
        },
        instruction: {
          en: "Match the Wonder to the Civilization",
          zh: "å°‡å¥‡è¹Ÿèˆ‡æ–‡æ˜Žé…å°",
          ja: "ä¸æ€è­°ã¨æ–‡æ˜Žã‚’ä¸€è‡´ã•ã›ã‚‹",
          ko: "ë¶ˆê°€ì‚¬ì˜ì™€ ë¬¸ëª…ì„ ì¼ì¹˜ì‹œí‚¤ì„¸ìš”",
          es: "Empareja la Maravilla con la CivilizaciÃ³n",
          de: "Ordne das Wunder der Zivilisation zu",
          fi: "YhdistÃ¤ ihme sivilisaatioon",
          fr: "Associez la Merveille Ã  la Civilisation",
          ar: "Ø·Ø§Ø¨Ù‚ Ø§Ù„Ø¹Ø¬ÙŠØ¨Ø© Ø¨Ø§Ù„Ø­Ø¶Ø§Ø±Ø©",
          it: "Abbina la Meraviglia alla CiviltÃ ",
        },
        egypt: {
          en: "Ancient Egypt",
          zh: "å¤åŸƒåŠ",
          ja: "å¤ä»£ã‚¨ã‚¸ãƒ—ãƒˆ",
          ko: "ê³ ëŒ€ ì´ì§‘íŠ¸",
        },
        china: {
          en: "Ancient China",
          zh: "å¤ä»£ä¸­åœ‹",
          ja: "å¤ä»£ä¸­å›½",
          ko: "ê³ ëŒ€ ì¤‘êµ­",
        },
        rome: {
          en: "Ancient Rome",
          zh: "å¤ç¾…é¦¬",
          ja: "å¤ä»£ãƒ­ãƒ¼ãƒž",
          ko: "ê³ ëŒ€ ë¡œë§ˆ",
        },
        greece: {
          en: "Ancient Greece",
          zh: "å¤å¸Œè‡˜",
          ja: "å¤ä»£ã‚®ãƒªã‚·ãƒ£",
          ko: "ê³ ëŒ€ ê·¸ë¦¬ìŠ¤",
        },

        pyramids: {
          en: "Pyramids",
          zh: "é‡‘å­—å¡”",
          ja: "ãƒ”ãƒ©ãƒŸãƒƒãƒ‰",
          ko: "í”¼ë¼ë¯¸ë“œ",
        },
        wall: {
          en: "Great Wall",
          zh: "è¬é‡Œé•·åŸŽ",
          ja: "ä¸‡é‡Œã®é•·åŸŽ",
          ko: "ë§Œë¦¬ìž¥ì„±",
        },
        colosseum: {
          en: "Colosseum",
          zh: "ç¾…é¦¬é¬¥ç¸å ´",
          ja: "ã‚³ãƒ­ãƒƒã‚»ã‚ª",
          ko: "ì½œë¡œì„¸ì›€",
        },
        parthenon: {
          en: "Parthenon",
          zh: "å¸•ç‰¹è¾²ç¥žå»Ÿ",
          ja: "ãƒ‘ãƒ«ãƒ†ãƒŽãƒ³ç¥žæ®¿",
          ko: "íŒŒë¥´í…Œë…¼ ì‹ ì „",
        },

        correct: {
          en: "Correct Match!",
          zh: "é…å°æ­£ç¢ºï¼",
          ja: "æ­£ã—ã„ãƒžãƒƒãƒï¼",
          ko: "ì˜¬ë°”ë¥¸ ë§¤ì¹˜!",
        },
      };

      const pairs = [
        { civ: "egypt", wonder: "pyramids", icon: "ðŸ”º" },
        { civ: "china", wonder: "wall", icon: "ðŸ§±" },
        { civ: "rome", wonder: "colosseum", icon: "ðŸŸï¸" },
        { civ: "greece", wonder: "parthenon", icon: "ðŸ›ï¸" },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [selectedCiv, setSelectedCiv] = useState(null);
        const [matched, setMatched] = useState([]);

        const getText = (key) => t[key][lang] || t[key]["en"];

        // Randomize visual order
        const [civs, setCivs] = useState([]);
        const [wonders, setWonders] = useState([]);

        useEffect(() => {
          setCivs([...pairs].sort(() => Math.random() - 0.5));
          setWonders([...pairs].sort(() => Math.random() - 0.5));
        }, []);

        const handleCivClick = (c) => {
          if (matched.includes(c.civ)) return;
          setSelectedCiv(c);
        };

        const handleWonderClick = (w) => {
          if (matched.includes(w.civ)) return;
          if (!selectedCiv) return;

          if (selectedCiv.civ === w.civ) {
            setMatched([...matched, w.civ]);
            setSelectedCiv(null);
          } else {
            setSelectedCiv(null);
            // Error feedback
            alert("Try again!");
          }
        };

        return (
          <div className="min-h-screen flex flex-col items-center p-4">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl font-bold mb-8 text-amber-700">
              {getText("title")}
            </h1>
            <p className="mb-8 font-bold text-slate-500">
              {getText("instruction")}
            </p>

            <div className="flex gap-12 w-full max-w-4xl justify-center">
              {/* Civilizations */}
              <div className="flex flex-col gap-4">
                <h2 className="text-center font-bold text-slate-400 mb-2">
                  Civilization
                </h2>
                {civs.map((c) => (
                  <button
                    key={c.civ}
                    onClick={() => handleCivClick(c)}
                    disabled={matched.includes(c.civ)}
                    className={`p-6 w-48 rounded-xl font-bold shadow-md transition-all
                            ${
                              matched.includes(c.civ)
                                ? "bg-green-100 text-green-800 opacity-50"
                                : selectedCiv && selectedCiv.civ === c.civ
                                ? "bg-amber-500 text-white scale-105"
                                : "bg-white hover:bg-amber-50 text-amber-900"
                            }
                         `}
                  >
                    {getText(c.civ)}
                  </button>
                ))}
              </div>

              {/* Wonders */}
              <div className="flex flex-col gap-4">
                <h2 className="text-center font-bold text-slate-400 mb-2">
                  Wonder
                </h2>
                {wonders.map((w) => (
                  <button
                    key={w.wonder}
                    onClick={() => handleWonderClick(w)}
                    disabled={matched.includes(w.civ)}
                    className={`p-6 w-48 rounded-xl font-bold shadow-md flex items-center gap-4 transition-all
                            ${
                              matched.includes(w.civ)
                                ? "bg-green-100 text-green-800 opacity-50"
                                : "bg-white hover:bg-slate-50 text-slate-800 border-2 border-transparent hover:border-amber-300"
                            }
                         `}
                  >
                    <span className="text-2xl">{w.icon}</span>
                    {getText(w.wonder)}
                  </button>
                ))}
              </div>
            </div>

            {matched.length === pairs.length && matched.length > 0 && (
              <div className="mt-8 text-4xl font-black text-amber-600 animate-bounce">
                {getText("correct")}
              </div>
            )}
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
