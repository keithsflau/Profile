<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>General Studies - Pollution Type</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <style>
      body {
        font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
        background: #f1f5f9;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Pollution Sorter",
          zh: "æ±¡æŸ“åˆ†é¡ž",
          ja: "æ±šæŸ“ã‚½ãƒ¼ã‚¿ãƒ¼",
          ko: "ì˜¤ì—¼ ë¶„ë¥˜ê¸°",
          es: "Clasificador de contaminaciÃ³n",
          de: "Umweltverschmutzungs-Sortierer",
          fi: "Saastelajittelija",
          fr: "Trieur de pollution",
          ar: "ÙØ§Ø±Ø² Ø§Ù„ØªÙ„ÙˆØ«",
          it: "Selezionatore di Inquinamento",
        },
        instruction: {
          en: "What type of pollution is this?",
          zh: "è¿™æ˜¯ä»€ä¹ˆç±»åž‹çš„æ±¡æŸ“ï¼Ÿ",
          ja: "ã“ã‚Œã¯ã©ã®ã‚ˆã†ãªç¨®é¡žã®æ±šæŸ“ã§ã™ã‹ï¼Ÿ",
          ko: "ì´ê²ƒì€ ì–´ë–¤ ì¢…ë¥˜ì˜ ì˜¤ì—¼ìž…ë‹ˆê¹Œ?",
          es: "Â¿QuÃ© tipo de contaminaciÃ³n es esta?",
          de: "Welche Art von Verschmutzung ist das?",
          fi: "MinkÃ¤ tyyppistÃ¤ saastumista tÃ¤mÃ¤ on?",
          fr: "De quel type de pollution s'agit-il ?",
          ar: "Ù…Ø§ Ù‡Ø°Ø§ Ø§Ù„Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„ØªÙ„ÙˆØ«ØŸ",
          it: "Che tipo di inquinamento Ã¨ questo?",
        },
        air: {
          en: "Air Pollution",
          zh: "ç©ºæ°£æ±¡æŸ“",
          ja: "å¤§æ°—æ±šæŸ“",
          ko: "ëŒ€ê¸° ì˜¤ì—¼",
        },
        water: {
          en: "Water Pollution",
          zh: "æ°´è³ªæ±¡æŸ“",
          ja: "æ°´è³ªæ±šæŸ“",
          ko: "ìˆ˜ì§ˆ ì˜¤ì—¼",
        },
        noise: {
          en: "Noise Pollution",
          zh: "å™ªéŸ³æ±¡æŸ“",
          ja: "é¨’éŸ³æ±šæŸ“",
          ko: "ì†ŒìŒ ì˜¤ì—¼",
        },
        land: {
          en: "Land Pollution",
          zh: "åœŸåœ°æ±¡æŸ“",
          ja: "åœŸå£Œæ±šæŸ“",
          ko: "í† ì–‘ ì˜¤ì—¼",
        },

        correct: { en: "Correct!", zh: "æ­£ç¢ºï¼", ja: "æ­£è§£ï¼", ko: "ì •ë‹µ!" },
        wrong: {
          en: "Try Again",
          zh: "å†è©¦ä¸€æ¬¡",
          ja: "ã‚‚ã†ä¸€åº¦",
          ko: "ë‹¤ì‹œ ì‹œë„",
        },
      };

      const sources = [
        { id: "car", type: "air", icon: "ðŸš—ðŸ’¨", bg: "bg-gray-200" },
        { id: "factory_smoke", type: "air", icon: "ðŸ­", bg: "bg-gray-300" },
        { id: "oil_spill", type: "water", icon: "ðŸ›¢ï¸ðŸŒŠ", bg: "bg-blue-200" },
        { id: "trash_ocean", type: "water", icon: "ðŸ¥¤ðŸŸ", bg: "bg-blue-100" },
        { id: "drill", type: "noise", icon: "ðŸš§ðŸ”Š", bg: "bg-yellow-100" },
        { id: "loud_music", type: "noise", icon: "ðŸ“¢ðŸŽµ", bg: "bg-pink-100" },
        { id: "landfill", type: "land", icon: "ðŸ—‘ï¸â›°ï¸", bg: "bg-green-100" },
        { id: "fertilizer", type: "land", icon: "ðŸ§ªðŸŒ±", bg: "bg-green-200" },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [idx, setIdx] = useState(0);
        const [feedback, setFeedback] = useState(null);

        const getText = (key) => t[key][lang] || t[key]["en"];
        const current = sources[idx];

        const check = (type) => {
          if (feedback) return;
          if (type === current.type) {
            setFeedback("correct");
            setTimeout(() => {
              setFeedback(null);
              setIdx((idx + 1) % sources.length);
            }, 1000);
          } else {
            setFeedback("wrong");
            setTimeout(() => setFeedback(null), 500);
          }
        };

        return (
          <div className="min-h-screen flex flex-col items-center p-4">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl font-bold mb-8 text-slate-700">
              {getText("title")}
            </h1>
            <p className="mb-8 font-bold text-slate-500">
              {getText("instruction")}
            </p>

            <motion.div
              key={current.id}
              initial={{ scale: 0.5, opacity: 0 }}
              animate={{ scale: 1, opacity: 1 }}
              className={`w-64 h-64 ${current.bg} rounded-3xl shadow-xl flex items-center justify-center text-9xl mb-8 border-4 border-white`}
            >
              {current.icon}
            </motion.div>

            <div className="grid grid-cols-2 gap-4 w-full max-w-lg">
              <button
                onClick={() => check("air")}
                className="p-4 bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold rounded-xl"
              >
                {getText("air")}
              </button>
              <button
                onClick={() => check("water")}
                className="p-4 bg-blue-100 hover:bg-blue-200 text-blue-700 font-bold rounded-xl"
              >
                {getText("water")}
              </button>
              <button
                onClick={() => check("noise")}
                className="p-4 bg-yellow-100 hover:bg-yellow-200 text-yellow-700 font-bold rounded-xl"
              >
                {getText("noise")}
              </button>
              <button
                onClick={() => check("land")}
                className="p-4 bg-green-100 hover:bg-green-200 text-green-700 font-bold rounded-xl"
              >
                {getText("land")}
              </button>
            </div>

            {feedback && (
              <div
                className={`mt-8 text-3xl font-black ${
                  feedback === "correct" ? "text-green-500" : "text-red-500"
                } animate-bounce`}
              >
                {getText(feedback)}
              </div>
            )}
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
