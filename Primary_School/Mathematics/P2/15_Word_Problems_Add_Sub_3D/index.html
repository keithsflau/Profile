<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Â∞è‰∫åÊï∏Â≠∏ÔºöÊáâÁî®È°å (‰∏â‰ΩçÊï∏) | Word Problems (3-Digit)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&family=Outfit:wght@400;600;800&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Outfit", "Noto Sans TC", sans-serif;
        background: linear-gradient(135deg, #fce7f3 0%, #db2777 100%);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "üìù Word Problems",
          zh: "üìù ÊáâÁî®È°å",
          ja: "üìù ÊñáÁ´†È°å",
          ko: "üìù Î¨∏Ïû•Ï†ú",
          es: "üìù Problemas verbales",
          de: "üìù Textaufgaben",
          fi: "üìù Sanalliset teht√§v√§t",
          fr: "üìù Probl√®mes √©crits",
          ar: "üìù ŸÖÿ≥ÿßÿ¶ŸÑ ŸÜÿµŸäÿ©",
          it: "üìù Problemi verbali",
        },
        calc: {
          en: "Calculation:",
          zh: "ÂàóÂºè",
          ja: "Ë®àÁÆóÂºè:",
          ko: "Í≥ÑÏÇ∞:",
          es: "C√°lculo:",
          de: "Rechnung:",
          fi: "Lasku:",
          fr: "Calcul :",
          ar: "ÿßŸÑÿ≠ÿ≥ÿßÿ®:",
          it: "Calcolo:",
        },
        ok: {
          en: "OK",
          zh: "Á¢∫ÂÆö",
          ja: "OK",
          ko: "ÌôïÏù∏",
          es: "Aceptar",
          de: "OK",
          fi: "OK",
          fr: "OK",
          ar: "ŸÖŸàÿßŸÅŸÇ",
          it: "OK",
        },
        thinkAgain: {
          en: "Think again",
          zh: "ÂÜçÊÉ≥ÊÉ≥",
          ja: "„ÇÇ„ÅÜ‰∏ÄÂ∫¶ËÄÉ„Åà„Å¶",
          ko: "Îã§Ïãú ÏÉùÍ∞ÅÌï¥ Î≥¥ÏÑ∏Ïöî",
          es: "Pi√©nsalo de nuevo",
          de: "Denk nochmal nach",
          fi: "Mieti uudelleen",
          fr: "R√©fl√©chissez encore",
          ar: "ŸÅŸÉÿ± ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ",
          it: "Pensaci ancora",
        },
        correct: {
          en: "Correct! {n1} {op} {n2} = {ans}",
          zh: "Ê≠£Á¢∫ÔºÅ {n1} {op} {n2} = {ans}",
          ja: "Ê≠£Ëß£ÔºÅ {n1} {op} {n2} = {ans}",
          ko: "Ï†ïÎãµ! {n1} {op} {n2} = {ans}",
          es: "¬°Correcto! {n1} {op} {n2} = {ans}",
          de: "Richtig! {n1} {op} {n2} = {ans}",
          fi: "Oikein! {n1} {op} {n2} = {ans}",
          fr: "Correct ! {n1} {op} {n2} = {ans}",
          ar: "ÿµÿ≠Ÿäÿ≠! {n1} {op} {n2} = {ans}",
          it: "Corretto! {n1} {op} {n2} = {ans}",
        },
      };

      function App() {
        const [lang, setLang] = useState("zh");
        const [p, setP] = useState({});
        const [input, setInput] = useState("");
        const [feedback, setFeedback] = useState("");

        const problems = [
          {
            zh: "Â≠∏Ê†°ÊúâÁî∑Áîü {n1} ‰∫∫ÔºåÂ•≥Áîü {n2} ‰∫∫„ÄÇÂÖ®Ê†°ÂÖ±ÊúâÂ§öÂ∞ë‰∫∫Ôºü",
            en: "There are {n1} boys and {n2} girls. How many students in total?",
            ja: "Â≠¶Ê†°„Å´„ÅØÁî∑Â≠ê„Åå {n1} ‰∫∫„ÄÅÂ•≥Â≠ê„Åå {n2} ‰∫∫„ÅÑ„Åæ„Åô„ÄÇÂÖ®Ê†°ÁîüÂæí„ÅØ‰Ωï‰∫∫„Åß„Åô„ÅãÔºü",
            ko: "ÌïôÍµêÏóê ÎÇ®ÌïôÏÉùÏù¥ {n1} Î™Ö, Ïó¨ÌïôÏÉùÏù¥ {n2} Î™Ö ÏûàÏäµÎãàÎã§. Ï†ÑÏ≤¥ ÌïôÏÉù ÏàòÎäî Î™á Î™ÖÏûÖÎãàÍπå?",
            es: "Hay {n1} ni√±os y {n2} ni√±as en la escuela. ¬øCu√°ntos estudiantes hay en total?",
            fr: "Il y a {n1} gar√ßons et {n2} filles √† l'√©cole. Combien d'√©l√®ves au total ?",
            de: "Es gibt {n1} Jungen und {n2} M√§dchen. Wie viele Sch√ºler sind es insgesamt?",
            op: "+",
            icon: "üè´",
          },
          {
            zh: "ÂúñÊõ∏È§®ÊúâÊõ∏ {n1} Êú¨ÔºåÂÄüÂá∫‰∫Ü {n2} Êú¨„ÄÇÈÇÑÂâ©‰∏ãÂ§öÂ∞ëÊú¨Ôºü",
            en: "Library has {n1} books. {n2} are loaned out. How many left?",
            ja: "Âõ≥Êõ∏È§®„Å´Êú¨„Åå {n1} ÂÜä„ÅÇ„Çä„Åæ„Åô„ÄÇ{n2} ÂÜäË≤∏„ÅóÂá∫„Åï„Çå„Åæ„Åó„Åü„ÄÇÊÆã„Çä„ÅØ‰ΩïÂÜä„Åß„Åô„ÅãÔºü",
            ko: "ÎèÑÏÑúÍ¥ÄÏóê Ï±ÖÏù¥ {n1} Í∂å ÏûàÏäµÎãàÎã§. {n2} Í∂åÏù¥ ÎåÄÏ∂úÎêòÏóàÏäµÎãàÎã§. Î™á Í∂åÏù¥ ÎÇ®ÏïòÏäµÎãàÍπå?",
            es: "La biblioteca tiene {n1} libros. {n2} fueron prestados. ¬øCu√°ntos quedan?",
            fr: "La biblioth√®que a {n1} livres. {n2} sont pr√™t√©s. Combien en reste-t-il ?",
            de: "Die Bibliothek hat {n1} B√ºcher. {n2} sind ausgeliehen. Wie viele sind noch da?",
            op: "-",
            icon: "üìö",
          },
          {
            zh: "Â∞èÊòéÊúâ ${n1}ÔºåË≤∑Áé©ÂÖ∑Áî®‰∫Ü ${n2}„ÄÇ‰ªñÈÇÑÊúâÂ§öÂ∞ëÈå¢Ôºü",
            en: "Ming has ${n1}, spent ${n2}. How much left?",
            ja: "„Éü„É≥„ÅØ ${n1} ÊåÅ„Å£„Å¶„ÅÑ„Å¶„ÄÅ„Åä„ÇÇ„Å°„ÇÉ„Å´ ${n2} ‰Ωø„ÅÑ„Åæ„Åó„Åü„ÄÇÊÆã„Çä„ÅØ„ÅÑ„Åè„Çâ„Åß„Åô„ÅãÔºü",
            ko: "Î∞çÏùÄ ${n1}Î•º Í∞ÄÏßÄÍ≥† ÏûàÏóàÍ≥†, Ïû•ÎÇúÍ∞êÏóê ${n2}Î•º ÏçºÏäµÎãàÎã§. ÏñºÎßàÍ∞Ä ÎÇ®ÏïòÏäµÎãàÍπå?",
            es: "Ming tiene ${n1}, gast√≥ ${n2}. ¬øCu√°nto le queda?",
            fr: "Ming a ${n1}, a d√©pens√© ${n2}. Combien lui reste-t-il ?",
            de: "Ming hat ${n1}, hat ${n2} ausgegeben. Wie viel ist √ºbrig?",
            op: "-",
            icon: "üí∞",
          },
          {
            zh: "Á¨¨‰∏ÄÂ§©Ë∑ë‰∫Ü {n1} Á±≥ÔºåÁ¨¨‰∫åÂ§©Ë∑ë‰∫Ü {n2} Á±≥„ÄÇÂÖ©Â§©ÂÖ±Ë∑ë‰∫ÜÂ§öÂ∞ëÁ±≥Ôºü",
            en: "Run {n1}m on Day 1, {n2}m on Day 2. Total distance?",
            ja: "1Êó•ÁõÆ„Å´ {n1}m„ÄÅ2Êó•ÁõÆ„Å´ {n2}m Ëµ∞„Çä„Åæ„Åó„Åü„ÄÇÂêàË®àË∑ùÈõ¢„ÅØÔºü",
            ko: "Ï≤´Ïß∏ ÎÇ† {n1}m, ÎëòÏß∏ ÎÇ† {n2}mÎ•º Îã¨Î†∏ÏäµÎãàÎã§. Ï¥ù Í±∞Î¶¨Îäî?",
            es: "Corri√≥ {n1} m el d√≠a 1, {n2} m el d√≠a 2. ¬øDistancia total?",
            fr: "Couru {n1}m le jour 1, {n2}m le jour 2. Distance totale ?",
            de: "Tag 1: {n1}m, Tag 2: {n2}m gelaufen. Gesamtstrecke?",
            op: "+",
            icon: "üèÉ",
          },
        ];

        const next = () => {
          const tIdx = Math.floor(Math.random() * problems.length);
          const t = problems[tIdx];
          let n1 = Math.floor(Math.random() * 400) + 100;
          let n2 = Math.floor(Math.random() * 300) + 50;

          if (t.op === "-" && n2 > n1) [n1, n2] = [n2, n1];

          setP({ ...t, n1, n2 });
          setInput("");
          setFeedback("");
        };

        useEffect(next, []);

        const check = () => {
          let ans = p.op === "+" ? p.n1 + p.n2 : p.n1 - p.n2;
          if (parseInt(input) === ans) {
            setFeedback("CORRECT");
            setTimeout(next, 3000);
          } else {
            setFeedback("WRONG");
          }
        };

        const getProblemText = () => {
          const tmpl = p[lang] || p["en"]; // Fallback to English
          if (!tmpl) return "";
          return tmpl.replace("{n1}", p.n1).replace("{n2}", p.n2);
        };

        const getCorrectText = () => {
          const ans = p.op === "+" ? p.n1 + p.n2 : p.n1 - p.n2;
          const tmpl = t.correct[lang] || t.correct["en"];
          return tmpl
            .replace("{n1}", p.n1)
            .replace("{op}", p.op)
            .replace("{n2}", p.n2)
            .replace("{ans}", ans);
        };

        return (
          <div className="min-h-screen p-8 flex flex-col items-center justify-center">
            <LanguageSelector lang={lang} setLang={setLang} />

            <h1 className="text-5xl font-black text-pink-900 mb-8 max-w-2xl text-center">
              {t.title[lang] || t.title["en"]}
            </h1>

            <div className="bg-white/90 rounded-3xl p-8 shadow-2xl w-full max-w-3xl text-center border-4 border-pink-300">
              <div className="text-8xl mb-8 animate-bounce">{p.icon}</div>

              <div className="text-2xl md:text-3xl font-bold text-slate-700 mb-8 leading-loose bg-pink-50 p-8 rounded-2xl border-2 border-pink-100 text-left">
                <div className="mb-4 text-pink-800">{getProblemText()}</div>
              </div>

              <div className="flex justify-center flex-col items-center gap-4 mb-6">
                <label className="font-bold text-pink-600 text-xl">
                  {t.calc[lang] || t.calc["en"]} {p.n1} {p.op} {p.n2} = ?
                </label>
                <div className="flex gap-4">
                  <input
                    type="number"
                    value={input}
                    onChange={(e) => setInput(e.target.value)}
                    className="w-48 text-center text-5xl font-black p-4 border-4 border-pink-400 rounded-2xl"
                    placeholder="?"
                  />
                  <button
                    onClick={check}
                    className="px-8 bg-pink-500 text-white rounded-2xl font-bold text-xl hover:bg-pink-600"
                  >
                    {t.ok[lang] || t.ok["en"]}
                  </button>
                </div>
              </div>

              <div className="min-h-[60px]">
                {feedback === "CORRECT" && (
                  <div className="text-2xl md:text-3xl font-black text-green-500 animate-bounce">
                    {getCorrectText()}
                  </div>
                )}
                {feedback === "WRONG" && (
                  <div className="text-3xl font-black text-red-500">
                    {t.thinkAgain[lang] || t.thinkAgain["en"]}
                  </div>
                )}
              </div>
            </div>
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
