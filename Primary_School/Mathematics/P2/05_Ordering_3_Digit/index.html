<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Â∞è‰∫åÊï∏Â≠∏ÔºöÊï∏Â≠óÊéíÂ∫è | Ordering Numbers</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&family=Outfit:wght@400;600;800&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Outfit", "Noto Sans TC", sans-serif;
        background: linear-gradient(135deg, #ecfccb 0%, #84cc16 100%);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "üî¢ Ordering Numbers",
          zh: "üî¢ Êï∏Â≠óÊéíÂ∫è",
          ja: "üî¢ Êï∞„ÅÆ‰∏¶„ÅπÊõø„Åà",
          ko: "üî¢ Ïà´Ïûê ÏàúÏÑú",
          es: "üî¢ Ordenar n√∫meros",
          de: "üî¢ Zahlen ordnen",
          fi: "üî¢ Numeroiden j√§rjestys",
          fr: "üî¢ Ordonner les nombres",
          ar: "üî¢ ÿ™ÿ±ÿ™Ÿäÿ® ÿßŸÑÿ£ÿ±ŸÇÿßŸÖ",
          it: "üî¢ Ordinare i numeri",
        },
        order: {
          en: "Order from {o}",
          zh: "Ë´ãÁî± {o} ÊéíÂàó",
          ja: "{o} „Åß‰∏¶„Åπ„Å¶„Åè„Å†„Åï„ÅÑ",
          ko: "{o} ÏàúÏÑúÎ°ú Ï†ïÎ†¨ÌïòÏÑ∏Ïöî",
          es: "Ordenar de {o}",
          de: "Ordne von {o}",
          fi: "J√§rjest√§ {o}",
          fr: "Ordonner du {o}",
          ar: "ÿ±ÿ™ÿ® ŸÖŸÜ {o}",
          it: "Ordina dal {o}",
        },
        SmallToBig: {
          en: "Smallest to Largest",
          zh: "Â∞èËá≥Â§ß",
          ja: "Â∞è„Åï„ÅÑÈ†Ü",
          ko: "ÏûëÏùÄ ÏàòÎ∂ÄÌÑ∞ ÌÅ∞ Ïàò",
          es: "Menor a Mayor",
          de: "Klein nach Gro√ü",
          fi: "Pienimm√§s√§ suurimpaan",
          fr: "Plus petit au plus grand",
          ar: "ÿßŸÑÿ£ÿµÿ∫ÿ± ÿ•ŸÑŸâ ÿßŸÑÿ£ŸÉÿ®ÿ±",
          it: "Pi√π piccolo al pi√π grande",
        },
        BigToSmall: {
          en: "Largest to Smallest",
          zh: "Â§ßËá≥Â∞è",
          ja: "Â§ß„Åç„ÅÑÈ†Ü",
          ko: "ÌÅ∞ ÏàòÎ∂ÄÌÑ∞ ÏûëÏùÄ Ïàò",
          es: "Mayor a Menor",
          de: "Gro√ü nach Klein",
          fi: "Suurimmasta pienimp√§√§n",
          fr: "Plus grand au plus petit",
          ar: "ÿßŸÑÿ£ŸÉÿ®ÿ± ÿ•ŸÑŸâ ÿßŸÑÿ£ÿµÿ∫ÿ±",
          it: "Pi√π grande al pi√π piccolo",
        },
        reset: {
          en: "Reset",
          zh: "ÈáçÁΩÆ",
          ja: "„É™„Çª„ÉÉ„Éà",
          ko: "Ï¥àÍ∏∞Ìôî",
          es: "Reiniciar",
          de: "Zur√ºcksetzen",
          fi: "Nollaa",
          fr: "R√©initialiser",
          ar: "ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ",
          it: "Reimposta",
        },
        check: {
          en: "Check",
          zh: "Ê™¢Êü•",
          ja: "Á¢∫Ë™ç",
          ko: "ÌôïÏù∏",
          es: "Comprobar",
          de: "Pr√ºfen",
          fi: "Tarkista",
          fr: "V√©rifier",
          ar: "ÿ™ÿ≠ŸÇŸÇ",
          it: "Controlla",
        },
      };

      function App() {
        const [lang, setLang] = useState("zh");
        const [nums, setNums] = useState([]);
        const [order, setOrder] = useState("asc"); // asc (Small to Big), desc (Big to Small)
        const [slots, setSlots] = useState([null, null, null]);
        const [pool, setPool] = useState([]);
        const [feedback, setFeedback] = useState("");

        const newGame = () => {
          let ns = [];
          while (ns.length < 3) {
            let r = Math.floor(Math.random() * 900) + 100;
            if (!ns.includes(r)) ns.push(r);
          }
          setNums(ns);
          setOrder(Math.random() > 0.5 ? "asc" : "desc");
          setPool([...ns].sort(() => Math.random() - 0.5));
          setSlots([null, null, null]);
          setFeedback("");
        };

        useEffect(newGame, []);

        const selectNum = (n) => {
          // Find first empty slot
          const idx = slots.findIndex((s) => s === null);
          if (idx !== -1) {
            const newSlots = [...slots];
            newSlots[idx] = n;
            setSlots(newSlots);
            setPool(pool.filter((x) => x !== n)); // remove from pool
          }
        };

        const deselectNum = (n, idx) => {
          const newSlots = [...slots];
          newSlots[idx] = null;
          setSlots(newSlots);
          setPool([...pool, n]); // return to pool
        };

        const checkGame = () => {
          if (slots.includes(null)) return;

          const sorted = [...nums].sort((a, b) =>
            order === "asc" ? a - b : b - a
          );
          if (JSON.stringify(slots) === JSON.stringify(sorted)) {
            setFeedback("CORRECT");
            setTimeout(newGame, 1500);
          } else {
            setFeedback("WRONG");
          }
        };

        const reset = () => {
          setSlots([null, null, null]);
          setPool([...nums]);
        };

        const getOrderText = () => {
          let key = order === "asc" ? "SmallToBig" : "BigToSmall";
          let txt = t.order[lang] || t.order["en"];
          let oWord = t[key][lang] || t[key]["en"];
          return txt.replace("{o}", oWord);
        };

        return (
          <div className="min-h-screen p-8 flex flex-col items-center justify-center">
            <LanguageSelector lang={lang} setLang={setLang} />

            <h1 className="text-5xl font-black text-lime-900 mb-8 max-w-2xl text-center">
              {t.title[lang] || t.title["en"]}
            </h1>

            <div className="bg-white/90 rounded-3xl p-8 shadow-2xl w-full max-w-4xl text-center border-4 border-lime-300">
              <h2 className="text-3xl font-bold text-slate-700 mb-8">
                {getOrderText()}
              </h2>

              {/* Slots */}
              <div className="flex justify-center gap-4 mb-12">
                {slots.map((s, i) => (
                  <div
                    key={i}
                    onClick={() => s !== null && deselectNum(s, i)}
                    className={`w-40 h-40 rounded-2xl border-4 border-dashed border-lime-400 flex items-center justify-center text-5xl font-black text-lime-800 cursor-pointer shadow-inner bg-lime-50
                        ${s ? "bg-lime-200 border-solid" : "opacity-50"}`}
                  >
                    {s}
                    {i < 2 && (
                      <div className="absolute -right-6 top-1/2 -translate-y-1/2 text-slate-300 pointer-events-none">
                        ‚ûú
                      </div>
                    )}
                  </div>
                ))}
              </div>

              {/* Pool */}
              <div className="flex justify-center gap-6 mb-8 min-h-[100px]">
                {pool.map((n) => (
                  <button
                    key={n}
                    onClick={() => selectNum(n)}
                    className="w-32 py-4 bg-white border-4 border-lime-500 rounded-xl text-3xl font-black text-lime-700 shadow-lg hover:bg-lime-100 hover:scale-105 transition-all"
                  >
                    {n}
                  </button>
                ))}
              </div>

              <div className="flex justify-center gap-4">
                <button
                  onClick={reset}
                  className="px-6 py-3 bg-red-400 text-white rounded-xl font-bold shadow hover:bg-red-500"
                >
                  {t.reset[lang] || t.reset["en"]}
                </button>
                <button
                  onClick={checkGame}
                  className="px-10 py-3 bg-lime-500 text-white rounded-xl font-black text-2xl shadow-xl hover:bg-lime-600 active:scale-95 transition-transform"
                >
                  {t.check[lang] || t.check["en"]}
                </button>
              </div>

              <div className="h-16 mt-8">
                {feedback === "CORRECT" && (
                  <div className="text-4xl font-black text-green-500 animate-bounce">
                    {get("correct", lang)}
                  </div>
                )}
                {feedback === "WRONG" && (
                  <div className="text-4xl font-black text-red-500 animate-shake">
                    {get("wrong", lang)}
                  </div>
                )}
              </div>
            </div>
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
