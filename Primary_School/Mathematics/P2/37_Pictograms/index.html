<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Â∞è‰∫åÊï∏Â≠∏ÔºöË±°ÂΩ¢Âúñ (‰∏ÄÊ†º‰ª£Ë°®Â§öÂÄã) | Pictograms Scaling</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&family=Outfit:wght@400;600;800&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Outfit", "Noto Sans TC", sans-serif;
        background: linear-gradient(135deg, #fefce8 0%, #ca8a04 100%);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "üìä Pictograms",
          zh: "üìä Ë±°ÂΩ¢Âúñ",
          ja: "üìä „Éî„ÇØ„Éà„Ç∞„É©„É†",
          ko: "üìä Í∑∏Î¶º Í∑∏ÎûòÌîÑ",
          es: "üìä Pictogramas",
          de: "üìä Piktogramme",
          fi: "üìä Piktogrammit",
          fr: "üìä Pictogrammes",
          ar: "üìä ÿßŸÑÿ±ÿ≥ŸàŸÖ ÿßŸÑÿ™Ÿàÿ∂Ÿäÿ≠Ÿäÿ©",
          it: "üìä Pittogrammi",
        },
        eachRepresents: {
          en: "Each icon =",
          zh: "ÊØèÂÄãÂúñÂΩ¢‰ª£Ë°®",
          ja: "ÂêÑ„Ç¢„Ç§„Ç≥„É≥ =",
          ko: "Í∞Å ÏïÑÏù¥ÏΩò =",
          es: "Cada icono =",
          de: "Jedes Symbol =",
          fi: "Jokainen kuvake =",
          fr: "Chaque ic√¥ne =",
          ar: "ŸÉŸÑ ÿ£ŸäŸÇŸàŸÜÿ© =",
          it: "Ogni icona =",
        },
        fruits: {
          en: "fruits",
          zh: "ÂÄãÊ∞¥Êûú",
          ja: "ÂÄã„ÅÆÊûúÁâ©",
          ko: "Í∞úÏùò Í≥ºÏùº",
          es: "frutas",
          de: "Fr√ºchte",
          fi: "hedelm√§√§",
          fr: "fruits",
          ar: "ŸÅŸàÿßŸÉŸá",
          it: "frutti",
        },
        howMany: {
          en: "How many",
          zh: "ÂÖ±ÊúâÂ§öÂ∞ëÂÄã",
          ja: "„ÅÑ„Åè„Å§„ÅÇ„Çä„Åæ„Åô„Åã",
          ko: "ÏñºÎßàÎÇò ÎßéÏùÄ",
          es: "Cu√°ntos",
          de: "Wie viele",
          fi: "Kuinka monta",
          fr: "Combien de",
          ar: "ŸÉŸÖ ÿπÿØÿØ",
          it: "Quanti",
        },
        check: {
          en: "Check",
          zh: "Ê™¢Êü•",
          ja: "Á¢∫Ë™ç",
          ko: "ÌôïÏù∏",
          es: "Comprobar",
          de: "Pr√ºfen",
          fi: "Tarkista",
          fr: "V√©rifier",
          ar: "ÿ™ÿ≠ŸÇŸÇ",
          it: "Controlla",
        },
      };

      const itemsData = [
        { name: { zh: "ËòãÊûú", en: "Apple", ja: "„É™„É≥„Ç¥" }, icon: "üçé" },
        { name: { zh: "Ê©ô", en: "Orange", ja: "„Ç™„É¨„É≥„Ç∏" }, icon: "üçä" },
        { name: { zh: "Ê¢®", en: "Pear", ja: "Ê¢®" }, icon: "üçê" },
        { name: { zh: "È¶ôËïâ", en: "Banana", ja: "„Éê„Éä„Éä" }, icon: "üçå" },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [scale, setScale] = useState(2); // 2, 5, or 10
        const [counts, setCounts] = useState([4, 6, 8, 2]); // Actual counts (must be divisible by scale)
        const [targetIdx, setTargetIdx] = useState(0);
        const [input, setInput] = useState("");
        const [feedback, setFeedback] = useState("");

        const newProb = () => {
          setFeedback("");
          setInput("");

          const s = [2, 5, 10][Math.floor(Math.random() * 3)];
          setScale(s);

          const newCounts = itemsData.map(
            () => (Math.floor(Math.random() * 5) + 1) * s
          );
          setCounts(newCounts);
          setTargetIdx(Math.floor(Math.random() * itemsData.length));
        };

        useEffect(newProb, []);

        const check = () => {
          if (parseInt(input) === counts[targetIdx]) {
            setFeedback("CORRECT");
            setTimeout(newProb, 2000);
          } else {
            setFeedback("WRONG");
          }
        };

        const getItemName = (item) => item.name[lang] || item.name["en"];

        return (
          <div className="min-h-screen p-8 flex flex-col items-center justify-center">
            <LanguageSelector lang={lang} setLang={setLang} />

            <h1 className="text-4xl md:text-5xl font-black text-yellow-900 mb-8 max-w-2xl text-center">
              {t.title[lang] || t.title["en"]}
            </h1>

            <div className="bg-white/90 rounded-3xl p-8 shadow-2xl w-full max-w-3xl text-center border-4 border-yellow-300">
              {/* Graph */}
              <div className="bg-yellow-50 rounded-xl p-6 border-2 border-yellow-200 mb-6">
                <div className="text-right text-sm font-bold text-yellow-700 mb-4 bg-yellow-200 inline-block px-3 py-1 rounded-full">
                  {t.eachRepresents[lang] || t.eachRepresents["en"]} {scale}{" "}
                  {t.fruits[lang] || t.fruits["en"]}
                </div>

                <div className="flex justify-around items-end h-64 border-b-4 border-yellow-600 pb-2 gap-4">
                  {itemsData.map((item, i) => (
                    <div
                      key={i}
                      className="flex flex-col items-center w-full justify-end h-full"
                    >
                      <div
                        className="flex flex-col-reverse items-center w-full gap-1 transition-all duration-500"
                        style={{ height: "100%" }}
                      >
                        {[...Array(counts[i] / scale)].map((_, j) => (
                          <div
                            key={j}
                            className="text-2xl md:text-3xl animate-bounce-short"
                            style={{ animationDelay: `${j * 100}ms` }}
                          >
                            {itemsData[i].icon}
                          </div> // Use generic block or icon
                        ))}
                      </div>
                      <div className="mt-4 font-bold text-slate-600 text-sm md:text-base whitespace-nowrap">
                        {getItemName(item)}
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              <div className="text-2xl font-bold text-slate-700 mb-6 flex flex-col items-center">
                {lang === "zh" ? (
                  <>
                    {t.howMany[lang]} {getItemName(itemsData[targetIdx])}Ôºü
                  </>
                ) : (
                  <>
                    {t.howMany[lang] || t.howMany["en"]}{" "}
                    {getItemName(itemsData[targetIdx])}s?
                  </>
                )}
              </div>

              <div className="flex items-center justify-center gap-4 text-4xl mb-8 font-black text-yellow-900">
                <input
                  type="number"
                  value={input}
                  onChange={(e) => setInput(e.target.value)}
                  className="w-32 text-center border-b-4 border-yellow-500 bg-yellow-50 focus:outline-none rounded-t-lg"
                  autoFocus
                />
              </div>

              <div className="text-center">
                <button
                  onClick={check}
                  className="px-10 py-3 bg-yellow-500 text-white rounded-full font-black text-2xl shadow-xl hover:bg-yellow-600 active:scale-95 transition-transform"
                >
                  {t.check[lang] || t.check["en"]}
                </button>
              </div>

              <div className="h-16 mt-8">
                {feedback === "CORRECT" && (
                  <div>
                    <div className="text-center text-4xl font-black text-green-500 animate-bounce">
                      {get("correct", lang)}
                    </div>
                    <div className="text-slate-400 font-bold mt-2">
                      {counts[targetIdx] / scale} √ó {scale} ={" "}
                      {counts[targetIdx]}
                    </div>
                  </div>
                )}
                {feedback === "WRONG" && (
                  <div className="text-center text-4xl font-black text-red-500 animate-shake">
                    {get("wrong", lang)}
                  </div>
                )}
              </div>
            </div>
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
    <style>
      @keyframes bounce-short {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-3px);
        }
      }
      .animate-bounce-short {
        animation: bounce-short 1s infinite;
      }
    </style>
  </body>
</html>
