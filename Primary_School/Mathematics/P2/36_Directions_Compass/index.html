<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å°äºŒæ•¸å­¸ï¼šå››å€‹æ–¹å‘ | 4 Directions</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&family=Outfit:wght@400;600;800&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Outfit", "Noto Sans TC", sans-serif;
        background: linear-gradient(135deg, #ecfeff 0%, #06b6d4 100%);
      }
      .compass-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
      }
      .cell {
        background: rgba(255, 255, 255, 0.8);
        border-radius: 15px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100px;
        font-weight: bold;
        border: 3px solid #cffafe;
      }
      .center-cell {
        background: #bae6fd;
        border-color: #0ea5e9;
        color: #0369a1;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "ğŸ§­ 4 Directions",
          zh: "ğŸ§­ å››å€‹æ–¹å‘",
          ja: "ğŸ§­ 4ã¤ã®æ–¹å‘",
          ko: "ğŸ§­ 4ê°€ì§€ ë°©í–¥",
          es: "ğŸ§­ 4 Direcciones",
          de: "ğŸ§­ 4 Richtungen",
          fi: "ğŸ§­ 4 Suuntaa",
          fr: "ğŸ§­ 4 Directions",
          ar: "ğŸ§­ 4 Ø§ØªØ¬Ø§Ù‡Ø§Øª",
          it: "ğŸ§­ 4 Direzioni",
        },
        north: {
          en: "North",
          zh: "åŒ—æ–¹",
          ja: "åŒ—",
          ko: "ë¶ìª½",
          es: "Norte",
          de: "Norden",
          fi: "Pohjoinen",
          fr: "Nord",
          ar: "Ø´Ù…Ø§Ù„",
          it: "Nord",
        },
        east: {
          en: "East",
          zh: "æ±æ–¹",
          ja: "æ±",
          ko: "ë™ìª½",
          es: "Este",
          de: "Osten",
          fi: "ItÃ¤",
          fr: "Est",
          ar: "Ø´Ø±Ù‚",
          it: "Est",
        },
        south: {
          en: "South",
          zh: "å—æ–¹",
          ja: "å—",
          ko: "ë‚¨ìª½",
          es: "Sur",
          de: "SÃ¼den",
          fi: "EtelÃ¤",
          fr: "Sud",
          ar: "Ø¬Ù†ÙˆØ¨",
          it: "Sud",
        },
        west: {
          en: "West",
          zh: "è¥¿æ–¹",
          ja: "è¥¿",
          ko: "ì„œìª½",
          es: "Oeste",
          de: "Westen",
          fi: "LÃ¤nsi",
          fr: "Ouest",
          ar: "ØºØ±Ø¨",
          it: "Ovest",
        },
        whereIs: {
          en: "Where is the",
          zh: "åœ¨æˆ‘çš„å“ªä¸€æ–¹ï¼Ÿ",
          ja: "ã¯ç§ã®ã©ã®æ–¹è§’ã§ã™ã‹ï¼Ÿ",
          ko: "ì€/ëŠ” ë‚˜ì˜ ì–´ëŠ ìª½ì— ìˆìŠµë‹ˆê¹Œ?",
          es: "Â¿DÃ³nde estÃ¡",
          de: "Wo ist",
          fi: "MissÃ¤ on",
          fr: "OÃ¹ est",
          ar: "Ø£ÙŠÙ† ÙŠÙ‚Ø¹",
          it: "Dov'Ã¨",
        },
        me: {
          en: "Me",
          zh: "æˆ‘",
          ja: "ç§",
          ko: "ë‚˜",
          es: "Yo",
          de: "Ich",
          fi: "MinÃ¤",
          fr: "Moi",
          ar: "Ø£Ù†Ø§",
          it: "Io",
        },
        check: {
          en: "Check",
          zh: "æª¢æŸ¥",
          ja: "ç¢ºèª",
          ko: "í™•ì¸",
          es: "Comprobar",
          de: "PrÃ¼fen",
          fi: "Tarkista",
          fr: "VÃ©rifier",
          ar: "ØªØ­Ù‚Ù‚",
          it: "Controlla",
        },
      };

      const itemsData = [
        { name: { zh: "å…¬åœ’", en: "Park", ja: "å…¬åœ’" }, icon: "ğŸŒ³" },
        { name: { zh: "å­¸æ ¡", en: "School", ja: "å­¦æ ¡" }, icon: "ğŸ«" },
        { name: { zh: "åœ–æ›¸é¤¨", en: "Library", ja: "å›³æ›¸é¤¨" }, icon: "ğŸ“š" },
        { name: { zh: "å‹•ç‰©åœ’", en: "Zoo", ja: "å‹•ç‰©åœ’" }, icon: "ğŸ¦" },
        {
          name: { zh: "è¶…ç´šå¸‚å ´", en: "Supermarket", ja: "ã‚¹ãƒ¼ãƒ‘ãƒ¼" },
          icon: "ğŸ›’",
        },
        { name: { zh: "é†«é™¢", en: "Hospital", ja: "ç—…é™¢" }, icon: "ğŸ¥" },
        { name: { zh: "éƒµå±€", en: "Post Office", ja: "éƒµä¾¿å±€" }, icon: "ğŸ“®" },
        { name: { zh: "å·´å£«ç«™", en: "Bus Stop", ja: "ãƒã‚¹åœ" }, icon: "ğŸš" },
      ];

      function App() {
        const [lang, setLang] = useState("zh");
        const [grid, setGrid] = useState(Array(9).fill(null));
        const [target, setTarget] = useState(null);
        const [answerDir, setAnswerDir] = useState("");
        const [feedback, setFeedback] = useState("");
        const [renderKey, setRenderKey] = useState(0);

        const newProb = () => {
          setFeedback("");

          // Shuffle items
          let shuffled = [...itemsData].sort(() => 0.5 - Math.random());

          // Fill N, E, S, W (indices 1, 5, 7, 3)
          // 0 1 2
          // 3 4 5
          // 6 7 8
          let newGrid = Array(9).fill(null);
          let positions = [1, 5, 7, 3]; // N, E, S, W relative to 4
          let dirKeys = ["north", "east", "south", "west"];
          let targets = [];

          positions.forEach((pos, i) => {
            newGrid[pos] = shuffled[i];
            targets.push({ item: shuffled[i], dirKey: dirKeys[i], dirCode: i }); // 0:N, 1:E, 2:S, 3:W
          });

          newGrid[4] = {
            name: { zh: "æˆ‘", en: "Me", ja: "ç§" },
            icon: "ğŸ§’",
            isMe: true,
          };

          const t = targets[Math.floor(Math.random() * targets.length)];
          setTarget(t);
          setGrid(newGrid);
          setAnswerDir(t.dirKey);
          setRenderKey((k) => k + 1);
        };

        useEffect(newProb, []);

        const check = (dirKey) => {
          if (dirKey === answerDir) {
            setFeedback("CORRECT");
            setTimeout(newProb, 1500);
          } else {
            setFeedback("WRONG");
          }
        };

        if (!target) return null;

        const getItemName = (item) => item.name[lang] || item.name["en"];
        const getDirName = (key) => t[key][lang] || t[key]["en"];

        return (
          <div className="min-h-screen p-8 flex flex-col items-center justify-center">
            <LanguageSelector lang={lang} setLang={setLang} />

            <h1 className="text-4xl md:text-5xl font-black text-cyan-900 mb-8 max-w-2xl text-center">
              {t.title[lang] || t.title["en"]}
            </h1>

            <div className="bg-white/90 rounded-3xl p-8 shadow-2xl w-full max-w-2xl text-center border-4 border-cyan-300">
              <div className="compass-grid mb-8 max-w-md mx-auto">
                {grid.map((cell, i) => (
                  <div
                    key={i}
                    className={`cell ${
                      i === 4 ? "center-cell" : ""
                    } transition-all duration-300 transform ${
                      cell && target && cell.name === target.item.name // Simple comparison by ref or name
                        ? "scale-110 shadow-lg border-yellow-400 bg-yellow-50"
                        : ""
                    }`}
                  >
                    {cell && (
                      <>
                        <div className="text-4xl">{cell.icon}</div>
                        <div className="text-xs mt-1 text-center">
                          {cell.isMe
                            ? t.me[lang] || t.me["en"]
                            : getItemName(cell)}
                        </div>
                      </>
                    )}
                    {/* Compass rose on empty diagonal cells? Optional */}
                    {!cell && i === 0 && (
                      <div className="text-4xl opacity-10">â†–</div>
                    )}
                  </div>
                ))}
              </div>

              <div className="text-xl md:text-2xl font-bold text-slate-700 mb-8 bg-white p-4 rounded-xl border-2 border-slate-100">
                <span className="text-cyan-600 text-3xl mr-2">
                  {target.item.icon}
                </span>
                {lang === "zh" ? (
                  <>
                    {getItemName(target.item)}{" "}
                    {t.whereIs[lang] || t.whereIs["en"]}
                  </>
                ) : (
                  <>
                    {t.whereIs[lang] || t.whereIs["en"]}{" "}
                    {getItemName(target.item)}?
                  </>
                )}
              </div>

              <div className="grid grid-cols-2 gap-4 max-w-sm mx-auto">
                {["north", "east", "south", "west"].map((dir) => (
                  <button
                    key={dir}
                    onClick={() => check(dir)}
                    className="bg-cyan-100 hover:bg-cyan-200 p-4 rounded-xl font-bold text-cyan-800 border-2 border-cyan-200"
                  >
                    {getDirName(dir)}
                  </button>
                ))}
              </div>

              <div className="h-16 mt-6">
                {feedback === "CORRECT" && (
                  <div className="text-4xl font-black text-green-500 animate-bounce">
                    {get("correct", lang)}
                  </div>
                )}
                {feedback === "WRONG" && (
                  <div className="text-4xl font-black text-red-500 animate-shake">
                    {get("wrong", lang)}
                  </div>
                )}
              </div>
            </div>
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  
      
      <!-- Footer -->
      <footer class="text-center py-4 text-slate-500 text-sm">
        <p class="italic mb-1">
          But God made the earth by his power; he founded the world by his wisdom and stretched out the heavens by his
          understanding. Jeremiah 10:12
        </p>
        <p class="text-xs mb-1 mt-2">
          ã€Œè€¶å’Œè¯ç”¨èƒ½åŠ›å‰µé€ å¤§åœ°ï¼Œç”¨æ™ºæ…§å»ºç«‹ä¸–ç•Œï¼Œç”¨è°æ˜é‹ªå¼µç©¹è’¼ã€‚ã€ è€¶åˆ©ç±³æ›¸ 10:12
        </p>
        <p class="text-xs mt-2 pt-2 border-t border-slate-300">
          @ 2025 Education Engineering Portfolio | Generated by Gemini Pro 3.0 | Prepared by SF Lau
        </p>
      </footer>
</body>
</html>
