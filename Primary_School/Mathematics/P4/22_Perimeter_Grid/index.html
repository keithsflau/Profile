<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å°å››æ•¸å­¸ï¼šæ ¼ä»”å‘¨ç•Œ | Grid Perimeter</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: linear-gradient(135deg, #f0f9ff 0%, #0ea5e9 100%);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState } = React;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Grid Perimeter Challenge",
          zh: "æ ¼ä»”å‘¨ç•ŒæŒ‘æˆ°",
          ja: "ã‚°ãƒªãƒƒãƒ‰å‘¨å›²ãƒãƒ£ãƒ¬ãƒ³ã‚¸",
          ko: "ê·¸ë¦¬ë“œ ë‘˜ë ˆ ë„ì „",
          es: "DesafÃ­o de PerÃ­metro de CuadrÃ­cula",
          de: "Gitterumfang-Herausforderung",
          fi: "Ruudukon piirihaaste",
          fr: "DÃ©fi de pÃ©rimÃ¨tre de grille",
          ar: "ØªØ­Ø¯ÙŠ Ù…Ø­ÙŠØ· Ø§Ù„Ø´Ø¨ÙƒØ©",
          it: "Sfida perimetro griglia",
        },
        perimeter: {
          en: "Perimeter",
          zh: "å‘¨ç•Œ (Perimeter)",
          ja: "å‘¨å›²",
          ko: "ë‘˜ë ˆ",
          es: "PerÃ­metro",
          de: "Umfang",
          fi: "Piiri",
          fr: "PÃ©rimÃ¨tre",
          ar: "Ø§Ù„Ù…Ø­ÙŠØ·",
          it: "Perimetro",
        },
        reset: {
          en: "Reset",
          zh: "æ¸…é™¤é‡ä¾†",
          ja: "ãƒªã‚»ãƒƒãƒˆ",
          ko: "ì´ˆê¸°í™”",
          es: "Reiniciar",
          de: "ZurÃ¼cksetzen",
          fi: "Nollaa",
          fr: "RÃ©initialiser",
          ar: "Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†",
          it: "Reimposta",
        },
        tip: {
          en: "Tip: Click cells to form shapes and see how the perimeter changes!",
          zh: "Tip: é»æ“Šæ ¼å­çµ„æˆåœ–å½¢ï¼Œçœ‹çœ‹å‘¨ç•Œå¦‚ä½•è®ŠåŒ–ï¼",
          ja: "ãƒ’ãƒ³ãƒˆï¼šã‚»ãƒ«ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å›³å½¢ã‚’ä½œæˆã—ã€å‘¨å›²ãŒã©ã®ã‚ˆã†ã«å¤‰åŒ–ã™ã‚‹ã‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼",
          ko: "íŒ: ì…€ì„ í´ë¦­í•˜ì—¬ ë„í˜•ì„ ë§Œë“¤ê³  ë‘˜ë ˆê°€ ì–´ë–»ê²Œ ë³€í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”!",
          es: "Consejo: Â¡Haz clic en las celdas para formar formas y observa cÃ³mo cambia el perÃ­metro!",
          de: "Tipp: Klicken Sie auf Zellen, um Formen zu bilden, und sehen Sie, wie sich der Umfang Ã¤ndert!",
          fi: "Vinkki: Napsauta soluja muodostaaksesi muotoja ja katso, miten piiri muuttuu!",
          fr: "Astuce : Cliquez sur les cellules pour former des formes et voyez comment le pÃ©rimÃ¨tre change !",
          ar: "Ù†ØµÙŠØ­Ø©: Ø§Ù†Ù‚Ø± ÙÙˆÙ‚ Ø§Ù„Ø®Ù„Ø§ÙŠØ§ Ù„ØªØ´ÙƒÙŠÙ„ Ø§Ù„Ø£Ø´ÙƒØ§Ù„ ÙˆØ§Ù†Ø¸Ø± ÙƒÙŠÙ ÙŠØªØºÙŠØ± Ø§Ù„Ù…Ø­ÙŠØ·!",
          it: "Suggerimento: clicca sulle celle per formare forme e guarda come cambia il perimetro!",
        },
      };

      function App() {
        const [lang, setLang] = useState("zh");
        const getText = (key) => t[key][lang] || t[key]["en"];

        // 8x8 Grid
        // User clicks squares to fill them
        // App calculates perimeter of the conglomerate shape

        const [grid, setGrid] = useState(
          Array(8)
            .fill()
            .map(() => Array(8).fill(false))
        );

        const toggle = (r, c) => {
          const newG = [...grid];
          newG[r] = [...newG[r]];
          newG[r][c] = !newG[r][c];
          setGrid(newG);
        };

        const calculatePerimeter = () => {
          let p = 0;
          for (let r = 0; r < 8; r++) {
            for (let c = 0; c < 8; c++) {
              if (grid[r][c]) {
                // Check 4 neighbors. If neighbor is empty or out of bounds, add 1 side.
                if (r === 0 || !grid[r - 1][c]) p++; // Top
                if (r === 7 || !grid[r + 1][c]) p++; // Bottom
                if (c === 0 || !grid[r][c - 1]) p++; // Left
                if (c === 7 || !grid[r][c + 1]) p++; // Right
              }
            }
          }
          return p;
        };

        const perimeter = calculatePerimeter();

        return (
          <div className="min-h-screen p-8 flex flex-col items-center">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl md:text-5xl font-black text-white mb-8 mt-8">
              ğŸ“ {getText("title")}
            </h1>

            <div className="bg-white/95 backdrop-blur-md rounded-3xl p-8 shadow-2xl flex flex-col md:flex-row gap-12 items-center">
              <div className="bg-sky-100 p-2 rounded-xl grid grid-cols-8 gap-1 shadow-inner border-4 border-sky-300">
                {grid.map((row, r) =>
                  row.map((active, c) => (
                    <div
                      key={`${r}-${c}`}
                      onClick={() => toggle(r, c)}
                      className={`w-12 h-12 rounded-sm cursor-pointer transition-all ${
                        active
                          ? "bg-sky-500 shadow-lg scale-95"
                          : "bg-white hover:bg-sky-200"
                      }`}
                    />
                  ))
                )}
              </div>

              <div className="flex flex-col items-center gap-6">
                <div className="bg-sky-50 p-6 rounded-2xl w-64 text-center border-2 border-sky-200">
                  <h3 className="text-xl font-bold text-sky-800 mb-2">
                    {getText("perimeter")}
                  </h3>
                  <div className="text-6xl font-black text-sky-600">
                    {perimeter} <span className="text-2xl">cm</span>
                  </div>
                </div>

                <button
                  onClick={() =>
                    setGrid(
                      Array(8)
                        .fill()
                        .map(() => Array(8).fill(false))
                    )
                  }
                  className="px-8 py-3 bg-red-400 text-white rounded-xl font-bold hover:bg-red-500 shadow-lg"
                >
                  {getText("reset")}
                </button>

                <div className="text-sky-100 font-bold text-sm max-w-[200px] text-center">
                  {getText("tip")}
                </div>
              </div>
            </div>
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
