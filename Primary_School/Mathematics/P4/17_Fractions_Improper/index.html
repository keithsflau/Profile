<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Â∞èÂõõÊï∏Â≠∏ÔºöÂÅáÂàÜÊï∏ | Improper Fractions</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: linear-gradient(135deg, #fae8ff 0%, #d946ef 100%);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState } = React;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Improper Fractions",
          zh: "ÂÅáÂàÜÊï∏Ë™çË≠ò",
          ja: "‰ªÆÂàÜÊï∞",
          ko: "Í∞ÄÎ∂ÑÏàò",
          es: "Fracciones Impropias",
          de: "Unechte Br√ºche",
          fi: "Ep√§murtoluvut",
          fr: "Fractions impropres",
          ar: "ÿßŸÑŸÉÿ≥Ÿàÿ± ÿ∫Ÿäÿ± ÿßŸÑŸÅÿπŸÑŸäÿ©",
          it: "Frazioni improprie",
        },
        improperLabel: {
          en: "Improper Fraction",
          zh: "ÂÅáÂàÜÊï∏",
          ja: "‰ªÆÂàÜÊï∞",
          ko: "Í∞ÄÎ∂ÑÏàò",
          es: "Fracci√≥n Impropia",
          de: "Unechter Bruch",
          fi: "Ep√§murtoluku",
          fr: "Fraction impropre",
          ar: "ŸÉÿ≥ÿ± ÿ∫Ÿäÿ± ŸÅÿπŸÑŸä",
          it: "Frazione impropria",
        },
        rule: {
          en: "When numerator ({num}) ‚â• denominator ({den}), it is an Improper Fraction!",
          zh: "ÂàÜÂ≠ê ({num}) ‚â• ÂàÜÊØç ({den}) ÊôÇÔºåÂ∞±ÊòØÂÅáÂàÜÊï∏ÔºÅ",
          ja: "ÂàÜÂ≠ê ({num}) ‚â• ÂàÜÊØç ({den}) „ÅÆÂ†¥Âêà„ÄÅ„Åù„Çå„ÅØ‰ªÆÂàÜÊï∞„Åß„ÅôÔºÅ",
          ko: "Î∂ÑÏûê ({num}) ‚â• Î∂ÑÎ™® ({den}) Ïùº Îïå, Í∑∏Í≤ÉÏùÄ Í∞ÄÎ∂ÑÏàòÏûÖÎãàÎã§!",
          es: "¬°Cuando el numerador ({num}) ‚â• denominador ({den}), es una Fracci√≥n Impropia!",
          de: "Wenn Z√§hler ({num}) ‚â• Nenner ({den}), ist es ein unechter Bruch!",
          fi: "Kun osoittaja ({num}) ‚â• nimitt√§j√§ ({den}), se on ep√§murtoluku!",
          fr: "Lorsque le num√©rateur ({num}) ‚â• d√©nominateur ({den}), c'est une fraction impropre !",
          ar: "ÿπŸÜÿØŸÖÿß ÿßŸÑÿ®ÿ≥ÿ∑ ({num}) ‚â• ÿßŸÑŸÖŸÇÿßŸÖ ({den})ÿå ŸÅŸáŸà ŸÉÿ≥ÿ± ÿ∫Ÿäÿ± ŸÅÿπŸÑŸä!",
          it: "Quando numeratore ({num}) ‚â• denominatore ({den}), √® una frazione impropria!",
        },
      };

      function App() {
        const [lang, setLang] = useState("zh");
        const [num, setNum] = useState(5);
        const [den, setDen] = useState(3);

        const getText = (key) => t[key][lang] || t[key]["en"];

        // Visual logic:
        // num = 5, den = 3. 5/3 = 1 whole + 2/3.
        // Show 2 circles. 1st full (3/3), 2nd partial (2/3).

        const whole = Math.floor(num / den);
        const rem = num % den;
        const totalCircles = Math.ceil(num / den);

        return (
          <div className="min-h-screen p-8 flex flex-col items-center">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl md:text-5xl font-black text-fuchsia-900 mb-8 mt-8">
              üçá {getText("title")}
            </h1>

            <div className="bg-white/95 backdrop-blur-md rounded-3xl p-8 shadow-2xl max-w-4xl w-full flex flex-col md:flex-row gap-8 items-center">
              <div className="flex flex-col items-center gap-4 bg-fuchsia-50 p-6 rounded-2xl w-48">
                <input
                  type="number"
                  min="1"
                  value={num}
                  onChange={(e) =>
                    setNum(Math.max(1, parseInt(e.target.value)))
                  }
                  className="w-full text-5xl font-black text-center bg-transparent border-b-4 border-fuchsia-400 outline-none"
                />
                <div className="w-full h-1 bg-fuchsia-800 rounded-full"></div>
                <input
                  type="number"
                  min="1"
                  value={den}
                  onChange={(e) =>
                    setDen(Math.max(1, parseInt(e.target.value)))
                  }
                  className="w-full text-5xl font-black text-center bg-transparent border-b-4 border-fuchsia-400 outline-none"
                />
                <div className="font-bold text-fuchsia-700 mt-2">
                  {getText("improperLabel")}
                </div>
              </div>

              <div className="text-6xl font-black text-fuchsia-300">=</div>

              <div className="flex flex-wrap gap-4 items-center justify-center flex-1">
                {[...Array(totalCircles)].map((_, i) => {
                  let partsFilled = den;
                  if (i === totalCircles - 1 && rem !== 0) partsFilled = rem;
                  else if (i >= whole && rem === 0) partsFilled = den; // last one full if exact?

                  const toFill = Math.min(den, Math.max(0, num - i * den));

                  return (
                    <svg
                      key={i}
                      width="100"
                      height="100"
                      viewBox="0 0 100 100"
                      className="transform -rotate-90"
                    >
                      <circle
                        cx="50"
                        cy="50"
                        r="48"
                        fill="white"
                        stroke="#e879f9"
                        strokeWidth="2"
                      />
                      {[...Array(den)].map((_, j) => {
                        const deg = 360 / den;
                        const start = j * deg;
                        const end = (j + 1) * deg;
                        const largeArc = deg > 180 ? 1 : 0;
                        const x1 =
                          50 + 48 * Math.cos(Math.PI * 2 * (start / 360));
                        const y1 =
                          50 + 48 * Math.sin(Math.PI * 2 * (start / 360));
                        const x2 =
                          50 + 48 * Math.cos(Math.PI * 2 * (end / 360));
                        const y2 =
                          50 + 48 * Math.sin(Math.PI * 2 * (end / 360));

                        // Full circle path fix for den=1
                        if (den === 1) {
                          return (
                            <circle
                              key={j}
                              cx="50"
                              cy="50"
                              r="48"
                              fill={j < toFill ? "#d946ef" : "transparent"}
                              stroke="white"
                            />
                          );
                        }

                        return (
                          <path
                            key={j}
                            d={`M50,50 L${x1},${y1} A48,48 0 ${largeArc} 1 ${x2},${y2} Z`}
                            fill={j < toFill ? "#d946ef" : "transparent"}
                            stroke="white"
                          />
                        );
                      })}
                    </svg>
                  );
                })}
              </div>
            </div>

            <div className="mt-8 text-white font-bold text-xl drop-shadow-md text-center">
              {getText("rule").replace("{num}", num).replace("{den}", den)}
            </div>
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
