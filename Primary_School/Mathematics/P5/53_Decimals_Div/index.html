<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>小五數學：小數除法</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: linear-gradient(135deg, #d4fc79 0%, #96e6a1 100%);
      }
      .digit-box {
        transition: all 0.5s ease-out;
      }
      .decimal-point {
        transition: transform 1s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;

      const ArrowRight = () => (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          strokeWidth="2"
          strokeLinecap="round"
          strokeLinejoin="round"
        >
          <path d="M5 12h14" />
          <path d="m12 5 7 7-7 7" />
        </svg>
      );

      function App() {
        const [dividend, setDividend] = useState(2.4);
        const [divisor, setDivisor] = useState(0.6);
        const [step, setStep] = useState(0); // 0: input, 1: shift, 2: solve

        const generate = () => {
          // Generate nice numbers
          // Multiples of 0.1 to 0.9
          const d = Math.floor(Math.random() * 8) + 2; // 2..9
          const q = Math.floor(Math.random() * 8) + 2; // 2..9
          // total = d * q
          // example: 3 * 4 = 12 -> 1.2 / 0.3 = 4

          setDivisor(d / 10);
          setDividend((d * q) / 10);
          setStep(0);
        };

        useEffect(() => {
          generate();
        }, []);

        const result = Math.round(dividend / divisor);

        // Display strings
        const divStr = divisor.toFixed(1);
        const dendStr = dividend.toFixed(1);

        return (
          <div className="min-h-screen p-6 flex flex-col items-center justify-center">
            <div className="bg-white/90 backdrop-blur-xl rounded-[2rem] p-12 shadow-2xl border-4 border-white w-full max-w-3xl text-center">
              <h1 className="text-4xl font-black text-slate-800 mb-2">
                小數除法
              </h1>
              <p className="text-slate-500 font-bold mb-12">
                Decimal Division: Shifting the Point
              </p>

              {/* Main Visualization Stage */}
              <div className="bg-slate-100 rounded-3xl p-12 relative overflow-hidden min-h-[300px] flex items-center justify-center">
                {/* Equation Container */}
                <div className="flex items-center gap-8 text-6xl font-black font-mono relative z-10">
                  {/* Dividend Part */}
                  <div
                    className={`flex items-baseline transition-all duration-1000 ${
                      step >= 1 ? "-translate-x-8" : ""
                    }`}
                  >
                    <span>{dendStr[0]}</span>
                    <span
                      className={`text-blue-500 mx-1 decimal-point inline-block ${
                        step >= 1 ? "translate-x-[40px] opacity-20" : ""
                      }`}
                    >
                      .
                    </span>
                    <span>{dendStr[2]}</span>
                    {step >= 1 && (
                      <span className="text-blue-600 decimal-point absolute right-[-20px] animate-[bounce_0.5s_infinite]">
                        .
                      </span>
                    )}
                  </div>

                  <div className="text-slate-300">÷</div>

                  {/* Divisor Part */}
                  <div
                    className={`flex items-baseline transition-all duration-1000 ${
                      step >= 1 ? "translate-x-4" : ""
                    }`}
                  >
                    <span>0</span>
                    <span
                      className={`text-red-500 mx-1 decimal-point inline-block ${
                        step >= 1 ? "translate-x-[40px] opacity-20" : ""
                      }`}
                    >
                      .
                    </span>
                    <span>{divStr[2]}</span>
                    {step >= 1 && (
                      <span className="text-red-600 decimal-point absolute right-[-20px] animate-[bounce_0.5s_infinite]">
                        .
                      </span>
                    )}
                  </div>
                </div>

                {/* Hint Arrows */}
                {step === 1 && (
                  <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full h-full pointer-events-none">
                    <div className="absolute top-20 left-[35%] text-blue-500 font-bold animate-pulse">
                      × 10
                    </div>
                    <div className="absolute top-20 right-[35%] text-red-500 font-bold animate-pulse">
                      × 10
                    </div>
                  </div>
                )}
              </div>

              {/* Explanation Box */}
              <div className="mt-8 h-24 flex items-center justify-center">
                {step === 0 && (
                  <div className="text-xl text-slate-500 font-bold">
                    我們不喜歡除數是小數...
                    <br />
                    We don't like decimal divisors.
                  </div>
                )}
                {step === 1 && (
                  <div className="text-xl text-slate-800 font-bold bg-yellow-100 px-6 py-3 rounded-xl border-2 border-yellow-300">
                    把小數點向右移！變整數！
                    <br />
                    Move the point right! Make it whole!
                  </div>
                )}
                {step === 2 && (
                  <div className="text-3xl font-black text-green-600 animate-[bounce_1s_ease-in-out]">
                    {dendStr.replace(".", "")} ÷ {divStr.replace(".", "")} ={" "}
                    {result}
                  </div>
                )}
              </div>

              {/* Controls */}
              <div className="mt-8 flex justify-center gap-4">
                {step < 2 ? (
                  <button
                    onClick={() => setStep((s) => s + 1)}
                    className="bg-blue-600 hover:bg-blue-700 text-white text-xl font-bold px-8 py-4 rounded-full shadow-lg transition-transform hover:scale-105 flex items-center gap-2"
                  >
                    下一步 Next <ArrowRight />
                  </button>
                ) : (
                  <button
                    onClick={generate}
                    className="bg-green-500 hover:bg-green-600 text-white text-xl font-bold px-8 py-4 rounded-full shadow-lg transition-transform hover:scale-105"
                  >
                    再試一次 Try Again
                  </button>
                )}
              </div>
            </div>

            <div className="fixed bottom-4 left-4">
              <a
                href="../index.html"
                className="bg-white/80 backdrop-blur hover:bg-white text-slate-600 px-6 py-3 rounded-full font-bold shadow-lg flex items-center gap-2 transition-all"
              >
                ← 返回目錄
              </a>
            </div>
          </div>
        );
      }

      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
