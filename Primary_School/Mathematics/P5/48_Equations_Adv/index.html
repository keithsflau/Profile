<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Â∞è‰∫îÊï∏Â≠∏ÔºöÁ∞°ÊòìÊñπÁ®ã (‰∫å) | Simple Equations (2)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/lucide-react@latest/dist/umd/lucide-react.min.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&family=Outfit:wght@400;600;800&family=JetBrains+Mono:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Outfit", "Noto Sans TC", sans-serif;
        background: #0f172a;
        color: white;
        overflow-x: hidden;
      }
      .glass-panel {
        background: rgba(236, 72, 153, 0.15); /* Pink 500 alpha */
        backdrop-filter: blur(12px);
        border: 1px solid rgba(244, 114, 182, 0.2);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { Split, X, Divide, RefreshCw, Calculator, ArrowRight } =
        window.LucideReact;
      const { LanguageSelector } = window.MathI18n || {
        LanguageSelector: () => null,
      };

      const t = {
        title: {
          en: "Simple Equations (2)",
          zh: "Á∞°ÊòìÊñπÁ®ã (‰∫å)",
          ja: "‰∏ÄÊ¨°ÊñπÁ®ãÂºè (2)",
          ko: "ÏùºÏ∞®Î∞©Ï†ïÏãù (2)",
          es: "Ecuaciones Simples (2)",
          de: "Einfache Gleichungen (2)",
          fi: "Yksinkertaiset yht√§l√∂t (2)",
          fr: "√âquations simples (2)",
          ar: "ŸÖÿπÿßÿØŸÑÿßÿ™ ÿ®ÿ≥Ÿäÿ∑ÿ© (2)",
          it: "Equazioni semplici (2)",
        },
        topic: {
          en: "Equations (Mult/Div)",
          zh: "ÊñπÁ®ã (‰πòÈô§)",
          ja: "ÊñπÁ®ãÂºè (‰πóÈô§)",
          ko: "Î∞©Ï†ïÏãù (Í≥±ÏÖà/ÎÇòÎàóÏÖà)",
          es: "Ecuaciones (Mult/Div)",
          de: "Gleichungen (Mult/Div)",
          fi: "Yht√§l√∂t (Kerto/Jako)",
          fr: "√âquations (Mult/Div)",
          ar: "ŸÖÿπÿßÿØŸÑÿßÿ™ (ÿ∂ÿ±ÿ®/ŸÇÿ≥ŸÖÿ©)",
          it: "Equazioni (Molt/Div)",
        },
        divideBoth: {
          en: "Divide both sides by",
          zh: "ÂÖ©ÈÇäÂêåÊôÇÈô§‰ª•",
          ja: "‰∏°Ëæ∫„ÇíÂâ≤„Çã",
          ko: "ÏñëÎ≥ÄÏùÑ ÎÇòÎàÑÍ∏∞",
          es: "Dividir ambos lados por",
          de: "Teile beide Seiten durch",
          fi: "Jaa molemmat puolet luvulla",
          fr: "Diviser les deux c√¥t√©s par",
          ar: "ÿßŸÇÿ≥ŸÖ ŸÉŸÑÿß ÿßŸÑÿ¨ÿßŸÜÿ®ŸäŸÜ ÿπŸÑŸâ",
          it: "Dividi entrambi i lati per",
        },
        multiplyBoth: {
          en: "Multiply both sides by",
          zh: "ÂÖ©ÈÇäÂêåÊôÇ‰πò‰ª•",
          ja: "‰∏°Ëæ∫„Å´Êéõ„Åë„Çã",
          ko: "ÏñëÎ≥ÄÏóê Í≥±ÌïòÍ∏∞",
          es: "Multiplicar ambos lados por",
          de: "Multipliziere beide Seiten mit",
          fi: "Kerro molemmat puolet luvulla",
          fr: "Multiplier les deux c√¥t√©s par",
          ar: "ÿßÿ∂ÿ±ÿ® ŸÉŸÑÿß ÿßŸÑÿ¨ÿßŸÜÿ®ŸäŸÜ ŸÅŸä",
          it: "Moltiplica entrambi i lati per",
        },
        next: {
          en: "Next Question",
          zh: "‰∏ã‰∏ÄÈ°å",
          ja: "Ê¨°„ÅÆÂïèÈ°å",
          ko: "Îã§Ïùå Î¨∏Ï†ú",
          es: "Siguiente Pregunta",
          de: "N√§chste Frage",
          fi: "Seuraava kysymys",
          fr: "Question suivante",
          ar: "ÿßŸÑÿ≥ÿ§ÿßŸÑ ÿßŸÑÿ™ÿßŸÑŸä",
          it: "Prossima domanda",
        },
        steps: {
          en: "Step-by-step",
          zh: "Ê≠•È©üËß£Ë™™",
          ja: "„Çπ„ÉÜ„ÉÉ„Éó„Éê„Ç§„Çπ„ÉÜ„ÉÉ„Éó",
          ko: "Îã®Í≥ÑÎ≥Ñ ÏÑ§Î™Ö",
          es: "Paso a paso",
          de: "Schritt f√ºr Schritt",
          fi: "Vaihe vaiheelta",
          fr: "Pas √† pas",
          ar: "ÿÆÿ∑Ÿàÿ© ÿ®ÿÆÿ∑Ÿàÿ©",
          it: "Passo dopo passo",
        },
        equation: {
          en: "Equation",
          zh: "ÊñπÁ®ã",
          ja: "ÊñπÁ®ãÂºè",
          ko: "Î∞©Ï†ïÏãù",
          es: "Ecuaci√≥n",
          de: "Gleichung",
          fi: "Yht√§l√∂",
          fr: "√âquation",
          ar: "ŸÖÿπÿßÿØŸÑÿ©",
          it: "Equazione",
        },
      };

      const getText = (key, lang) => t[key]?.[lang] || t[key]?.["en"] || key;

      function App() {
        const [lang, setLang] = useState("zh");
        const [type, setType] = useState("mul"); // 'mul' (Ax=B) or 'div' (x/A=B)
        const [yVal, setYVal] = useState(4); // The answer value of y
        const [coeff, setCoeff] = useState(3); // A
        const [step, setStep] = useState(0); // 0: init, 1: showing solution

        const generate = () => {
          const nextType = Math.random() > 0.5 ? "mul" : "div";
          setType(nextType);
          setYVal(Math.floor(Math.random() * 8) + 2); // 2-9
          setCoeff(Math.floor(Math.random() * 3) + 2); // 2-4
          setStep(0);
        };

        useEffect(() => {
          generate();
        }, []);

        const total = type === "mul" ? yVal * coeff : yVal; // For mul: Right side is total. For div: Right side is coeff*yVal? No.
        // wait.
        // Mul: Ay = B -> y = B/A. So B = y*A. total = yVal*coeff.
        // Div: y/A = B -> y = B*A. So B = yVal/A? No let's say B is integer.
        // If type 'div', equation is y/A = B. y is big. y = B * A.
        // Let's set 'B' (RHS) as integer.
        // Equation: y / coeff = result. y = result * coeff.
        // In this component state, `yVal` was originally 'the answer'.
        // Let's keep `yVal` as the unknown's value.
        // If div: y / coeff = (yVal / coeff).
        // This implies yVal must be divisible by coeff for integer arithmetic displays.

        // Adjusted logic:
        // Mul: Ay = B. y=target. B = A*target. Equ: A y = B.
        // Div: y/A = B. y=target. B = target/A.
        // For clean numbers, if Div, target must be multiple of A.

        // Let's re-init for cleanliness
        useEffect(() => {
          if (type === "div") {
            const B = Math.floor(Math.random() * 5) + 2;
            setYVal(B * coeff); // y is big
          }
        }, [type]);

        const B = type === "mul" ? yVal * coeff : yVal / coeff; // The RHS displayed number

        // Visualization Data
        // Mul: Show 'coeff' groups of 'y'. Total items visible = B.
        // Div: Show 'y' items, split into 'coeff' groups. Each group has B items.

        return (
          <div className="min-h-screen flex flex-col items-center p-4">
            <div className="w-full max-w-5xl flex justify-between items-center mb-10">
              <h1 className="text-3xl md:text-5xl font-black text-pink-400 drop-shadow-[0_0_15px_rgba(244,114,182,0.5)]">
                üßÆ {getText("title", lang)}
              </h1>
              <div className="bg-slate-800/80 p-1.5 rounded-xl border border-white/10 flex flex-wrap justify-end gap-1 max-w-[50%]">
                {[
                  "zh",
                  "en",
                  "ja",
                  "ko",
                  "es",
                  "de",
                  "fi",
                  "fr",
                  "ar",
                  "it",
                ].map((l) => (
                  <button
                    key={l}
                    onClick={() => setLang(l)}
                    className={`px-3 py-1.5 rounded-lg font-bold text-xs uppercase transition-all ${
                      lang === l
                        ? "bg-pink-600 text-white shadow-lg scale-105"
                        : "text-slate-400 hover:text-white hover:bg-white/5"
                    }`}
                  >
                    {l}
                  </button>
                ))}
              </div>
            </div>

            <main className="w-full max-w-5xl grid lg:grid-cols-2 gap-8">
              {/* Visual Area */}
              <div className="glass-panel p-8 rounded-3xl flex flex-col items-center justify-center min-h-[400px] relative">
                {/* Equation Top */}
                <div className="absolute top-6 left-0 right-0 flex justify-center">
                  <div className="bg-slate-900/60 backdrop-blur border border-pink-500/30 px-8 py-4 rounded-2xl text-4xl font-mono font-black text-white flex items-center gap-4 shadow-xl">
                    {type === "mul" ? (
                      <>
                        <span>
                          {coeff}
                          <span className="text-pink-400">y</span>
                        </span>
                        <span>=</span>
                        <span className="text-blue-400">{B}</span>
                      </>
                    ) : (
                      <>
                        <div className="flex flex-col items-center leading-none">
                          <span className="text-pink-400 border-b-2 border-white/20 w-full text-center pb-1">
                            y
                          </span>
                          <span className="text-sm pt-1">{coeff}</span>
                        </div>
                        <span>=</span>
                        <span className="text-blue-400">{B}</span>
                      </>
                    )}
                  </div>
                </div>

                {/* Graphic */}
                <div className="mt-20 w-full flex justify-center items-center">
                  {type === "mul" ? (
                    <div
                      className="grid gap-4"
                      style={{
                        gridTemplateColumns: `repeat(${Math.min(
                          coeff,
                          3
                        )}, 1fr)`,
                      }}
                    >
                      {Array.from({ length: coeff }).map((_, i) => (
                        <motion.div
                          key={i}
                          initial={{ scale: 0.8, opacity: 0 }}
                          animate={{ scale: 1, opacity: 1 }}
                          transition={{ delay: i * 0.1 }}
                          className={`w-24 h-32 border-4 rounded-2xl flex flex-col items-center justify-center gap-2 relative transition-colors duration-500 ${
                            step === 1
                              ? "border-green-400 bg-green-500/10"
                              : "border-pink-500 bg-pink-500/10"
                          }`}
                        >
                          <span className="absolute top-2 left-2 text-xs font-bold text-pink-300">
                            y
                          </span>
                          {step === 1 ? (
                            /* Show dots */
                            <div className="grid grid-cols-3 gap-1">
                              {Array.from({ length: yVal }).map((_, d) => (
                                <motion.div
                                  key={d}
                                  initial={{ scale: 0 }}
                                  animate={{ scale: 1 }}
                                  className="w-3 h-3 bg-green-400 rounded-full"
                                />
                              ))}
                            </div>
                          ) : (
                            <span className="text-4xl font-black text-pink-300">
                              ?
                            </span>
                          )}
                        </motion.div>
                      ))}
                    </div>
                  ) : (
                    // Division Visual: A big bar split into Coeff parts. One part is B. Total length is y.
                    <div className="w-full max-w-sm flex flex-col gap-2">
                      <div className="flex w-full h-24 rounded-2xl overflow-hidden border-4 border-pink-500/50">
                        {Array.from({ length: coeff }).map((_, i) => (
                          <motion.div
                            key={i}
                            className={`flex-1 border-r border-pink-500/30 flex items-center justify-center relative ${
                              step === 1 ? "bg-green-500/20" : "bg-pink-500/10"
                            }`}
                          >
                            {i === 0 && (
                              <span className="absolute inset-0 flex items-center justify-center text-2xl font-black text-blue-400">
                                {!step ? B : ""}
                              </span>
                            )}
                            {step === 1 && (
                              <span className="text-xl font-bold text-green-400">
                                {B}
                              </span>
                            )}
                          </motion.div>
                        ))}
                      </div>
                      <div className="flex justify-between text-xs font-bold text-pink-300 px-1">
                        <span>0</span>
                        <span>y</span>
                      </div>
                    </div>
                  )}
                </div>
              </div>

              {/* Control Panel */}
              <div className="flex flex-col gap-6">
                <div className="glass-panel p-8 rounded-3xl flex-1 flex flex-col justify-center">
                  {step === 0 ? (
                    <div className="flex flex-col gap-6">
                      <h3 className="text-xl font-bold text-center text-white">
                        {getText("steps", lang)}?
                      </h3>
                      <button
                        onClick={() => setStep(1)}
                        className="w-full py-4 bg-pink-600 hover:bg-pink-500 rounded-xl text-white font-bold text-lg shadow-lg flex items-center justify-center gap-3 transition-all transform hover:scale-105"
                      >
                        {type === "mul" ? (
                          <>
                            <span>
                              {getText("divideBoth", lang)} {coeff}
                            </span>
                            <Divide size={24} />
                          </>
                        ) : (
                          <>
                            <span>
                              {getText("multiplyBoth", lang)} {coeff}
                            </span>
                            <X size={24} />
                          </>
                        )}
                      </button>
                    </div>
                  ) : (
                    <motion.div
                      initial={{ opacity: 0, y: 20 }}
                      animate={{ opacity: 1, y: 0 }}
                      className="flex flex-col items-center text-center gap-6"
                    >
                      <div className="text-2xl font-mono text-slate-300 bg-slate-900/50 p-6 rounded-2xl border border-white/10 w-full">
                        {type === "mul" ? (
                          <>
                            <div className="mb-2 opacity-50">
                              {coeff}y √∑ {coeff} = {B} √∑ {coeff}
                            </div>
                            <div className="text-4xl font-black text-green-400">
                              y = {yVal}
                            </div>
                          </>
                        ) : (
                          <>
                            <div className="mb-2 opacity-50 flex items-center justify-center gap-2">
                              <span className="flex flex-col leading-none text-sm">
                                <span className="border-b border-white">y</span>
                                <span>{coeff}</span>
                              </span>
                              <span>
                                √ó {coeff} = {B} √ó {coeff}
                              </span>
                            </div>
                            <div className="text-4xl font-black text-green-400">
                              y = {yVal}
                            </div>
                          </>
                        )}
                      </div>

                      <button
                        onClick={generate}
                        className="w-full py-3 bg-indigo-600 hover:bg-indigo-500 rounded-xl text-white font-bold flex items-center justify-center gap-2 transition-all"
                      >
                        <RefreshCw size={20} /> {getText("next", lang)}
                      </button>
                    </motion.div>
                  )}
                </div>

                <div className="glass-panel p-6 rounded-2xl flex items-start gap-4">
                  <Calculator className="text-pink-400 shrink-0 mt-1" />
                  <div className="text-sm text-slate-300">
                    {type === "mul"
                      ? getText("divideBoth", lang) + ` ${coeff}`
                      : getText("multiplyBoth", lang) + ` ${coeff}`}
                    <br />
                    <span className="opacity-50">
                      Inverse operations help isolate the variable 'y'.
                    </span>
                  </div>
                </div>
              </div>
            </main>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
