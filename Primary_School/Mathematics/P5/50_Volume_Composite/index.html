<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Â∞è‰∫îÊï∏Â≠∏ÔºöË§áÂêàÂúñÂΩ¢È´îÁ©ç | Composite Volume</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/lucide-react@latest/dist/umd/lucide-react.min.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&family=Outfit:wght@400;600;800&family=JetBrains+Mono:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Outfit", "Noto Sans TC", sans-serif;
        background: #0f172a;
        color: white;
        overflow-x: hidden;
      }
      .glass-panel {
        background: rgba(245, 158, 11, 0.15); /* Amber 500 alpha */
        backdrop-filter: blur(12px);
        border: 1px solid rgba(251, 191, 36, 0.2);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      }

      .scene {
        perspective: 1200px;
        transform-style: preserve-3d;
      }
      .cuboid-container {
        position: relative;
        transform-style: preserve-3d;
        transform: rotateX(-30deg) rotateY(45deg);
        transition: transform 0.5s ease;
      }
      .cube {
        position: absolute;
        width: 40px;
        height: 40px;
        transform-style: preserve-3d;
        transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      }
      .face {
        position: absolute;
        width: 40px;
        height: 40px;
        border: 1px solid rgba(255, 255, 255, 0.2);
        opacity: 0.9;
      }
      .front {
        transform: rotateY(0deg) translateZ(20px);
        filter: brightness(1);
      }
      .right {
        transform: rotateY(90deg) translateZ(20px);
        filter: brightness(0.85);
      }
      .left {
        transform: rotateY(-90deg) translateZ(20px);
        filter: brightness(0.85);
      }
      .back {
        transform: rotateY(180deg) translateZ(20px);
        filter: brightness(0.7);
      }
      .top {
        transform: rotateX(90deg) translateZ(20px);
        filter: brightness(1.1);
      }
      .bottom {
        transform: rotateX(-90deg) translateZ(20px);
        filter: brightness(0.6);
      }

      /* Custom colors/glows handled inline */
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion } = window.Motion;
      const { Layers, Scissors, Box, CheckCircle } = window.LucideReact;
      const { LanguageSelector } = window.MathI18n || {
        LanguageSelector: () => null,
      };

      const t = {
        title: {
          en: "Composite Volume",
          zh: "Ë§áÂêàÂúñÂΩ¢È´îÁ©ç",
          ja: "Ë§áÂêàÂõ≥ÂΩ¢„ÅÆ‰ΩìÁ©ç",
          ko: "Î≥µÌï© ÎèÑÌòïÏùò Î∂ÄÌîº",
          es: "Volumen Compuesto",
          de: "Zusammengesetztes Volumen",
          fi: "Yhdistelm√§kappaleen tilavuus",
          fr: "Volume composite",
          ar: "ÿ≠ÿ¨ŸÖ ÿßŸÑÿ£ÿ¥ŸÉÿßŸÑ ÿßŸÑŸÖÿ±ŸÉÿ®ÿ©",
          it: "Volume composto",
        },
        original: {
          en: "Original",
          zh: "ÂéüÂúñ",
          ja: "ÂÖÉ„ÅÆÂõ≥",
          ko: "ÏõêÎ≥∏",
          es: "Original",
          de: "Original",
          fi: "Alkuper√§inen",
          fr: "Original",
          ar: "ÿßŸÑÿ£ÿµŸÑ",
          it: "Originale",
        },
        method1: {
          en: "Vertical Split",
          zh: "ÂûÇÁõ¥ÂàáÂâ≤",
          ja: "ÂûÇÁõ¥ÂàÜÂâ≤",
          ko: "ÏàòÏßÅ Î∂ÑÌï†",
          es: "Divisi√≥n Vertical",
          de: "Vertikale Teilung",
          fi: "Pystyleikkaus",
          fr: "Coupe verticale",
          ar: "ÿßŸÑŸÇÿ∑ÿπ ÿßŸÑÿ±ÿ£ÿ≥Ÿä",
          it: "Taglio verticale",
        },
        method2: {
          en: "Horizontal Split",
          zh: "Ê∞¥Âπ≥ÂàáÂâ≤",
          ja: "Ê∞¥Âπ≥ÂàÜÂâ≤",
          ko: "ÏàòÌèâ Î∂ÑÌï†",
          es: "Divisi√≥n Horizontal",
          de: "Horizontale Teilung",
          fi: "Vaakaleikkaus",
          fr: "Coupe horizontale",
          ar: "ÿßŸÑŸÇÿ∑ÿπ ÿßŸÑÿ£ŸÅŸÇŸä",
          it: "Taglio orizzontale",
        },
        totalVolume: {
          en: "Total Volume",
          zh: "Á∏ΩÈ´îÁ©ç",
          ja: "Á∑è‰ΩìÁ©ç",
          ko: "Ï¥ù Î∂ÄÌîº",
          es: "Volumen Total",
          de: "Gesamtvolumen",
          fi: "Kokonaistilavuus",
          fr: "Volume total",
          ar: "ÿßŸÑÿ≠ÿ¨ŸÖ ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä",
          it: "Volume totale",
        },
        partA: {
          en: "Part A",
          zh: "ÈÉ®ÂàÜ A",
          ja: "„Éë„Éº„Éà A",
          ko: "ÌååÌä∏ A",
          es: "Parte A",
          de: "Teil A",
          fi: "Osa A",
          fr: "Partie A",
          ar: "ÿßŸÑÿ¨ÿ≤ÿ° A",
          it: "Parte A",
        },
        partB: {
          en: "Part B",
          zh: "ÈÉ®ÂàÜ B",
          ja: "„Éë„Éº„Éà B",
          ko: "ÌååÌä∏ B",
          es: "Parte B",
          de: "Teil B",
          fi: "Osa B",
          fr: "Partie B",
          ar: "ÿßŸÑÿ¨ÿ≤ÿ° B",
          it: "Parte B",
        },
      };

      const getText = (key, lang) => t[key]?.[lang] || t[key]?.["en"] || key;

      function App() {
        const [lang, setLang] = useState("zh");
        const [method, setMethod] = useState("none"); // none, v-split, h-split

        // Shape Params
        const shape = {
          slab: { l: 4, w: 2, h: 2 },
          tower: { l: 2, w: 2, h: 3, x: 2, z: 0 }, // Placed at x=2 (right side) top of slab
          // Wait, previous file had tower at x=0? Let's check visually.
          // Tower width=2. My slab length=4. If I want L shape...
          // Let's make it simple.
          // Slab: 4x2x2. Tower on top of right side (x=2..3).
        };

        const cubes = [];
        // Generate Slab
        for (let x = 0; x < 4; x++) {
          for (let y = 0; y < 2; y++) {
            for (let z = 0; z < 2; z++) {
              let group = "slab";
              if (method === "v-split") {
                // Cut at x=2. Left side (x<2) is A. Right side (x>=2) + Tower is B?
                // Vertical split separates the 'tall' part from the 'short' part.
                group = x < 2 ? "A" : "B";
              }
              if (method === "h-split") {
                // Cut horizontally between slab and tower.
                // Slab is A. Tower is B.
                group = "A";
              }
              cubes.push({ x, y, z, group });
            }
          }
        }
        // Generate Tower (Right side, on top)
        for (let x = 2; x < 4; x++) {
          for (let y = 2; y < 5; y++) {
            // h=3, so 2,3,4
            for (let z = 0; z < 2; z++) {
              let group = "tower";
              if (method === "v-split") {
                // Part of the tall stack B
                group = "B";
              }
              if (method === "h-split") {
                group = "B";
              }
              cubes.push({ x, y, z, group });
            }
          }
        }

        const size = 40;
        const cx = (4 * 40) / 2;
        const cy = (5 * 40) / 2;
        const cz = (2 * 40) / 2;

        const getGroupColor = (g) => {
          if (method === "none") return "rgba(245, 158, 11, 0.9)"; // Amber
          if (g === "A") return "rgba(236, 72, 153, 0.9)"; // Pink
          if (g === "B") return "rgba(34, 197, 94, 0.9)"; // Green
          return "white";
        };

        return (
          <div className="min-h-screen flex flex-col items-center p-4">
            <div className="w-full max-w-6xl flex justify-between items-center mb-6">
              <h1 className="text-3xl md:text-5xl font-black text-amber-400 drop-shadow-[0_0_15px_rgba(251,191,36,0.5)]">
                üèóÔ∏è {getText("title", lang)}
              </h1>
              <div className="bg-slate-800/80 p-1.5 rounded-xl border border-white/10 flex flex-wrap justify-end gap-1">
                {[
                  "zh",
                  "en",
                  "ja",
                  "ko",
                  "es",
                  "de",
                  "fi",
                  "fr",
                  "ar",
                  "it",
                ].map((l) => (
                  <button
                    key={l}
                    onClick={() => setLang(l)}
                    className={`px-3 py-1.5 rounded-lg font-bold text-xs uppercase transition-all ${
                      lang === l
                        ? "bg-amber-600 text-white shadow-lg scale-105"
                        : "text-slate-400 hover:text-white hover:bg-white/5"
                    }`}
                  >
                    {l}
                  </button>
                ))}
              </div>
            </div>

            <main className="w-full max-w-6xl grid lg:grid-cols-3 gap-8">
              {/* Control Panel */}
              <div className="flex flex-col gap-6">
                <div className="glass-panel p-2 rounded-2xl flex flex-col gap-2">
                  {[
                    {
                      id: "none",
                      label: "original",
                      icon: <Layers size={20} />,
                    },
                    {
                      id: "v-split",
                      label: "method1",
                      icon: <Scissors size={20} className="-rotate-90" />,
                    },
                    {
                      id: "h-split",
                      label: "method2",
                      icon: <Scissors size={20} />,
                    },
                  ].map((m) => (
                    <button
                      key={m.id}
                      onClick={() => setMethod(m.id)}
                      className={`w-full py-4 px-6 rounded-xl font-bold flex items-center gap-3 transition-all ${
                        method === m.id
                          ? "bg-amber-500 text-white shadow-lg"
                          : "hover:bg-white/5 text-amber-200"
                      }`}
                    >
                      {m.icon}
                      <span>{getText(m.label, lang)}</span>
                      {method === m.id && (
                        <CheckCircle className="ml-auto" size={18} />
                      )}
                    </button>
                  ))}
                </div>

                <div className="glass-panel p-6 rounded-3xl flex-1 flex flex-col justify-center">
                  {method === "none" && (
                    <div className="text-center text-amber-200/50 text-sm font-bold uppercase tracking-widest">
                      Select a split method to calculate volume
                    </div>
                  )}
                  {method === "v-split" && (
                    <div className="flex flex-col gap-4">
                      <div className="bg-pink-500/20 border border-pink-500/30 p-4 rounded-xl">
                        <div className="text-pink-300 font-bold text-xs uppercase mb-1">
                          {getText("partA", lang)} (Left)
                        </div>
                        <div className="text-2xl font-mono text-white">
                          2 √ó 2 √ó 2 ={" "}
                          <span className="font-black text-pink-400">8</span>
                        </div>
                      </div>
                      <div className="bg-green-500/20 border border-green-500/30 p-4 rounded-xl">
                        <div className="text-green-300 font-bold text-xs uppercase mb-1">
                          {getText("partB", lang)} (Right Stack)
                        </div>
                        <div className="text-2xl font-mono text-white">
                          2 √ó 2 √ó 5 ={" "}
                          <span className="font-black text-green-400">20</span>
                        </div>
                      </div>
                    </div>
                  )}
                  {method === "h-split" && (
                    <div className="flex flex-col gap-4">
                      <div className="bg-pink-500/20 border border-pink-500/30 p-4 rounded-xl">
                        <div className="text-pink-300 font-bold text-xs uppercase mb-1">
                          {getText("partA", lang)} (Bottom Slab)
                        </div>
                        <div className="text-2xl font-mono text-white">
                          4 √ó 2 √ó 2 ={" "}
                          <span className="font-black text-pink-400">16</span>
                        </div>
                      </div>
                      <div className="bg-green-500/20 border border-green-500/30 p-4 rounded-xl">
                        <div className="text-green-300 font-bold text-xs uppercase mb-1">
                          {getText("partB", lang)} (Top Tower)
                        </div>
                        <div className="text-2xl font-mono text-white">
                          2 √ó 2 √ó 3 ={" "}
                          <span className="font-black text-green-400">12</span>
                        </div>
                      </div>
                    </div>
                  )}

                  <div className="mt-8 pt-4 border-t border-white/10 flex justify-between items-end">
                    <div className="text-slate-400 font-bold text-sm uppercase">
                      {getText("totalVolume", lang)}
                    </div>
                    <div className="text-5xl font-black text-white drop-shadow-[0_0_10px_rgba(251,191,36,0.5)]">
                      28
                    </div>
                  </div>
                </div>
              </div>

              {/* 3D Scene */}
              <div className="lg:col-span-2 glass-panel rounded-3xl relative overflow-hidden flex items-center justify-center min-h-[500px]">
                <div className="scene w-full h-full flex items-center justify-center">
                  <div className="cuboid-container">
                    {cubes.map((c, i) => {
                      let offsetX = 0;
                      let offsetY = 0;

                      if (method === "v-split" && c.group === "B") offsetX = 40;
                      if (method === "h-split" && c.group === "B") offsetY = 40;

                      return (
                        <div
                          key={i}
                          className="cube"
                          style={{
                            transform: `translate3d(${
                              c.x * size - cx + offsetX
                            }px, ${-c.y * size + cy - offsetY}px, ${
                              c.z * size - cz
                            }px)`,
                          }}
                        >
                          <div
                            className="face front"
                            style={{ backgroundColor: getGroupColor(c.group) }}
                          />
                          <div
                            className="face back"
                            style={{ backgroundColor: getGroupColor(c.group) }}
                          />
                          <div
                            className="face right"
                            style={{ backgroundColor: getGroupColor(c.group) }}
                          />
                          <div
                            className="face left"
                            style={{ backgroundColor: getGroupColor(c.group) }}
                          />
                          <div
                            className="face top"
                            style={{ backgroundColor: getGroupColor(c.group) }}
                          />
                          <div
                            className="face bottom"
                            style={{ backgroundColor: getGroupColor(c.group) }}
                          />
                        </div>
                      );
                    })}
                  </div>
                </div>
              </div>
            </main>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
