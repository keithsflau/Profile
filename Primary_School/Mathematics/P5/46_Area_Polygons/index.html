<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Â∞è‰∫îÊï∏Â≠∏ÔºöÂ§öÈÇäÂΩ¢Èù¢Á©ç | Area of Polygons</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/lucide-react@latest/dist/umd/lucide-react.min.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&family=Outfit:wght@400;600;800&family=JetBrains+Mono:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Outfit", "Noto Sans TC", sans-serif;
        background: #0f172a;
        color: white;
        overflow-x: hidden;
      }
      .glass-panel {
        background: rgba(21, 128, 61, 0.2); /* Green 700 alpha */
        backdrop-filter: blur(12px);
        border: 1px solid rgba(74, 222, 128, 0.1);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      }
      .shape-path {
        transition: d 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion } = window.Motion;
      const { Ruler, Triangle, Square, Layers, Calculator } =
        window.LucideReact;
      const { LanguageSelector } = window.MathI18n || {
        LanguageSelector: () => null,
      };

      const t = {
        title: {
          en: "Area of Polygons",
          zh: "Â§öÈÇäÂΩ¢Èù¢Á©ç",
          ja: "Â§öËßíÂΩ¢„ÅÆÈù¢Á©ç",
          ko: "Îã§Í∞ÅÌòïÏùò ÎÑìÏù¥",
          es: "√Årea de Pol√≠gonos",
          de: "Fl√§cheninhalt",
          fi: "Pinta-ala",
          fr: "Aire des polygones",
          ar: "ŸÖÿ≥ÿßÿ≠ÿ© ÿßŸÑŸÖÿ∂ŸÑÿπÿßÿ™",
          it: "Area dei poligoni",
        },
        triangle: {
          en: "Triangle",
          zh: "‰∏âËßíÂΩ¢",
          ja: "‰∏âËßíÂΩ¢",
          ko: "ÏÇºÍ∞ÅÌòï",
          es: "Tri√°ngulo",
          de: "Dreieck",
          fi: "Kolmio",
          fr: "Triangle",
          ar: "ŸÖÿ´ŸÑÿ´",
          it: "Triangolo",
        },
        parallelogram: {
          en: "Parallelogram",
          zh: "Âπ≥Ë°åÂõõÈÇäÂΩ¢",
          ja: "Âπ≥Ë°åÂõõËæ∫ÂΩ¢",
          ko: "ÌèâÌñâÏÇ¨Î≥ÄÌòï",
          es: "Paralelogramo",
          de: "Parallelogramm",
          fi: "Suunnikas",
          fr: "Parall√©logramme",
          ar: "ŸÖÿ™Ÿàÿßÿ≤Ÿä ÿßŸÑÿ£ÿ∂ŸÑÿßÿπ",
          it: "Parallelogramma",
        },
        trapezium: {
          en: "Trapezium",
          zh: "Ê¢ØÂΩ¢",
          ja: "Âè∞ÂΩ¢",
          ko: "ÏÇ¨Îã§Î¶¨Íº¥",
          es: "Trapecio",
          de: "Trapez",
          fi: "Puolisuunnikas",
          fr: "Trap√®ze",
          ar: "ÿ¥ÿ®Ÿá ŸÖŸÜÿ≠ÿ±ŸÅ",
          it: "Trapezio",
        },
        base: {
          en: "Base",
          zh: "Â∫ï",
          ja: "Â∫ïËæ∫",
          ko: "Î∞ëÎ≥Ä",
          es: "Base",
          de: "Basis",
          fi: "Kanta",
          fr: "Base",
          ar: "ÿßŸÑŸÇÿßÿπÿØÿ©",
          it: "Base",
        },
        topBase: {
          en: "Top Base",
          zh: "‰∏äÂ∫ï",
          ja: "‰∏äÂ∫ï",
          ko: "ÏúóÎ≥Ä",
          es: "Base Sup.",
          de: "Obere Basis",
          fi: "Yl√§kanta",
          fr: "Petite base",
          ar: "ÿßŸÑŸÇÿßÿπÿØÿ© ÿßŸÑÿπŸÑŸäÿß",
          it: "Base Superiore",
        },
        bottomBase: {
          en: "Bottom Base",
          zh: "‰∏ãÂ∫ï",
          ja: "‰∏ãÂ∫ï",
          ko: "ÏïÑÎû´Î≥Ä",
          es: "Base Inf.",
          de: "Untere Basis",
          fi: "Alakanta",
          fr: "Grande base",
          ar: "ÿßŸÑŸÇÿßÿπÿØÿ© ÿßŸÑÿ≥ŸÅŸÑŸâ",
          it: "Base Inferiore",
        },
        height: {
          en: "Height",
          zh: "È´ò",
          ja: "È´ò„Åï",
          ko: "ÎÜíÏù¥",
          es: "Altura",
          de: "H√∂he",
          fi: "Korkeus",
          fr: "Hauteur",
          ar: "ÿßŸÑÿßÿ±ÿ™ŸÅÿßÿπ",
          it: "Altezza",
        },
        formula: {
          en: "Formula",
          zh: "ÂÖ¨Âºè",
          ja: "ÂÖ¨Âºè",
          ko: "Í≥µÏãù",
          es: "F√≥rmula",
          de: "Formel",
          fi: "Kaava",
          fr: "Formule",
          ar: "ÿßŸÑÿµŸäÿ∫ÿ©",
          it: "Formula",
        },
        calc: {
          en: "Calculation",
          zh: "Ë®àÁÆó",
          ja: "Ë®àÁÆó",
          ko: "Í≥ÑÏÇ∞",
          es: "C√°lculo",
          de: "Rechnung",
          fi: "Lasku",
          fr: "Calcul",
          ar: "ÿ≠ÿ≥ÿßÿ®",
          it: "Calcolo",
        },
        area: {
          en: "Area",
          zh: "Èù¢Á©ç",
          ja: "Èù¢Á©ç",
          ko: "ÎÑìÏù¥",
          es: "√Årea",
          de: "Fl√§che",
          fi: "Pinta-ala",
          fr: "Aire",
          ar: "ŸÖÿ≥ÿßÿ≠ÿ©",
          it: "Area",
        },
      };

      const getText = (key, lang) => t[key]?.[lang] || t[key]?.["en"] || key;

      function App() {
        const [lang, setLang] = useState("zh");
        const [shape, setShape] = useState("triangle");
        const [base, setBase] = useState(10);
        const [height, setHeight] = useState(8);
        const [topBase, setTopBase] = useState(6);

        const getArea = () => {
          if (shape === "triangle") return (base * height) / 2;
          if (shape === "parallelogram") return base * height;
          if (shape === "trapezium") return ((base + topBase) * height) / 2;
          return 0;
        };

        const getFormulaDisplay = () => {
          if (shape === "triangle")
            return `(${getText("base", lang)} √ó ${getText(
              "height",
              lang
            )}) √∑ 2`;
          if (shape === "parallelogram")
            return `${getText("base", lang)} √ó ${getText("height", lang)}`;
          if (shape === "trapezium")
            return `(${getText("topBase", lang)} + ${getText(
              "bottomBase",
              lang
            )}) √ó ${getText("height", lang)} √∑ 2`;
        };

        const getCalcDisplay = () => {
          if (shape === "triangle") return `(${base} √ó ${height}) √∑ 2`;
          if (shape === "parallelogram") return `${base} √ó ${height}`;
          if (shape === "trapezium")
            return `(${topBase} + ${base}) √ó ${height} √∑ 2`;
        };

        const getPath = () => {
          const scale = 15;
          const cx = 200;
          const by = 300; // Bottom Y

          const bPx = base * scale;
          const hPx = height * scale;
          const tPx = topBase * scale;

          if (shape === "triangle") {
            return `M${cx},${by - hPx} L${cx + bPx / 2},${by} L${
              cx - bPx / 2
            },${by} Z`;
          } else if (shape === "parallelogram") {
            const slant = hPx * 0.4;
            const sx = cx - bPx / 2 - slant / 2;
            return `M${sx + slant},${by - hPx} L${sx + slant + bPx},${
              by - hPx
            } L${sx + bPx},${by} L${sx},${by} Z`;
          } else {
            // Trapezium
            return `M${cx - tPx / 2},${by - hPx} L${cx + tPx / 2},${
              by - hPx
            } L${cx + bPx / 2},${by} L${cx - bPx / 2},${by} Z`;
          }
        };

        return (
          <div className="min-h-screen flex flex-col items-center p-4">
            <div className="w-full max-w-6xl flex justify-between items-center mb-6">
              <h1 className="text-3xl md:text-5xl font-black text-green-400 drop-shadow-[0_0_15px_rgba(74,222,128,0.5)]">
                üìê {getText("title", lang)}
              </h1>
              <div className="bg-slate-800/80 p-1.5 rounded-xl border border-white/10 flex flex-wrap justify-end gap-1">
                {[
                  "zh",
                  "en",
                  "ja",
                  "ko",
                  "es",
                  "de",
                  "fi",
                  "fr",
                  "ar",
                  "it",
                ].map((l) => (
                  <button
                    key={l}
                    onClick={() => setLang(l)}
                    className={`px-3 py-1.5 rounded-lg font-bold text-xs uppercase transition-all ${
                      lang === l
                        ? "bg-green-600 text-white shadow-lg scale-105"
                        : "text-slate-400 hover:text-white hover:bg-white/5"
                    }`}
                  >
                    {l}
                  </button>
                ))}
              </div>
            </div>

            <main className="w-full max-w-6xl grid lg:grid-cols-12 gap-6">
              {/* Visualizer */}
              <div className="lg:col-span-8 flex flex-col gap-6">
                {/* Shape Selector */}
                <div className="glass-panel p-2 rounded-2xl flex justify-center gap-2">
                  {[
                    {
                      id: "triangle",
                      icon: <Triangle size={20} />,
                      label: "triangle",
                    },
                    {
                      id: "parallelogram",
                      icon: <Square size={20} className="skew-x-6" />,
                      label: "parallelogram",
                    },
                    {
                      id: "trapezium",
                      icon: <Layers size={20} />,
                      label: "trapezium",
                    },
                  ].map((s) => (
                    <button
                      key={s.id}
                      onClick={() => setShape(s.id)}
                      className={`flex items-center gap-2 px-6 py-3 rounded-xl font-bold transition-all ${
                        shape === s.id
                          ? "bg-green-600 text-white shadow-lg shadow-green-900/50"
                          : "text-green-300 hover:bg-white/5"
                      }`}
                    >
                      {s.icon} <span>{getText(s.label, lang)}</span>
                    </button>
                  ))}
                </div>

                <div className="glass-panel p-8 rounded-3xl flex items-center justify-center min-h-[400px] overflow-hidden relative">
                  <div
                    className="absolute inset-0 grid-bg opacity-20 pointer-events-none"
                    style={{
                      backgroundImage:
                        "linear-gradient(rgba(255,255,255,0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px)",
                      backgroundSize: "20px 20px",
                    }}
                  ></div>

                  <svg
                    width="600"
                    height="400"
                    viewBox="0 0 400 350"
                    className="drop-shadow-[0_0_20px_rgba(34,197,94,0.3)] max-w-full"
                  >
                    <defs>
                      <linearGradient
                        id="gradShape"
                        x1="0%"
                        y1="0%"
                        x2="0%"
                        y2="100%"
                      >
                        <stop
                          offset="0%"
                          stopColor="#4ade80"
                          stopOpacity="0.4"
                        />
                        <stop
                          offset="100%"
                          stopColor="#16a34a"
                          stopOpacity="0.6"
                        />
                      </linearGradient>
                    </defs>

                    {/* Shape */}
                    <path
                      d={getPath()}
                      fill="url(#gradShape)"
                      stroke="#86efac"
                      strokeWidth="3"
                      className="shape-path"
                    />

                    {/* Height Indicator */}
                    {(() => {
                      const scale = 15;
                      const cx = 200;
                      const by = 300;
                      const hPx = height * scale;
                      return (
                        <g>
                          <line
                            x1={cx}
                            y1={by}
                            x2={cx}
                            y2={by - hPx}
                            stroke="#fcd34d"
                            strokeWidth="2"
                            strokeDasharray="6,4"
                          />
                          <text
                            x={cx + 8}
                            y={by - hPx / 2}
                            fill="#fcd34d"
                            fontSize="16"
                            fontWeight="bold"
                            fontFamily="monospace"
                          >
                            h={height}
                          </text>
                        </g>
                      );
                    })()}

                    {/* Base Indicators - Render text dynamically based on scale logic if needed, but simple bottom center is fine */}
                    <text
                      x="200"
                      y="330"
                      textAnchor="middle"
                      fill="#86efac"
                      fontSize="16"
                      fontWeight="bold"
                      fontFamily="monospace"
                    >
                      {shape === "trapezium"
                        ? `Bottom Base = ${base}`
                        : `Base = ${base}`}
                    </text>

                    {shape === "trapezium" && (
                      <text
                        x="200"
                        y={300 - height * 15 - 15}
                        textAnchor="middle"
                        fill="#86efac"
                        fontSize="16"
                        fontWeight="bold"
                        fontFamily="monospace"
                      >
                        Top Base = {topBase}
                      </text>
                    )}
                  </svg>
                </div>
              </div>

              {/* Controls & Math */}
              <div className="lg:col-span-4 flex flex-col gap-6">
                <div className="glass-panel p-6 rounded-3xl flex flex-col gap-6">
                  <h3 className="text-xl font-bold text-green-300 flex items-center gap-2">
                    <Ruler size={20} /> {getText("calc", lang)}
                  </h3>

                  {/* Sliders */}
                  {[
                    {
                      label: shape === "trapezium" ? "bottomBase" : "base",
                      val: base,
                      set: setBase,
                      max: 20,
                    },
                    { label: "height", val: height, set: setHeight, max: 15 },
                    ...(shape === "trapezium"
                      ? [
                          {
                            label: "topBase",
                            val: topBase,
                            set: setTopBase,
                            max: 15,
                          },
                        ]
                      : []),
                  ].map((s) => (
                    <div key={s.label}>
                      <div className="flex justify-between text-sm text-slate-300 mb-2 font-bold">
                        <span>{getText(s.label, lang)}</span>
                        <span className="text-white bg-slate-700 px-2 py-0.5 rounded shadow">
                          {s.val}
                        </span>
                      </div>
                      <input
                        type="range"
                        min="2"
                        max={s.max}
                        value={s.val}
                        onChange={(e) => s.set(Number(e.target.value))}
                        className="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-green-500"
                      />
                    </div>
                  ))}
                </div>

                <div className="glass-panel p-6 rounded-3xl flex-1 flex flex-col relative overflow-hidden">
                  <div className="relative z-10 flex flex-col h-full justify-between">
                    <div>
                      <h3 className="text-green-300 text-sm font-bold uppercase tracking-widest mb-4 flex items-center gap-2">
                        <Calculator size={16} /> {getText("formula", lang)}
                      </h3>
                      <div className="text-white font-mono text-sm md:text-base bg-slate-900/50 p-3 rounded-lg border border-white/5 mb-4">
                        {getFormulaDisplay()}
                      </div>

                      <h3 className="text-green-300 text-sm font-bold uppercase tracking-widest mb-2">
                        {getText("calc", lang)}
                      </h3>
                      <div className="text-yellow-400 font-mono text-lg md:text-xl">
                        = {getCalcDisplay()}
                      </div>
                    </div>

                    <motion.div
                      className="mt-8 pt-8 border-t border-white/10"
                      layout
                    >
                      <div className="flex justify-between items-end">
                        <span className="text-slate-400 font-bold uppercase tracking-widest text-sm">
                          {getText("area", lang)}
                        </span>
                        <span className="text-5xl font-black text-white drop-shadow-[0_0_10px_rgba(255,255,255,0.5)]">
                          {getArea()}
                        </span>
                      </div>
                    </motion.div>
                  </div>
                </div>
              </div>
            </main>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
