<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>小五數學：體積初探</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%);
      }
      .scene {
        perspective: 1000px;
        transform-style: preserve-3d;
      }
      .cuboid-container {
        position: relative;
        transform-style: preserve-3d;
        transform: rotateX(-30deg) rotateY(45deg);
        transition: transform 0.5s ease;
      }
      .cube {
        position: absolute;
        width: 40px;
        height: 40px;
        transform-style: preserve-3d;
      }
      .face {
        position: absolute;
        width: 40px;
        height: 40px;
        border: 1px solid rgba(255, 255, 255, 0.4);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 10px;
        font-weight: bold;
        color: rgba(0, 0, 0, 0.1);
      }
      .front {
        transform: rotateY(0deg) translateZ(20px);
        background: rgba(59, 130, 246, 0.9);
      }
      .right {
        transform: rotateY(90deg) translateZ(20px);
        background: rgba(37, 99, 235, 0.9);
      }
      .left {
        transform: rotateY(-90deg) translateZ(20px);
        background: rgba(37, 99, 235, 0.9);
      }
      .back {
        transform: rotateY(180deg) translateZ(20px);
        background: rgba(59, 130, 246, 0.9);
      }
      .top {
        transform: rotateX(90deg) translateZ(20px);
        background: rgba(96, 165, 250, 0.9);
      }
      .bottom {
        transform: rotateX(-90deg) translateZ(20px);
        background: rgba(96, 165, 250, 0.9);
      }

      /* Slider Styling */
      input[type="range"] {
        -webkit-appearance: none;
        background: transparent;
      }
      input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
      }
      input[type="range"]:focus {
        outline: none;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState } = React;

      const Box = (props) => (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width={props.size || 24}
          height={props.size || 24}
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          strokeWidth="2"
          strokeLinecap="round"
          strokeLinejoin="round"
          {...props}
        >
          <path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z" />
          <path d="m3.3 7 8.7 5 8.7-5" />
          <path d="M12 22V12" />
        </svg>
      );

      function App() {
        const [dims, setDims] = useState({ l: 3, w: 2, h: 4 });
        const [isExploded, setIsExploded] = useState(false);

        const updateDim = (k, v) =>
          setDims((p) => ({ ...p, [k]: parseInt(v) }));

        const cubes = [];
        // Generate cubes
        // We center the whole block
        // x goes from 0 to l-1
        // y goes from 0 to h-1 (height usually maps to -y or z in web)
        // z goes from 0 to w-1

        // CSS 3D coordinate system:
        // X right, Y down, Z towards viewer
        // We want Y up (negative Y) for height

        for (let x = 0; x < dims.l; x++) {
          for (let y = 0; y < dims.h; y++) {
            for (let z = 0; z < dims.w; z++) {
              cubes.push({ x, y, z });
            }
          }
        }

        const size = 40;
        const offsetStep = isExploded ? 60 : 40;

        // Center offsets
        const cx = (dims.l * offsetStep) / 2;
        const cy = (dims.h * offsetStep) / 2;
        const cz = (dims.w * offsetStep) / 2;

        return (
          <div className="min-h-screen flex flex-col items-center justify-center p-4 overflow-hidden">
            <div className="flex w-fullmax-w-6xl gap-8 flex-col lg:flex-row items-center justify-center">
              {/* Controls */}
              <div className="bg-white/90 backdrop-blur-xl p-8 rounded-3xl shadow-2xl w-full max-w-md border-4 border-white z-10">
                <h1 className="text-3xl font-black text-slate-800 mb-8 flex items-center gap-3">
                  <Box className="text-blue-500" size={32} />
                  體積計算機
                </h1>

                {["l", "w", "h"].map((d, i) => {
                  const labels = {
                    l: "長 Length",
                    w: "闊 Width",
                    h: "高 Height",
                  };
                  const colors = {
                    l: "text-blue-500",
                    w: "text-purple-500",
                    h: "text-green-500",
                  };
                  const bgColors = {
                    l: "accent-blue-500",
                    w: "accent-purple-500",
                    h: "accent-green-500",
                  };
                  return (
                    <div key={d} className="mb-6">
                      <div className="flex justify-between font-bold text-slate-500 mb-2">
                        <span className={colors[d]}>{labels[d]}</span>
                        <span className="text-2xl text-slate-800">
                          {dims[d]}
                        </span>
                      </div>
                      <input
                        type="range"
                        min="1"
                        max="6"
                        value={dims[d]}
                        onChange={(e) => updateDim(d, e.target.value)}
                        className={`w-full h-3 bg-slate-200 rounded-full cursor-pointer appearance-none ${bgColors[d]}`}
                      />
                    </div>
                  );
                })}

                <div className="mt-8 pt-8 border-t-2 border-slate-100">
                  <div className="flex items-center justify-center gap-4 text-4xl font-black text-slate-700 bg-slate-50 p-4 rounded-2xl">
                    <span className="text-blue-500">{dims.l}</span>
                    <span className="text-slate-300">×</span>
                    <span className="text-purple-500">{dims.w}</span>
                    <span className="text-slate-300">×</span>
                    <span className="text-green-500">{dims.h}</span>
                    <span className="text-slate-300">=</span>
                    <span className="text-slate-800">
                      {dims.l * dims.w * dims.h}
                    </span>
                  </div>
                  <div className="text-center mt-2 text-slate-400 font-bold text-sm">
                    體積 (Volume) = 長 × 闊 × 高
                  </div>
                </div>

                <div className="mt-6 flex justify-center">
                  <label className="flex items-center gap-2 cursor-pointer bg-slate-100 px-4 py-2 rounded-full font-bold text-slate-600 hover:bg-slate-200 transition-colors">
                    <input
                      type="checkbox"
                      checked={isExploded}
                      onChange={(e) => setIsExploded(e.target.checked)}
                      className="w-5 h-5 rounded text-blue-500"
                    />
                    <span>分解方塊 (Explode)</span>
                  </label>
                </div>
              </div>

              {/* 3D View */}
              <div
                className="w-full lg:w-[600px] h-[500px] relative flex items-center justify-center scene ml-0 lg:ml-12"
                style={{ perspective: "1200px" }}
              >
                <div className="cuboid-container">
                  {cubes.map((c, i) => (
                    <div
                      key={i}
                      className="cube transition-all duration-500 ease-out"
                      style={{
                        transform: `translate3d(${c.x * offsetStep - cx}px, ${
                          -c.y * offsetStep + cy
                        }px, ${c.z * offsetStep - cz}px)`,
                      }}
                    >
                      <div className="face front"></div>
                      <div className="face back"></div>
                      <div className="face right"></div>
                      <div className="face left"></div>
                      <div className="face top"></div>
                      <div className="face bottom"></div>
                    </div>
                  ))}
                </div>

                {/* Floor circle for grounding */}
                <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-black/10 rounded-full blur-xl -z-10 transform rotateX(60deg) translateZ(-200px)"></div>
              </div>
            </div>

            <div className="fixed bottom-4 left-4">
              <a
                href="../index.html"
                className="bg-white/80 backdrop-blur hover:bg-white text-slate-600 px-6 py-3 rounded-full font-bold shadow-lg flex items-center gap-2 transition-all"
              >
                ← 返回目錄
              </a>
            </div>
          </div>
        );
      }

      lucide.createIcons();
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
