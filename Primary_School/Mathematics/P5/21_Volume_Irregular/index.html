<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Â∞è‰∫îÊï∏Â≠∏Ôºö‰∏çË¶èÂâáÈ´îÁ©ç | Irregular Volume</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&family=Outfit:wght@400;600;800&family=JetBrains+Mono:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <script src="../../common/i18n.js"></script>
    <style>
      body {
        font-family: "Outfit", "Noto Sans TC", sans-serif;
        background: #0f172a;
        color: white;
        overflow-x: hidden;
      }
      .glass-panel {
        background: rgba(30, 41, 59, 0.7);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;
      const { motion, AnimatePresence } = window.Motion;
      const { LanguageSelector } = window.MathI18n || {
        LanguageSelector: () => null,
      };

      const t = {
        title: {
          en: "Irregular Volume",
          zh: "‰∏çË¶èÂâáÈ´îÁ©ç",
          ja: "‰∏çË¶èÂâá„Å™‰ΩìÁ©ç",
          ko: "Î∂àÍ∑úÏπôÌïú Î∂ÄÌîº",
          es: "Volumen Irregular",
          de: "Unregelm√§√üiges Volumen",
          fi: "Ep√§s√§√§nn√∂llinen tilavuus",
          fr: "Volume irr√©gulier",
          ar: "ÿ≠ÿ¨ŸÖ ÿ∫Ÿäÿ± ŸÖŸÜÿ™ÿ∏ŸÖ",
          it: "Volume irregolare",
        },
        method1: {
          en: "Split Method",
          zh: "ÂàÜÂâ≤Ê≥ï",
          ja: "ÂàÜÂâ≤Ê≥ï",
          ko: "Î∂ÑÌï†Î≤ï",
          es: "M√©todo de Divisi√≥n",
          de: "Aufteilungsmethode",
          fi: "Jakomenetelm√§",
          fr: "M√©thode de division",
          ar: "ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿ™ŸÇÿ≥ŸäŸÖ",
          it: "Metodo di divisione",
        },
        method2: {
          en: "Complete & Subtract",
          zh: "Â°´Ë£úÊ≥ï",
          ja: "Ë£úÂÆåÊ≥ï",
          ko: "Î≥¥ÏôÑÎ≤ï",
          es: "M√©todo de Sustracci√≥n",
          de: "Subtraktionsmethode",
          fi: "V√§hennysmenetelm√§",
          fr: "M√©thode de soustraction",
          ar: "ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿ∑ÿ±ÿ≠",
          it: "Metodo di sottrazione",
        },
        total: {
          en: "Total Volume",
          zh: "Á∏ΩÈ´îÁ©ç",
          ja: "Á∑è‰ΩìÁ©ç",
          ko: "Ï¥ù Î∂ÄÌîº",
          es: "Volumen Total",
          de: "Gesamtvolumen",
          fi: "Kokonaistilavuus",
          fr: "Volume total",
          ar: "ÿßŸÑÿ≠ÿ¨ŸÖ ÿßŸÑŸÉŸÑŸä",
          it: "Volume totale",
        },
        partA: {
          en: "Part A",
          zh: "ÈÉ®ÂàÜ A",
          ja: "„Éë„Éº„Éà A",
          ko: "ÌååÌä∏ A",
          es: "Parte A",
          de: "Teil A",
          fi: "Osa A",
          fr: "Partie A",
          ar: "ÿ¨ÿ≤ÿ° A",
          it: "Parte A",
        },
        partB: {
          en: "Part B",
          zh: "ÈÉ®ÂàÜ B",
          ja: "„Éë„Éº„Éà B",
          ko: "ÌååÌä∏ B",
          es: "Parte B",
          de: "Teil B",
          fi: "Osa B",
          fr: "Partie B",
          ar: "ÿ¨ÿ≤ÿ° B",
          it: "Parte B",
        },
        whole: {
          en: "Whole Block",
          zh: "ÂÆåÊï¥Èï∑ÊñπÈ´î",
          ja: "ÂÖ®‰Ωì„ÅÆ„Éñ„É≠„ÉÉ„ÇØ",
          ko: "Ï†ÑÏ≤¥ Î∏îÎ°ù",
          es: "Bloque Completo",
          de: "Ganzer Block",
          fi: "Koko lohko",
          fr: "Bloc entier",
          ar: "ÿßŸÑŸÉÿ™ŸÑÿ© ÿßŸÑŸÉÿßŸÖŸÑÿ©",
          it: "Blocco intero",
        },
        missing: {
          en: "Missing Part",
          zh: "Áº∫Âè£ÈÉ®ÂàÜ",
          ja: "Ê¨†„Åë„ÅüÈÉ®ÂàÜ",
          ko: "Îπà Î∂ÄÎ∂Ñ",
          es: "Parte Faltante",
          de: "Fehlender Teil",
          fi: "Puuttuva osa",
          fr: "Partie manquante",
          ar: "ÿßŸÑÿ¨ÿ≤ÿ° ÿßŸÑŸÖŸÅŸÇŸàÿØ",
          it: "Parte mancante",
        },
      };

      const getText = (key, lang) => t[key]?.[lang] || t[key]?.["en"] || key;

      function App() {
        const [lang, setLang] = useState("zh");
        const [method, setMethod] = useState("split");
        const [animate, setAnimate] = useState(false);

        useEffect(() => {
          setAnimate(true);
          const timer = setTimeout(() => setAnimate(false), 2000);
        }, [method]);

        // Isometric Projection: (x-y), (x+y) version
        const iso = (x, y, z) => {
          const angle = 30 * (Math.PI / 180);
          const isoX = (x - y) * Math.cos(angle);
          const isoY = (x + y) * Math.sin(angle) - z; // z is Up
          return { x: 400 + isoX * 20, y: 300 + isoY * 20 };
        };

        const Face = ({ p1, p2, p3, p4, color, opacity = 1 }) => (
          <path
            d={`M ${p1.x} ${p1.y} L ${p2.x} ${p2.y} L ${p3.x} ${p3.y} L ${p4.x} ${p4.y} Z`}
            fill={color}
            stroke="rgba(255,255,255,0.4)"
            strokeWidth="1.5"
            fillOpacity={opacity}
          />
        );

        const Cuboid = ({
          x,
          y,
          z,
          w,
          d,
          h,
          color,
          delay = 0,
          visible = true,
        }) => {
          const p = [
            iso(x, y, z), // 0
            iso(x + w, y, z), // 1
            iso(x + w, y + d, z), // 2
            iso(x, y + d, z), // 3
            iso(x, y, z + h), // 4
            iso(x + w, y, z + h), // 5
            iso(x + w, y + d, z + h), // 6
            iso(x, y + d, z + h), // 7
          ];

          return (
            <motion.g
              initial={{ opacity: 0, y: -20 }}
              animate={{ opacity: visible ? 1 : 0, y: 0 }}
              transition={{ delay: delay, duration: 0.5 }}
            >
              {/* Left Face (y=d plane) - Front Left */}
              <Face
                p1={p[3]}
                p2={p[2]}
                p3={p[6]}
                p4={p[7]}
                color={color === "#ef4444" ? "#b91c1c" : "#0e7490"} // Darkest
                opacity={0.9}
              />

              {/* Right Face (x=w plane) - Front Right */}
              <Face
                p1={p[1]}
                p2={p[2]}
                p3={p[6]}
                p4={p[5]}
                color={color === "#ef4444" ? "#dc2626" : "#06b6d4"} // Medium
                opacity={0.8}
              />

              {/* Top Face (z=h plane) */}
              <Face
                p1={p[4]}
                p2={p[5]}
                p3={p[6]}
                p4={p[7]}
                color={color === "#ef4444" ? "#f87171" : "#22d3ee"} // Lightest
                opacity={1}
              />
            </motion.g>
          );
        };

        return (
          <div className="min-h-screen flex flex-col items-center p-4 font-sans bg-slate-900 text-white">
            <div className="w-full max-w-5xl flex justify-between items-center mb-10">
              <h1 className="text-4xl font-black text-cyan-400 drop-shadow-[0_0_15px_rgba(34,211,238,0.5)]">
                üî∑ {getText("title", lang)}
              </h1>
              <div className="flex bg-slate-800/80 p-1.5 rounded-xl border border-white/10 flex-wrap justify-end gap-1 max-w-[50%]">
                {[
                  "zh",
                  "en",
                  "ja",
                  "ko",
                  "es",
                  "de",
                  "fi",
                  "fr",
                  "ar",
                  "it",
                ].map((l) => (
                  <button
                    key={l}
                    onClick={() => setLang(l)}
                    className={`px-3 py-1.5 rounded-lg font-bold text-xs uppercase transition-all ${
                      lang === l
                        ? "bg-cyan-600 text-white shadow-lg scale-105"
                        : "text-slate-400 hover:text-white hover:bg-white/5"
                    }`}
                  >
                    {l}
                  </button>
                ))}
              </div>
            </div>

            <div className="flex gap-4 mb-8 bg-slate-800 p-2 rounded-2xl">
              <button
                onClick={() => setMethod("split")}
                className={`px-6 py-3 rounded-xl font-bold transition-all ${
                  method === "split"
                    ? "bg-cyan-500 text-white shadow-lg"
                    : "text-slate-400 hover:bg-white/5"
                }`}
              >
                {getText("method1", lang)}
              </button>
              <button
                onClick={() => setMethod("subtract")}
                className={`px-6 py-3 rounded-xl font-bold transition-all ${
                  method === "subtract"
                    ? "bg-cyan-500 text-white shadow-lg"
                    : "text-slate-400 hover:bg-white/5"
                }`}
              >
                {getText("method2", lang)}
              </button>
            </div>

            <div className="w-full max-w-6xl flex flex-col lg:flex-row gap-8 items-center">
              <div className="flex-1 w-full glass-panel rounded-3xl overflow-hidden relative min-h-[500px] flex items-center justify-center border-4 border-slate-700/50">
                <svg viewBox="0 0 800 600" className="w-full h-full">
                  {method === "split" ? (
                    <>
                      {/* Part A (Back Left) - Draw First */}
                      <Cuboid
                        x={0}
                        y={0}
                        z={0}
                        w={4}
                        d={4}
                        h={8}
                        color="#0891b2"
                        delay={0}
                      />
                      {/* Part B (Front Right) - Draw Second */}
                      <Cuboid
                        x={4}
                        y={0}
                        z={0}
                        w={4}
                        d={4}
                        h={4}
                        color="#06b6d4"
                        delay={0.2}
                      />

                      {/* Labels */}
                      <text
                        x="350"
                        y="200"
                        fill="white"
                        fontSize="28"
                        fontWeight="bold"
                        filter="drop-shadow(0 2px 2px rgba(0,0,0,0.8))"
                      >
                        A
                      </text>
                      <text
                        x="500"
                        y="380"
                        fill="white"
                        fontSize="28"
                        fontWeight="bold"
                        filter="drop-shadow(0 2px 2px rgba(0,0,0,0.8))"
                      >
                        B
                      </text>
                    </>
                  ) : (
                    <>
                      {/* Whole Block Parts - Back to Front */}
                      <Cuboid
                        x={0}
                        y={0}
                        z={0}
                        w={4}
                        d={4}
                        h={8}
                        color="#06b6d4"
                      />
                      <Cuboid
                        x={4}
                        y={0}
                        z={0}
                        w={4}
                        d={4}
                        h={4}
                        color="#06b6d4"
                      />

                      {/* Missing Part (Ghost) - Top Front Right */}
                      <Cuboid
                        x={4}
                        y={0}
                        z={4}
                        w={4}
                        d={4}
                        h={4}
                        color="#ef4444"
                        delay={0.5}
                        visible={true}
                      />
                    </>
                  )}
                </svg>
              </div>

              <div className="w-full lg:w-96 flex flex-col gap-6">
                <div className="glass-panel p-8 rounded-3xl">
                  {method === "split" ? (
                    <div className="space-y-6">
                      <div>
                        <div className="text-cyan-400 font-bold uppercase tracking-widest text-xs mb-1">
                          {getText("partA", lang)}
                        </div>
                        <div className="text-2xl font-mono text-white">
                          4 √ó 4 √ó 8 = <span className="font-bold">128</span>
                        </div>
                      </div>
                      <div>
                        <div className="text-cyan-400 font-bold uppercase tracking-widest text-xs mb-1">
                          {getText("partB", lang)}
                        </div>
                        <div className="text-2xl font-mono text-white">
                          4 √ó 4 √ó 4 = <span className="font-bold">64</span>
                        </div>
                      </div>
                      <div className="pt-6 border-t border-white/10">
                        <div className="text-slate-400 font-bold uppercase tracking-widest text-xs mb-1">
                          {getText("total", lang)}
                        </div>
                        <div className="text-5xl font-black text-cyan-300">
                          192
                        </div>
                        <div className="text-sm font-mono text-cyan-500/80 mt-1">
                          128 + 64
                        </div>
                      </div>
                    </div>
                  ) : (
                    <div className="space-y-6">
                      <div>
                        <div className="text-cyan-400 font-bold uppercase tracking-widest text-xs mb-1">
                          {getText("whole", lang)}
                        </div>
                        <div className="text-2xl font-mono text-white">
                          8 √ó 4 √ó 8 = <span className="font-bold">256</span>
                        </div>
                      </div>
                      <div>
                        <div className="text-red-400 font-bold uppercase tracking-widest text-xs mb-1">
                          {getText("missing", lang)}
                        </div>
                        <div className="text-2xl font-mono text-white">
                          4 √ó 4 √ó 4 ={" "}
                          <span className="font-bold text-red-400">64</span>
                        </div>
                      </div>
                      <div className="pt-6 border-t border-white/10">
                        <div className="text-slate-400 font-bold uppercase tracking-widest text-xs mb-1">
                          {getText("total", lang)}
                        </div>
                        <div className="text-5xl font-black text-cyan-300">
                          192
                        </div>
                        <div className="text-sm font-mono text-cyan-500/80 mt-1">
                          256 - 64
                        </div>
                      </div>
                    </div>
                  )}
                </div>
              </div>
            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
