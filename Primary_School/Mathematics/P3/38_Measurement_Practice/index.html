<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Â∞è‰∏âÊï∏Â≠∏ÔºöÈï∑Â∫¶ÈáèÂ∫¶Â§ßÂ∏´ | Measurement Master</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="../../common/i18n.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: linear-gradient(135deg, #a5b4fc 0%, #6366f1 100%);
        overflow-x: hidden;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useRef, useEffect } = React;
      const { motion } = window.Motion;
      const { LanguageSelector, get } = window.MathI18n;

      const t = {
        title: {
          en: "Length Measurement Master",
          zh: "Èï∑Â∫¶ÈáèÂ∫¶Â§ßÂ∏´",
          ja: "Èï∑„ÅïÊ∏¨ÂÆö„Éû„Çπ„Çø„Éº",
          ko: "Í∏∏Ïù¥ Ï∏°Ï†ï ÎßàÏä§ÌÑ∞",
          es: "Maestro de medici√≥n de longitud",
          de: "L√§ngenmessmeister",
          fi: "Pituuden mittauksen mestari",
          fr: "Ma√Ætre de la mesure de longueur",
          ar: "ÿ≥ŸäÿØ ŸÇŸäÿßÿ≥ ÿßŸÑÿ∑ŸàŸÑ",
          it: "Maestro di misurazione della lunghezza",
        },
        score: {
          en: "Score",
          zh: "ÂæóÂàÜ",
          ja: "„Çπ„Ç≥„Ç¢",
          ko: "Ï†êÏàò",
          es: "Puntuaci√≥n",
          de: "Punktzahl",
          fi: "Pisteet",
          fr: "Score",
          ar: "ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ©",
          it: "Punteggio",
        },
        next: {
          en: "Next",
          zh: "‰∏ã‰∏ÄÈ°å",
          ja: "Ê¨°„Å∏",
          ko: "Îã§Ïùå",
          es: "Siguiente",
          de: "Weiter",
          fi: "Seuraava",
          fr: "Suivant",
          ar: "ÿßŸÑÿ™ÿßŸÑŸä",
          it: "Avanti",
        },
        start: {
          en: "Start",
          zh: "Ëµ∑Èªû",
          ja: "ÈñãÂßã",
          ko: "ÏãúÏûë",
          es: "Inicio",
          de: "Start",
          fi: "Alku",
          fr: "D√©but",
          ar: "ÿ®ÿØÿßŸäÿ©",
          it: "Inizio",
        },
        end: {
          en: "End",
          zh: "ÁµÇÈªû",
          ja: "ÁµÇ‰∫Ü",
          ko: "ÎÅù",
          es: "Fin",
          de: "Ende",
          fi: "Loppu",
          fr: "Fin",
          ar: "ŸÜŸáÿßŸäÿ©",
          it: "Fine",
        },
        dragTip: {
          en: "üëÜ Drag ruler to measure",
          zh: "üëÜ ÊãñÂãïÈñìÂ∞∫‰æÜÈáèÂ∫¶",
          ja: "üëÜ ÂÆöË¶è„Çí„Éâ„É©„ÉÉ„Ç∞„Åó„Å¶Ê∏¨ÂÆö",
          ko: "üëÜ ÏûêÎ•º ÎìúÎûòÍ∑∏ÌïòÏó¨ Ï∏°Ï†ï",
          es: "üëÜ Arrastra la regla para medir",
          de: "üëÜ Lineal ziehen zum Messen",
          fi: "üëÜ Ved√§ viivainta mitataksesi",
          fr: "üëÜ Faites glisser la r√®gle pour mesurer",
          ar: "üëÜ ÿßÿ≥ÿ≠ÿ® ÿßŸÑŸÖÿ≥ÿ∑ÿ±ÿ© ŸÑŸÑŸÇŸäÿßÿ≥",
          it: "üëÜ Trascina il righello per misurare",
        },
        lengthIs: {
          en: "Length is:",
          zh: "ÈÄôÊ¢ùÁ∑öÈï∑Â∫¶ÊòØÔºö",
          ja: "Èï∑„Åï„ÅØÔºö",
          ko: "Í∏∏Ïù¥Îäî:",
          es: "La longitud es:",
          de: "L√§nge ist:",
          fi: "Pituus on:",
          fr: "La longueur est :",
          ar: "ÿßŸÑÿ∑ŸàŸÑ ŸáŸà:",
          it: "La lunghezza √®:",
        },
        check: {
          en: "Check",
          zh: "Ê™¢Êü•",
          ja: "Á¢∫Ë™ç",
          ko: "ÌôïÏù∏",
          es: "Comprobar",
          de: "Pr√ºfen",
          fi: "Tarkista",
          fr: "V√©rifier",
          ar: "ÿ™ÿ≠ŸÇŸÇ",
          it: "Controlla",
        },
        correct: {
          en: "‚úì Correct!",
          zh: "‚úì Á≠îÂ∞ç‰∫ÜÔºÅ",
          ja: "‚úì Ê≠£Ëß£ÔºÅ",
          ko: "‚úì Ï†ïÎãµ!",
          es: "‚úì Correcto!",
          de: "‚úì Richtig!",
          fi: "‚úì Oikein!",
          fr: "‚úì Correct !",
          ar: "‚úì ÿµÿ≠Ÿäÿ≠!",
          it: "‚úì Corretto!",
        },
        incorrect: {
          en: "‚úó Try Again!",
          zh: "‚úó ÂÜçË©¶‰∏ÄÊ¨°ÔºÅ",
          ja: "‚úó „ÇÇ„ÅÜ‰∏ÄÂ∫¶ÔºÅ",
          ko: "‚úó Îã§Ïãú ÏãúÎèÑ!",
          es: "‚úó ¬°Int√©ntalo de nuevo!",
          de: "‚úó Versuch es nochmal!",
          fi: "‚úó Yrit√§ uudelleen!",
          fr: "‚úó R√©essayez !",
          ar: "‚úó ÿ≠ÿßŸàŸÑ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ!",
          it: "‚úó Riprova!",
        },
      };

      function App() {
        const [lang, setLang] = useState("zh");
        const [level, setLevel] = useState(1);
        const [targetLength, setTargetLength] = useState(0);
        const [rulerX, setRulerX] = useState(0);
        const [userInput, setUserInput] = useState("");
        const [feedback, setFeedback] = useState(null);
        const [score, setScore] = useState(0);

        const generateObject = () => {
          const len = Math.floor(Math.random() * 12) + 1; // 1 to 12 cm
          setTargetLength(len);
          setFeedback(null);
          setUserInput("");
          setRulerX(Math.random() * 200 - 100);
        };

        useEffect(() => {
          generateObject();
        }, [level]);

        const checkAnswer = () => {
          if (parseFloat(userInput) === targetLength) {
            setFeedback("correct");
            setScore((s) => s + 10);
          } else {
            setFeedback("incorrect");
          }
        };

        const getText = (key) => t[key][lang] || t[key]["en"];

        return (
          <div className="min-h-screen p-8 flex flex-col items-center select-none">
            <LanguageSelector lang={lang} setLang={setLang} />
            <h1 className="text-4xl md:text-6xl font-black text-white mb-8 mt-8 drop-shadow-md text-center">
              üìè {getText("title")}
            </h1>

            <div className="bg-white/90 backdrop-blur-md rounded-3xl p-8 shadow-2xl w-full max-w-4xl relative min-h-[500px] flex flex-col">
              <div className="flex justify-between items-center mb-8 bg-indigo-50 p-4 rounded-2xl">
                <div>
                  <span className="text-indigo-800 font-bold mr-2">
                    {getText("score")}:
                  </span>
                  <span className="text-3xl font-black text-indigo-600">
                    {score}
                  </span>
                </div>
                <button
                  onClick={generateObject}
                  className="bg-indigo-500 hover:bg-indigo-600 text-white px-6 py-2 rounded-xl font-bold transition-all"
                >
                  {getText("next")}
                </button>
              </div>

              {/* Measurement Area */}
              <div className="flex-1 bg-slate-100 rounded-2xl border-2 border-slate-200 relative overflow-hidden mb-8 flex items-center justify-center p-12">
                {/* Target Object */}
                <div
                  className="h-4 bg-gradient-to-r from-pink-500 to-rose-500 rounded shadow-lg absolute"
                  style={{
                    width: `${targetLength * 37.8}px`,
                    top: "40%",
                    left: "10%",
                  }}
                >
                  <div className="absolute -top-8 left-0 text-slate-400 font-bold text-xs whitespace-nowrap">
                    {getText("start")}
                  </div>
                  <div className="absolute -top-8 right-0 text-slate-400 font-bold text-xs whitespace-nowrap">
                    {getText("end")}
                  </div>
                  <div className="absolute -left-1 -bottom-2 w-0.5 h-6 bg-slate-400"></div>
                  <div className="absolute -right-1 -bottom-2 w-0.5 h-6 bg-slate-400"></div>
                </div>

                {/* Draggable Ruler */}
                <motion.div
                  drag="x"
                  dragMomentum={false}
                  className="absolute cursor-grab active:cursor-grabbing"
                  style={{ top: "60%", x: rulerX }}
                >
                  <div className="w-[600px] h-24 bg-yellow-100 border-b-4 border-yellow-600 rounded-lg shadow-xl relative flex items-end">
                    {/* Ruler Markings */}
                    {[...Array(16)].map((_, i) => (
                      <div
                        key={i}
                        className="absolute"
                        style={{ left: `${i * 37.8}px`, bottom: 0 }}
                      >
                        <div className="h-6 w-0.5 bg-slate-800"></div>
                        <div className="absolute -top-6 -left-2 font-bold text-slate-700">
                          {i}
                        </div>
                        {/* mm marks */}
                        {[...Array(9)].map((_, j) => (
                          <div
                            key={j}
                            className="absolute h-3 w-px bg-slate-400"
                            style={{ left: `${(j + 1) * 3.78}px`, bottom: 0 }}
                          ></div>
                        ))}
                      </div>
                    ))}
                    <div className="absolute right-4 top-2 text-yellow-800 font-black text-xl opacity-50">
                      cm
                    </div>
                  </div>
                </motion.div>

                <div className="absolute bottom-4 left-4 text-slate-400 text-sm font-bold animate-bounce">
                  {getText("dragTip")}
                </div>
              </div>

              {/* Input Area */}
              <div className="flex flex-col md:flex-row items-center justify-center gap-4">
                <div className="text-xl font-bold text-slate-600">
                  {getText("lengthIs")}
                </div>
                <input
                  type="number"
                  value={userInput}
                  onChange={(e) => setUserInput(e.target.value)}
                  className="w-32 px-4 py-3 text-3xl font-black text-center border-4 border-indigo-300 rounded-xl focus:border-indigo-600 outline-none"
                  placeholder="?"
                  onKeyDown={(e) => e.key === "Enter" && checkAnswer()}
                />
                <div className="text-2xl font-black text-slate-600">cm</div>
                <button
                  onClick={checkAnswer}
                  className="px-8 py-4 bg-green-500 hover:bg-green-600 text-white rounded-xl font-bold shadow-lg transition-transform active:scale-95"
                >
                  {getText("check")}
                </button>
              </div>

              {feedback === "correct" && (
                <motion.div
                  initial={{ scale: 0 }}
                  animate={{ scale: 1 }}
                  className="absolute inset-0 flex items-center justify-center pointer-events-none"
                >
                  <div className="bg-green-500 text-white px-8 py-6 rounded-3xl text-4xl font-black shadow-2xl">
                    {getText("correct")}
                  </div>
                </motion.div>
              )}

              {feedback === "incorrect" && (
                <motion.div
                  initial={{ scale: 0 }}
                  animate={{ scale: 1 }}
                  className="absolute inset-0 flex items-center justify-center pointer-events-none"
                >
                  <div className="bg-red-500 text-white px-8 py-6 rounded-3xl text-4xl font-black shadow-2xl">
                    {getText("incorrect")}
                  </div>
                </motion.div>
              )}
            </div>
          </div>
        );
      }
      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
