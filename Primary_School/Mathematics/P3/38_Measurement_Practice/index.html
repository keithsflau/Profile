<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å°ä¸‰æ•¸å­¸ï¼šé•·åº¦é‡åº¦å¤§å¸«</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&family=Fredoka:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Fredoka", "Noto Sans TC", sans-serif;
        background: linear-gradient(135deg, #a5b4fc 0%, #6366f1 100%);
        overflow-x: hidden;
      }
      .ruler {
        background: repeating-linear-gradient(
            90deg,
            #fbbf24 0 1px,
            transparent 1px 10px
          ),
          repeating-linear-gradient(90deg, #fbbf24 0 2px, transparent 2px 50px);
        background-color: rgba(255, 255, 255, 0.9);
      }
      .marker {
        height: 10px;
        width: 1px;
        background: #000;
        position: absolute;
        bottom: 0;
      }
      .marker.long {
        height: 20px;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useRef, useEffect } = React;
      const { motion } = window.Motion;

      function App() {
        const [level, setLevel] = useState(1);
        const [targetLength, setTargetLength] = useState(0);
        const [rulerX, setRulerX] = useState(0);
        const [userInput, setUserInput] = useState("");
        const [feedback, setFeedback] = useState(null);
        const [score, setScore] = useState(0);

        // Random object generator
        const generateObject = () => {
          const len = Math.floor(Math.random() * 12) + 1; // 1 to 12 cm
          setTargetLength(len);
          setFeedback(null);
          setUserInput("");
          setRulerX(Math.random() * 200 - 100); // Randomize ruler pos slightly
        };

        useEffect(() => {
          generateObject();
        }, [level]);

        const checkAnswer = () => {
          if (parseFloat(userInput) === targetLength) {
            setFeedback("correct");
            setScore((s) => s + 10);
          } else {
            setFeedback("incorrect");
          }
        };

        const rulerRef = useRef(null);

        return (
          <div className="min-h-screen p-8 flex flex-col items-center select-none">
            <h1 className="text-5xl font-black text-white mb-8 drop-shadow-md">
              ğŸ“ é•·åº¦é‡åº¦å¤§å¸«
            </h1>

            <div className="bg-white/90 backdrop-blur-md rounded-3xl p-8 shadow-2xl w-full max-w-4xl relative min-h-[500px] flex flex-col">
              <div className="flex justify-between items-center mb-8 bg-indigo-50 p-4 rounded-2xl">
                <div>
                  <span className="text-indigo-800 font-bold mr-2">å¾—åˆ†:</span>
                  <span className="text-3xl font-black text-indigo-600">
                    {score}
                  </span>
                </div>
                <button
                  onClick={generateObject}
                  className="bg-indigo-500 hover:bg-indigo-600 text-white px-6 py-2 rounded-xl font-bold transition-all"
                >
                  ä¸‹ä¸€é¡Œ
                </button>
              </div>

              {/* Measurement Area */}
              <div className="flex-1 bg-slate-100 rounded-2xl border-2 border-slate-200 relative overflow-hidden mb-8 flex items-center justify-center p-12">
                {/* Target Object */}
                <div
                  className="h-4 bg-gradient-to-r from-pink-500 to-rose-500 rounded shadow-lg absolute"
                  style={{
                    width: `${targetLength * 37.8}px`,
                    top: "40%",
                    left: "10%",
                  }} // approx 37.8px per cm
                >
                  <div className="absolute -top-8 left-0 text-slate-400 font-bold text-xs">
                    èµ·é»
                  </div>
                  <div className="absolute -top-8 right-0 text-slate-400 font-bold text-xs">
                    çµ‚é»
                  </div>
                  <div className="absolute -left-1 -bottom-2 w-0.5 h-6 bg-slate-400"></div>
                  <div className="absolute -right-1 -bottom-2 w-0.5 h-6 bg-slate-400"></div>
                </div>

                {/* Draggable Ruler */}
                <motion.div
                  drag="x"
                  dragMomentum={false}
                  className="absolute cursor-grab active:cursor-grabbing"
                  style={{ top: "60%", x: rulerX }}
                >
                  <div className="w-[600px] h-24 bg-yellow-100 border-b-4 border-yellow-600 rounded-lg shadow-xl relative flex items-end">
                    {/* Ruler Markings */}
                    {[...Array(16)].map((_, i) => (
                      <div
                        key={i}
                        className="absolute"
                        style={{ left: `${i * 37.8}px`, bottom: 0 }}
                      >
                        <div className="h-6 w-0.5 bg-slate-800"></div>
                        <div className="absolute -top-6 -left-2 font-bold text-slate-700">
                          {i}
                        </div>
                        {/* mm marks */}
                        {[...Array(9)].map((_, j) => (
                          <div
                            key={j}
                            className="absolute h-3 w-px bg-slate-400"
                            style={{ left: `${(j + 1) * 3.78}px`, bottom: 0 }}
                          ></div>
                        ))}
                      </div>
                    ))}
                    <div className="absolute right-4 top-2 text-yellow-800 font-black text-xl opacity-50">
                      cm
                    </div>
                  </div>
                </motion.div>

                <div className="absolute bottom-4 left-4 text-slate-400 text-sm font-bold animate-bounce">
                  ğŸ‘† æ‹–å‹•é–“å°ºä¾†é‡åº¦
                </div>
              </div>

              {/* Input Area */}
              <div className="flex items-center justify-center gap-4">
                <div className="text-xl font-bold text-slate-600">
                  é€™æ¢ç·šé•·åº¦æ˜¯ï¼š
                </div>
                <input
                  type="number"
                  value={userInput}
                  onChange={(e) => setUserInput(e.target.value)}
                  className="w-32 px-4 py-3 text-3xl font-black text-center border-4 border-indigo-300 rounded-xl focus:border-indigo-600 outline-none"
                  placeholder="?"
                  onKeyDown={(e) => e.key === "Enter" && checkAnswer()}
                />
                <div className="text-2xl font-black text-slate-600">cm</div>
                <button
                  onClick={checkAnswer}
                  className="px-8 py-4 bg-green-500 hover:bg-green-600 text-white rounded-xl font-bold shadow-lg transition-transform active:scale-95"
                >
                  æª¢æŸ¥
                </button>
              </div>

              {feedback === "correct" && (
                <motion.div
                  initial={{ scale: 0 }}
                  animate={{ scale: 1 }}
                  className="absolute inset-0 flex items-center justify-center pointer-events-none"
                >
                  <div className="bg-green-500 text-white px-8 py-6 rounded-3xl text-4xl font-black shadow-2xl">
                    âœ“ ç­”å°äº†ï¼
                  </div>
                </motion.div>
              )}

              {feedback === "incorrect" && (
                <motion.div
                  initial={{ scale: 0 }}
                  animate={{ scale: 1 }}
                  className="absolute inset-0 flex items-center justify-center pointer-events-none"
                >
                  <div className="bg-red-500 text-white px-8 py-6 rounded-3xl text-4xl font-black shadow-2xl">
                    âœ— å†è©¦ä¸€æ¬¡ï¼
                  </div>
                </motion.div>
              )}
            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
